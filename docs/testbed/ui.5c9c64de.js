parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"FoTz":[function(require,module,exports) {
"use strict";var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),i=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),l=Symbol.iterator;function p(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=l&&e[l]||e["@@iterator"])?e:null}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},d=Object.assign,_={};function h(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||y}function x(){}function m(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||y}h.prototype.isReactComponent={},h.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},h.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=h.prototype;var v=m.prototype=new x;v.constructor=m,d(v,h.prototype),v.isPureReactComponent=!0;var b=Array.isArray,S=Object.prototype.hasOwnProperty,E={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function w(t,r,n){var o,u={},s=null,a=null;if(null!=r)for(o in void 0!==r.ref&&(a=r.ref),void 0!==r.key&&(s=""+r.key),r)S.call(r,o)&&!$.hasOwnProperty(o)&&(u[o]=r[o]);var c=arguments.length-2;if(1===c)u.children=n;else if(1<c){for(var i=Array(c),f=0;f<c;f++)i[f]=arguments[f+2];u.children=i}if(t&&t.defaultProps)for(o in c=t.defaultProps)void 0===u[o]&&(u[o]=c[o]);return{$$typeof:e,type:t,key:s,ref:a,props:u,_owner:E.current}}function R(t,r){return{$$typeof:e,type:t.type,key:r,ref:t.ref,props:t.props,_owner:t._owner}}function k(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}function C(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}var g=/\/+/g;function j(e,t){return"object"==typeof e&&null!==e&&null!=e.key?C(""+e.key):t.toString(36)}function O(r,n,o,u,s){var a=typeof r;"undefined"!==a&&"boolean"!==a||(r=null);var c=!1;if(null===r)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(r.$$typeof){case e:case t:c=!0}}if(c)return s=s(c=r),r=""===u?"."+j(c,0):u,b(s)?(o="",null!=r&&(o=r.replace(g,"$&/")+"/"),O(s,n,o,"",function(e){return e})):null!=s&&(k(s)&&(s=R(s,o+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(g,"$&/")+"/")+r)),n.push(s)),1;if(c=0,u=""===u?".":u+":",b(r))for(var i=0;i<r.length;i++){var f=u+j(a=r[i],i);c+=O(a,n,o,f,s)}else if("function"==typeof(f=p(r)))for(r=f.call(r),i=0;!(a=r.next()).done;)c+=O(a=a.value,n,o,f=u+j(a,i++),s);else if("object"===a)throw n=String(r),Error("Objects are not valid as a React child (found: "+("[object Object]"===n?"object with keys {"+Object.keys(r).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return c}function P(e,t,r){if(null==e)return e;var n=[],o=0;return O(e,n,"","",function(e){return t.call(r,e,o++)}),n}function I(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var T={current:null},V={transition:null},A={ReactCurrentDispatcher:T,ReactCurrentBatchConfig:V,ReactCurrentOwner:E};exports.Children={map:P,forEach:function(e,t,r){P(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},exports.Component=h,exports.Fragment=r,exports.Profiler=o,exports.PureComponent=m,exports.StrictMode=n,exports.Suspense=c,exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,exports.cloneElement=function(t,r,n){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var o=d({},t.props),u=t.key,s=t.ref,a=t._owner;if(null!=r){if(void 0!==r.ref&&(s=r.ref,a=E.current),void 0!==r.key&&(u=""+r.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(i in r)S.call(r,i)&&!$.hasOwnProperty(i)&&(o[i]=void 0===r[i]&&void 0!==c?c[i]:r[i])}var i=arguments.length-2;if(1===i)o.children=n;else if(1<i){c=Array(i);for(var f=0;f<i;f++)c[f]=arguments[f+2];o.children=c}return{$$typeof:e,type:t.type,key:u,ref:s,props:o,_owner:a}},exports.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},exports.createElement=w,exports.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},exports.createRef=function(){return{current:null}},exports.forwardRef=function(e){return{$$typeof:a,render:e}},exports.isValidElement=k,exports.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:I}},exports.memo=function(e,t){return{$$typeof:i,type:e,compare:void 0===t?null:t}},exports.startTransition=function(e){var t=V.transition;V.transition={};try{e()}finally{V.transition=t}},exports.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},exports.useCallback=function(e,t){return T.current.useCallback(e,t)},exports.useContext=function(e){return T.current.useContext(e)},exports.useDebugValue=function(){},exports.useDeferredValue=function(e){return T.current.useDeferredValue(e)},exports.useEffect=function(e,t){return T.current.useEffect(e,t)},exports.useId=function(){return T.current.useId()},exports.useImperativeHandle=function(e,t,r){return T.current.useImperativeHandle(e,t,r)},exports.useInsertionEffect=function(e,t){return T.current.useInsertionEffect(e,t)},exports.useLayoutEffect=function(e,t){return T.current.useLayoutEffect(e,t)},exports.useMemo=function(e,t){return T.current.useMemo(e,t)},exports.useReducer=function(e,t,r){return T.current.useReducer(e,t,r)},exports.useRef=function(e){return T.current.useRef(e)},exports.useState=function(e){return T.current.useState(e)},exports.useSyncExternalStore=function(e,t,r){return T.current.useSyncExternalStore(e,t,r)},exports.useTransition=function(){return T.current.useTransition()},exports.version="18.1.0";
},{}],"dmLA":[function(require,module,exports) {
"use strict";module.exports=require("./cjs/react.production.min.js");
},{"./cjs/react.production.min.js":"FoTz"}],"px6A":[function(require,module,exports) {
"use strict";function e(e,n){var t=e.length;e.push(n);e:for(;0<t;){var a=t-1>>>1,o=e[a];if(!(0<r(o,n)))break e;e[a]=n,e[t]=o,t=a}}function n(e){return 0===e.length?null:e[0]}function t(e){if(0===e.length)return null;var n=e[0],t=e.pop();if(t!==n){e[0]=t;e:for(var a=0,o=e.length,l=o>>>1;a<l;){var i=2*(a+1)-1,u=e[i],s=i+1,c=e[s];if(0>r(u,t))s<o&&0>r(c,u)?(e[a]=c,e[s]=t,a=s):(e[a]=u,e[i]=t,a=i);else{if(!(s<o&&0>r(c,t)))break e;e[a]=c,e[s]=t,a=s}}}return n}function r(e,n){var t=e.sortIndex-n.sortIndex;return 0!==t?t:e.id-n.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;exports.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();exports.unstable_now=function(){return o.now()-l}}var i=[],u=[],s=1,c=null,f=3,p=!1,b=!1,d=!1,v="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function m(r){for(var a=n(u);null!==a;){if(null===a.callback)t(u);else{if(!(a.startTime<=r))break;t(u),a.sortIndex=a.expirationTime,e(i,a)}a=n(u)}}function g(e){if(d=!1,m(e),!b)if(null!==n(i))b=!0,j(_);else{var t=n(u);null!==t&&E(g,t.startTime-e)}}function _(e,r){b=!1,d&&(d=!1,x(I),I=-1),p=!0;var a=f;try{for(m(r),c=n(i);null!==c&&(!(c.expirationTime>r)||e&&!C());){var o=c.callback;if("function"==typeof o){c.callback=null,f=c.priorityLevel;var l=o(c.expirationTime<=r);r=exports.unstable_now(),"function"==typeof l?c.callback=l:c===n(i)&&t(i),m(r)}else t(i);c=n(i)}if(null!==c)var s=!0;else{var v=n(u);null!==v&&E(g,v.startTime-r),s=!1}return s}finally{c=null,f=a,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var h,k=!1,w=null,I=-1,T=5,P=-1;function C(){return!(exports.unstable_now()-P<T)}function L(){if(null!==w){var e=exports.unstable_now();P=e;var n=!0;try{n=w(!0,e)}finally{n?h():(k=!1,w=null)}}else k=!1}if("function"==typeof y)h=function(){y(L)};else if("undefined"!=typeof MessageChannel){var M=new MessageChannel,F=M.port2;M.port1.onmessage=L,h=function(){F.postMessage(null)}}else h=function(){v(L,0)};function j(e){w=e,k||(k=!0,h())}function E(e,n){I=v(function(){e(exports.unstable_now())},n)}exports.unstable_IdlePriority=5,exports.unstable_ImmediatePriority=1,exports.unstable_LowPriority=4,exports.unstable_NormalPriority=3,exports.unstable_Profiling=null,exports.unstable_UserBlockingPriority=2,exports.unstable_cancelCallback=function(e){e.callback=null},exports.unstable_continueExecution=function(){b||p||(b=!0,j(_))},exports.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},exports.unstable_getCurrentPriorityLevel=function(){return f},exports.unstable_getFirstCallbackNode=function(){return n(i)},exports.unstable_next=function(e){switch(f){case 1:case 2:case 3:var n=3;break;default:n=f}var t=f;f=n;try{return e()}finally{f=t}},exports.unstable_pauseExecution=function(){},exports.unstable_requestPaint=function(){},exports.unstable_runWithPriority=function(e,n){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=f;f=e;try{return n()}finally{f=t}},exports.unstable_scheduleCallback=function(t,r,a){var o=exports.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?o+a:o:a=o,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:s++,callback:r,priorityLevel:t,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>o?(t.sortIndex=a,e(u,t),null===n(i)&&t===n(u)&&(d?(x(I),I=-1):d=!0,E(g,a-o))):(t.sortIndex=l,e(i,t),b||p||(b=!0,j(_))),t},exports.unstable_shouldYield=C,exports.unstable_wrapCallback=function(e){var n=f;return function(){var t=f;f=n;try{return e.apply(this,arguments)}finally{f=t}}};
},{}],"vqYn":[function(require,module,exports) {
"use strict";module.exports=require("./cjs/scheduler.production.min.js");
},{"./cjs/scheduler.production.min.js":"px6A"}],"ogJH":[function(require,module,exports) {
"use strict";var e=require("react"),n=require("scheduler");function t(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)n+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,l={};function a(e,n){u(e,n),u(e+"Capture",n)}function u(e,n){for(l[e]=n,e=0;e<n.length;e++)r.add(n[e])}var o=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),i=Object.prototype.hasOwnProperty,s=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},f={};function d(e){return!!i.call(f,e)||!i.call(c,e)&&(s.test(e)?f[e]=!0:(c[e]=!0,!1))}function p(e,n,t,r){if(null!==t&&0===t.type)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==t?!t.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}function m(e,n,t,r){if(null==n||p(e,n,t,r))return!0;if(r)return!1;if(null!==t)switch(t.type){case 3:return!n;case 4:return!1===n;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function h(e,n,t,r,l,a,u){this.acceptsBooleans=2===n||3===n||4===n,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=t,this.propertyName=e,this.type=n,this.sanitizeURL=a,this.removeEmptyString=u}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new h(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];g[n]=new h(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new h(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new h(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new h(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new h(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new h(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new h(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new h(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,n,t,r){var l=g.hasOwnProperty(n)?g[n]:null;(null!==l?0!==l.type:r||!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&(m(n,t,l,r)&&(t=null),r||null===l?d(n)&&(null===t?e.removeAttribute(n):e.setAttribute(n,""+t)):l.mustUseProperty?e[l.propertyName]=null===t?3!==l.type&&"":t:(n=l.attributeName,r=l.attributeNamespace,null===t?e.removeAttribute(n):(t=3===(l=l.type)||4===l&&!0===t?"":""+t,r?e.setAttributeNS(r,n,t):e.setAttribute(n,t))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(v,y);g[n]=new h(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(v,y);g[n]=new h(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(v,y);g[n]=new h(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new h(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new h("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new h(e,1,!1,e.toLowerCase(),null,!0,!0)});var k=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),N=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var F=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=R&&e[R]||e["@@iterator"])?e:null}var O,I=Object.assign;function U(e){if(void 0===O)try{throw Error()}catch(t){var n=t.stack.trim().match(/\n( *(at )?)/);O=n&&n[1]||""}return"\n"+O+e}var V=!1;function A(e,n){if(!e||V)return"";V=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(s){var r=s}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){r=s}e.call(n.prototype)}else{try{throw Error()}catch(s){r=s}e()}}catch(s){if(s&&r&&"string"==typeof s.stack){for(var l=s.stack.split("\n"),a=r.stack.split("\n"),u=l.length-1,o=a.length-1;1<=u&&0<=o&&l[u]!==a[o];)o--;for(;1<=u&&0<=o;u--,o--)if(l[u]!==a[o]){if(1!==u||1!==o)do{if(u--,0>--o||l[u]!==a[o]){var i="\n"+l[u].replace(" at new "," at ");return e.displayName&&i.includes("<anonymous>")&&(i=i.replace("<anonymous>",e.displayName)),i}}while(1<=u&&0<=o);break}}}finally{V=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?U(e):""}function B(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=A(e.type,!1);case 11:return e=A(e.type.render,!1);case 1:return e=A(e.type,!0);default:return""}}function Q(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case x:return"Fragment";case S:return"Portal";case C:return"Profiler";case E:return"StrictMode";case _:return"Suspense";case L:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case z:return(e._context.displayName||"Context")+".Provider";case P:var n=e.render;return(e=e.displayName)||(e=""!==(e=n.displayName||n.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(n=e.displayName||null)?n:Q(e.type)||"Memo";case M:n=e._payload,e=e._init;try{return Q(e(n))}catch(t){}}return null}function W(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=n.render).displayName||e.name||"",n.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(n);case 8:return n===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof n)return n.displayName||n.name||null;if("string"==typeof n)return n}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var n=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===n||"radio"===n)}function $(e){var n=j(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),r=""+e[n];if(!e.hasOwnProperty(n)&&void 0!==t&&"function"==typeof t.get&&"function"==typeof t.set){var l=t.get,a=t.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return l.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,n,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function q(e){e._valueTracker||(e._valueTracker=$(e))}function K(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var t=n.getValue(),r="";return e&&(r=j(e)?e.checked?"true":"false":e.value),(e=r)!==t&&(n.setValue(e),!0)}function Y(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(n){return e.body}}function X(e,n){var t=n.checked;return I({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=t?t:e._wrapperState.initialChecked})}function G(e,n){var t=null==n.defaultValue?"":n.defaultValue,r=null!=n.checked?n.checked:n.defaultChecked;t=H(null!=n.value?n.value:t),e._wrapperState={initialChecked:r,initialValue:t,controlled:"checkbox"===n.type||"radio"===n.type?null!=n.checked:null!=n.value}}function Z(e,n){null!=(n=n.checked)&&b(e,"checked",n,!1)}function J(e,n){Z(e,n);var t=H(n.value),r=n.type;if(null!=t)"number"===r?(0===t&&""===e.value||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");n.hasOwnProperty("value")?ne(e,n.type,t):n.hasOwnProperty("defaultValue")&&ne(e,n.type,H(n.defaultValue)),null==n.checked&&null!=n.defaultChecked&&(e.defaultChecked=!!n.defaultChecked)}function ee(e,n,t){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var r=n.type;if(!("submit"!==r&&"reset"!==r||void 0!==n.value&&null!==n.value))return;n=""+e._wrapperState.initialValue,t||n===e.value||(e.value=n),e.defaultValue=n}""!==(t=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==t&&(e.name=t)}function ne(e,n,t){"number"===n&&Y(e.ownerDocument)===e||(null==t?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var te=Array.isArray;function re(e,n,t,r){if(e=e.options,n){n={};for(var l=0;l<t.length;l++)n["$"+t[l]]=!0;for(t=0;t<e.length;t++)l=n.hasOwnProperty("$"+e[t].value),e[t].selected!==l&&(e[t].selected=l),l&&r&&(e[t].defaultSelected=!0)}else{for(t=""+H(t),n=null,l=0;l<e.length;l++){if(e[l].value===t)return e[l].selected=!0,void(r&&(e[l].defaultSelected=!0));null!==n||e[l].disabled||(n=e[l])}null!==n&&(n.selected=!0)}}function le(e,n){if(null!=n.dangerouslySetInnerHTML)throw Error(t(91));return I({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,n){var r=n.value;if(null==r){if(r=n.children,n=n.defaultValue,null!=r){if(null!=n)throw Error(t(92));if(te(r)){if(1<r.length)throw Error(t(93));r=r[0]}n=r}null==n&&(n=""),r=n}e._wrapperState={initialValue:H(r)}}function ue(e,n){var t=H(n.value),r=H(n.defaultValue);null!=t&&((t=""+t)!==e.value&&(e.value=t),null==n.defaultValue&&e.defaultValue!==t&&(e.defaultValue=t)),null!=r&&(e.defaultValue=""+r)}function oe(e){var n=e.textContent;n===e._wrapperState.initialValue&&""!==n&&null!==n&&(e.value=n)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,n){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(n):"http://www.w3.org/2000/svg"===e&&"foreignObject"===n?"http://www.w3.org/1999/xhtml":e}var ce,fe=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(n,t,r,l){MSApp.execUnsafeLocalFunction(function(){return e(n,t)})}:e}(function(e,n){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=n;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function de(e,n){if(n){var t=e.firstChild;if(t&&t===e.lastChild&&3===t.nodeType)return void(t.nodeValue=n)}e.textContent=n}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function he(e,n,t){return null==n||"boolean"==typeof n||""===n?"":t||"number"!=typeof n||0===n||pe.hasOwnProperty(e)&&pe[e]?(""+n).trim():n+"px"}function ge(e,n){for(var t in e=e.style,n)if(n.hasOwnProperty(t)){var r=0===t.indexOf("--"),l=he(t,n[t],r);"float"===t&&(t="cssFloat"),r?e.setProperty(t,l):e[t]=l}}Object.keys(pe).forEach(function(e){me.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),pe[n]=pe[e]})});var ve=I({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,n){if(n){if(ve[e]&&(null!=n.children||null!=n.dangerouslySetInnerHTML))throw Error(t(137,e));if(null!=n.dangerouslySetInnerHTML){if(null!=n.children)throw Error(t(60));if("object"!=typeof n.dangerouslySetInnerHTML||!("__html"in n.dangerouslySetInnerHTML))throw Error(t(61))}if(null!=n.style&&"object"!=typeof n.style)throw Error(t(62))}}function be(e,n){if(-1===e.indexOf("-"))return"string"==typeof n.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,xe=null,Ee=null;function Ce(e){if(e=Ul(e)){if("function"!=typeof Se)throw Error(t(280));var n=e.stateNode;n&&(n=Al(n),Se(e.stateNode,e.type,n))}}function ze(e){xe?Ee?Ee.push(e):Ee=[e]:xe=e}function Ne(){if(xe){var e=xe,n=Ee;if(Ee=xe=null,Ce(e),n)for(e=0;e<n.length;e++)Ce(n[e])}}function Pe(e,n){return e(n)}function _e(){}var Le=!1;function Te(e,n,t){if(Le)return e(n,t);Le=!0;try{return Pe(e,n,t)}finally{Le=!1,(null!==xe||null!==Ee)&&(_e(),Ne())}}function Me(e,n){var r=e.stateNode;if(null===r)return null;var l=Al(r);if(null===l)return null;r=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(l=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!l;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(t(231,n,typeof r));return r}var Fe=!1;if(o)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Fe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(Mc){Fe=!1}function De(e,n,t,r,l,a,u,o,i){var s=Array.prototype.slice.call(arguments,3);try{n.apply(t,s)}catch(c){this.onError(c)}}var Oe=!1,Ie=null,Ue=!1,Ve=null,Ae={onError:function(e){Oe=!0,Ie=e}};function Be(e,n,t,r,l,a,u,o,i){Oe=!1,Ie=null,De.apply(Ae,arguments)}function Qe(e,n,r,l,a,u,o,i,s){if(Be.apply(this,arguments),Oe){if(!Oe)throw Error(t(198));var c=Ie;Oe=!1,Ie=null,Ue||(Ue=!0,Ve=c)}}function We(e){var n=e,t=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do{0!=(4098&(n=e).flags)&&(t=n.return),e=n.return}while(e)}return 3===n.tag?t:null}function He(e){if(13===e.tag){var n=e.memoizedState;if(null===n&&(null!==(e=e.alternate)&&(n=e.memoizedState)),null!==n)return n.dehydrated}return null}function je(e){if(We(e)!==e)throw Error(t(188))}function $e(e){var n=e.alternate;if(!n){if(null===(n=We(e)))throw Error(t(188));return n!==e?null:e}for(var r=e,l=n;;){var a=r.return;if(null===a)break;var u=a.alternate;if(null===u){if(null!==(l=a.return)){r=l;continue}break}if(a.child===u.child){for(u=a.child;u;){if(u===r)return je(a),e;if(u===l)return je(a),n;u=u.sibling}throw Error(t(188))}if(r.return!==l.return)r=a,l=u;else{for(var o=!1,i=a.child;i;){if(i===r){o=!0,r=a,l=u;break}if(i===l){o=!0,l=a,r=u;break}i=i.sibling}if(!o){for(i=u.child;i;){if(i===r){o=!0,r=u,l=a;break}if(i===l){o=!0,l=u,r=a;break}i=i.sibling}if(!o)throw Error(t(189))}}if(r.alternate!==l)throw Error(t(190))}if(3!==r.tag)throw Error(t(188));return r.stateNode.current===r?e:n}function qe(e){return null!==(e=$e(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var n=Ke(e);if(null!==n)return n;e=e.sibling}return null}var Ye=n.unstable_scheduleCallback,Xe=n.unstable_cancelCallback,Ge=n.unstable_shouldYield,Ze=n.unstable_requestPaint,Je=n.unstable_now,en=n.unstable_getCurrentPriorityLevel,nn=n.unstable_ImmediatePriority,tn=n.unstable_UserBlockingPriority,rn=n.unstable_NormalPriority,ln=n.unstable_LowPriority,an=n.unstable_IdlePriority,un=null,on=null;function sn(e){if(on&&"function"==typeof on.onCommitFiberRoot)try{on.onCommitFiberRoot(un,e,void 0,128==(128&e.current.flags))}catch(n){}}var cn=Math.clz32?Math.clz32:pn,fn=Math.log,dn=Math.LN2;function pn(e){return 0===(e>>>=0)?32:31-(fn(e)/dn|0)|0}var mn=64,hn=4194304;function gn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vn(e,n){var t=e.pendingLanes;if(0===t)return 0;var r=0,l=e.suspendedLanes,a=e.pingedLanes,u=268435455&t;if(0!==u){var o=u&~l;0!==o?r=gn(o):0!==(a&=u)&&(r=gn(a))}else 0!==(u=t&~l)?r=gn(u):0!==a&&(r=gn(a));if(0===r)return 0;if(0!==n&&n!==r&&0==(n&l)&&((l=r&-r)>=(a=n&-n)||16===l&&0!=(4194240&a)))return n;if(0!=(4&r)&&(r|=16&t),0!==(n=e.entangledLanes))for(e=e.entanglements,n&=r;0<n;)l=1<<(t=31-cn(n)),r|=e[t],n&=~l;return r}function yn(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:default:return-1}}function bn(e,n){for(var t=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,a=e.pendingLanes;0<a;){var u=31-cn(a),o=1<<u,i=l[u];-1===i?0!=(o&t)&&0==(o&r)||(l[u]=yn(o,n)):i<=n&&(e.expiredLanes|=o),a&=~o}}function kn(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function wn(){var e=mn;return 0==(4194240&(mn<<=1))&&(mn=64),e}function Sn(e){for(var n=[],t=0;31>t;t++)n.push(e);return n}function xn(e,n,t){e.pendingLanes|=n,536870912!==n&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[n=31-cn(n)]=t}function En(e,n){var t=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<t;){var l=31-cn(t),a=1<<l;n[l]=0,r[l]=-1,e[l]=-1,t&=~a}}function Cn(e,n){var t=e.entangledLanes|=n;for(e=e.entanglements;t;){var r=31-cn(t),l=1<<r;l&n|e[r]&n&&(e[r]|=n),t&=~l}}var zn=0;function Nn(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var Pn,_n,Ln,Tn,Mn,Fn=!1,Rn=[],Dn=null,On=null,In=null,Un=new Map,Vn=new Map,An=[],Bn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qn(e,n){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":In=null;break;case"pointerover":case"pointerout":Un.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vn.delete(n.pointerId)}}function Wn(e,n,t,r,l,a){return null===e||e.nativeEvent!==a?(e={blockedOn:n,domEventName:t,eventSystemFlags:r,nativeEvent:a,targetContainers:[l]},null!==n&&(null!==(n=Ul(n))&&_n(n)),e):(e.eventSystemFlags|=r,n=e.targetContainers,null!==l&&-1===n.indexOf(l)&&n.push(l),e)}function Hn(e,n,t,r,l){switch(n){case"focusin":return Dn=Wn(Dn,e,n,t,r,l),!0;case"dragenter":return On=Wn(On,e,n,t,r,l),!0;case"mouseover":return In=Wn(In,e,n,t,r,l),!0;case"pointerover":var a=l.pointerId;return Un.set(a,Wn(Un.get(a)||null,e,n,t,r,l)),!0;case"gotpointercapture":return a=l.pointerId,Vn.set(a,Wn(Vn.get(a)||null,e,n,t,r,l)),!0}return!1}function jn(e){var n=Il(e.target);if(null!==n){var t=We(n);if(null!==t)if(13===(n=t.tag)){if(null!==(n=He(t)))return e.blockedOn=n,void Mn(e.priority,function(){Ln(t)})}else if(3===n&&t.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===t.tag?t.stateNode.containerInfo:null)}e.blockedOn=null}function $n(e){if(null!==e.blockedOn)return!1;for(var n=e.targetContainers;0<n.length;){var t=rt(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(null!==t)return null!==(n=Ul(t))&&_n(n),e.blockedOn=t,!1;var r=new(t=e.nativeEvent).constructor(t.type,t);ke=r,t.target.dispatchEvent(r),ke=null,n.shift()}return!0}function qn(e,n,t){$n(e)&&t.delete(n)}function Kn(){Fn=!1,null!==Dn&&$n(Dn)&&(Dn=null),null!==On&&$n(On)&&(On=null),null!==In&&$n(In)&&(In=null),Un.forEach(qn),Vn.forEach(qn)}function Yn(e,t){e.blockedOn===t&&(e.blockedOn=null,Fn||(Fn=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Kn)))}function Xn(e){function n(n){return Yn(n,e)}if(0<Rn.length){Yn(Rn[0],e);for(var t=1;t<Rn.length;t++){var r=Rn[t];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Dn&&Yn(Dn,e),null!==On&&Yn(On,e),null!==In&&Yn(In,e),Un.forEach(n),Vn.forEach(n),t=0;t<An.length;t++)(r=An[t]).blockedOn===e&&(r.blockedOn=null);for(;0<An.length&&null===(t=An[0]).blockedOn;)jn(t),null===t.blockedOn&&An.shift()}var Gn=k.ReactCurrentBatchConfig,Zn=!0;function Jn(e,n,t,r){var l=zn,a=Gn.transition;Gn.transition=null;try{zn=1,nt(e,n,t,r)}finally{zn=l,Gn.transition=a}}function et(e,n,t,r){var l=zn,a=Gn.transition;Gn.transition=null;try{zn=4,nt(e,n,t,r)}finally{zn=l,Gn.transition=a}}function nt(e,n,t,r){if(Zn){var l=rt(e,n,t,r);if(null===l)sl(e,n,r,tt,t),Qn(e,r);else if(Hn(l,e,n,t,r))r.stopPropagation();else if(Qn(e,r),4&n&&-1<Bn.indexOf(e)){for(;null!==l;){var a=Ul(l);if(null!==a&&Pn(a),null===(a=rt(e,n,t,r))&&sl(e,n,r,tt,t),a===l)break;l=a}null!==l&&r.stopPropagation()}else sl(e,n,r,null,t)}}var tt=null;function rt(e,n,t,r){if(tt=null,null!==(e=Il(e=we(r))))if(null===(n=We(e)))e=null;else if(13===(t=n.tag)){if(null!==(e=He(n)))return e;e=null}else if(3===t){if(n.stateNode.current.memoizedState.isDehydrated)return 3===n.tag?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return tt=e,null}function lt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(en()){case nn:return 1;case tn:return 4;case rn:case ln:return 16;case an:return 536870912;default:return 16}default:return 16}}var at=null,ut=null,ot=null;function it(){if(ot)return ot;var e,n,t=ut,r=t.length,l="value"in at?at.value:at.textContent,a=l.length;for(e=0;e<r&&t[e]===l[e];e++);var u=r-e;for(n=1;n<=u&&t[r-n]===l[a-n];n++);return ot=l.slice(e,1<n?1-n:void 0)}function st(e){var n=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===n&&(e=13):e=n,10===e&&(e=13),32<=e||13===e?e:0}function ct(){return!0}function ft(){return!1}function dt(e){function n(n,t,r,l,a){for(var u in this._reactName=n,this._targetInst=r,this.type=t,this.nativeEvent=l,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(l):l[u]);return this.isDefaultPrevented=(null!=l.defaultPrevented?l.defaultPrevented:!1===l.returnValue)?ct:ft,this.isPropagationStopped=ft,this}return I(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ct)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ct)},persist:function(){},isPersistent:ct}),n}var pt,mt,ht,gt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vt=dt(gt),yt=I({},gt,{view:0,detail:0}),bt=dt(yt),kt=I({},yt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ot,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ht&&(ht&&"mousemove"===e.type?(pt=e.screenX-ht.screenX,mt=e.screenY-ht.screenY):mt=pt=0,ht=e),pt)},movementY:function(e){return"movementY"in e?e.movementY:mt}}),wt=dt(kt),St=I({},kt,{dataTransfer:0}),xt=dt(St),Et=I({},yt,{relatedTarget:0}),Ct=dt(Et),zt=I({},gt,{animationName:0,elapsedTime:0,pseudoElement:0}),Nt=dt(zt),Pt=I({},gt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_t=dt(Pt),Lt=I({},gt,{data:0}),Tt=dt(Lt),Mt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ft={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dt(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):!!(e=Rt[e])&&!!n[e]}function Ot(){return Dt}var It=I({},yt,{key:function(e){if(e.key){var n=Mt[e.key]||e.key;if("Unidentified"!==n)return n}return"keypress"===e.type?13===(e=st(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ft[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ot,charCode:function(e){return"keypress"===e.type?st(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?st(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ut=dt(It),Vt=I({},kt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),At=dt(Vt),Bt=I({},yt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ot}),Qt=dt(Bt),Wt=I({},gt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ht=dt(Wt),jt=I({},kt,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$t=dt(jt),qt=[9,13,27,32],Kt=o&&"CompositionEvent"in window,Yt=null;o&&"documentMode"in document&&(Yt=document.documentMode);var Xt=o&&"TextEvent"in window&&!Yt,Gt=o&&(!Kt||Yt&&8<Yt&&11>=Yt),Zt=String.fromCharCode(32),Jt=!1;function er(e,n){switch(e){case"keyup":return-1!==qt.indexOf(n.keyCode);case"keydown":return 229!==n.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nr(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var tr=!1;function rr(e,n){switch(e){case"compositionend":return nr(n);case"keypress":return 32!==n.which?null:(Jt=!0,Zt);case"textInput":return(e=n.data)===Zt&&Jt?null:e;default:return null}}function lr(e,n){if(tr)return"compositionend"===e||!Kt&&er(e,n)?(e=it(),ot=ut=at=null,tr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Gt&&"ko"!==n.locale?null:n.data;default:return null}}var ar={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ur(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===n?!!ar[e.type]:"textarea"===n}function or(e,n,t,r){ze(r),0<(n=fl(n,"onChange")).length&&(t=new vt("onChange","change",null,t,r),e.push({event:t,listeners:n}))}var ir=null,sr=null;function cr(e){rl(e,0)}function fr(e){if(K(Vl(e)))return e}function dr(e,n){if("change"===e)return n}var pr=!1;if(o){var mr;if(o){var hr="oninput"in document;if(!hr){var gr=document.createElement("div");gr.setAttribute("oninput","return;"),hr="function"==typeof gr.oninput}mr=hr}else mr=!1;pr=mr&&(!document.documentMode||9<document.documentMode)}function vr(){ir&&(ir.detachEvent("onpropertychange",yr),sr=ir=null)}function yr(e){if("value"===e.propertyName&&fr(sr)){var n=[];or(n,sr,e,we(e)),Te(cr,n)}}function br(e,n,t){"focusin"===e?(vr(),sr=t,(ir=n).attachEvent("onpropertychange",yr)):"focusout"===e&&vr()}function kr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return fr(sr)}function wr(e,n){if("click"===e)return fr(n)}function Sr(e,n){if("input"===e||"change"===e)return fr(n)}function xr(e,n){return e===n&&(0!==e||1/e==1/n)||e!=e&&n!=n}var Er="function"==typeof Object.is?Object.is:xr;function Cr(e,n){if(Er(e,n))return!0;if("object"!=typeof e||null===e||"object"!=typeof n||null===n)return!1;var t=Object.keys(e),r=Object.keys(n);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var l=t[r];if(!i.call(n,l)||!Er(e[l],n[l]))return!1}return!0}function zr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nr(e,n){var t,r=zr(e);for(e=0;r;){if(3===r.nodeType){if(t=e+r.textContent.length,e<=n&&t>=n)return{node:r,offset:n-e};e=t}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=zr(r)}}function Pr(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?Pr(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}function _r(){for(var e=window,n=Y();n instanceof e.HTMLIFrameElement;){try{var t="string"==typeof n.contentWindow.location.href}catch(r){t=!1}if(!t)break;n=Y((e=n.contentWindow).document)}return n}function Lr(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&("input"===n&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===n||"true"===e.contentEditable)}function Tr(e){var n=_r(),t=e.focusedElem,r=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&Pr(t.ownerDocument.documentElement,t)){if(null!==r&&Lr(t))if(n=r.start,void 0===(e=r.end)&&(e=n),"selectionStart"in t)t.selectionStart=n,t.selectionEnd=Math.min(e,t.value.length);else if((e=(n=t.ownerDocument||document)&&n.defaultView||window).getSelection){e=e.getSelection();var l=t.textContent.length,a=Math.min(r.start,l);r=void 0===r.end?a:Math.min(r.end,l),!e.extend&&a>r&&(l=r,r=a,a=l),l=Nr(t,a);var u=Nr(t,r);l&&u&&(1!==e.rangeCount||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==u.node||e.focusOffset!==u.offset)&&((n=n.createRange()).setStart(l.node,l.offset),e.removeAllRanges(),a>r?(e.addRange(n),e.extend(u.node,u.offset)):(n.setEnd(u.node,u.offset),e.addRange(n)))}for(n=[],e=t;e=e.parentNode;)1===e.nodeType&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof t.focus&&t.focus(),t=0;t<n.length;t++)(e=n[t]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Mr=o&&"documentMode"in document&&11>=document.documentMode,Fr=null,Rr=null,Dr=null,Or=!1;function Ir(e,n,t){var r=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;Or||null==Fr||Fr!==Y(r)||("selectionStart"in(r=Fr)&&Lr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Dr&&Cr(Dr,r)||(Dr=r,0<(r=fl(Rr,"onSelect")).length&&(n=new vt("onSelect","select",null,n,t),e.push({event:n,listeners:r}),n.target=Fr)))}function Ur(e,n){var t={};return t[e.toLowerCase()]=n.toLowerCase(),t["Webkit"+e]="webkit"+n,t["Moz"+e]="moz"+n,t}var Vr={animationend:Ur("Animation","AnimationEnd"),animationiteration:Ur("Animation","AnimationIteration"),animationstart:Ur("Animation","AnimationStart"),transitionend:Ur("Transition","TransitionEnd")},Ar={},Br={};function Qr(e){if(Ar[e])return Ar[e];if(!Vr[e])return e;var n,t=Vr[e];for(n in t)if(t.hasOwnProperty(n)&&n in Br)return Ar[e]=t[n];return e}o&&(Br=document.createElement("div").style,"AnimationEvent"in window||(delete Vr.animationend.animation,delete Vr.animationiteration.animation,delete Vr.animationstart.animation),"TransitionEvent"in window||delete Vr.transitionend.transition);var Wr=Qr("animationend"),Hr=Qr("animationiteration"),jr=Qr("animationstart"),$r=Qr("transitionend"),qr=new Map,Kr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(e,n){qr.set(e,n),a(n,[e])}for(var Xr=0;Xr<Kr.length;Xr++){var Gr=Kr[Xr],Zr=Gr.toLowerCase(),Jr=Gr[0].toUpperCase()+Gr.slice(1);Yr(Zr,"on"+Jr)}Yr(Wr,"onAnimationEnd"),Yr(Hr,"onAnimationIteration"),Yr(jr,"onAnimationStart"),Yr("dblclick","onDoubleClick"),Yr("focusin","onFocus"),Yr("focusout","onBlur"),Yr($r,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var el="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nl=new Set("cancel close invalid load scroll toggle".split(" ").concat(el));function tl(e,n,t){var r=e.type||"unknown-event";e.currentTarget=t,Qe(r,n,void 0,e),e.currentTarget=null}function rl(e,n){n=0!=(4&n);for(var t=0;t<e.length;t++){var r=e[t],l=r.event;r=r.listeners;e:{var a=void 0;if(n)for(var u=r.length-1;0<=u;u--){var o=r[u],i=o.instance,s=o.currentTarget;if(o=o.listener,i!==a&&l.isPropagationStopped())break e;tl(l,o,s),a=i}else for(u=0;u<r.length;u++){if(i=(o=r[u]).instance,s=o.currentTarget,o=o.listener,i!==a&&l.isPropagationStopped())break e;tl(l,o,s),a=i}}}if(Ue)throw e=Ve,Ue=!1,Ve=null,e}function ll(e,n){var t=n[Rl];void 0===t&&(t=n[Rl]=new Set);var r=e+"__bubble";t.has(r)||(il(n,e,2,!1),t.add(r))}function al(e,n,t){var r=0;n&&(r|=4),il(t,e,r,n)}var ul="_reactListening"+Math.random().toString(36).slice(2);function ol(e){if(!e[ul]){e[ul]=!0,r.forEach(function(n){"selectionchange"!==n&&(nl.has(n)||al(n,!1,e),al(n,!0,e))});var n=9===e.nodeType?e:e.ownerDocument;null===n||n[ul]||(n[ul]=!0,al("selectionchange",!1,n))}}function il(e,n,t,r){switch(lt(n)){case 1:var l=Jn;break;case 4:l=et;break;default:l=nt}t=l.bind(null,n,t,e),l=void 0,!Fe||"touchstart"!==n&&"touchmove"!==n&&"wheel"!==n||(l=!0),r?void 0!==l?e.addEventListener(n,t,{capture:!0,passive:l}):e.addEventListener(n,t,!0):void 0!==l?e.addEventListener(n,t,{passive:l}):e.addEventListener(n,t,!1)}function sl(e,n,t,r,l){var a=r;if(0==(1&n)&&0==(2&n)&&null!==r)e:for(;;){if(null===r)return;var u=r.tag;if(3===u||4===u){var o=r.stateNode.containerInfo;if(o===l||8===o.nodeType&&o.parentNode===l)break;if(4===u)for(u=r.return;null!==u;){var i=u.tag;if((3===i||4===i)&&((i=u.stateNode.containerInfo)===l||8===i.nodeType&&i.parentNode===l))return;u=u.return}for(;null!==o;){if(null===(u=Il(o)))return;if(5===(i=u.tag)||6===i){r=a=u;continue e}o=o.parentNode}}r=r.return}Te(function(){var r=a,l=we(t),u=[];e:{var o=qr.get(e);if(void 0!==o){var i=vt,s=e;switch(e){case"keypress":if(0===st(t))break e;case"keydown":case"keyup":i=Ut;break;case"focusin":s="focus",i=Ct;break;case"focusout":s="blur",i=Ct;break;case"beforeblur":case"afterblur":i=Ct;break;case"click":if(2===t.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":i=wt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":i=xt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":i=Qt;break;case Wr:case Hr:case jr:i=Nt;break;case $r:i=Ht;break;case"scroll":i=bt;break;case"wheel":i=$t;break;case"copy":case"cut":case"paste":i=_t;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":i=At}var c=0!=(4&n),f=!c&&"scroll"===e,d=c?null!==o?o+"Capture":null:o;c=[];for(var p,m=r;null!==m;){var h=(p=m).stateNode;if(5===p.tag&&null!==h&&(p=h,null!==d&&(null!=(h=Me(m,d))&&c.push(cl(m,h,p)))),f)break;m=m.return}0<c.length&&(o=new i(o,s,null,t,l),u.push({event:o,listeners:c}))}}if(0==(7&n)){if(i="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||t===ke||!(s=t.relatedTarget||t.fromElement)||!Il(s)&&!s[Fl])&&(i||o)&&(o=l.window===l?l:(o=l.ownerDocument)?o.defaultView||o.parentWindow:window,i?(i=r,null!==(s=(s=t.relatedTarget||t.toElement)?Il(s):null)&&(s!==(f=We(s))||5!==s.tag&&6!==s.tag)&&(s=null)):(i=null,s=r),i!==s)){if(c=wt,h="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(c=At,h="onPointerLeave",d="onPointerEnter",m="pointer"),f=null==i?o:Vl(i),p=null==s?o:Vl(s),(o=new c(h,m+"leave",i,t,l)).target=f,o.relatedTarget=p,h=null,Il(l)===r&&((c=new c(d,m+"enter",s,t,l)).target=p,c.relatedTarget=f,h=c),f=h,i&&s)e:{for(d=s,m=0,p=c=i;p;p=dl(p))m++;for(p=0,h=d;h;h=dl(h))p++;for(;0<m-p;)c=dl(c),m--;for(;0<p-m;)d=dl(d),p--;for(;m--;){if(c===d||null!==d&&c===d.alternate)break e;c=dl(c),d=dl(d)}c=null}else c=null;null!==i&&pl(u,o,i,c,!1),null!==s&&null!==f&&pl(u,f,s,c,!0)}if("select"===(i=(o=r?Vl(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===i&&"file"===o.type)var g=dr;else if(ur(o))if(pr)g=Sr;else{g=kr;var v=br}else(i=o.nodeName)&&"input"===i.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=wr);switch(g&&(g=g(e,r))?or(u,g,t,l):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ne(o,"number",o.value)),v=r?Vl(r):window,e){case"focusin":(ur(v)||"true"===v.contentEditable)&&(Fr=v,Rr=r,Dr=null);break;case"focusout":Dr=Rr=Fr=null;break;case"mousedown":Or=!0;break;case"contextmenu":case"mouseup":case"dragend":Or=!1,Ir(u,t,l);break;case"selectionchange":if(Mr)break;case"keydown":case"keyup":Ir(u,t,l)}var y;if(Kt)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else tr?er(e,t)&&(b="onCompositionEnd"):"keydown"===e&&229===t.keyCode&&(b="onCompositionStart");b&&(Gt&&"ko"!==t.locale&&(tr||"onCompositionStart"!==b?"onCompositionEnd"===b&&tr&&(y=it()):(ut="value"in(at=l)?at.value:at.textContent,tr=!0)),0<(v=fl(r,b)).length&&(b=new Tt(b,e,null,t,l),u.push({event:b,listeners:v}),y?b.data=y:null!==(y=nr(t))&&(b.data=y))),(y=Xt?rr(e,t):lr(e,t))&&(0<(r=fl(r,"onBeforeInput")).length&&(l=new Tt("onBeforeInput","beforeinput",null,t,l),u.push({event:l,listeners:r}),l.data=y))}rl(u,n)})}function cl(e,n,t){return{instance:e,listener:n,currentTarget:t}}function fl(e,n){for(var t=n+"Capture",r=[];null!==e;){var l=e,a=l.stateNode;5===l.tag&&null!==a&&(l=a,null!=(a=Me(e,t))&&r.unshift(cl(e,a,l)),null!=(a=Me(e,n))&&r.push(cl(e,a,l))),e=e.return}return r}function dl(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function pl(e,n,t,r,l){for(var a=n._reactName,u=[];null!==t&&t!==r;){var o=t,i=o.alternate,s=o.stateNode;if(null!==i&&i===r)break;5===o.tag&&null!==s&&(o=s,l?null!=(i=Me(t,a))&&u.unshift(cl(t,i,o)):l||null!=(i=Me(t,a))&&u.push(cl(t,i,o))),t=t.return}0!==u.length&&e.push({event:n,listeners:u})}var ml=/\r\n?/g,hl=/\u0000|\uFFFD/g;function gl(e){return("string"==typeof e?e:""+e).replace(ml,"\n").replace(hl,"")}function vl(e,n,r){if(n=gl(n),gl(e)!==n&&r)throw Error(t(425))}function yl(){}var bl=null,kl=null;function wl(e,n){return"textarea"===e||"noscript"===e||"string"==typeof n.children||"number"==typeof n.children||"object"==typeof n.dangerouslySetInnerHTML&&null!==n.dangerouslySetInnerHTML&&null!=n.dangerouslySetInnerHTML.__html}var Sl="function"==typeof setTimeout?setTimeout:void 0,xl="function"==typeof clearTimeout?clearTimeout:void 0,El="function"==typeof Promise?Promise:void 0,Cl="function"==typeof queueMicrotask?queueMicrotask:void 0!==El?function(e){return El.resolve(null).then(e).catch(zl)}:Sl;function zl(e){setTimeout(function(){throw e})}function Nl(e,n){var t=n,r=0;do{var l=t.nextSibling;if(e.removeChild(t),l&&8===l.nodeType)if("/$"===(t=l.data)){if(0===r)return e.removeChild(l),void Xn(n);r--}else"$"!==t&&"$?"!==t&&"$!"!==t||r++;t=l}while(t);Xn(n)}function Pl(e){for(;null!=e;e=e.nextSibling){var n=e.nodeType;if(1===n||3===n)break;if(8===n){if("$"===(n=e.data)||"$!"===n||"$?"===n)break;if("/$"===n)return null}}return e}function _l(e){e=e.previousSibling;for(var n=0;e;){if(8===e.nodeType){var t=e.data;if("$"===t||"$!"===t||"$?"===t){if(0===n)return e;n--}else"/$"===t&&n++}e=e.previousSibling}return null}var Ll=Math.random().toString(36).slice(2),Tl="__reactFiber$"+Ll,Ml="__reactProps$"+Ll,Fl="__reactContainer$"+Ll,Rl="__reactEvents$"+Ll,Dl="__reactListeners$"+Ll,Ol="__reactHandles$"+Ll;function Il(e){var n=e[Tl];if(n)return n;for(var t=e.parentNode;t;){if(n=t[Fl]||t[Tl]){if(t=n.alternate,null!==n.child||null!==t&&null!==t.child)for(e=_l(e);null!==e;){if(t=e[Tl])return t;e=_l(e)}return n}t=(e=t).parentNode}return null}function Ul(e){return!(e=e[Tl]||e[Fl])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Vl(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(t(33))}function Al(e){return e[Ml]||null}var Bl=[],Ql=-1;function Wl(e){return{current:e}}function Hl(e){0>Ql||(e.current=Bl[Ql],Bl[Ql]=null,Ql--)}function jl(e,n){Bl[++Ql]=e.current,e.current=n}var $l={},ql=Wl($l),Kl=Wl(!1),Yl=$l;function Xl(e,n){var t=e.type.contextTypes;if(!t)return $l;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===n)return r.__reactInternalMemoizedMaskedChildContext;var l,a={};for(l in t)a[l]=n[l];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),a}function Gl(e){return null!=(e=e.childContextTypes)}function Zl(){Hl(Kl),Hl(ql)}function Jl(e,n,r){if(ql.current!==$l)throw Error(t(168));jl(ql,n),jl(Kl,r)}function ea(e,n,r){var l=e.stateNode;if(n=n.childContextTypes,"function"!=typeof l.getChildContext)return r;for(var a in l=l.getChildContext())if(!(a in n))throw Error(t(108,W(e)||"Unknown",a));return I({},r,l)}function na(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$l,Yl=ql.current,jl(ql,e),jl(Kl,Kl.current),!0}function ta(e,n,r){var l=e.stateNode;if(!l)throw Error(t(169));r?(e=ea(e,n,Yl),l.__reactInternalMemoizedMergedChildContext=e,Hl(Kl),Hl(ql),jl(ql,e)):Hl(Kl),jl(Kl,r)}var ra=null,la=!1,aa=!1;function ua(e){null===ra?ra=[e]:ra.push(e)}function oa(e){la=!0,ua(e)}function ia(){if(!aa&&null!==ra){aa=!0;var e=0,n=zn;try{var t=ra;for(zn=1;e<t.length;e++){var r=t[e];do{r=r(!0)}while(null!==r)}ra=null,la=!1}catch(l){throw null!==ra&&(ra=ra.slice(e+1)),Ye(nn,ia),l}finally{zn=n,aa=!1}}return null}var sa=k.ReactCurrentBatchConfig;function ca(e,n){if(e&&e.defaultProps){for(var t in n=I({},n),e=e.defaultProps)void 0===n[t]&&(n[t]=e[t]);return n}return n}var fa=Wl(null),da=null,pa=null,ma=null;function ha(){ma=pa=da=null}function ga(e){var n=fa.current;Hl(fa),e._currentValue=n}function va(e,n,t){for(;null!==e;){var r=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,null!==r&&(r.childLanes|=n)):null!==r&&(r.childLanes&n)!==n&&(r.childLanes|=n),e===t)break;e=e.return}}function ya(e,n){da=e,ma=pa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&n)&&(Qo=!0),e.firstContext=null)}function ba(e){var n=e._currentValue;if(ma!==e)if(e={context:e,memoizedValue:n,next:null},null===pa){if(null===da)throw Error(t(308));pa=e,da.dependencies={lanes:0,firstContext:e}}else pa=pa.next=e;return n}var ka=null,wa=!1;function Sa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xa(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ea(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Ca(e,n){var t=e.updateQueue;null!==t&&(t=t.shared,Es(e)?(null===(e=t.interleaved)?(n.next=n,null===ka?ka=[t]:ka.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n))}function za(e,n,t){if(null!==(n=n.updateQueue)&&(n=n.shared,0!=(4194240&t))){var r=n.lanes;t|=r&=e.pendingLanes,n.lanes=t,Cn(e,t)}}function Na(e,n){var t=e.updateQueue,r=e.alternate;if(null!==r&&t===(r=r.updateQueue)){var l=null,a=null;if(null!==(t=t.firstBaseUpdate)){do{var u={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};null===a?l=a=u:a=a.next=u,t=t.next}while(null!==t);null===a?l=a=n:a=a.next=n}else l=a=n;return t={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=t)}null===(e=t.lastBaseUpdate)?t.firstBaseUpdate=n:e.next=n,t.lastBaseUpdate=n}function Pa(e,n,t,r){var l=e.updateQueue;wa=!1;var a=l.firstBaseUpdate,u=l.lastBaseUpdate,o=l.shared.pending;if(null!==o){l.shared.pending=null;var i=o,s=i.next;i.next=null,null===u?a=s:u.next=s,u=i;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==u&&(null===o?c.firstBaseUpdate=s:o.next=s,c.lastBaseUpdate=i))}if(null!==a){var f=l.baseState;for(u=0,c=s=i=null,o=a;;){var d=o.lane,p=o.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,h=o;switch(d=n,p=t,h.tag){case 1:if("function"==typeof(m=h.payload)){f=m.call(p,f,d);break e}f=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(d="function"==typeof(m=h.payload)?m.call(p,f,d):m))break e;f=I({},f,d);break e;case 2:wa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=l.effects)?l.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(s=c=p,i=f):c=c.next=p,u|=d;if(null===(o=o.next)){if(null===(o=l.shared.pending))break;o=(d=o).next,d.next=null,l.lastBaseUpdate=d,l.shared.pending=null}}if(null===c&&(i=f),l.baseState=i,l.firstBaseUpdate=s,l.lastBaseUpdate=c,null!==(n=l.shared.interleaved)){l=n;do{u|=l.lane,l=l.next}while(l!==n)}else null===a&&(l.shared.lanes=0);ts|=u,e.lanes=u,e.memoizedState=f}}function _a(e,n,r){if(e=n.effects,n.effects=null,null!==e)for(n=0;n<e.length;n++){var l=e[n],a=l.callback;if(null!==a){if(l.callback=null,l=r,"function"!=typeof a)throw Error(t(191,a));a.call(l)}}}var La=(new e.Component).refs;function Ta(e,n,t,r){t=null==(t=t(r,n=e.memoizedState))?n:I({},n,t),e.memoizedState=t,0===e.lanes&&(e.updateQueue.baseState=t)}var Ma={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,n,t){e=e._reactInternals;var r=ks(),l=ws(e),a=Ea(r,l);a.payload=n,null!=t&&(a.callback=t),Ca(e,a),null!==(n=Ss(e,l,r))&&za(n,e,l)},enqueueReplaceState:function(e,n,t){e=e._reactInternals;var r=ks(),l=ws(e),a=Ea(r,l);a.tag=1,a.payload=n,null!=t&&(a.callback=t),Ca(e,a),null!==(n=Ss(e,l,r))&&za(n,e,l)},enqueueForceUpdate:function(e,n){e=e._reactInternals;var t=ks(),r=ws(e),l=Ea(t,r);l.tag=2,null!=n&&(l.callback=n),Ca(e,l),null!==(n=Ss(e,r,t))&&za(n,e,r)}};function Fa(e,n,t,r,l,a,u){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,u):!n.prototype||!n.prototype.isPureReactComponent||(!Cr(t,r)||!Cr(l,a))}function Ra(e,n,t){var r=!1,l=$l,a=n.contextType;return"object"==typeof a&&null!==a?a=ba(a):(l=Gl(n)?Yl:ql.current,a=(r=null!=(r=n.contextTypes))?Xl(e,l):$l),n=new n(t,a),e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,n.updater=Ma,e.stateNode=n,n._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=a),n}function Da(e,n,t,r){e=n.state,"function"==typeof n.componentWillReceiveProps&&n.componentWillReceiveProps(t,r),"function"==typeof n.UNSAFE_componentWillReceiveProps&&n.UNSAFE_componentWillReceiveProps(t,r),n.state!==e&&Ma.enqueueReplaceState(n,n.state,null)}function Oa(e,n,t,r){var l=e.stateNode;l.props=t,l.state=e.memoizedState,l.refs=La,Sa(e);var a=n.contextType;"object"==typeof a&&null!==a?l.context=ba(a):(a=Gl(n)?Yl:ql.current,l.context=Xl(e,a)),l.state=e.memoizedState,"function"==typeof(a=n.getDerivedStateFromProps)&&(Ta(e,n,a,t),l.state=e.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof l.getSnapshotBeforeUpdate||"function"!=typeof l.UNSAFE_componentWillMount&&"function"!=typeof l.componentWillMount||(n=l.state,"function"==typeof l.componentWillMount&&l.componentWillMount(),"function"==typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount(),n!==l.state&&Ma.enqueueReplaceState(l,l.state,null),Pa(e,t,l,r),l.state=e.memoizedState),"function"==typeof l.componentDidMount&&(e.flags|=4194308)}var Ia=[],Ua=0,Va=null,Aa=0,Ba=[],Qa=0,Wa=null,Ha=1,ja="";function $a(e,n){Ia[Ua++]=Aa,Ia[Ua++]=Va,Va=e,Aa=n}function qa(e,n,t){Ba[Qa++]=Ha,Ba[Qa++]=ja,Ba[Qa++]=Wa,Wa=e;var r=Ha;e=ja;var l=32-cn(r)-1;r&=~(1<<l),t+=1;var a=32-cn(n)+l;if(30<a){var u=l-l%5;a=(r&(1<<u)-1).toString(32),r>>=u,l-=u,Ha=1<<32-cn(n)+l|t<<l|r,ja=a+e}else Ha=1<<a|t<<l|r,ja=e}function Ka(e){null!==e.return&&($a(e,1),qa(e,1,0))}function Ya(e){for(;e===Va;)Va=Ia[--Ua],Ia[Ua]=null,Aa=Ia[--Ua],Ia[Ua]=null;for(;e===Wa;)Wa=Ba[--Qa],Ba[Qa]=null,ja=Ba[--Qa],Ba[Qa]=null,Ha=Ba[--Qa],Ba[Qa]=null}var Xa=null,Ga=null,Za=!1,Ja=null;function eu(e,n){var t=nc(5,null,null,0);t.elementType="DELETED",t.stateNode=n,t.return=e,null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)}function nu(e,n){switch(e.tag){case 5:var t=e.type;return null!==(n=1!==n.nodeType||t.toLowerCase()!==n.nodeName.toLowerCase()?null:n)&&(e.stateNode=n,Xa=e,Ga=Pl(n.firstChild),!0);case 6:return null!==(n=""===e.pendingProps||3!==n.nodeType?null:n)&&(e.stateNode=n,Xa=e,Ga=null,!0);case 13:return null!==(n=8!==n.nodeType?null:n)&&(t=null!==Wa?{id:Ha,overflow:ja}:null,e.memoizedState={dehydrated:n,treeContext:t,retryLane:1073741824},(t=nc(18,null,null,0)).stateNode=n,t.return=e,e.child=t,Xa=e,Ga=null,!0);default:return!1}}function tu(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ru(e){if(Za){var n=Ga;if(n){var r=n;if(!nu(e,n)){if(tu(e))throw Error(t(418));n=Pl(r.nextSibling);var l=Xa;n&&nu(e,n)?eu(l,r):(e.flags=-4097&e.flags|2,Za=!1,Xa=e)}}else{if(tu(e))throw Error(t(418));e.flags=-4097&e.flags|2,Za=!1,Xa=e}}}function lu(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Xa=e}function au(e){if(e!==Xa)return!1;if(!Za)return lu(e),Za=!0,!1;var n;if((n=3!==e.tag)&&!(n=5!==e.tag)&&(n="head"!==(n=e.type)&&"body"!==n&&!wl(e.type,e.memoizedProps)),n&&(n=Ga)){if(tu(e)){for(e=Ga;e;)e=Pl(e.nextSibling);throw Error(t(418))}for(;n;)eu(e,n),n=Pl(n.nextSibling)}if(lu(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(t(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===n){Ga=Pl(e.nextSibling);break e}n--}else"$"!==r&&"$!"!==r&&"$?"!==r||n++}e=e.nextSibling}Ga=null}}else Ga=Xa?Pl(e.stateNode.nextSibling):null;return!0}function uu(){Ga=Xa=null,Za=!1}function ou(e){null===Ja?Ja=[e]:Ja.push(e)}function iu(e,n,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(t(309));var l=r.stateNode}if(!l)throw Error(t(147,e));var a=l,u=""+e;return null!==n&&null!==n.ref&&"function"==typeof n.ref&&n.ref._stringRef===u?n.ref:((n=function(e){var n=a.refs;n===La&&(n=a.refs={}),null===e?delete n[u]:n[u]=e})._stringRef=u,n)}if("string"!=typeof e)throw Error(t(284));if(!r._owner)throw Error(t(290,e))}return e}function su(e,n){throw e=Object.prototype.toString.call(n),Error(t(31,"[object Object]"===e?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function cu(e){return(0,e._init)(e._payload)}function fu(e){function n(n,t){if(e){var r=n.deletions;null===r?(n.deletions=[t],n.flags|=16):r.push(t)}}function r(t,r){if(!e)return null;for(;null!==r;)n(t,r),r=r.sibling;return null}function l(e,n){for(e=new Map;null!==n;)null!==n.key?e.set(n.key,n):e.set(n.index,n),n=n.sibling;return e}function a(e,n){return(e=lc(e,n)).index=0,e.sibling=null,e}function u(n,t,r){return n.index=r,e?null!==(r=n.alternate)?(r=r.index)<t?(n.flags|=2,t):r:(n.flags|=2,t):(n.flags|=1048576,t)}function o(n){return e&&null===n.alternate&&(n.flags|=2),n}function i(e,n,t,r){return null===n||6!==n.tag?((n=ic(t,e.mode,r)).return=e,n):((n=a(n,t)).return=e,n)}function s(e,n,t,r){var l=t.type;return l===x?f(e,n,t.props.children,r,t.key):null!==n&&(n.elementType===l||"object"==typeof l&&null!==l&&l.$$typeof===M&&cu(l)===n.type)?((r=a(n,t.props)).ref=iu(e,n,t),r.return=e,r):((r=ac(t.type,t.key,t.props,null,e.mode,r)).ref=iu(e,n,t),r.return=e,r)}function c(e,n,t,r){return null===n||4!==n.tag||n.stateNode.containerInfo!==t.containerInfo||n.stateNode.implementation!==t.implementation?((n=sc(t,e.mode,r)).return=e,n):((n=a(n,t.children||[])).return=e,n)}function f(e,n,t,r,l){return null===n||7!==n.tag?((n=uc(t,e.mode,r,l)).return=e,n):((n=a(n,t)).return=e,n)}function d(e,n,t){if("string"==typeof n&&""!==n||"number"==typeof n)return(n=ic(""+n,e.mode,t)).return=e,n;if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return(t=ac(n.type,n.key,n.props,null,e.mode,t)).ref=iu(e,null,n),t.return=e,t;case S:return(n=sc(n,e.mode,t)).return=e,n;case M:return d(e,(0,n._init)(n._payload),t)}if(te(n)||D(n))return(n=uc(n,e.mode,t,null)).return=e,n;su(e,n)}return null}function p(e,n,t,r){var l=null!==n?n.key:null;if("string"==typeof t&&""!==t||"number"==typeof t)return null!==l?null:i(e,n,""+t,r);if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return t.key===l?s(e,n,t,r):null;case S:return t.key===l?c(e,n,t,r):null;case M:return p(e,n,(l=t._init)(t._payload),r)}if(te(t)||D(t))return null!==l?null:f(e,n,t,r,null);su(e,t)}return null}function m(e,n,t,r,l){if("string"==typeof r&&""!==r||"number"==typeof r)return i(n,e=e.get(t)||null,""+r,l);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return s(n,e=e.get(null===r.key?t:r.key)||null,r,l);case S:return c(n,e=e.get(null===r.key?t:r.key)||null,r,l);case M:return m(e,n,t,(0,r._init)(r._payload),l)}if(te(r)||D(r))return f(n,e=e.get(t)||null,r,l,null);su(n,r)}return null}function h(t,a,o,i){for(var s=null,c=null,f=a,h=a=0,g=null;null!==f&&h<o.length;h++){f.index>h?(g=f,f=null):g=f.sibling;var v=p(t,f,o[h],i);if(null===v){null===f&&(f=g);break}e&&f&&null===v.alternate&&n(t,f),a=u(v,a,h),null===c?s=v:c.sibling=v,c=v,f=g}if(h===o.length)return r(t,f),Za&&$a(t,h),s;if(null===f){for(;h<o.length;h++)null!==(f=d(t,o[h],i))&&(a=u(f,a,h),null===c?s=f:c.sibling=f,c=f);return Za&&$a(t,h),s}for(f=l(t,f);h<o.length;h++)null!==(g=m(f,t,h,o[h],i))&&(e&&null!==g.alternate&&f.delete(null===g.key?h:g.key),a=u(g,a,h),null===c?s=g:c.sibling=g,c=g);return e&&f.forEach(function(e){return n(t,e)}),Za&&$a(t,h),s}function g(a,o,i,s){var c=D(i);if("function"!=typeof c)throw Error(t(150));if(null==(i=c.call(i)))throw Error(t(151));for(var f=c=null,h=o,g=o=0,v=null,y=i.next();null!==h&&!y.done;g++,y=i.next()){h.index>g?(v=h,h=null):v=h.sibling;var b=p(a,h,y.value,s);if(null===b){null===h&&(h=v);break}e&&h&&null===b.alternate&&n(a,h),o=u(b,o,g),null===f?c=b:f.sibling=b,f=b,h=v}if(y.done)return r(a,h),Za&&$a(a,g),c;if(null===h){for(;!y.done;g++,y=i.next())null!==(y=d(a,y.value,s))&&(o=u(y,o,g),null===f?c=y:f.sibling=y,f=y);return Za&&$a(a,g),c}for(h=l(a,h);!y.done;g++,y=i.next())null!==(y=m(h,a,g,y.value,s))&&(e&&null!==y.alternate&&h.delete(null===y.key?g:y.key),o=u(y,o,g),null===f?c=y:f.sibling=y,f=y);return e&&h.forEach(function(e){return n(a,e)}),Za&&$a(a,g),c}return function e(t,l,u,i){if("object"==typeof u&&null!==u&&u.type===x&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case w:e:{for(var s=u.key,c=l;null!==c;){if(c.key===s){if((s=u.type)===x){if(7===c.tag){r(t,c.sibling),(l=a(c,u.props.children)).return=t,t=l;break e}}else if(c.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===M&&cu(s)===c.type){r(t,c.sibling),(l=a(c,u.props)).ref=iu(t,c,u),l.return=t,t=l;break e}r(t,c);break}n(t,c),c=c.sibling}u.type===x?((l=uc(u.props.children,t.mode,i,u.key)).return=t,t=l):((i=ac(u.type,u.key,u.props,null,t.mode,i)).ref=iu(t,l,u),i.return=t,t=i)}return o(t);case S:e:{for(c=u.key;null!==l;){if(l.key===c){if(4===l.tag&&l.stateNode.containerInfo===u.containerInfo&&l.stateNode.implementation===u.implementation){r(t,l.sibling),(l=a(l,u.children||[])).return=t,t=l;break e}r(t,l);break}n(t,l),l=l.sibling}(l=sc(u,t.mode,i)).return=t,t=l}return o(t);case M:return e(t,l,(c=u._init)(u._payload),i)}if(te(u))return h(t,l,u,i);if(D(u))return g(t,l,u,i);su(t,u)}return"string"==typeof u&&""!==u||"number"==typeof u?(u=""+u,null!==l&&6===l.tag?(r(t,l.sibling),(l=a(l,u)).return=t,t=l):(r(t,l),(l=ic(u,t.mode,i)).return=t,t=l),o(t)):r(t,l)}}var du=fu(!0),pu=fu(!1),mu={},hu=Wl(mu),gu=Wl(mu),vu=Wl(mu);function yu(e){if(e===mu)throw Error(t(174));return e}function bu(e,n){switch(jl(vu,n),jl(gu,e),jl(hu,mu),e=n.nodeType){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:se(null,"");break;default:n=se(n=(e=8===e?n.parentNode:n).namespaceURI||null,e=e.tagName)}Hl(hu),jl(hu,n)}function ku(){Hl(hu),Hl(gu),Hl(vu)}function wu(e){yu(vu.current);var n=yu(hu.current),t=se(n,e.type);n!==t&&(jl(gu,e),jl(hu,t))}function Su(e){gu.current===e&&(Hl(hu),Hl(gu))}var xu=Wl(0);function Eu(e){for(var n=e;null!==n;){if(13===n.tag){var t=n.memoizedState;if(null!==t&&(null===(t=t.dehydrated)||"$?"===t.data||"$!"===t.data))return n}else if(19===n.tag&&void 0!==n.memoizedProps.revealOrder){if(0!=(128&n.flags))return n}else if(null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Cu=[];function zu(){for(var e=0;e<Cu.length;e++)Cu[e]._workInProgressVersionPrimary=null;Cu.length=0}var Nu=k.ReactCurrentDispatcher,Pu=k.ReactCurrentBatchConfig,_u=0,Lu=null,Tu=null,Mu=null,Fu=!1,Ru=!1,Du=0,Ou=0;function Iu(){throw Error(t(321))}function Uu(e,n){if(null===n)return!1;for(var t=0;t<n.length&&t<e.length;t++)if(!Er(e[t],n[t]))return!1;return!0}function Vu(e,n,r,l,a,u){if(_u=u,Lu=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Nu.current=null===e||null===e.memoizedState?xo:Eo,e=r(l,a),Ru){u=0;do{if(Ru=!1,Du=0,25<=u)throw Error(t(301));u+=1,Mu=Tu=null,n.updateQueue=null,Nu.current=Co,e=r(l,a)}while(Ru)}if(Nu.current=So,n=null!==Tu&&null!==Tu.next,_u=0,Mu=Tu=Lu=null,Fu=!1,n)throw Error(t(300));return e}function Au(){var e=0!==Du;return Du=0,e}function Bu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Mu?Lu.memoizedState=Mu=e:Mu=Mu.next=e,Mu}function Qu(){if(null===Tu){var e=Lu.alternate;e=null!==e?e.memoizedState:null}else e=Tu.next;var n=null===Mu?Lu.memoizedState:Mu.next;if(null!==n)Mu=n,Tu=e;else{if(null===e)throw Error(t(310));e={memoizedState:(Tu=e).memoizedState,baseState:Tu.baseState,baseQueue:Tu.baseQueue,queue:Tu.queue,next:null},null===Mu?Lu.memoizedState=Mu=e:Mu=Mu.next=e}return Mu}function Wu(e,n){return"function"==typeof n?n(e):n}function Hu(e){var n=Qu(),r=n.queue;if(null===r)throw Error(t(311));r.lastRenderedReducer=e;var l=Tu,a=l.baseQueue,u=r.pending;if(null!==u){if(null!==a){var o=a.next;a.next=u.next,u.next=o}l.baseQueue=a=u,r.pending=null}if(null!==a){u=a.next,l=l.baseState;var i=o=null,s=null,c=u;do{var f=c.lane;if((_u&f)===f)null!==s&&(s=s.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),l=c.hasEagerState?c.eagerState:e(l,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===s?(i=s=d,o=l):s=s.next=d,Lu.lanes|=f,ts|=f}c=c.next}while(null!==c&&c!==u);null===s?o=l:s.next=i,Er(l,n.memoizedState)||(Qo=!0),n.memoizedState=l,n.baseState=o,n.baseQueue=s,r.lastRenderedState=l}if(null!==(e=r.interleaved)){a=e;do{u=a.lane,Lu.lanes|=u,ts|=u,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[n.memoizedState,r.dispatch]}function ju(e){var n=Qu(),r=n.queue;if(null===r)throw Error(t(311));r.lastRenderedReducer=e;var l=r.dispatch,a=r.pending,u=n.memoizedState;if(null!==a){r.pending=null;var o=a=a.next;do{u=e(u,o.action),o=o.next}while(o!==a);Er(u,n.memoizedState)||(Qo=!0),n.memoizedState=u,null===n.baseQueue&&(n.baseState=u),r.lastRenderedState=u}return[u,l]}function $u(){}function qu(e,n){var r=Lu,l=Qu(),a=n(),u=!Er(l.memoizedState,a);if(u&&(l.memoizedState=a,Qo=!0),l=l.queue,lo(Xu.bind(null,r,l,e),[e]),l.getSnapshot!==n||u||null!==Mu&&1&Mu.memoizedState.tag){if(r.flags|=2048,Ju(9,Yu.bind(null,r,l,a,n),void 0,null),null===Yi)throw Error(t(349));0!=(30&_u)||Ku(r,n,a)}return a}function Ku(e,n,t){e.flags|=16384,e={getSnapshot:n,value:t},null===(n=Lu.updateQueue)?(n={lastEffect:null,stores:null},Lu.updateQueue=n,n.stores=[e]):null===(t=n.stores)?n.stores=[e]:t.push(e)}function Yu(e,n,t,r){n.value=t,n.getSnapshot=r,Gu(n)&&Ss(e,1,-1)}function Xu(e,n,t){return t(function(){Gu(n)&&Ss(e,1,-1)})}function Gu(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!Er(e,t)}catch(r){return!0}}function Zu(e){var n=Bu();return"function"==typeof e&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wu,lastRenderedState:e},n.queue=e,e=e.dispatch=vo.bind(null,Lu,e),[n.memoizedState,e]}function Ju(e,n,t,r){return e={tag:e,create:n,destroy:t,deps:r,next:null},null===(n=Lu.updateQueue)?(n={lastEffect:null,stores:null},Lu.updateQueue=n,n.lastEffect=e.next=e):null===(t=n.lastEffect)?n.lastEffect=e.next=e:(r=t.next,t.next=e,e.next=r,n.lastEffect=e),e}function eo(){return Qu().memoizedState}function no(e,n,t,r){var l=Bu();Lu.flags|=e,l.memoizedState=Ju(1|n,t,void 0,void 0===r?null:r)}function to(e,n,t,r){var l=Qu();r=void 0===r?null:r;var a=void 0;if(null!==Tu){var u=Tu.memoizedState;if(a=u.destroy,null!==r&&Uu(r,u.deps))return void(l.memoizedState=Ju(n,t,a,r))}Lu.flags|=e,l.memoizedState=Ju(1|n,t,a,r)}function ro(e,n){return no(8390656,8,e,n)}function lo(e,n){return to(2048,8,e,n)}function ao(e,n){return to(4,2,e,n)}function uo(e,n){return to(4,4,e,n)}function oo(e,n){return"function"==typeof n?(e=e(),n(e),function(){n(null)}):null!=n?(e=e(),n.current=e,function(){n.current=null}):void 0}function io(e,n,t){return t=null!=t?t.concat([e]):null,to(4,4,oo.bind(null,n,e),t)}function so(){}function co(e,n){var t=Qu();n=void 0===n?null:n;var r=t.memoizedState;return null!==r&&null!==n&&Uu(n,r[1])?r[0]:(t.memoizedState=[e,n],e)}function fo(e,n){var t=Qu();n=void 0===n?null:n;var r=t.memoizedState;return null!==r&&null!==n&&Uu(n,r[1])?r[0]:(e=e(),t.memoizedState=[e,n],e)}function po(e,n,t){return 0==(21&_u)?(e.baseState&&(e.baseState=!1,Qo=!0),e.memoizedState=t):(Er(t,n)||(t=wn(),Lu.lanes|=t,ts|=t,e.baseState=!0),n)}function mo(e,n){var t=zn;zn=0!==t&&4>t?t:4,e(!0);var r=Pu.transition;Pu.transition={};try{e(!1),n()}finally{zn=t,Pu.transition=r}}function ho(){return Qu().memoizedState}function go(e,n,t){var r=ws(e);t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},yo(e)?bo(n,t):(ko(e,n,t),null!==(e=Ss(e,r,t=ks()))&&wo(e,n,r))}function vo(e,n,t){var r=ws(e),l={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(yo(e))bo(n,l);else{ko(e,n,l);var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=n.lastRenderedReducer))try{var u=n.lastRenderedState,o=a(u,t);if(l.hasEagerState=!0,l.eagerState=o,Er(o,u))return}catch(i){}null!==(e=Ss(e,r,t=ks()))&&wo(e,n,r)}}function yo(e){var n=e.alternate;return e===Lu||null!==n&&n===Lu}function bo(e,n){Ru=Fu=!0;var t=e.pending;null===t?n.next=n:(n.next=t.next,t.next=n),e.pending=n}function ko(e,n,t){Es(e)?(null===(e=n.interleaved)?(t.next=t,null===ka?ka=[n]:ka.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t)}function wo(e,n,t){if(0!=(4194240&t)){var r=n.lanes;t|=r&=e.pendingLanes,n.lanes=t,Cn(e,t)}}var So={readContext:ba,useCallback:Iu,useContext:Iu,useEffect:Iu,useImperativeHandle:Iu,useInsertionEffect:Iu,useLayoutEffect:Iu,useMemo:Iu,useReducer:Iu,useRef:Iu,useState:Iu,useDebugValue:Iu,useDeferredValue:Iu,useTransition:Iu,useMutableSource:Iu,useSyncExternalStore:Iu,useId:Iu,unstable_isNewReconciler:!1},xo={readContext:ba,useCallback:function(e,n){return Bu().memoizedState=[e,void 0===n?null:n],e},useContext:ba,useEffect:ro,useImperativeHandle:function(e,n,t){return t=null!=t?t.concat([e]):null,no(4194308,4,oo.bind(null,n,e),t)},useLayoutEffect:function(e,n){return no(4194308,4,e,n)},useInsertionEffect:function(e,n){return no(4,2,e,n)},useMemo:function(e,n){var t=Bu();return n=void 0===n?null:n,e=e(),t.memoizedState=[e,n],e},useReducer:function(e,n,t){var r=Bu();return n=void 0!==t?t(n):n,r.memoizedState=r.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},r.queue=e,e=e.dispatch=go.bind(null,Lu,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Bu().memoizedState=e},useState:Zu,useDebugValue:so,useDeferredValue:function(e){return Bu().memoizedState=e},useTransition:function(){var e=Zu(!1),n=e[0];return e=mo.bind(null,e[1]),Bu().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,r){var l=Lu,a=Bu();if(Za){if(void 0===r)throw Error(t(407));r=r()}else{if(r=n(),null===Yi)throw Error(t(349));0!=(30&_u)||Ku(l,n,r)}a.memoizedState=r;var u={value:r,getSnapshot:n};return a.queue=u,ro(Xu.bind(null,l,u,e),[e]),l.flags|=2048,Ju(9,Yu.bind(null,l,u,r,n),void 0,null),r},useId:function(){var e=Bu(),n=Yi.identifierPrefix;if(Za){var t=ja;n=":"+n+"R"+(t=(Ha&~(1<<32-cn(Ha)-1)).toString(32)+t),0<(t=Du++)&&(n+="H"+t.toString(32)),n+=":"}else n=":"+n+"r"+(t=Ou++).toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},Eo={readContext:ba,useCallback:co,useContext:ba,useEffect:lo,useImperativeHandle:io,useInsertionEffect:ao,useLayoutEffect:uo,useMemo:fo,useReducer:Hu,useRef:eo,useState:function(){return Hu(Wu)},useDebugValue:so,useDeferredValue:function(e){return po(Qu(),Tu.memoizedState,e)},useTransition:function(){return[Hu(Wu)[0],Qu().memoizedState]},useMutableSource:$u,useSyncExternalStore:qu,useId:ho,unstable_isNewReconciler:!1},Co={readContext:ba,useCallback:co,useContext:ba,useEffect:lo,useImperativeHandle:io,useInsertionEffect:ao,useLayoutEffect:uo,useMemo:fo,useReducer:ju,useRef:eo,useState:function(){return ju(Wu)},useDebugValue:so,useDeferredValue:function(e){var n=Qu();return null===Tu?n.memoizedState=e:po(n,Tu.memoizedState,e)},useTransition:function(){return[ju(Wu)[0],Qu().memoizedState]},useMutableSource:$u,useSyncExternalStore:qu,useId:ho,unstable_isNewReconciler:!1};function zo(e,n){try{var t="",r=n;do{t+=B(r),r=r.return}while(r);var l=t}catch(a){l="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:n,stack:l}}function No(e,n){try{console.error(n.value)}catch(t){setTimeout(function(){throw t})}}var Po,_o,Lo,To,Mo="function"==typeof WeakMap?WeakMap:Map;function Fo(e,n,t){(t=Ea(-1,t)).tag=3,t.payload={element:null};var r=n.value;return t.callback=function(){cs||(cs=!0,fs=r),No(e,n)},t}function Ro(e,n,t){(t=Ea(-1,t)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var l=n.value;t.payload=function(){return r(l)},t.callback=function(){No(e,n)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(t.callback=function(){No(e,n),"function"!=typeof r&&(null===ds?ds=new Set([this]):ds.add(this));var t=n.stack;this.componentDidCatch(n.value,{componentStack:null!==t?t:""})}),t}function Do(e,n,t){var r=e.pingCache;if(null===r){r=e.pingCache=new Mo;var l=new Set;r.set(n,l)}else void 0===(l=r.get(n))&&(l=new Set,r.set(n,l));l.has(t)||(l.add(t),e=Ys.bind(null,e,n,t),n.then(e,e))}function Oo(e){do{var n;if((n=13===e.tag)&&(n=null===(n=e.memoizedState)||null!==n.dehydrated),n)return e;e=e.return}while(null!==e);return null}function Io(e,n,t,r,l){return 0==(1&e.mode)?(e===n?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,1===t.tag&&(null===t.alternate?t.tag=17:((n=Ea(-1,1)).tag=2,Ca(t,n))),t.lanes|=1),e):(e.flags|=65536,e.lanes=l,e)}function Uo(e,n){if(!Za)switch(e.tailMode){case"hidden":n=e.tail;for(var t=null;null!==n;)null!==n.alternate&&(t=n),n=n.sibling;null===t?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?n||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Vo(e){var n=null!==e.alternate&&e.alternate.child===e.child,t=0,r=0;if(n)for(var l=e.child;null!==l;)t|=l.lanes|l.childLanes,r|=14680064&l.subtreeFlags,r|=14680064&l.flags,l.return=e,l=l.sibling;else for(l=e.child;null!==l;)t|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=t,n}function Ao(e,n,r){var a=n.pendingProps;switch(Ya(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vo(n),null;case 1:return Gl(n.type)&&Zl(),Vo(n),null;case 3:return a=n.stateNode,ku(),Hl(Kl),Hl(ql),zu(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(au(n)?n.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&n.flags)||(n.flags|=1024,null!==Ja&&(Ps(Ja),Ja=null))),_o(e,n),Vo(n),null;case 5:Su(n);var u=yu(vu.current);if(r=n.type,null!==e&&null!=n.stateNode)Lo(e,n,r,a,u),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!a){if(null===n.stateNode)throw Error(t(166));return Vo(n),null}if(e=yu(hu.current),au(n)){a=n.stateNode,r=n.type;var o=n.memoizedProps;switch(a[Tl]=n,a[Ml]=o,e=0!=(1&n.mode),r){case"dialog":ll("cancel",a),ll("close",a);break;case"iframe":case"object":case"embed":ll("load",a);break;case"video":case"audio":for(u=0;u<el.length;u++)ll(el[u],a);break;case"source":ll("error",a);break;case"img":case"image":case"link":ll("error",a),ll("load",a);break;case"details":ll("toggle",a);break;case"input":G(a,o),ll("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!o.multiple},ll("invalid",a);break;case"textarea":ae(a,o),ll("invalid",a)}for(var i in ye(r,o),u=null,o)if(o.hasOwnProperty(i)){var s=o[i];"children"===i?"string"==typeof s?a.textContent!==s&&(!0!==o.suppressHydrationWarning&&vl(a.textContent,s,e),u=["children",s]):"number"==typeof s&&a.textContent!==""+s&&(!0!==o.suppressHydrationWarning&&vl(a.textContent,s,e),u=["children",""+s]):l.hasOwnProperty(i)&&null!=s&&"onScroll"===i&&ll("scroll",a)}switch(r){case"input":q(a),ee(a,o,!0);break;case"textarea":q(a),oe(a);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(a.onclick=yl)}a=u,n.updateQueue=a,null!==a&&(n.flags|=4)}else{i=9===u.nodeType?u:u.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof a.is?e=i.createElement(r,{is:a.is}):(e=i.createElement(r),"select"===r&&(i=e,a.multiple?i.multiple=!0:a.size&&(i.size=a.size))):e=i.createElementNS(e,r),e[Tl]=n,e[Ml]=a,Po(e,n,!1,!1),n.stateNode=e;e:{switch(i=be(r,a),r){case"dialog":ll("cancel",e),ll("close",e),u=a;break;case"iframe":case"object":case"embed":ll("load",e),u=a;break;case"video":case"audio":for(u=0;u<el.length;u++)ll(el[u],e);u=a;break;case"source":ll("error",e),u=a;break;case"img":case"image":case"link":ll("error",e),ll("load",e),u=a;break;case"details":ll("toggle",e),u=a;break;case"input":G(e,a),u=X(e,a),ll("invalid",e);break;case"option":u=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},u=I({},a,{value:void 0}),ll("invalid",e);break;case"textarea":ae(e,a),u=le(e,a),ll("invalid",e);break;default:u=a}for(o in ye(r,u),s=u)if(s.hasOwnProperty(o)){var c=s[o];"style"===o?ge(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&fe(e,c):"children"===o?"string"==typeof c?("textarea"!==r||""!==c)&&de(e,c):"number"==typeof c&&de(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(l.hasOwnProperty(o)?null!=c&&"onScroll"===o&&ll("scroll",e):null!=c&&b(e,o,c,i))}switch(r){case"input":q(e),ee(e,a,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=a.value&&e.setAttribute("value",""+H(a.value));break;case"select":e.multiple=!!a.multiple,null!=(o=a.value)?re(e,!!a.multiple,o,!1):null!=a.defaultValue&&re(e,!!a.multiple,a.defaultValue,!0);break;default:"function"==typeof u.onClick&&(e.onclick=yl)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(n.flags|=4)}null!==n.ref&&(n.flags|=512,n.flags|=2097152)}return Vo(n),null;case 6:if(e&&null!=n.stateNode)To(e,n,e.memoizedProps,a);else{if("string"!=typeof a&&null===n.stateNode)throw Error(t(166));if(r=yu(vu.current),yu(hu.current),au(n)){if(a=n.stateNode,r=n.memoizedProps,a[Tl]=n,(o=a.nodeValue!==r)&&null!==(e=Xa))switch(e.tag){case 3:vl(a.nodeValue,r,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&vl(a.nodeValue,r,0!=(1&e.mode))}o&&(n.flags|=4)}else(a=(9===r.nodeType?r:r.ownerDocument).createTextNode(a))[Tl]=n,n.stateNode=a}return Vo(n),null;case 13:if(Hl(xu),a=n.memoizedState,Za&&null!==Ga&&0!=(1&n.mode)&&0==(128&n.flags)){for(a=Ga;a;)a=Pl(a.nextSibling);return uu(),n.flags|=98560,n}if(null!==a&&null!==a.dehydrated){if(a=au(n),null===e){if(!a)throw Error(t(318));if(!(a=null!==(a=n.memoizedState)?a.dehydrated:null))throw Error(t(317));a[Tl]=n}else uu(),0==(128&n.flags)&&(n.memoizedState=null),n.flags|=4;return Vo(n),null}return null!==Ja&&(Ps(Ja),Ja=null),0!=(128&n.flags)?(n.lanes=r,n):(a=null!==a,r=!1,null===e?au(n):r=null!==e.memoizedState,a!==r&&a&&(n.child.flags|=8192,0!=(1&n.mode)&&(null===e||0!=(1&xu.current)?0===es&&(es=3):Us())),null!==n.updateQueue&&(n.flags|=4),Vo(n),null);case 4:return ku(),_o(e,n),null===e&&ol(n.stateNode.containerInfo),Vo(n),null;case 10:return ga(n.type._context),Vo(n),null;case 17:return Gl(n.type)&&Zl(),Vo(n),null;case 19:if(Hl(xu),null===(o=n.memoizedState))return Vo(n),null;if(a=0!=(128&n.flags),null===(i=o.rendering))if(a)Uo(o,!1);else{if(0!==es||null!==e&&0!=(128&e.flags))for(e=n.child;null!==e;){if(null!==(i=Eu(e))){for(n.flags|=128,Uo(o,!1),null!==(a=i.updateQueue)&&(n.updateQueue=a,n.flags|=4),n.subtreeFlags=0,a=r,r=n.child;null!==r;)e=a,(o=r).flags&=14680066,null===(i=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return jl(xu,1&xu.current|2),n.child}e=e.sibling}null!==o.tail&&Je()>is&&(n.flags|=128,a=!0,Uo(o,!1),n.lanes=4194304)}else{if(!a)if(null!==(e=Eu(i))){if(n.flags|=128,a=!0,null!==(r=e.updateQueue)&&(n.updateQueue=r,n.flags|=4),Uo(o,!0),null===o.tail&&"hidden"===o.tailMode&&!i.alternate&&!Za)return Vo(n),null}else 2*Je()-o.renderingStartTime>is&&1073741824!==r&&(n.flags|=128,a=!0,Uo(o,!1),n.lanes=4194304);o.isBackwards?(i.sibling=n.child,n.child=i):(null!==(r=o.last)?r.sibling=i:n.child=i,o.last=i)}return null!==o.tail?(n=o.tail,o.rendering=n,o.tail=n.sibling,o.renderingStartTime=Je(),n.sibling=null,r=xu.current,jl(xu,a?1&r|2:1&r),n):(Vo(n),null);case 22:case 23:return Rs(),a=null!==n.memoizedState,null!==e&&null!==e.memoizedState!==a&&(n.flags|=8192),a&&0!=(1&n.mode)?0!=(1073741824&Zi)&&(Vo(n),6&n.subtreeFlags&&(n.flags|=8192)):Vo(n),null;case 24:case 25:return null}throw Error(t(156,n.tag))}Po=function(e,n){for(var t=n.child;null!==t;){if(5===t.tag||6===t.tag)e.appendChild(t.stateNode);else if(4!==t.tag&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)return;t=t.return}t.sibling.return=t.return,t=t.sibling}},_o=function(){},Lo=function(e,n,t,r){var a=e.memoizedProps;if(a!==r){e=n.stateNode,yu(hu.current);var u,o=null;switch(t){case"input":a=X(e,a),r=X(e,r),o=[];break;case"select":a=I({},a,{value:void 0}),r=I({},r,{value:void 0}),o=[];break;case"textarea":a=le(e,a),r=le(e,r),o=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(e.onclick=yl)}for(c in ye(t,r),t=null,a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&null!=a[c])if("style"===c){var i=a[c];for(u in i)i.hasOwnProperty(u)&&(t||(t={}),t[u]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(l.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var s=r[c];if(i=null!=a?a[c]:void 0,r.hasOwnProperty(c)&&s!==i&&(null!=s||null!=i))if("style"===c)if(i){for(u in i)!i.hasOwnProperty(u)||s&&s.hasOwnProperty(u)||(t||(t={}),t[u]="");for(u in s)s.hasOwnProperty(u)&&i[u]!==s[u]&&(t||(t={}),t[u]=s[u])}else t||(o||(o=[]),o.push(c,t)),t=s;else"dangerouslySetInnerHTML"===c?(s=s?s.__html:void 0,i=i?i.__html:void 0,null!=s&&i!==s&&(o=o||[]).push(c,s)):"children"===c?"string"!=typeof s&&"number"!=typeof s||(o=o||[]).push(c,""+s):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(l.hasOwnProperty(c)?(null!=s&&"onScroll"===c&&ll("scroll",e),o||i===s||(o=[])):(o=o||[]).push(c,s))}t&&(o=o||[]).push("style",t);var c=o;(n.updateQueue=c)&&(n.flags|=4)}},To=function(e,n,t,r){t!==r&&(n.flags|=4)};var Bo=k.ReactCurrentOwner,Qo=!1;function Wo(e,n,t,r){n.child=null===e?pu(n,null,t,r):du(n,e.child,t,r)}function Ho(e,n,t,r,l){t=t.render;var a=n.ref;return ya(n,l),r=Vu(e,n,t,r,a,l),t=Au(),null===e||Qo?(Za&&t&&Ka(n),n.flags|=1,Wo(e,n,r,l),n.child):(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~l,fi(e,n,l))}function jo(e,n,t,r,l){if(null===e){var a=t.type;return"function"!=typeof a||tc(a)||void 0!==a.defaultProps||null!==t.compare||void 0!==t.defaultProps?((e=ac(t.type,null,r,n,n.mode,l)).ref=n.ref,e.return=n,n.child=e):(n.tag=15,n.type=a,$o(e,n,a,r,l))}if(a=e.child,0==(e.lanes&l)){var u=a.memoizedProps;if((t=null!==(t=t.compare)?t:Cr)(u,r)&&e.ref===n.ref)return fi(e,n,l)}return n.flags|=1,(e=lc(a,r)).ref=n.ref,e.return=n,n.child=e}function $o(e,n,t,r,l){if(null!==e){var a=e.memoizedProps;if(Cr(a,r)&&e.ref===n.ref){if(Qo=!1,n.pendingProps=r=a,0==(e.lanes&l))return n.lanes=e.lanes,fi(e,n,l);0!=(131072&e.flags)&&(Qo=!0)}}return Yo(e,n,t,r,l)}function qo(e,n,t){var r=n.pendingProps,l=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0==(1&n.mode))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},jl(Ji,Zi),Zi|=t;else{if(0==(1073741824&t))return e=null!==a?a.baseLanes|t:t,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,jl(Ji,Zi),Zi|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:t,jl(Ji,Zi),Zi|=r}else null!==a?(r=a.baseLanes|t,n.memoizedState=null):r=t,jl(Ji,Zi),Zi|=r;return Wo(e,n,l,t),n.child}function Ko(e,n){var t=n.ref;(null===e&&null!==t||null!==e&&e.ref!==t)&&(n.flags|=512,n.flags|=2097152)}function Yo(e,n,t,r,l){var a=Gl(t)?Yl:ql.current;return a=Xl(n,a),ya(n,l),t=Vu(e,n,t,r,a,l),r=Au(),null===e||Qo?(Za&&r&&Ka(n),n.flags|=1,Wo(e,n,t,l),n.child):(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~l,fi(e,n,l))}function Xo(e,n,t,r,l){if(Gl(t)){var a=!0;na(n)}else a=!1;if(ya(n,l),null===n.stateNode)null!==e&&(e.alternate=null,n.alternate=null,n.flags|=2),Ra(n,t,r),Oa(n,t,r,l),r=!0;else if(null===e){var u=n.stateNode,o=n.memoizedProps;u.props=o;var i=u.context,s=t.contextType;"object"==typeof s&&null!==s?s=ba(s):s=Xl(n,s=Gl(t)?Yl:ql.current);var c=t.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof u.getSnapshotBeforeUpdate;f||"function"!=typeof u.UNSAFE_componentWillReceiveProps&&"function"!=typeof u.componentWillReceiveProps||(o!==r||i!==s)&&Da(n,u,r,s),wa=!1;var d=n.memoizedState;u.state=d,Pa(n,r,u,l),i=n.memoizedState,o!==r||d!==i||Kl.current||wa?("function"==typeof c&&(Ta(n,t,c,r),i=n.memoizedState),(o=wa||Fa(n,t,o,r,d,i,s))?(f||"function"!=typeof u.UNSAFE_componentWillMount&&"function"!=typeof u.componentWillMount||("function"==typeof u.componentWillMount&&u.componentWillMount(),"function"==typeof u.UNSAFE_componentWillMount&&u.UNSAFE_componentWillMount()),"function"==typeof u.componentDidMount&&(n.flags|=4194308)):("function"==typeof u.componentDidMount&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=i),u.props=r,u.state=i,u.context=s,r=o):("function"==typeof u.componentDidMount&&(n.flags|=4194308),r=!1)}else{u=n.stateNode,xa(e,n),o=n.memoizedProps,s=n.type===n.elementType?o:ca(n.type,o),u.props=s,f=n.pendingProps,d=u.context,"object"==typeof(i=t.contextType)&&null!==i?i=ba(i):i=Xl(n,i=Gl(t)?Yl:ql.current);var p=t.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof u.getSnapshotBeforeUpdate)||"function"!=typeof u.UNSAFE_componentWillReceiveProps&&"function"!=typeof u.componentWillReceiveProps||(o!==f||d!==i)&&Da(n,u,r,i),wa=!1,d=n.memoizedState,u.state=d,Pa(n,r,u,l);var m=n.memoizedState;o!==f||d!==m||Kl.current||wa?("function"==typeof p&&(Ta(n,t,p,r),m=n.memoizedState),(s=wa||Fa(n,t,s,r,d,m,i)||!1)?(c||"function"!=typeof u.UNSAFE_componentWillUpdate&&"function"!=typeof u.componentWillUpdate||("function"==typeof u.componentWillUpdate&&u.componentWillUpdate(r,m,i),"function"==typeof u.UNSAFE_componentWillUpdate&&u.UNSAFE_componentWillUpdate(r,m,i)),"function"==typeof u.componentDidUpdate&&(n.flags|=4),"function"==typeof u.getSnapshotBeforeUpdate&&(n.flags|=1024)):("function"!=typeof u.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(n.flags|=4),"function"!=typeof u.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=m),u.props=r,u.state=m,u.context=i,r=s):("function"!=typeof u.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(n.flags|=4),"function"!=typeof u.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(n.flags|=1024),r=!1)}return Go(e,n,t,r,a,l)}function Go(e,n,t,r,l,a){Ko(e,n);var u=0!=(128&n.flags);if(!r&&!u)return l&&ta(n,t,!1),fi(e,n,a);r=n.stateNode,Bo.current=n;var o=u&&"function"!=typeof t.getDerivedStateFromError?null:r.render();return n.flags|=1,null!==e&&u?(n.child=du(n,e.child,null,a),n.child=du(n,null,o,a)):Wo(e,n,o,a),n.memoizedState=r.state,l&&ta(n,t,!0),n.child}function Zo(e){var n=e.stateNode;n.pendingContext?Jl(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Jl(e,n.context,!1),bu(e,n.containerInfo)}function Jo(e,n,t,r,l){return uu(),ou(l),n.flags|=256,Wo(e,n,t,r),n.child}var ei={dehydrated:null,treeContext:null,retryLane:0};function ni(e){return{baseLanes:e,cachePool:null,transitions:null}}function ti(e,n){return{baseLanes:e.baseLanes|n,cachePool:null,transitions:e.transitions}}function ri(e,n,r){var l,a=n.pendingProps,u=xu.current,o=!1,i=0!=(128&n.flags);if((l=i)||(l=(null===e||null!==e.memoizedState)&&0!=(2&u)),l?(o=!0,n.flags&=-129):null!==e&&null===e.memoizedState||(u|=1),jl(xu,1&u),null===e)return ru(n),null!==(e=n.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&n.mode)?n.lanes=1:"$!"===e.data?n.lanes=8:n.lanes=1073741824,null):(u=a.children,e=a.fallback,o?(a=n.mode,o=n.child,u={mode:"hidden",children:u},0==(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=u):o=oc(u,a,0,null),e=uc(e,a,r,null),o.return=n,e.return=n,o.sibling=e,n.child=o,n.child.memoizedState=ni(r),n.memoizedState=ei,e):li(n,u));if(null!==(u=e.memoizedState)){if(null!==(l=u.dehydrated)){if(i)return 256&n.flags?(n.flags&=-257,oi(e,n,r,Error(t(422)))):null!==n.memoizedState?(n.child=e.child,n.flags|=128,null):(o=a.fallback,u=n.mode,a=oc({mode:"visible",children:a.children},u,0,null),(o=uc(o,u,r,null)).flags|=2,a.return=n,o.return=n,a.sibling=o,n.child=a,0!=(1&n.mode)&&du(n,e.child,null,r),n.child.memoizedState=ni(r),n.memoizedState=ei,o);if(0==(1&n.mode))n=oi(e,n,r,null);else if("$!"===l.data)n=oi(e,n,r,Error(t(419)));else if(a=0!=(r&e.childLanes),Qo||a){if(null!==(a=Yi)){switch(r&-r){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(a=0!=(o&(a.suspendedLanes|r))?0:o)&&a!==u.retryLane&&(u.retryLane=a,Ss(e,a,-1))}Us(),n=oi(e,n,r,Error(t(421)))}else"$?"===l.data?(n.flags|=128,n.child=e.child,n=Gs.bind(null,e),l._reactRetry=n,n=null):(r=u.treeContext,Ga=Pl(l.nextSibling),Xa=n,Za=!0,Ja=null,null!==r&&(Ba[Qa++]=Ha,Ba[Qa++]=ja,Ba[Qa++]=Wa,Ha=r.id,ja=r.overflow,Wa=n),(n=li(n,n.pendingProps.children)).flags|=4096);return n}return o?(a=ui(e,n,a.children,a.fallback,r),o=n.child,u=e.child.memoizedState,o.memoizedState=null===u?ni(r):ti(u,r),o.childLanes=e.childLanes&~r,n.memoizedState=ei,a):(r=ai(e,n,a.children,r),n.memoizedState=null,r)}return o?(a=ui(e,n,a.children,a.fallback,r),o=n.child,u=e.child.memoizedState,o.memoizedState=null===u?ni(r):ti(u,r),o.childLanes=e.childLanes&~r,n.memoizedState=ei,a):(r=ai(e,n,a.children,r),n.memoizedState=null,r)}function li(e,n){return(n=oc({mode:"visible",children:n},e.mode,0,null)).return=e,e.child=n}function ai(e,n,t,r){var l=e.child;return e=l.sibling,t=lc(l,{mode:"visible",children:t}),0==(1&n.mode)&&(t.lanes=r),t.return=n,t.sibling=null,null!==e&&(null===(r=n.deletions)?(n.deletions=[e],n.flags|=16):r.push(e)),n.child=t}function ui(e,n,t,r,l){var a=n.mode,u=(e=e.child).sibling,o={mode:"hidden",children:t};return 0==(1&a)&&n.child!==e?((t=n.child).childLanes=0,t.pendingProps=o,n.deletions=null):(t=lc(e,o)).subtreeFlags=14680064&e.subtreeFlags,null!==u?r=lc(u,r):(r=uc(r,a,l,null)).flags|=2,r.return=n,t.return=n,t.sibling=r,n.child=t,r}function oi(e,n,t,r){return null!==r&&ou(r),du(n,e.child,null,t),(e=li(n,n.pendingProps.children)).flags|=2,n.memoizedState=null,e}function ii(e,n,t){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n),va(e.return,n,t)}function si(e,n,t,r,l){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:l}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=t,a.tailMode=l)}function ci(e,n,t){var r=n.pendingProps,l=r.revealOrder,a=r.tail;if(Wo(e,n,r.children,t),0!=(2&(r=xu.current)))r=1&r|2,n.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=n.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ii(e,t,n);else if(19===e.tag)ii(e,t,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(jl(xu,r),0==(1&n.mode))n.memoizedState=null;else switch(l){case"forwards":for(t=n.child,l=null;null!==t;)null!==(e=t.alternate)&&null===Eu(e)&&(l=t),t=t.sibling;null===(t=l)?(l=n.child,n.child=null):(l=t.sibling,t.sibling=null),si(n,!1,l,t,a);break;case"backwards":for(t=null,l=n.child,n.child=null;null!==l;){if(null!==(e=l.alternate)&&null===Eu(e)){n.child=l;break}e=l.sibling,l.sibling=t,t=l,l=e}si(n,!0,t,null,a);break;case"together":si(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function fi(e,n,r){if(null!==e&&(n.dependencies=e.dependencies),ts|=n.lanes,0==(r&n.childLanes))return null;if(null!==e&&n.child!==e.child)throw Error(t(153));if(null!==n.child){for(r=lc(e=n.child,e.pendingProps),n.child=r,r.return=n;null!==e.sibling;)e=e.sibling,(r=r.sibling=lc(e,e.pendingProps)).return=n;r.sibling=null}return n.child}function di(e,n,t){switch(n.tag){case 3:Zo(n),uu();break;case 5:wu(n);break;case 1:Gl(n.type)&&na(n);break;case 4:bu(n,n.stateNode.containerInfo);break;case 10:var r=n.type._context,l=n.memoizedProps.value;jl(fa,r._currentValue),r._currentValue=l;break;case 13:if(null!==(r=n.memoizedState))return null!==r.dehydrated?(jl(xu,1&xu.current),n.flags|=128,null):0!=(t&n.child.childLanes)?ri(e,n,t):(jl(xu,1&xu.current),null!==(e=fi(e,n,t))?e.sibling:null);jl(xu,1&xu.current);break;case 19:if(r=0!=(t&n.childLanes),0!=(128&e.flags)){if(r)return ci(e,n,t);n.flags|=128}if(null!==(l=n.memoizedState)&&(l.rendering=null,l.tail=null,l.lastEffect=null),jl(xu,xu.current),r)break;return null;case 22:case 23:return n.lanes=0,qo(e,n,t)}return fi(e,n,t)}function pi(e,n){switch(Ya(n),n.tag){case 1:return Gl(n.type)&&Zl(),65536&(e=n.flags)?(n.flags=-65537&e|128,n):null;case 3:return ku(),Hl(Kl),Hl(ql),zu(),0!=(65536&(e=n.flags))&&0==(128&e)?(n.flags=-65537&e|128,n):null;case 5:return Su(n),null;case 13:if(Hl(xu),null!==(e=n.memoizedState)&&null!==e.dehydrated){if(null===n.alternate)throw Error(t(340));uu()}return 65536&(e=n.flags)?(n.flags=-65537&e|128,n):null;case 19:return Hl(xu),null;case 4:return ku(),null;case 10:return ga(n.type._context),null;case 22:case 23:return Rs(),null;case 24:default:return null}}var mi=!1,hi=!1,gi="function"==typeof WeakSet?WeakSet:Set,vi=null;function yi(e,n){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(r){Ks(e,n,r)}else t.current=null}function bi(e,n,t){try{t()}catch(r){Ks(e,n,r)}}var ki=!1;function wi(e,n){if(bl=Zn,Lr(e=_r())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var l=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(l&&0!==l.rangeCount){r=l.anchorNode;var a=l.anchorOffset,u=l.focusNode;l=l.focusOffset;try{r.nodeType,u.nodeType}catch(S){r=null;break e}var o=0,i=-1,s=-1,c=0,f=0,d=e,p=null;n:for(;;){for(var m;d!==r||0!==a&&3!==d.nodeType||(i=o+a),d!==u||0!==l&&3!==d.nodeType||(s=o+l),3===d.nodeType&&(o+=d.nodeValue.length),null!==(m=d.firstChild);)p=d,d=m;for(;;){if(d===e)break n;if(p===r&&++c===a&&(i=o),p===u&&++f===l&&(s=o),null!==(m=d.nextSibling))break;p=(d=p).parentNode}d=m}r=-1===i||-1===s?null:{start:i,end:s}}else r=null}r=r||{start:0,end:0}}else r=null;for(kl={focusedElem:e,selectionRange:r},Zn=!1,vi=n;null!==vi;)if(e=(n=vi).child,0!=(1028&n.subtreeFlags)&&null!==e)e.return=n,vi=e;else for(;null!==vi;){n=vi;try{var h=n.alternate;if(0!=(1024&n.flags))switch(n.tag){case 0:case 11:case 15:break;case 1:if(null!==h){var g=h.memoizedProps,v=h.memoizedState,y=n.stateNode,b=y.getSnapshotBeforeUpdate(n.elementType===n.type?g:ca(n.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var k=n.stateNode.containerInfo;if(1===k.nodeType)k.textContent="";else if(9===k.nodeType){var w=k.body;null!=w&&(w.textContent="")}break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(S){Ks(n,n.return,S)}if(null!==(e=n.sibling)){e.return=n.return,vi=e;break}vi=n.return}return h=ki,ki=!1,h}function Si(e,n,t){var r=n.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var l=r=r.next;do{if((l.tag&e)===e){var a=l.destroy;l.destroy=void 0,void 0!==a&&bi(n,t,a)}l=l.next}while(l!==r)}}function xi(e,n){if(null!==(n=null!==(n=n.updateQueue)?n.lastEffect:null)){var t=n=n.next;do{if((t.tag&e)===e){var r=t.create;t.destroy=r()}t=t.next}while(t!==n)}}function Ei(e){var n=e.ref;if(null!==n){var t=e.stateNode;switch(e.tag){case 5:e=t;break;default:e=t}"function"==typeof n?n(e):n.current=e}}function Ci(e){var n=e.alternate;null!==n&&(e.alternate=null,Ci(n)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(n=e.stateNode)&&(delete n[Tl],delete n[Ml],delete n[Rl],delete n[Dl],delete n[Ol])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zi(e){return 5===e.tag||3===e.tag||4===e.tag}function Ni(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||zi(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Pi(e,n,t){var r=e.tag;if(5===r||6===r)e=e.stateNode,n?8===t.nodeType?t.parentNode.insertBefore(e,n):t.insertBefore(e,n):(8===t.nodeType?(n=t.parentNode).insertBefore(e,t):(n=t).appendChild(e),null!=(t=t._reactRootContainer)||null!==n.onclick||(n.onclick=yl));else if(4!==r&&null!==(e=e.child))for(Pi(e,n,t),e=e.sibling;null!==e;)Pi(e,n,t),e=e.sibling}function _i(e,n,t){var r=e.tag;if(5===r||6===r)e=e.stateNode,n?t.insertBefore(e,n):t.appendChild(e);else if(4!==r&&null!==(e=e.child))for(_i(e,n,t),e=e.sibling;null!==e;)_i(e,n,t),e=e.sibling}var Li=null,Ti=!1;function Mi(e,n,t){for(t=t.child;null!==t;)Fi(e,n,t),t=t.sibling}function Fi(e,n,t){if(on&&"function"==typeof on.onCommitFiberUnmount)try{on.onCommitFiberUnmount(un,t)}catch(o){}switch(t.tag){case 5:hi||yi(t,n);case 6:var r=Li,l=Ti;Li=null,Mi(e,n,t),Ti=l,null!==(Li=r)&&(Ti?(e=Li,t=t.stateNode,8===e.nodeType?e.parentNode.removeChild(t):e.removeChild(t)):Li.removeChild(t.stateNode));break;case 18:null!==Li&&(Ti?(e=Li,t=t.stateNode,8===e.nodeType?Nl(e.parentNode,t):1===e.nodeType&&Nl(e,t),Xn(e)):Nl(Li,t.stateNode));break;case 4:r=Li,l=Ti,Li=t.stateNode.containerInfo,Ti=!0,Mi(e,n,t),Li=r,Ti=l;break;case 0:case 11:case 14:case 15:if(!hi&&(null!==(r=t.updateQueue)&&null!==(r=r.lastEffect))){l=r=r.next;do{var a=l,u=a.destroy;a=a.tag,void 0!==u&&(0!=(2&a)?bi(t,n,u):0!=(4&a)&&bi(t,n,u)),l=l.next}while(l!==r)}Mi(e,n,t);break;case 1:if(!hi&&(yi(t,n),"function"==typeof(r=t.stateNode).componentWillUnmount))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Ks(t,n,o)}Mi(e,n,t);break;case 21:Mi(e,n,t);break;case 22:1&t.mode?(hi=(r=hi)||null!==t.memoizedState,Mi(e,n,t),hi=r):Mi(e,n,t);break;default:Mi(e,n,t)}}function Ri(e){var n=e.updateQueue;if(null!==n){e.updateQueue=null;var t=e.stateNode;null===t&&(t=e.stateNode=new gi),n.forEach(function(n){var r=Zs.bind(null,e,n);t.has(n)||(t.add(n),n.then(r,r))})}}function Di(e,n){var r=n.deletions;if(null!==r)for(var l=0;l<r.length;l++){var a=r[l];try{var u=e,o=n,i=o;e:for(;null!==i;){switch(i.tag){case 5:Li=i.stateNode,Ti=!1;break e;case 3:case 4:Li=i.stateNode.containerInfo,Ti=!0;break e}i=i.return}if(null===Li)throw Error(t(160));Fi(u,o,a),Li=null,Ti=!1;var s=a.alternate;null!==s&&(s.return=null),a.return=null}catch(c){Ks(a,n,c)}}if(12854&n.subtreeFlags)for(n=n.child;null!==n;)Oi(n,e),n=n.sibling}function Oi(e,n){var r=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Di(n,e),Ii(e),4&l){try{Si(3,e,e.return),xi(3,e)}catch(h){Ks(e,e.return,h)}try{Si(5,e,e.return)}catch(h){Ks(e,e.return,h)}}break;case 1:Di(n,e),Ii(e),512&l&&null!==r&&yi(r,r.return);break;case 5:if(Di(n,e),Ii(e),512&l&&null!==r&&yi(r,r.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(h){Ks(e,e.return,h)}}if(4&l&&null!=(a=e.stateNode)){var u=e.memoizedProps,o=null!==r?r.memoizedProps:u,i=e.type,s=e.updateQueue;if(e.updateQueue=null,null!==s)try{"input"===i&&"radio"===u.type&&null!=u.name&&Z(a,u),be(i,o);var c=be(i,u);for(o=0;o<s.length;o+=2){var f=s[o],d=s[o+1];"style"===f?ge(a,d):"dangerouslySetInnerHTML"===f?fe(a,d):"children"===f?de(a,d):b(a,f,d,c)}switch(i){case"input":J(a,u);break;case"textarea":ue(a,u);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!u.multiple;var m=u.value;null!=m?re(a,!!u.multiple,m,!1):p!==!!u.multiple&&(null!=u.defaultValue?re(a,!!u.multiple,u.defaultValue,!0):re(a,!!u.multiple,u.multiple?[]:"",!1))}a[Ml]=u}catch(h){Ks(e,e.return,h)}}break;case 6:if(Di(n,e),Ii(e),4&l){if(null===e.stateNode)throw Error(t(162));c=e.stateNode,f=e.memoizedProps;try{c.nodeValue=f}catch(h){Ks(e,e.return,h)}}break;case 3:if(Di(n,e),Ii(e),4&l&&null!==r&&r.memoizedState.isDehydrated)try{Xn(n.containerInfo)}catch(h){Ks(e,e.return,h)}break;case 4:Di(n,e),Ii(e);break;case 13:Di(n,e),Ii(e),8192&(c=e.child).flags&&null!==c.memoizedState&&(null===c.alternate||null===c.alternate.memoizedState)&&(os=Je()),4&l&&Ri(e);break;case 22:if(c=null!==r&&null!==r.memoizedState,1&e.mode?(hi=(f=hi)||c,Di(n,e),hi=f):Di(n,e),Ii(e),8192&l){f=null!==e.memoizedState;e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{a=p.stateNode,f?"function"==typeof(u=a.style).setProperty?u.setProperty("display","none","important"):u.display="none":(i=p.stateNode,o=null!=(s=p.memoizedProps.style)&&s.hasOwnProperty("display")?s.display:null,i.style.display=he("display",o))}catch(h){Ks(e,e.return,h)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(h){Ks(e,e.return,h)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}if(f&&!c&&0!=(1&e.mode))for(vi=e,e=e.child;null!==e;){for(c=vi=e;null!==vi;){switch(d=(f=vi).child,f.tag){case 0:case 11:case 14:case 15:Si(4,f,f.return);break;case 1:if(yi(f,f.return),"function"==typeof(u=f.stateNode).componentWillUnmount){p=f,m=f.return;try{a=p,u.props=a.memoizedProps,u.state=a.memoizedState,u.componentWillUnmount()}catch(h){Ks(p,m,h)}}break;case 5:yi(f,f.return);break;case 22:if(null!==f.memoizedState){Bi(c);continue}}null!==d?(d.return=f,vi=d):Bi(c)}e=e.sibling}}break;case 19:Di(n,e),Ii(e),4&l&&Ri(e);break;case 21:break;default:Di(n,e),Ii(e)}}function Ii(e){var n=e.flags;if(2&n){try{e:{for(var r=e.return;null!==r;){if(zi(r)){var l=r;break e}r=r.return}throw Error(t(160))}switch(l.tag){case 5:var a=l.stateNode;32&l.flags&&(de(a,""),l.flags&=-33),_i(e,Ni(e),a);break;case 3:case 4:var u=l.stateNode.containerInfo;Pi(e,Ni(e),u);break;default:throw Error(t(161))}}catch(o){Ks(e,e.return,o)}e.flags&=-3}4096&n&&(e.flags&=-4097)}function Ui(e,n,t){vi=e,Vi(e,n,t)}function Vi(e,n,t){for(var r=0!=(1&e.mode);null!==vi;){var l=vi,a=l.child;if(22===l.tag&&r){var u=null!==l.memoizedState||mi;if(!u){var o=l.alternate,i=null!==o&&null!==o.memoizedState||hi;o=mi;var s=hi;if(mi=u,(hi=i)&&!s)for(vi=l;null!==vi;)i=(u=vi).child,22===u.tag&&null!==u.memoizedState?Qi(l):null!==i?(i.return=u,vi=i):Qi(l);for(;null!==a;)vi=a,Vi(a,n,t),a=a.sibling;vi=l,mi=o,hi=s}Ai(e,n,t)}else 0!=(8772&l.subtreeFlags)&&null!==a?(a.return=l,vi=a):Ai(e,n,t)}}function Ai(e){for(;null!==vi;){var n=vi;if(0!=(8772&n.flags)){var r=n.alternate;try{if(0!=(8772&n.flags))switch(n.tag){case 0:case 11:case 15:hi||xi(5,n);break;case 1:var l=n.stateNode;if(4&n.flags&&!hi)if(null===r)l.componentDidMount();else{var a=n.elementType===n.type?r.memoizedProps:ca(n.type,r.memoizedProps);l.componentDidUpdate(a,r.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var u=n.updateQueue;null!==u&&_a(n,u,l);break;case 3:var o=n.updateQueue;if(null!==o){if(r=null,null!==n.child)switch(n.child.tag){case 5:r=n.child.stateNode;break;case 1:r=n.child.stateNode}_a(n,o,r)}break;case 5:var i=n.stateNode;if(null===r&&4&n.flags){r=i;var s=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break;case"img":s.src&&(r.src=s.src)}}break;case 6:case 4:case 12:break;case 13:if(null===n.memoizedState){var c=n.alternate;if(null!==c){var f=c.memoizedState;if(null!==f){var d=f.dehydrated;null!==d&&Xn(d)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(t(163))}hi||512&n.flags&&Ei(n)}catch(p){Ks(n,n.return,p)}}if(n===e){vi=null;break}if(null!==(r=n.sibling)){r.return=n.return,vi=r;break}vi=n.return}}function Bi(e){for(;null!==vi;){var n=vi;if(n===e){vi=null;break}var t=n.sibling;if(null!==t){t.return=n.return,vi=t;break}vi=n.return}}function Qi(e){for(;null!==vi;){var n=vi;try{switch(n.tag){case 0:case 11:case 15:var t=n.return;try{xi(4,n)}catch(i){Ks(n,t,i)}break;case 1:var r=n.stateNode;if("function"==typeof r.componentDidMount){var l=n.return;try{r.componentDidMount()}catch(i){Ks(n,l,i)}}var a=n.return;try{Ei(n)}catch(i){Ks(n,a,i)}break;case 5:var u=n.return;try{Ei(n)}catch(i){Ks(n,u,i)}}}catch(i){Ks(n,n.return,i)}if(n===e){vi=null;break}var o=n.sibling;if(null!==o){o.return=n.return,vi=o;break}vi=n.return}}var Wi,Hi=Math.ceil,ji=k.ReactCurrentDispatcher,$i=k.ReactCurrentOwner,qi=k.ReactCurrentBatchConfig,Ki=0,Yi=null,Xi=null,Gi=0,Zi=0,Ji=Wl(0),es=0,ns=null,ts=0,rs=0,ls=0,as=null,us=null,os=0,is=1/0,ss=null,cs=!1,fs=null,ds=null,ps=!1,ms=null,hs=0,gs=0,vs=null,ys=-1,bs=0;function ks(){return 0!=(6&Ki)?Je():-1!==ys?ys:ys=Je()}function ws(e){return 0==(1&e.mode)?1:0!=(2&Ki)&&0!==Gi?Gi&-Gi:null!==sa.transition?(0===bs&&(bs=wn()),bs):0!==(e=zn)?e:e=void 0===(e=window.event)?16:lt(e.type)}function Ss(e,n,r){if(50<gs)throw gs=0,vs=null,Error(t(185));var l=xs(e,n);return null===l?null:(xn(l,n,r),0!=(2&Ki)&&l===Yi||(l===Yi&&(0==(2&Ki)&&(rs|=n),4===es&&Ls(l,Gi)),Cs(l,r),1===n&&0===Ki&&0==(1&e.mode)&&(is=Je()+500,la&&ia())),l)}function xs(e,n){e.lanes|=n;var t=e.alternate;for(null!==t&&(t.lanes|=n),t=e,e=e.return;null!==e;)e.childLanes|=n,null!==(t=e.alternate)&&(t.childLanes|=n),t=e,e=e.return;return 3===t.tag?t.stateNode:null}function Es(e){return(null!==Yi||null!==ka)&&0!=(1&e.mode)&&0==(2&Ki)}function Cs(e,n){var t=e.callbackNode;bn(e,n);var r=vn(e,e===Yi?Gi:0);if(0===r)null!==t&&Xe(t),e.callbackNode=null,e.callbackPriority=0;else if(n=r&-r,e.callbackPriority!==n){if(null!=t&&Xe(t),1===n)0===e.tag?oa(Ts.bind(null,e)):ua(Ts.bind(null,e)),Cl(function(){0===Ki&&ia()}),t=null;else{switch(Nn(r)){case 1:t=nn;break;case 4:t=tn;break;case 16:t=rn;break;case 536870912:t=an;break;default:t=rn}t=Js(t,zs.bind(null,e))}e.callbackPriority=n,e.callbackNode=t}}function zs(e,n){if(ys=-1,bs=0,0!=(6&Ki))throw Error(t(327));var r=e.callbackNode;if($s()&&e.callbackNode!==r)return null;var l=vn(e,e===Yi?Gi:0);if(0===l)return null;if(0!=(30&l)||0!=(l&e.expiredLanes)||n)n=Vs(e,l);else{n=l;var a=Ki;Ki|=2;var u=Is();for(Yi===e&&Gi===n||(ss=null,is=Je()+500,Ds(e,n));;)try{Bs();break}catch(i){Os(e,i)}ha(),ji.current=u,Ki=a,null!==Xi?n=0:(Yi=null,Gi=0,n=es)}if(0!==n){if(2===n&&(0!==(a=kn(e))&&(l=a,n=Ns(e,a))),1===n)throw r=ns,Ds(e,0),Ls(e,l),Cs(e,Je()),r;if(6===n)Ls(e,l);else{if(a=e.current.alternate,0==(30&l)&&!_s(a)&&(2===(n=Vs(e,l))&&(0!==(u=kn(e))&&(l=u,n=Ns(e,u))),1===n))throw r=ns,Ds(e,0),Ls(e,l),Cs(e,Je()),r;switch(e.finishedWork=a,e.finishedLanes=l,n){case 0:case 1:throw Error(t(345));case 2:Hs(e,us,ss);break;case 3:if(Ls(e,l),(130023424&l)===l&&10<(n=os+500-Je())){if(0!==vn(e,0))break;if(((a=e.suspendedLanes)&l)!==l){ks(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Sl(Hs.bind(null,e,us,ss),n);break}Hs(e,us,ss);break;case 4:if(Ls(e,l),(4194240&l)===l)break;for(n=e.eventTimes,a=-1;0<l;){var o=31-cn(l);u=1<<o,(o=n[o])>a&&(a=o),l&=~u}if(l=a,10<(l=(120>(l=Je()-l)?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Hi(l/1960))-l)){e.timeoutHandle=Sl(Hs.bind(null,e,us,ss),l);break}Hs(e,us,ss);break;case 5:Hs(e,us,ss);break;default:throw Error(t(329))}}}return Cs(e,Je()),e.callbackNode===r?zs.bind(null,e):null}function Ns(e,n){var t=as;return e.current.memoizedState.isDehydrated&&(Ds(e,n).flags|=256),2!==(e=Vs(e,n))&&(n=us,us=t,null!==n&&Ps(n)),e}function Ps(e){null===us?us=e:us.push.apply(us,e)}function _s(e){for(var n=e;;){if(16384&n.flags){var t=n.updateQueue;if(null!==t&&null!==(t=t.stores))for(var r=0;r<t.length;r++){var l=t[r],a=l.getSnapshot;l=l.value;try{if(!Er(a(),l))return!1}catch(u){return!1}}}if(t=n.child,16384&n.subtreeFlags&&null!==t)t.return=n,n=t;else{if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ls(e,n){for(n&=~ls,n&=~rs,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var t=31-cn(n),r=1<<t;e[t]=-1,n&=~r}}function Ts(e){if(0!=(6&Ki))throw Error(t(327));$s();var n=vn(e,0);if(0==(1&n))return Cs(e,Je()),null;var r=Vs(e,n);if(0!==e.tag&&2===r){var l=kn(e);0!==l&&(n=l,r=Ns(e,l))}if(1===r)throw r=ns,Ds(e,0),Ls(e,n),Cs(e,Je()),r;if(6===r)throw Error(t(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Hs(e,us,ss),Cs(e,Je()),null}function Ms(e,n){var t=Ki;Ki|=1;try{return e(n)}finally{0===(Ki=t)&&(is=Je()+500,la&&ia())}}function Fs(e){null!==ms&&0===ms.tag&&0==(6&Ki)&&$s();var n=Ki;Ki|=1;var t=qi.transition,r=zn;try{if(qi.transition=null,zn=1,e)return e()}finally{zn=r,qi.transition=t,0==(6&(Ki=n))&&ia()}}function Rs(){Zi=Ji.current,Hl(Ji)}function Ds(e,n){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(-1!==t&&(e.timeoutHandle=-1,xl(t)),null!==Xi)for(t=Xi.return;null!==t;){var r=t;switch(Ya(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Zl();break;case 3:ku(),Hl(Kl),Hl(ql),zu();break;case 5:Su(r);break;case 4:ku();break;case 13:case 19:Hl(xu);break;case 10:ga(r.type._context);break;case 22:case 23:Rs()}t=t.return}if(Yi=e,Xi=e=lc(e.current,null),Gi=Zi=n,es=0,ns=null,ls=rs=ts=0,us=as=null,null!==ka){for(n=0;n<ka.length;n++)if(null!==(r=(t=ka[n]).interleaved)){t.interleaved=null;var l=r.next,a=t.pending;if(null!==a){var u=a.next;a.next=l,r.next=u}t.pending=r}ka=null}return e}function Os(e,n){for(;;){var r=Xi;try{if(ha(),Nu.current=So,Fu){for(var l=Lu.memoizedState;null!==l;){var a=l.queue;null!==a&&(a.pending=null),l=l.next}Fu=!1}if(_u=0,Mu=Tu=Lu=null,Ru=!1,Du=0,$i.current=null,null===r||null===r.return){es=1,ns=n,Xi=null;break}e:{var u=e,o=r.return,i=r,s=n;if(n=Gi,i.flags|=32768,null!==s&&"object"==typeof s&&"function"==typeof s.then){var c=s,f=i,d=f.tag;if(0==(1&f.mode)&&(0===d||11===d||15===d)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Oo(o);if(null!==m){m.flags&=-257,Io(m,o,i,u,n),1&m.mode&&Do(u,c,n),s=c;var h=(n=m).updateQueue;if(null===h){var g=new Set;g.add(s),n.updateQueue=g}else h.add(s);break e}if(0==(1&n)){Do(u,c,n),Us();break e}s=Error(t(426))}else if(Za&&1&i.mode){var v=Oo(o);if(null!==v){0==(65536&v.flags)&&(v.flags|=256),Io(v,o,i,u,n),ou(s);break e}}u=s,4!==es&&(es=2),null===as?as=[u]:as.push(u),s=zo(s,i),i=o;do{switch(i.tag){case 3:i.flags|=65536,n&=-n,i.lanes|=n,Na(i,Fo(i,s,n));break e;case 1:u=s;var y=i.type,b=i.stateNode;if(0==(128&i.flags)&&("function"==typeof y.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===ds||!ds.has(b)))){i.flags|=65536,n&=-n,i.lanes|=n,Na(i,Ro(i,u,n));break e}}i=i.return}while(null!==i)}Ws(r)}catch(k){n=k,Xi===r&&null!==r&&(Xi=r=r.return);continue}break}}function Is(){var e=ji.current;return ji.current=So,null===e?So:e}function Us(){0!==es&&3!==es&&2!==es||(es=4),null===Yi||0==(268435455&ts)&&0==(268435455&rs)||Ls(Yi,Gi)}function Vs(e,n){var r=Ki;Ki|=2;var l=Is();for(Yi===e&&Gi===n||(ss=null,Ds(e,n));;)try{As();break}catch(a){Os(e,a)}if(ha(),Ki=r,ji.current=l,null!==Xi)throw Error(t(261));return Yi=null,Gi=0,es}function As(){for(;null!==Xi;)Qs(Xi)}function Bs(){for(;null!==Xi&&!Ge();)Qs(Xi)}function Qs(e){var n=Wi(e.alternate,e,Zi);e.memoizedProps=e.pendingProps,null===n?Ws(e):Xi=n,$i.current=null}function Ws(e){var n=e;do{var t=n.alternate;if(e=n.return,0==(32768&n.flags)){if(null!==(t=Ao(t,n,Zi)))return void(Xi=t)}else{if(null!==(t=pi(t,n)))return t.flags&=32767,void(Xi=t);if(null===e)return es=6,void(Xi=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(n=n.sibling))return void(Xi=n);Xi=n=e}while(null!==n);0===es&&(es=5)}function Hs(e,n,t){var r=zn,l=qi.transition;try{qi.transition=null,zn=1,js(e,n,t,r)}finally{qi.transition=l,zn=r}return null}function js(e,n,r,l){do{$s()}while(null!==ms);if(0!=(6&Ki))throw Error(t(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(t(177));e.callbackNode=null,e.callbackPriority=0;var u=r.lanes|r.childLanes;if(En(e,u),e===Yi&&(Xi=Yi=null,Gi=0),0==(2064&r.subtreeFlags)&&0==(2064&r.flags)||ps||(ps=!0,Js(rn,function(){return $s(),null})),u=0!=(15990&r.flags),0!=(15990&r.subtreeFlags)||u){u=qi.transition,qi.transition=null;var o=zn;zn=1;var i=Ki;Ki|=4,$i.current=null,wi(e,r),Oi(r,e),Tr(kl),Zn=!!bl,kl=bl=null,e.current=r,Ui(r,e,a),Ze(),Ki=i,zn=o,qi.transition=u}else e.current=r;if(ps&&(ps=!1,ms=e,hs=a),0===(u=e.pendingLanes)&&(ds=null),sn(r.stateNode,l),Cs(e,Je()),null!==n)for(l=e.onRecoverableError,r=0;r<n.length;r++)l(n[r]);if(cs)throw cs=!1,e=fs,fs=null,e;return 0!=(1&hs)&&0!==e.tag&&$s(),0!=(1&(u=e.pendingLanes))?e===vs?gs++:(gs=0,vs=e):gs=0,ia(),null}function $s(){if(null!==ms){var e=Nn(hs),n=qi.transition,r=zn;try{if(qi.transition=null,zn=16>e?16:e,null===ms)var l=!1;else{if(e=ms,ms=null,hs=0,0!=(6&Ki))throw Error(t(331));var a=Ki;for(Ki|=4,vi=e.current;null!==vi;){var u=vi,o=u.child;if(0!=(16&vi.flags)){var i=u.deletions;if(null!==i){for(var s=0;s<i.length;s++){var c=i[s];for(vi=c;null!==vi;){var f=vi;switch(f.tag){case 0:case 11:case 15:Si(8,f,u)}var d=f.child;if(null!==d)d.return=f,vi=d;else for(;null!==vi;){var p=(f=vi).sibling,m=f.return;if(Ci(f),f===c){vi=null;break}if(null!==p){p.return=m,vi=p;break}vi=m}}}var h=u.alternate;if(null!==h){var g=h.child;if(null!==g){h.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}vi=u}}if(0!=(2064&u.subtreeFlags)&&null!==o)o.return=u,vi=o;else e:for(;null!==vi;){if(0!=(2048&(u=vi).flags))switch(u.tag){case 0:case 11:case 15:Si(9,u,u.return)}var y=u.sibling;if(null!==y){y.return=u.return,vi=y;break e}vi=u.return}}var b=e.current;for(vi=b;null!==vi;){var k=(o=vi).child;if(0!=(2064&o.subtreeFlags)&&null!==k)k.return=o,vi=k;else e:for(o=b;null!==vi;){if(0!=(2048&(i=vi).flags))try{switch(i.tag){case 0:case 11:case 15:xi(9,i)}}catch(S){Ks(i,i.return,S)}if(i===o){vi=null;break e}var w=i.sibling;if(null!==w){w.return=i.return,vi=w;break e}vi=i.return}}if(Ki=a,ia(),on&&"function"==typeof on.onPostCommitFiberRoot)try{on.onPostCommitFiberRoot(un,e)}catch(S){}l=!0}return l}finally{zn=r,qi.transition=n}}return!1}function qs(e,n,t){Ca(e,n=Fo(e,n=zo(t,n),1)),n=ks(),null!==(e=xs(e,1))&&(xn(e,1,n),Cs(e,n))}function Ks(e,n,t){if(3===e.tag)qs(e,e,t);else for(;null!==n;){if(3===n.tag){qs(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ds||!ds.has(r))){Ca(n,e=Ro(n,e=zo(t,e),1)),e=ks(),null!==(n=xs(n,1))&&(xn(n,1,e),Cs(n,e));break}}n=n.return}}function Ys(e,n,t){var r=e.pingCache;null!==r&&r.delete(n),n=ks(),e.pingedLanes|=e.suspendedLanes&t,Yi===e&&(Gi&t)===t&&(4===es||3===es&&(130023424&Gi)===Gi&&500>Je()-os?Ds(e,0):ls|=t),Cs(e,n)}function Xs(e,n){0===n&&(0==(1&e.mode)?n=1:(n=hn,0==(130023424&(hn<<=1))&&(hn=4194304)));var t=ks();null!==(e=xs(e,n))&&(xn(e,n,t),Cs(e,t))}function Gs(e){var n=e.memoizedState,t=0;null!==n&&(t=n.retryLane),Xs(e,t)}function Zs(e,n){var r=0;switch(e.tag){case 13:var l=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(t(314))}null!==l&&l.delete(n),Xs(e,r)}function Js(e,n){return Ye(e,n)}function ec(e,n,t,r){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nc(e,n,t,r){return new ec(e,n,t,r)}function tc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function rc(e){if("function"==typeof e)return tc(e)?1:0;if(null!=e){if((e=e.$$typeof)===P)return 11;if(e===T)return 14}return 2}function lc(e,n){var t=e.alternate;return null===t?((t=nc(e.tag,n,e.key,e.mode)).elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=n,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=14680064&e.flags,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,n=e.dependencies,t.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function ac(e,n,r,l,a,u){var o=2;if(l=e,"function"==typeof e)tc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case x:return uc(r.children,a,u,n);case E:o=8,a|=8;break;case C:return(e=nc(12,r,n,2|a)).elementType=C,e.lanes=u,e;case _:return(e=nc(13,r,n,a)).elementType=_,e.lanes=u,e;case L:return(e=nc(19,r,n,a)).elementType=L,e.lanes=u,e;case F:return oc(r,a,u,n);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case z:o=10;break e;case N:o=9;break e;case P:o=11;break e;case T:o=14;break e;case M:o=16,l=null;break e}throw Error(t(130,null==e?e:typeof e,""))}return(n=nc(o,r,n,a)).elementType=e,n.type=l,n.lanes=u,n}function uc(e,n,t,r){return(e=nc(7,e,r,n)).lanes=t,e}function oc(e,n,t,r){return(e=nc(22,e,r,n)).elementType=F,e.lanes=t,e.stateNode={},e}function ic(e,n,t){return(e=nc(6,e,null,n)).lanes=t,e}function sc(e,n,t){return(n=nc(4,null!==e.children?e.children:[],e.key,n)).lanes=t,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function cc(e,n,t,r,l){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sn(0),this.expirationTimes=Sn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sn(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function fc(e,n,t,r,l,a,u,o,i){return e=new cc(e,n,t,o,i),1===n?(n=1,!0===a&&(n|=8)):n=0,a=nc(3,null,null,n),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sa(a),e}function dc(e,n,t){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:n,implementation:t}}function pc(e){if(!e)return $l;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(t(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Gl(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(null!==n);throw Error(t(171))}if(1===e.tag){var r=e.type;if(Gl(r))return ea(e,r,n)}return n}function mc(e,n,t,r,l,a,u,o,i){return(e=fc(t,r,!0,e,l,a,u,o,i)).context=pc(null),t=e.current,(a=Ea(r=ks(),l=ws(t))).callback=null!=n?n:null,Ca(t,a),e.current.lanes=l,xn(e,l,r),Cs(e,r),e}function hc(e,n,t,r){var l=n.current,a=ks(),u=ws(l);return t=pc(t),null===n.context?n.context=t:n.pendingContext=t,(n=Ea(a,u)).payload={element:e},null!==(r=void 0===r?null:r)&&(n.callback=r),Ca(l,n),null!==(e=Ss(l,u,a))&&za(e,l,u),u}function gc(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function vc(e,n){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var t=e.retryLane;e.retryLane=0!==t&&t<n?t:n}}function yc(e,n){vc(e,n),(e=e.alternate)&&vc(e,n)}function bc(){return null}Wi=function(e,n,r){if(null!==e)if(e.memoizedProps!==n.pendingProps||Kl.current)Qo=!0;else{if(0==(e.lanes&r)&&0==(128&n.flags))return Qo=!1,di(e,n,r);Qo=0!=(131072&e.flags)}else Qo=!1,Za&&0!=(1048576&n.flags)&&qa(n,Aa,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;null!==e&&(e.alternate=null,n.alternate=null,n.flags|=2),e=n.pendingProps;var a=Xl(n,ql.current);ya(n,r),a=Vu(null,n,l,e,a,r);var u=Au();return n.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Gl(l)?(u=!0,na(n)):u=!1,n.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Sa(n),a.updater=Ma,n.stateNode=a,a._reactInternals=n,Oa(n,l,e,r),n=Go(null,n,l,!0,u,r)):(n.tag=0,Za&&u&&Ka(n),Wo(null,n,a,r),n=n.child),n;case 16:l=n.elementType;e:{switch(null!==e&&(e.alternate=null,n.alternate=null,n.flags|=2),e=n.pendingProps,l=(a=l._init)(l._payload),n.type=l,a=n.tag=rc(l),e=ca(l,e),a){case 0:n=Yo(null,n,l,e,r);break e;case 1:n=Xo(null,n,l,e,r);break e;case 11:n=Ho(null,n,l,e,r);break e;case 14:n=jo(null,n,l,ca(l.type,e),r);break e}throw Error(t(306,l,""))}return n;case 0:return l=n.type,a=n.pendingProps,Yo(e,n,l,a=n.elementType===l?a:ca(l,a),r);case 1:return l=n.type,a=n.pendingProps,Xo(e,n,l,a=n.elementType===l?a:ca(l,a),r);case 3:e:{if(Zo(n),null===e)throw Error(t(387));l=n.pendingProps,a=(u=n.memoizedState).element,xa(e,n),Pa(n,l,null,r);var o=n.memoizedState;if(l=o.element,u.isDehydrated){if(u={element:l,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},n.updateQueue.baseState=u,n.memoizedState=u,256&n.flags){n=Jo(e,n,l,r,a=Error(t(423)));break e}if(l!==a){n=Jo(e,n,l,r,a=Error(t(424)));break e}for(Ga=Pl(n.stateNode.containerInfo.firstChild),Xa=n,Za=!0,Ja=null,r=pu(n,null,l,r),n.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(uu(),l===a){n=fi(e,n,r);break e}Wo(e,n,l,r)}n=n.child}return n;case 5:return wu(n),null===e&&ru(n),l=n.type,a=n.pendingProps,u=null!==e?e.memoizedProps:null,o=a.children,wl(l,a)?o=null:null!==u&&wl(l,u)&&(n.flags|=32),Ko(e,n),Wo(e,n,o,r),n.child;case 6:return null===e&&ru(n),null;case 13:return ri(e,n,r);case 4:return bu(n,n.stateNode.containerInfo),l=n.pendingProps,null===e?n.child=du(n,null,l,r):Wo(e,n,l,r),n.child;case 11:return l=n.type,a=n.pendingProps,Ho(e,n,l,a=n.elementType===l?a:ca(l,a),r);case 7:return Wo(e,n,n.pendingProps,r),n.child;case 8:case 12:return Wo(e,n,n.pendingProps.children,r),n.child;case 10:e:{if(l=n.type._context,a=n.pendingProps,u=n.memoizedProps,o=a.value,jl(fa,l._currentValue),l._currentValue=o,null!==u)if(Er(u.value,o)){if(u.children===a.children&&!Kl.current){n=fi(e,n,r);break e}}else for(null!==(u=n.child)&&(u.return=n);null!==u;){var i=u.dependencies;if(null!==i){o=u.child;for(var s=i.firstContext;null!==s;){if(s.context===l){if(1===u.tag){(s=Ea(-1,r&-r)).tag=2;var c=u.updateQueue;if(null!==c){var f=(c=c.shared).pending;null===f?s.next=s:(s.next=f.next,f.next=s),c.pending=s}}u.lanes|=r,null!==(s=u.alternate)&&(s.lanes|=r),va(u.return,r,n),i.lanes|=r;break}s=s.next}}else if(10===u.tag)o=u.type===n.type?null:u.child;else if(18===u.tag){if(null===(o=u.return))throw Error(t(341));o.lanes|=r,null!==(i=o.alternate)&&(i.lanes|=r),va(o,r,n),o=u.sibling}else o=u.child;if(null!==o)o.return=u;else for(o=u;null!==o;){if(o===n){o=null;break}if(null!==(u=o.sibling)){u.return=o.return,o=u;break}o=o.return}u=o}Wo(e,n,a.children,r),n=n.child}return n;case 9:return a=n.type,l=n.pendingProps.children,ya(n,r),l=l(a=ba(a)),n.flags|=1,Wo(e,n,l,r),n.child;case 14:return a=ca(l=n.type,n.pendingProps),jo(e,n,l,a=ca(l.type,a),r);case 15:return $o(e,n,n.type,n.pendingProps,r);case 17:return l=n.type,a=n.pendingProps,a=n.elementType===l?a:ca(l,a),null!==e&&(e.alternate=null,n.alternate=null,n.flags|=2),n.tag=1,Gl(l)?(e=!0,na(n)):e=!1,ya(n,r),Ra(n,l,a),Oa(n,l,a,r),Go(null,n,l,!0,e,r);case 19:return ci(e,n,r);case 22:return qo(e,n,r)}throw Error(t(156,n.tag))};var kc="function"==typeof reportError?reportError:function(e){console.error(e)};function wc(e){this._internalRoot=e}function Sc(e){this._internalRoot=e}function xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ec(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Cc(){}function zc(e,n,t,r,l){if(l){if("function"==typeof r){var a=r;r=function(){var e=gc(u);a.call(e)}}var u=mc(n,r,e,0,null,!1,!1,"",Cc);return e._reactRootContainer=u,e[Fl]=u.current,ol(8===e.nodeType?e.parentNode:e),Fs(),u}for(;l=e.lastChild;)e.removeChild(l);if("function"==typeof r){var o=r;r=function(){var e=gc(i);o.call(e)}}var i=fc(e,0,!1,null,null,!1,!1,"",Cc);return e._reactRootContainer=i,e[Fl]=i.current,ol(8===e.nodeType?e.parentNode:e),Fs(function(){hc(n,i,t,r)}),i}function Nc(e,n,t,r,l){var a=t._reactRootContainer;if(a){var u=a;if("function"==typeof l){var o=l;l=function(){var e=gc(u);o.call(e)}}hc(n,u,e,l)}else u=zc(t,n,e,l,r);return gc(u)}Sc.prototype.render=wc.prototype.render=function(e){var n=this._internalRoot;if(null===n)throw Error(t(409));hc(e,n,null,null)},Sc.prototype.unmount=wc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var n=e.containerInfo;Fs(function(){hc(null,e,null,null)}),n[Fl]=null}},Sc.prototype.unstable_scheduleHydration=function(e){if(e){var n=Tn();e={blockedOn:null,target:e,priority:n};for(var t=0;t<An.length&&0!==n&&n<An[t].priority;t++);An.splice(t,0,e),0===t&&jn(e)}},Pn=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var t=gn(n.pendingLanes);0!==t&&(Cn(n,1|t),Cs(n,Je()),0==(6&Ki)&&(is=Je()+500,ia()))}break;case 13:var r=ks();Fs(function(){return Ss(e,1,r)}),yc(e,1)}},_n=function(e){13===e.tag&&(Ss(e,134217728,ks()),yc(e,134217728))},Ln=function(e){if(13===e.tag){var n=ks(),t=ws(e);Ss(e,t,n),yc(e,t)}},Tn=function(){return zn},Mn=function(e,n){var t=zn;try{return zn=e,n()}finally{zn=t}},Se=function(e,n,r){switch(n){case"input":if(J(e,r),n=r.name,"radio"===r.type&&null!=n){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<r.length;n++){var l=r[n];if(l!==e&&l.form===e.form){var a=Al(l);if(!a)throw Error(t(90));K(l),J(l,a)}}}break;case"textarea":ue(e,r);break;case"select":null!=(n=r.value)&&re(e,!!r.multiple,n,!1)}},Pe=Ms,_e=Fs;var Pc={usingClientEntryPoint:!1,Events:[Ul,Vl,Al,ze,Ne,Ms]},_c={findFiberByHostInstance:Il,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},Lc={bundleType:_c.bundleType,version:_c.version,rendererPackageName:_c.rendererPackageName,rendererConfig:_c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:_c.findFiberByHostInstance||bc,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tc.isDisabled&&Tc.supportsFiber)try{un=Tc.inject(Lc),on=Tc}catch(Mc){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pc,exports.createPortal=function(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!xc(n))throw Error(t(200));return dc(e,n,null,r)},exports.createRoot=function(e,n){if(!xc(e))throw Error(t(299));var r=!1,l="",a=kc;return null!=n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(l=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),n=fc(e,1,!1,null,null,r,!1,l,a),e[Fl]=n.current,ol(8===e.nodeType?e.parentNode:e),new wc(n)},exports.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var n=e._reactInternals;if(void 0===n){if("function"==typeof e.render)throw Error(t(188));throw e=Object.keys(e).join(","),Error(t(268,e))}return e=null===(e=qe(n))?null:e.stateNode},exports.flushSync=function(e){return Fs(e)},exports.hydrate=function(e,n,r){if(!Ec(n))throw Error(t(200));return Nc(null,e,n,!0,r)},exports.hydrateRoot=function(e,n,r){if(!xc(e))throw Error(t(405));var l=null!=r&&r.hydratedSources||null,a=!1,u="",o=kc;if(null!=r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(u=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),n=mc(n,null,e,1,null!=r?r:null,a,!1,u,o),e[Fl]=n.current,ol(e),l)for(e=0;e<l.length;e++)a=(a=(r=l[e])._getVersion)(r._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[r,a]:n.mutableSourceEagerHydrationData.push(r,a);return new Sc(n)},exports.render=function(e,n,r){if(!Ec(n))throw Error(t(200));return Nc(null,e,n,!1,r)},exports.unmountComponentAtNode=function(e){if(!Ec(e))throw Error(t(40));return!!e._reactRootContainer&&(Fs(function(){Nc(null,null,e,!1,function(){e._reactRootContainer=null,e[Fl]=null})}),!0)},exports.unstable_batchedUpdates=Ms,exports.unstable_renderSubtreeIntoContainer=function(e,n,r,l){if(!Ec(r))throw Error(t(200));if(null==e||void 0===e._reactInternals)throw Error(t(38));return Nc(e,n,r,!1,l)},exports.version="18.1.0-next-22edb9f77-20220426";
},{"react":"dmLA","scheduler":"vqYn"}],"kUqu":[function(require,module,exports) {
"use strict";function _(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_)}catch(O){console.error(O)}}}_(),module.exports=require("./cjs/react-dom.production.min.js");
},{"./cjs/react-dom.production.min.js":"ogJH"}],"pHua":[function(require,module,exports) {

},{"./files/open-sans-latin-300.woff2":[["open-sans-latin-300.49cf3b01.woff2","DfZg"],"DfZg"],"./files/open-sans-latin-300.woff":[["open-sans-latin-300.a634e8c8.woff","a8HX"],"a8HX"],"./files/open-sans-latin-300italic.woff2":[["open-sans-latin-300italic.056aca4c.woff2","ISKU"],"ISKU"],"./files/open-sans-latin-300italic.woff":[["open-sans-latin-300italic.56a8a70c.woff","VbyA"],"VbyA"],"./files/open-sans-latin-400.woff2":[["open-sans-latin-400.54949422.woff2","sgio"],"sgio"],"./files/open-sans-latin-400.woff":[["open-sans-latin-400.d7dd8a80.woff","GqBe"],"GqBe"],"./files/open-sans-latin-400italic.woff2":[["open-sans-latin-400italic.b4275a56.woff2","GjBN"],"GjBN"],"./files/open-sans-latin-400italic.woff":[["open-sans-latin-400italic.bd4b4666.woff","xtQh"],"xtQh"],"./files/open-sans-latin-600.woff2":[["open-sans-latin-600.bf006418.woff2","uqxX"],"uqxX"],"./files/open-sans-latin-600.woff":[["open-sans-latin-600.cb6ab4e8.woff","RYVt"],"RYVt"],"./files/open-sans-latin-600italic.woff2":[["open-sans-latin-600italic.ddd4806e.woff2","F9tt"],"F9tt"],"./files/open-sans-latin-600italic.woff":[["open-sans-latin-600italic.a5b64397.woff","OpnS"],"OpnS"],"./files/open-sans-latin-700.woff2":[["open-sans-latin-700.1db8a90f.woff2","l5EI"],"l5EI"],"./files/open-sans-latin-700.woff":[["open-sans-latin-700.727affd4.woff","Q054"],"Q054"],"./files/open-sans-latin-700italic.woff2":[["open-sans-latin-700italic.82ea89dc.woff2","Q2P9"],"Q2P9"],"./files/open-sans-latin-700italic.woff":[["open-sans-latin-700italic.5d56e504.woff","ZCBE"],"ZCBE"],"./files/open-sans-latin-800.woff2":[["open-sans-latin-800.204f52d7.woff2","VlDY"],"VlDY"],"./files/open-sans-latin-800.woff":[["open-sans-latin-800.75a0af50.woff","Vv7J"],"Vv7J"],"./files/open-sans-latin-800italic.woff2":[["open-sans-latin-800italic.9b359a85.woff2","OmA1"],"OmA1"],"./files/open-sans-latin-800italic.woff":[["open-sans-latin-800italic.b2aeabb6.woff","BBfq"],"BBfq"]}],"lhbT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBasename=t,exports.getPathWithoutBasename=void 0;const e=e=>document.location.pathname.substring(e.length);function t(){const e=document.querySelector("base");if(!e)return"";const t=`/${e.href.split("/").slice(3).join("/")}`;return t.endsWith("/")?t.substr(0,t.length-1):t}exports.getPathWithoutBasename=e;
},{}],"Dm7Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createHistory=a,exports.getHashPath=void 0;var e=require("./basename");const t=()=>window.location.hash.substr(1);function a(a,s,o){const{location:r,history:n}=window,h=a?()=>o(t()):()=>o((0,e.getPathWithoutBasename)(s)),i=a?e=>`${r.pathname}${r.search}#${e}`:e=>`${s}${e}`;return window.addEventListener("popstate",h),{push(e){const t=i(e);t!==r.pathname+r.search+r.hash&&n.pushState({},"",t),h()},replace(e){n.replaceState({},"",i(e)),h()},stop(){window.removeEventListener("popstate",h)},urlTo:i}}exports.getHashPath=t;
},{"./basename":"lhbT"}],"hXKp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RouterContext=void 0;var e=require("react");const t=()=>{throw new Error("You forgot to add a Router element to your app.")},o=(0,e.createContext)({basename:"",path:"",history:{push:t,replace:t,stop:t,urlTo:t},matchRoute:t,urlTo:t});exports.RouterContext=o;
},{"react":"dmLA"}],"haBd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useParams=o,exports.useRouter=void 0;var e=require("react"),t=require("./RouterContext");const r=()=>(0,e.useContext)(t.RouterContext);function o(t){const o=r();return(0,e.useMemo)(()=>o.matchRoute(t,o.path),[t,o])}exports.useRouter=r;
},{"react":"dmLA","./RouterContext":"hXKp"}],"KFeT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useRouteLink=o,exports.Link=u;var e=n(require("react")),r=require("./hooks");function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t();if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var c=o?Object.getOwnPropertyDescriptor(e,u):null;c&&(c.get||c.set)?Object.defineProperty(n,u,c):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}function o(t,n){const{history:o}=(0,r.useRouter)();return(0,e.useMemo)(()=>({onClick(e){try{null==n||n(e)}catch(r){console.error(r)}e.defaultPrevented||(e.preventDefault(),o.push(t))},href:o.urlTo(t)}),[t,n,o])}function u(r){const t=o(r.href,r.onClick);return e.default.createElement("a",Object.assign({},r,{href:t.href,onClick:t.onClick}))}
},{"react":"dmLA","./hooks":"haBd"}],"P3pr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Route=o;var e=n(require("react")),t=require("./hooks");function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var a=o?Object.getOwnPropertyDescriptor(e,u):null;a&&(a.get||a.set)?Object.defineProperty(n,u,a):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}function o(r){const n=(0,t.useRouter)(),o=(0,e.useMemo)(()=>n.matchRoute(r.path,n.path),[r.path,n]);if(!o)return null;const u=r.component;if(u){let t;return!0===r.addKey?t=n.path:r.addKey&&(t=r.addKey.map(e=>`${e}=${o[e]}`).join("|")),e.default.createElement(u,{params:o,key:t})}return"function"==typeof r.children?r.children(o):r.children}
},{"react":"dmLA","./hooks":"haBd"}],"ftqz":[function(require,module,exports) {
"use strict";function e(e){const t={};return(r,o)=>{return(t[r]||(t[r]=e(r)))(o)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createRouteMatcher=e;
},{}],"CAcq":[function(require,module,exports) {
"use strict";function e(e){return t=>t===e||"*"===e?{}:null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.simpleRouteMatcherFactory=e;
},{}],"duQY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Router=void 0;var e=c(require("react")),t=require("./RouterContext"),r=require("./history"),o=require("./routeMatcher"),u=require("./basename"),a=require("./simpleRouteMatcherFactory");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var a=o?Object.getOwnPropertyDescriptor(e,u):null;a&&(a.get||a.set)?Object.defineProperty(r,u,a):r[u]=e[u]}return r.default=e,t&&t.set(e,r),r}const i=({basename:n="",mode:c,routeMatcherFactory:i=a.simpleRouteMatcherFactory,children:s})=>{const f="hash"===c,[p,l]=(0,e.useState)(()=>f?(0,r.getHashPath)():(0,u.getPathWithoutBasename)(n)),h=(0,e.useMemo)(()=>(0,r.createHistory)(f,n,l),[l,n,f]),y=(0,e.useMemo)(()=>(0,o.createRouteMatcher)(i),[i]),d=(0,e.useMemo)(()=>({basename:n,path:p,history:h,matchRoute:y,urlTo:h.urlTo}),[n,p,h,y]);return(0,e.useEffect)(()=>h.stop,[h]),e.default.createElement(t.RouterContext.Provider,{value:d},s)};exports.Router=i;
},{"react":"dmLA","./RouterContext":"hXKp","./history":"Dm7Y","./routeMatcher":"ftqz","./basename":"lhbT","./simpleRouteMatcherFactory":"CAcq"}],"nmgu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Switch=t;var e=require("react"),r=require("./hooks");function t(t){var o;const{matchRoute:u,path:i}=(0,r.useRouter)();return null!==(o=t.children.find(r=>r&&(0,e.isValidElement)(r)&&!!u(r.props.path,i)))&&void 0!==o?o:null}
},{"react":"dmLA","./hooks":"haBd"}],"Tbrz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./basename");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./history");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./hooks");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var u=require("./Link");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});var n=require("./Route");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}})});var o=require("./routeMatcher");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}})});var c=require("./Router");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}})});var f=require("./RouterContext");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return f[e]}})});var a=require("./simpleRouteMatcherFactory");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return a[e]}})});var i=require("./Switch");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}})});
},{"./basename":"lhbT","./history":"Dm7Y","./hooks":"haBd","./Link":"KFeT","./Route":"P3pr","./routeMatcher":"ftqz","./Router":"duQY","./RouterContext":"hXKp","./simpleRouteMatcherFactory":"CAcq","./Switch":"nmgu"}],"I6oK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2_maxPolygonVertices=exports.b2_lengthUnitsPerMeter=void 0,exports.b2_lengthUnitsPerMeter=1,exports.b2_maxPolygonVertices=8;
},{}],"ReKW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2MakeArray=exports.b2MakeBooleanArray=exports.b2MakeNumberArray=exports.b2_version=exports.b2_angularSleepTolerance=exports.b2_linearSleepTolerance=exports.b2_timeToSleep=exports.b2_toiBaumgarte=exports.b2_baumgarte=exports.b2_maxRotationSquared=exports.b2_maxRotation=exports.b2_maxTranslationSquared=exports.b2_maxTranslation=exports.b2_maxAngularCorrection=exports.b2_maxLinearCorrection=exports.b2_maxTOIContacts=exports.b2_maxSubSteps=exports.b2_polygonRadius=exports.b2_angularSlop=exports.b2_linearSlop=exports.b2_aabbMultiplier=exports.b2_aabbExtension=exports.b2_maxManifoldPoints=exports.b2_epsilon_sq=exports.b2_epsilon=exports.b2_maxFloat=exports.b2Verify=exports.b2Assert=void 0;const e=require("./b2_settings");function r(e,r){if(!e)throw new Error(r)}function t(e){if(null===e)throw new Error;return e}function o(e,r=0){const t=new Array(e);for(let o=0;o<e;o++)t[o]=r;return t}function a(e,r=!1){const t=new Array(e);for(let o=0;o<e;o++)t[o]=r;return t}function s(e,r){const t=new Array(e);for(let o=0;o<e;o++)t[o]=new r;return t}exports.b2Assert=r,exports.b2Verify=t,exports.b2_maxFloat=1e37,exports.b2_epsilon=1e-5,exports.b2_epsilon_sq=exports.b2_epsilon*exports.b2_epsilon,exports.b2_maxManifoldPoints=2,exports.b2_aabbExtension=.1*e.b2_lengthUnitsPerMeter,exports.b2_aabbMultiplier=4,exports.b2_linearSlop=.005*e.b2_lengthUnitsPerMeter,exports.b2_angularSlop=2/180*Math.PI,exports.b2_polygonRadius=2*exports.b2_linearSlop,exports.b2_maxSubSteps=8,exports.b2_maxTOIContacts=32,exports.b2_maxLinearCorrection=.2*e.b2_lengthUnitsPerMeter,exports.b2_maxAngularCorrection=8/180*Math.PI,exports.b2_maxTranslation=2*e.b2_lengthUnitsPerMeter,exports.b2_maxTranslationSquared=exports.b2_maxTranslation*exports.b2_maxTranslation,exports.b2_maxRotation=.5*Math.PI,exports.b2_maxRotationSquared=exports.b2_maxRotation*exports.b2_maxRotation,exports.b2_baumgarte=.2,exports.b2_toiBaumgarte=.75,exports.b2_timeToSleep=.5,exports.b2_linearSleepTolerance=.01*e.b2_lengthUnitsPerMeter,exports.b2_angularSleepTolerance=2/180*Math.PI,exports.b2_version={major:2,minor:4,patch:0},exports.b2MakeNumberArray=o,exports.b2MakeBooleanArray=a,exports.b2MakeArray=s;
},{"./b2_settings":"I6oK"}],"cQbL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Sweep=exports.b2Transform=exports.b2Rot=exports.b2Mat33=exports.b2Mat22=exports.b2Vec3=exports.b2Vec2=exports.b2RandomInt=exports.b2RandomFloat=exports.b2Random=exports.b2IsPowerOfTwo=exports.b2NextPowerOfTwo=exports.b2RadToDeg=exports.b2DegToRad=exports.b2Clamp=exports.b2_two_pi=exports.b2_180_over_pi=exports.b2_pi_over_180=void 0;const t=require("./b2_common");function e(t,e,s){return t<e?e:t>s?s:t}function s(t){return t*exports.b2_pi_over_180}function i(t){return t*exports.b2_180_over_pi}function r(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}function h(t){return t>0&&0==(t&t-1)}function y(){return 2*Math.random()-1}function x(t,e){return(e-t)*Math.random()+t}function n(t,e){return Math.round((e-t)*Math.random()+t)}exports.b2_pi_over_180=Math.PI/180,exports.b2_180_over_pi=180/Math.PI,exports.b2_two_pi=2*Math.PI,exports.b2Clamp=e,exports.b2DegToRad=s,exports.b2RadToDeg=i,exports.b2NextPowerOfTwo=r,exports.b2IsPowerOfTwo=h,exports.b2Random=y,exports.b2RandomFloat=x,exports.b2RandomInt=n;class o{constructor(t=0,e=0){this.x=t,this.y=e}Clone(){return new o(this.x,this.y)}SetZero(){return this.x=0,this.y=0,this}Set(t,e){return this.x=t,this.y=e,this}Copy(t){return this.x=t.x,this.y=t.y,this}Add(t){return this.x+=t.x,this.y+=t.y,this}AddXY(t,e){return this.x+=t,this.y+=e,this}Subtract(t){return this.x-=t.x,this.y-=t.y,this}SubtractXY(t,e){return this.x-=t,this.y-=e,this}Scale(t){return this.x*=t,this.y*=t,this}AddScaled(t,e){return this.x+=t*e.x,this.y+=t*e.y,this}SubtractScaled(t,e){return this.x-=t*e.x,this.y-=t*e.y,this}Dot(t){return this.x*t.x+this.y*t.y}Cross(t){return this.x*t.y-this.y*t.x}Length(){const{x:t,y:e}=this;return Math.sqrt(t*t+e*e)}LengthSquared(){const{x:t,y:e}=this;return t*t+e*e}Normalize(){const e=this.Length();if(e<t.b2_epsilon)return 0;const s=1/e;return this.x*=s,this.y*=s,e}Rotate(t){const e=Math.cos(t),s=Math.sin(t),{x:i}=this;return this.x=e*i-s*this.y,this.y=s*i+e*this.y,this}RotateCosSin(t,e){const{x:s}=this;return this.x=t*s-e*this.y,this.y=e*s+t*this.y,this}IsValid(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}Abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}GetAbs(t){return t.x=Math.abs(this.x),t.y=Math.abs(this.y),t}Negate(){return this.x=-this.x,this.y=-this.y,this}Skew(){const{x:t}=this;return this.x=-this.y,this.y=t,this}static Min(t,e,s){return s.x=Math.min(t.x,e.x),s.y=Math.min(t.y,e.y),s}static Max(t,e,s){return s.x=Math.max(t.x,e.x),s.y=Math.max(t.y,e.y),s}static Clamp(t,s,i,r){return r.x=e(t.x,s.x,i.x),r.y=e(t.y,s.y,i.y),r}static Rotate(t,e,s){const i=t.x,r=t.y,h=Math.cos(e),y=Math.sin(e);return s.x=h*i-y*r,s.y=y*i+h*r,s}static Dot(t,e){return t.x*e.x+t.y*e.y}static Cross(t,e){return t.x*e.y-t.y*e.x}static CrossVec2Scalar(t,e,s){const i=t.x;return s.x=e*t.y,s.y=-e*i,s}static CrossVec2One(t,e){const s=t.x;return e.x=t.y,e.y=-s,e}static CrossScalarVec2(t,e,s){const i=e.x;return s.x=-t*e.y,s.y=t*i,s}static CrossOneVec2(t,e){const s=t.x;return e.x=-t.y,e.y=s,e}static Add(t,e,s){return s.x=t.x+e.x,s.y=t.y+e.y,s}static Subtract(t,e,s){return s.x=t.x-e.x,s.y=t.y-e.y,s}static Scale(t,e,s){return s.x=e.x*t,s.y=e.y*t,s}static AddScaled(t,e,s,i){return i.x=t.x+e*s.x,i.y=t.y+e*s.y,i}static SubtractScaled(t,e,s,i){return i.x=t.x-e*s.x,i.y=t.y-e*s.y,i}static AddCrossScalarVec2(t,e,s,i){const r=s.x;return i.x=t.x-e*s.y,i.y=t.y+e*r,i}static Mid(t,e,s){return s.x=.5*(t.x+e.x),s.y=.5*(t.y+e.y),s}static Extents(t,e,s){return s.x=.5*(e.x-t.x),s.y=.5*(e.y-t.y),s}static Equals(t,e){return t.x===e.x&&t.y===e.y}static Distance(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}static DistanceSquared(t,e){return(t.x-e.x)**2+(t.y-e.y)**2}static Negate(t,e){return e.x=-t.x,e.y=-t.y,e}static Normalize(e,s){const i=e.x**2+e.y**2;if(i>=t.b2_epsilon_sq){const t=1/Math.sqrt(i);s.x=t*e.x,s.y=t*e.y}else s.x=0,s.y=0;return s}static Skew(t,e){const{x:s}=t;return e.x=-t.y,e.y=s,e}}exports.b2Vec2=o,o.ZERO=new o,o.UNITX=new o(1,0),o.UNITY=new o(0,1),o.s_t0=new o,o.s_t1=new o,o.s_t2=new o,o.s_t3=new o;class c{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}Clone(){return new c(this.x,this.y,this.z)}SetZero(){return this.x=0,this.y=0,this.z=0,this}Set(t,e,s){return this.x=t,this.y=e,this.z=s,this}Copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}Negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}Add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}AddXYZ(t,e,s){return this.x+=t,this.y+=e,this.z+=s,this}Subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}SubtractXYZ(t,e,s){return this.x-=t,this.y-=e,this.z-=s,this}Scale(t){return this.x*=t,this.y*=t,this.z*=t,this}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static Cross(t,e,s){const i=t.x,r=t.y,h=t.z,y=e.x,x=e.y,n=e.z;return s.x=r*n-h*x,s.y=h*y-i*n,s.z=i*x-r*y,s}}exports.b2Vec3=c,c.ZERO=new c(0,0,0),c.s_t0=new c;class a{constructor(){this.ex=new o(1,0),this.ey=new o(0,1)}Clone(){return(new a).Copy(this)}static FromColumns(t,e){return(new a).SetColumns(t,e)}static FromScalars(t,e,s,i){return(new a).SetScalars(t,e,s,i)}static FromAngle(t){return(new a).SetAngle(t)}SetScalars(t,e,s,i){return this.ex.Set(t,s),this.ey.Set(e,i),this}SetColumns(t,e){return this.ex.Copy(t),this.ey.Copy(e),this}SetAngle(t){const e=Math.cos(t),s=Math.sin(t);return this.ex.Set(e,s),this.ey.Set(-s,e),this}Copy(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this}SetIdentity(){return this.ex.Set(1,0),this.ey.Set(0,1),this}SetZero(){return this.ex.SetZero(),this.ey.SetZero(),this}GetAngle(){return Math.atan2(this.ex.y,this.ex.x)}Solve(t,e,s){const i=this.ex.x,r=this.ey.x,h=this.ex.y,y=this.ey.y;let x=i*y-r*h;return 0!==x&&(x=1/x),s.x=x*(y*t-r*e),s.y=x*(i*e-h*t),s}Abs(){return this.ex.Abs(),this.ey.Abs(),this}Inverse(){return this.GetInverse(this),this}Add(t){return this.ex.Add(t.ex),this.ey.Add(t.ey),this}Subtract(t){return this.ex.Subtract(t.ex),this.ey.Subtract(t.ey),this}GetInverse(t){const e=this.ex.x,s=this.ey.x,i=this.ex.y,r=this.ey.y;let h=e*r-s*i;return 0!==h&&(h=1/h),t.ex.x=h*r,t.ey.x=-h*s,t.ex.y=-h*i,t.ey.y=h*e,t}GetAbs(t){return t.ex.x=Math.abs(this.ex.x),t.ex.y=Math.abs(this.ex.y),t.ey.x=Math.abs(this.ey.x),t.ey.y=Math.abs(this.ey.y),t}static MultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.ex.x*i+t.ey.x*r,s.y=t.ex.y*i+t.ey.y*r,s}static TransposeMultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.ex.x*i+t.ex.y*r,s.y=t.ey.x*i+t.ey.y*r,s}static Add(t,e,s){return s.ex.x=t.ex.x+e.ex.x,s.ex.y=t.ex.y+e.ex.y,s.ey.x=t.ey.x+e.ey.x,s.ey.y=t.ey.y+e.ey.y,s}static Multiply(t,e,s){const i=t.ex.x,r=t.ex.y,h=t.ey.x,y=t.ey.y,x=e.ex.x,n=e.ex.y,o=e.ey.x,c=e.ey.y;return s.ex.x=i*x+h*n,s.ex.y=r*x+y*n,s.ey.x=i*o+h*c,s.ey.y=r*o+y*c,s}static TransposeMultiply(t,e,s){const i=t.ex.x,r=t.ex.y,h=t.ey.x,y=t.ey.y,x=e.ex.x,n=e.ex.y,o=e.ey.x,c=e.ey.y;return s.ex.x=i*x+r*n,s.ex.y=h*x+y*n,s.ey.x=i*o+r*c,s.ey.y=h*o+y*c,s}}exports.b2Mat22=a,a.IDENTITY=new a;class u{constructor(){this.ex=new c(1,0,0),this.ey=new c(0,1,0),this.ez=new c(0,0,1)}Clone(){return(new u).Copy(this)}SetColumns(t,e,s){return this.ex.Copy(t),this.ey.Copy(e),this.ez.Copy(s),this}Copy(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this.ez.Copy(t.ez),this}SetIdentity(){return this.ex.Set(1,0,0),this.ey.Set(0,1,0),this.ez.Set(0,0,1),this}SetZero(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this}Add(t){return this.ex.Add(t.ex),this.ey.Add(t.ey),this.ez.Add(t.ez),this}Solve33(t,e,s,i){const r=this.ex.x,h=this.ex.y,y=this.ex.z,x=this.ey.x,n=this.ey.y,o=this.ey.z,c=this.ez.x,a=this.ez.y,u=this.ez.z;let p=r*(n*u-o*a)+h*(o*c-x*u)+y*(x*a-n*c);return 0!==p&&(p=1/p),i.x=p*(t*(n*u-o*a)+e*(o*c-x*u)+s*(x*a-n*c)),i.y=p*(r*(e*u-s*a)+h*(s*c-t*u)+y*(t*a-e*c)),i.z=p*(r*(n*s-o*e)+h*(o*t-x*s)+y*(x*e-n*t)),i}Solve22(t,e,s){const i=this.ex.x,r=this.ey.x,h=this.ex.y,y=this.ey.y;let x=i*y-r*h;return 0!==x&&(x=1/x),s.x=x*(y*t-r*e),s.y=x*(i*e-h*t),s}GetInverse22(t){const e=this.ex.x,s=this.ey.x,i=this.ex.y,r=this.ey.y;let h=e*r-s*i;0!==h&&(h=1/h),t.ex.x=h*r,t.ey.x=-h*s,t.ex.z=0,t.ex.y=-h*i,t.ey.y=h*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0}GetSymInverse33(t){let e=c.Dot(this.ex,c.Cross(this.ey,this.ez,c.s_t0));0!==e&&(e=1/e);const s=this.ex.x,i=this.ey.x,r=this.ez.x,h=this.ey.y,y=this.ez.y,x=this.ez.z;t.ex.x=e*(h*x-y*y),t.ex.y=e*(r*y-i*x),t.ex.z=e*(i*y-r*h),t.ey.x=t.ex.y,t.ey.y=e*(s*x-r*r),t.ey.z=e*(r*i-s*y),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(s*h-i*i)}static MultiplyVec3(t,e,s){const{x:i,y:r,z:h}=e;return s.x=t.ex.x*i+t.ey.x*r+t.ez.x*h,s.y=t.ex.y*i+t.ey.y*r+t.ez.y*h,s.z=t.ex.z*i+t.ey.z*r+t.ez.z*h,s}static MultiplyVec2(t,e,s){const{x:i,y:r}=e;return s.x=t.ex.x*i+t.ey.x*r,s.y=t.ex.y*i+t.ey.y*r,s}}exports.b2Mat33=u,u.IDENTITY=new u;class p{constructor(t=0){this.s=0,this.c=1,t&&(this.s=Math.sin(t),this.c=Math.cos(t))}Clone(){return(new p).Copy(this)}Copy(t){return this.s=t.s,this.c=t.c,this}Set(t){return this.s=Math.sin(t),this.c=Math.cos(t),this}SetIdentity(){return this.s=0,this.c=1,this}GetAngle(){return Math.atan2(this.s,this.c)}GetXAxis(t){return t.x=this.c,t.y=this.s,t}GetYAxis(t){return t.x=-this.s,t.y=this.c,t}static Multiply(t,e,s){const i=t.s*e.c+t.c*e.s,r=t.c*e.c-t.s*e.s;return s.s=i,s.c=r,s}static TransposeMultiply(t,e,s){const i=t.c*e.s-t.s*e.c,r=t.c*e.c+t.s*e.s;return s.s=i,s.c=r,s}static MultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.c*i-t.s*r,s.y=t.s*i+t.c*r,s}static TransposeMultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.c*i+t.s*r,s.y=-t.s*i+t.c*r,s}}exports.b2Rot=p,p.IDENTITY=new p;class l{constructor(){this.p=new o,this.q=new p}Clone(){return(new l).Copy(this)}Copy(t){return this.p.Copy(t.p),this.q.Copy(t.q),this}SetIdentity(){return this.p.SetZero(),this.q.SetIdentity(),this}SetPositionRotation(t,e){return this.p.Copy(t),this.q.Copy(e),this}SetPositionAngle(t,e){return this.p.Copy(t),this.q.Set(e),this}SetPosition(t){return this.p.Copy(t),this}SetPositionXY(t,e){return this.p.Set(t,e),this}SetRotation(t){return this.q.Copy(t),this}SetRotationAngle(t){return this.q.Set(t),this}GetPosition(){return this.p}GetRotation(){return this.q}GetAngle(){return this.q.GetAngle()}static MultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.q.c*i-t.q.s*r+t.p.x,s.y=t.q.s*i+t.q.c*r+t.p.y,s}static TransposeMultiplyVec2(t,e,s){const i=e.x-t.p.x,r=e.y-t.p.y;return s.x=t.q.c*i+t.q.s*r,s.y=-t.q.s*i+t.q.c*r,s}static Multiply(t,e,s){return p.Multiply(t.q,e.q,s.q),p.MultiplyVec2(t.q,e.p,s.p).Add(t.p),s}static TransposeMultiply(t,e,s){return p.TransposeMultiply(t.q,e.q,s.q),p.TransposeMultiplyVec2(t.q,o.Subtract(e.p,t.p,s.p),s.p),s}}exports.b2Transform=l,l.IDENTITY=new l;class S{constructor(){this.localCenter=new o,this.c0=new o,this.c=new o,this.a0=0,this.a=0,this.alpha0=0}Clone(){return(new S).Copy(this)}Copy(t){return this.localCenter.Copy(t.localCenter),this.c0.Copy(t.c0),this.c.Copy(t.c),this.a0=t.a0,this.a=t.a,this.alpha0=t.alpha0,this}GetTransform(t,e){const s=1-e;t.p.x=s*this.c0.x+e*this.c.x,t.p.y=s*this.c0.y+e*this.c.y;const i=s*this.a0+e*this.a;return t.q.Set(i),t.p.Subtract(p.MultiplyVec2(t.q,this.localCenter,o.s_t0)),t}Advance(t){const e=(t-this.alpha0)/(1-this.alpha0);this.c0.x+=e*(this.c.x-this.c0.x),this.c0.y+=e*(this.c.y-this.c0.y),this.a0+=e*(this.a-this.a0),this.alpha0=t}Normalize(){const t=exports.b2_two_pi*Math.floor(this.a0/exports.b2_two_pi);this.a0-=t,this.a-=t}}exports.b2Sweep=S;
},{"./b2_common":"ReKW"}],"lvls":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debugColors=exports.b2Color=void 0;class t{constructor(t=.5,i=.5,s=.5,r=1){this.r=t,this.g=i,this.b=s,this.a=r}Clone(){return new t(this.r,this.g,this.b,this.a)}Copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}IsEqual(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}IsZero(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a}SetByteRGB(t,i,s){return this.r=t/255,this.g=i/255,this.b=s/255,this}SetByteRGBA(t,i,s,r){return this.r=t/255,this.g=i/255,this.b=s/255,this.a=r/255,this}SetRGB(t,i,s){return this.r=t,this.g=i,this.b=s,this}SetRGBA(t,i,s,r){return this.r=t,this.g=i,this.b=s,this.a=r,this}Add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}Subtract(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}Scale(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}Mix(i,s){t.MixColors(this,i,s)}static Add(t,i,s){return s.r=t.r+i.r,s.g=t.g+i.g,s.b=t.b+i.b,s.a=t.a+i.a,s}static Subtract(t,i,s){return s.r=t.r-i.r,s.g=t.g-i.g,s.b=t.b-i.b,s.a=t.a-i.a,s}static Scale(t,i,s){return s.r=t.r*i,s.g=t.g*i,s.b=t.b*i,s.a=t.a*i,s}static MixColors(t,i,s){const r=s*(i.r-t.r),e=s*(i.g-t.g),n=s*(i.b-t.b),h=s*(i.a-t.a);t.r+=r,t.g+=e,t.b+=n,t.a+=h,i.r-=r,i.g-=e,i.b-=n,i.a-=h}}exports.b2Color=t,t.ZERO=new t(0,0,0,0),t.RED=new t(1,0,0),t.GREEN=new t(0,1,0),t.BLUE=new t(0,0,1),t.WHITE=new t(1,1,1),t.BLACK=new t(0,0,0),exports.debugColors={badBody:new t(1,0,0),disabledBody:new t(.5,.5,.3),staticBody:new t(.5,.9,.5),kinematicBody:new t(.5,.5,.9),sleepingBody:new t(.6,.6,.6),body:new t(.9,.7,.7),pair:new t(.3,.9,.9),aabb:new t(.9,.3,.9),joint1:new t(.7,.7,.7),joint2:new t(.3,.9,.3),joint3:new t(.9,.3,.3),joint4:new t(.3,.3,.9),joint5:new t(.4,.4,.4),joint6:new t(.5,.8,.8),joint7:new t(0,1,0),joint8:new t(.8,.8,.8),rope:new t(.4,.5,.7),ropePointG:new t(.1,.8,.1),ropePointD:new t(.7,.2,.4)};
},{}],"stUN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Shape=exports.b2ShapeType=exports.b2MassData=void 0;const e=require("../common/b2_math");class t{constructor(){this.mass=0,this.center=new e.b2Vec2,this.I=0}}var s;exports.b2MassData=t,function(e){e[e.e_unknown=-1]="e_unknown",e[e.e_circle=0]="e_circle",e[e.e_edge=1]="e_edge",e[e.e_polygon=2]="e_polygon",e[e.e_chain=3]="e_chain",e[e.e_typeCount=4]="e_typeCount"}(s=exports.b2ShapeType||(exports.b2ShapeType={}));class r{constructor(e,t){this.m_radius=0,this.m_type=e,this.m_radius=t}Copy(e){return this.m_radius=e.m_radius,this}GetType(){return this.m_type}}exports.b2Shape=r;
},{"../common/b2_math":"cQbL"}],"hp9S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ShapeCast=exports.b2Distance=exports.b2Gjk=exports.b2ShapeCastOutput=exports.b2ShapeCastInput=exports.b2DistanceOutput=exports.b2DistanceInput=exports.b2SimplexCache=exports.b2DistanceProxy=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math");class s{constructor(){this.m_buffer=(0,t.b2MakeArray)(2,e.b2Vec2),this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0}Copy(t){return t.m_vertices===t.m_buffer?(this.m_vertices=this.m_buffer,this.m_buffer[0].Copy(t.m_buffer[0]),this.m_buffer[1].Copy(t.m_buffer[1])):this.m_vertices=t.m_vertices,this.m_count=t.m_count,this.m_radius=t.m_radius,this}Reset(){return this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0,this}SetShape(t,e){t.SetupDistanceProxy(this,e)}SetVerticesRadius(t,e,s){this.m_vertices=t,this.m_count=e,this.m_radius=s}GetSupport(t){let s=0,i=e.b2Vec2.Dot(this.m_vertices[0],t);for(let r=1;r<this.m_count;++r){const o=e.b2Vec2.Dot(this.m_vertices[r],t);o>i&&(s=r,i=o)}return s}GetSupportVertex(t){let s=0,i=e.b2Vec2.Dot(this.m_vertices[0],t);for(let r=1;r<this.m_count;++r){const o=e.b2Vec2.Dot(this.m_vertices[r],t);o>i&&(s=r,i=o)}return this.m_vertices[s]}GetVertexCount(){return this.m_count}GetVertex(t){return this.m_vertices[t]}}exports.b2DistanceProxy=s;class i{constructor(){this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}Reset(){return this.metric=0,this.count=0,this}}exports.b2SimplexCache=i;class r{constructor(){this.proxyA=new s,this.proxyB=new s,this.transformA=new e.b2Transform,this.transformB=new e.b2Transform,this.useRadii=!1}Reset(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this}}exports.b2DistanceInput=r;class o{constructor(){this.pointA=new e.b2Vec2,this.pointB=new e.b2Vec2,this.distance=0,this.iterations=0}Reset(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this}}exports.b2DistanceOutput=o;class c{constructor(){this.proxyA=new s,this.proxyB=new s,this.transformA=new e.b2Transform,this.transformB=new e.b2Transform,this.translationB=new e.b2Vec2}}exports.b2ShapeCastInput=c;class n{constructor(){this.point=new e.b2Vec2,this.normal=new e.b2Vec2,this.lambda=0,this.iterations=0}}exports.b2ShapeCastOutput=n,exports.b2Gjk={calls:0,iters:0,maxIters:0,reset(){this.calls=0,this.iters=0,this.maxIters=0}};class a{constructor(){this.wA=new e.b2Vec2,this.wB=new e.b2Vec2,this.w=new e.b2Vec2,this.a=0,this.indexA=0,this.indexB=0}Copy(t){return this.wA.Copy(t.wA),this.wB.Copy(t.wB),this.w.Copy(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB,this}}class h{constructor(){this.m_v1=new a,this.m_v2=new a,this.m_v3=new a,this.m_count=0,this.m_vertices=[this.m_v1,this.m_v2,this.m_v3]}ReadCache(s,i,r,o,c){this.m_count=s.count;const n=this.m_vertices;for(let t=0;t<this.m_count;++t){const a=n[t];a.indexA=s.indexA[t],a.indexB=s.indexB[t];const h=i.GetVertex(a.indexA),m=o.GetVertex(a.indexB);e.b2Transform.MultiplyVec2(r,h,a.wA),e.b2Transform.MultiplyVec2(c,m,a.wB),e.b2Vec2.Subtract(a.wB,a.wA,a.w),a.a=0}if(this.m_count>1){const e=s.metric,i=this.GetMetric();(i<.5*e||2*e<i||i<t.b2_epsilon)&&(this.m_count=0)}if(0===this.m_count){const t=n[0];t.indexA=0,t.indexB=0;const s=i.GetVertex(0),a=o.GetVertex(0);e.b2Transform.MultiplyVec2(r,s,t.wA),e.b2Transform.MultiplyVec2(c,a,t.wB),e.b2Vec2.Subtract(t.wB,t.wA,t.w),t.a=1,this.m_count=1}}WriteCache(t){t.metric=this.GetMetric(),t.count=this.m_count;const e=this.m_vertices;for(let s=0;s<this.m_count;++s)t.indexA[s]=e[s].indexA,t.indexB[s]=e[s].indexB}GetSearchDirection(t){switch(this.m_count){case 1:return e.b2Vec2.Negate(this.m_v1.w,t);case 2:{const s=e.b2Vec2.Subtract(this.m_v2.w,this.m_v1.w,t);return e.b2Vec2.Cross(s,e.b2Vec2.Negate(this.m_v1.w,e.b2Vec2.s_t0))>0?e.b2Vec2.CrossOneVec2(s,t):e.b2Vec2.CrossVec2One(s,t)}default:return t.SetZero()}}GetClosestPoint(t){switch(this.m_count){case 0:return t.SetZero();case 1:return t.Copy(this.m_v1.w);case 2:return t.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:default:return t.SetZero()}}GetWitnessPoints(t,e){switch(this.m_count){case 0:break;case 1:t.Copy(this.m_v1.wA),e.Copy(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y}}GetMetric(){switch(this.m_count){case 0:case 1:return 0;case 2:return e.b2Vec2.Distance(this.m_v1.w,this.m_v2.w);case 3:return e.b2Vec2.Cross(e.b2Vec2.Subtract(this.m_v2.w,this.m_v1.w,e.b2Vec2.s_t0),e.b2Vec2.Subtract(this.m_v3.w,this.m_v1.w,e.b2Vec2.s_t1));default:return 0}}Solve2(){const t=this.m_v1.w,s=this.m_v2.w,i=e.b2Vec2.Subtract(s,t,h.s_e12),r=-e.b2Vec2.Dot(t,i);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);const o=e.b2Vec2.Dot(s,i);if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);const c=1/(o+r);this.m_v1.a=o*c,this.m_v2.a=r*c,this.m_count=2}Solve3(){const t=this.m_v1.w,s=this.m_v2.w,i=this.m_v3.w,r=e.b2Vec2.Subtract(s,t,h.s_e12),o=e.b2Vec2.Dot(t,r),c=e.b2Vec2.Dot(s,r),n=-o,a=e.b2Vec2.Subtract(i,t,h.s_e13),m=e.b2Vec2.Dot(t,a),_=e.b2Vec2.Dot(i,a),u=-m,b=e.b2Vec2.Subtract(i,s,h.s_e23),p=e.b2Vec2.Dot(s,b),v=e.b2Vec2.Dot(i,b),V=-p,w=e.b2Vec2.Cross(r,a),x=w*e.b2Vec2.Cross(s,i),l=w*e.b2Vec2.Cross(i,t),d=w*e.b2Vec2.Cross(t,s);if(n<=0&&u<=0)return this.m_v1.a=1,void(this.m_count=1);if(c>0&&n>0&&d<=0){const t=1/(c+n);return this.m_v1.a=c*t,this.m_v2.a=n*t,void(this.m_count=2)}if(_>0&&u>0&&l<=0){const t=1/(_+u);return this.m_v1.a=_*t,this.m_v3.a=u*t,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(c<=0&&V<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(_<=0&&v<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(v>0&&V>0&&x<=0){const t=1/(v+V);return this.m_v2.a=v*t,this.m_v3.a=V*t,this.m_count=2,void this.m_v1.Copy(this.m_v3)}const f=1/(x+l+d);this.m_v1.a=x*f,this.m_v2.a=l*f,this.m_v3.a=d*f,this.m_count=3}}h.s_e12=new e.b2Vec2,h.s_e13=new e.b2Vec2,h.s_e23=new e.b2Vec2;const m=new h,_=[0,0,0],u=[0,0,0],b=new e.b2Vec2,p=new e.b2Vec2,v=new e.b2Vec2,V=new e.b2Vec2,w=new e.b2Vec2;function x(s,i,r){++exports.b2Gjk.calls;const{proxyA:o,proxyB:c,transformA:n,transformB:a}=r,h=m;h.ReadCache(i,o,n,c,a);const x=h.m_vertices,l=_,d=u;let f=0,y=0;for(;y<20;){f=h.m_count;for(let t=0;t<f;++t)l[t]=x[t].indexA,d[t]=x[t].indexB;switch(h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3()}if(3===h.m_count)break;const s=h.GetSearchDirection(p);if(s.LengthSquared()<t.b2_epsilon_sq)break;const i=x[h.m_count];i.indexA=o.GetSupport(e.b2Rot.TransposeMultiplyVec2(n.q,e.b2Vec2.Negate(s,e.b2Vec2.s_t0),V)),e.b2Transform.MultiplyVec2(n,o.GetVertex(i.indexA),i.wA),i.indexB=c.GetSupport(e.b2Rot.TransposeMultiplyVec2(a.q,s,w)),e.b2Transform.MultiplyVec2(a,c.GetVertex(i.indexB),i.wB),e.b2Vec2.Subtract(i.wB,i.wA,i.w),++y,++exports.b2Gjk.iters;let r=!1;for(let t=0;t<f;++t)if(i.indexA===l[t]&&i.indexB===d[t]){r=!0;break}if(r)break;++h.m_count}if(exports.b2Gjk.maxIters=Math.max(exports.b2Gjk.maxIters,y),h.GetWitnessPoints(s.pointA,s.pointB),s.distance=e.b2Vec2.Distance(s.pointA,s.pointB),s.iterations=y,h.WriteCache(i),r.useRadii){const i=o.m_radius,r=c.m_radius;if(s.distance>i+r&&s.distance>t.b2_epsilon){s.distance-=i+r;const t=e.b2Vec2.Subtract(s.pointB,s.pointA,v);t.Normalize(),s.pointA.AddScaled(i,t),s.pointB.SubtractScaled(r,t)}else{const t=e.b2Vec2.Mid(s.pointA,s.pointB,b);s.pointA.Copy(t),s.pointB.Copy(t),s.distance=0}}}exports.b2Distance=x;const l=new e.b2Vec2,d=new h,f=new e.b2Vec2,y=new e.b2Vec2,S=new e.b2Vec2,A=new e.b2Vec2,B=new e.b2Vec2,C=new e.b2Vec2;function G(s,i){s.iterations=0,s.lambda=1,s.normal.SetZero(),s.point.SetZero();const{proxyA:r,proxyB:o}=i,c=Math.max(r.m_radius,t.b2_polygonRadius),n=c+Math.max(o.m_radius,t.b2_polygonRadius),a=i.transformA,h=i.transformB,m=i.translationB,_=l.SetZero();let u=0;const b=d;b.m_count=0;const p=b.m_vertices;let v=r.GetSupport(e.b2Rot.TransposeMultiplyVec2(a.q,e.b2Vec2.Negate(m,e.b2Vec2.s_t1),e.b2Vec2.s_t0)),V=e.b2Transform.MultiplyVec2(a,r.GetVertex(v),f),w=o.GetSupport(e.b2Rot.TransposeMultiplyVec2(h.q,m,e.b2Vec2.s_t0)),x=e.b2Transform.MultiplyVec2(h,o.GetVertex(w),y);const G=e.b2Vec2.Subtract(V,x,S),D=Math.max(t.b2_polygonRadius,n-t.b2_polygonRadius),M=.5*t.b2_linearSlop;let R=0;for(;R<20&&G.Length()-D>M;){s.iterations+=1,v=r.GetSupport(e.b2Rot.TransposeMultiplyVec2(a.q,e.b2Vec2.Negate(G,e.b2Vec2.s_t1),e.b2Vec2.s_t0)),V=e.b2Transform.MultiplyVec2(a,r.GetVertex(v),f),w=o.GetSupport(e.b2Rot.TransposeMultiplyVec2(h.q,G,e.b2Vec2.s_t0)),x=e.b2Transform.MultiplyVec2(h,o.GetVertex(w),y);const t=e.b2Vec2.Subtract(V,x,A);G.Normalize();const i=e.b2Vec2.Dot(G,t),c=e.b2Vec2.Dot(G,m);if(i-D>u*c){if(c<=0)return!1;if((u=(i-D)/c)>1)return!1;e.b2Vec2.Negate(G,_),b.m_count=0}const n=p[b.m_count];switch(n.indexA=w,e.b2Vec2.AddScaled(x,u,m,n.wA),n.indexB=v,n.wB.Copy(V),e.b2Vec2.Subtract(n.wB,n.wA,n.w),n.a=1,b.m_count+=1,b.m_count){case 1:break;case 2:b.Solve2();break;case 3:b.Solve3()}if(3===b.m_count)return!1;b.GetClosestPoint(G),++R}if(0===R)return!1;const T=B,k=C;return b.GetWitnessPoints(T,k),G.LengthSquared()>0&&(e.b2Vec2.Negate(G,_),_.Normalize()),e.b2Vec2.AddScaled(T,c,_,s.point),s.normal.Copy(_),s.lambda=u,s.iterations=R,!0}exports.b2ShapeCast=G;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL"}],"PKgf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2TestOverlap=exports.b2ClipSegmentToLine=exports.b2AABB=exports.b2RayCastOutput=exports.b2RayCastInput=exports.b2ClipVertex=exports.b2GetPointStates=exports.b2PointState=exports.b2WorldManifold=exports.b2Manifold=exports.b2ManifoldType=exports.b2ManifoldPoint=exports.b2ContactID=exports.b2ContactFeature=exports.b2ContactFeatureType=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),i=require("./b2_distance");var o,n,s;!function(t){t[t.e_vertex=0]="e_vertex",t[t.e_face=1]="e_face"}(o=exports.b2ContactFeatureType||(exports.b2ContactFeatureType={}));class r{constructor(){this.m_key=0,this.m_key_invalid=!1,this.m_indexA=0,this.m_indexB=0,this.m_typeA=o.e_vertex,this.m_typeB=o.e_vertex}get key(){return this.m_key_invalid&&(this.m_key_invalid=!1,this.m_key=this.m_indexA|this.m_indexB<<8|this.m_typeA<<16|this.m_typeB<<24),this.m_key}set key(t){this.m_key=t,this.m_key_invalid=!1,this.m_indexA=255&this.m_key,this.m_indexB=this.m_key>>8&255,this.m_typeA=this.m_key>>16&255,this.m_typeB=this.m_key>>24&255}get indexA(){return this.m_indexA}set indexA(t){this.m_indexA=t,this.m_key_invalid=!0}get indexB(){return this.m_indexB}set indexB(t){this.m_indexB=t,this.m_key_invalid=!0}get typeA(){return this.m_typeA}set typeA(t){this.m_typeA=t,this.m_key_invalid=!0}get typeB(){return this.m_typeB}set typeB(t){this.m_typeB=t,this.m_key_invalid=!0}}exports.b2ContactFeature=r;class a{constructor(){this.cf=new r}Copy(t){return this.key=t.key,this}Clone(){return(new a).Copy(this)}get key(){return this.cf.key}set key(t){this.cf.key=t}}exports.b2ContactID=a;class p{constructor(){this.localPoint=new e.b2Vec2,this.normalImpulse=0,this.tangentImpulse=0,this.id=new a}Reset(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0}Copy(t){return this.localPoint.Copy(t.localPoint),this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.Copy(t.id),this}}exports.b2ManifoldPoint=p,function(t){t[t.e_circles=0]="e_circles",t[t.e_faceA=1]="e_faceA",t[t.e_faceB=2]="e_faceB"}(n=exports.b2ManifoldType||(exports.b2ManifoldType={}));class l{constructor(){this.points=(0,t.b2MakeArray)(t.b2_maxManifoldPoints,p),this.localNormal=new e.b2Vec2,this.localPoint=new e.b2Vec2,this.type=n.e_circles,this.pointCount=0}Reset(){for(let e=0;e<t.b2_maxManifoldPoints;++e)this.points[e].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=n.e_circles,this.pointCount=0}Copy(e){this.pointCount=e.pointCount;for(let i=0;i<t.b2_maxManifoldPoints;++i)this.points[i].Copy(e.points[i]);return this.localNormal.Copy(e.localNormal),this.localPoint.Copy(e.localPoint),this.type=e.type,this}Clone(){return(new l).Copy(this)}}exports.b2Manifold=l;class u{constructor(){this.normal=new e.b2Vec2,this.points=(0,t.b2MakeArray)(t.b2_maxManifoldPoints,e.b2Vec2),this.separations=(0,t.b2MakeNumberArray)(t.b2_maxManifoldPoints)}Initialize(i,o,s,r,a){if(0!==i.pointCount)switch(i.type){case n.e_circles:{this.normal.Set(1,0);const n=e.b2Transform.MultiplyVec2(o,i.localPoint,u.Initialize_s_pointA),p=e.b2Transform.MultiplyVec2(r,i.points[0].localPoint,u.Initialize_s_pointB);e.b2Vec2.DistanceSquared(n,p)>t.b2_epsilon_sq&&e.b2Vec2.Subtract(p,n,this.normal).Normalize();const l=e.b2Vec2.AddScaled(n,s,this.normal,u.Initialize_s_cA),c=e.b2Vec2.SubtractScaled(p,a,this.normal,u.Initialize_s_cB);e.b2Vec2.Mid(l,c,this.points[0]),this.separations[0]=e.b2Vec2.Dot(e.b2Vec2.Subtract(c,l,e.b2Vec2.s_t0),this.normal);break}case n.e_faceA:{e.b2Rot.MultiplyVec2(o.q,i.localNormal,this.normal);const t=e.b2Transform.MultiplyVec2(o,i.localPoint,u.Initialize_s_planePoint);for(let o=0;o<i.pointCount;++o){const n=e.b2Transform.MultiplyVec2(r,i.points[o].localPoint,u.Initialize_s_clipPoint),p=s-e.b2Vec2.Dot(e.b2Vec2.Subtract(n,t,e.b2Vec2.s_t0),this.normal),l=e.b2Vec2.AddScaled(n,p,this.normal,u.Initialize_s_cA),c=e.b2Vec2.SubtractScaled(n,a,this.normal,u.Initialize_s_cB);e.b2Vec2.Mid(l,c,this.points[o]),this.separations[o]=e.b2Vec2.Dot(e.b2Vec2.Subtract(c,l,e.b2Vec2.s_t0),this.normal)}break}case n.e_faceB:{e.b2Rot.MultiplyVec2(r.q,i.localNormal,this.normal);const t=e.b2Transform.MultiplyVec2(r,i.localPoint,u.Initialize_s_planePoint);for(let n=0;n<i.pointCount;++n){const r=e.b2Transform.MultiplyVec2(o,i.points[n].localPoint,u.Initialize_s_clipPoint),p=a-e.b2Vec2.Dot(e.b2Vec2.Subtract(r,t,e.b2Vec2.s_t0),this.normal),l=e.b2Vec2.AddScaled(r,p,this.normal,u.Initialize_s_cB),c=e.b2Vec2.SubtractScaled(r,s,this.normal,u.Initialize_s_cA);e.b2Vec2.Mid(c,l,this.points[n]),this.separations[n]=e.b2Vec2.Dot(e.b2Vec2.Subtract(c,l,e.b2Vec2.s_t0),this.normal)}this.normal.Negate();break}}}}function c(e,i,o,n){let r;for(r=0;r<o.pointCount;++r){const{key:t}=o.points[r].id;e[r]=s.b2_removeState;for(let i=0;i<n.pointCount;++i)if(n.points[i].id.key===t){e[r]=s.b2_persistState;break}}for(;r<t.b2_maxManifoldPoints;++r)e[r]=s.b2_nullState;for(r=0;r<n.pointCount;++r){const{key:t}=n.points[r].id;i[r]=s.b2_addState;for(let e=0;e<o.pointCount;++e)if(o.points[e].id.key===t){i[r]=s.b2_persistState;break}}for(;r<t.b2_maxManifoldPoints;++r)i[r]=s.b2_nullState}exports.b2WorldManifold=u,u.Initialize_s_pointA=new e.b2Vec2,u.Initialize_s_pointB=new e.b2Vec2,u.Initialize_s_cA=new e.b2Vec2,u.Initialize_s_cB=new e.b2Vec2,u.Initialize_s_planePoint=new e.b2Vec2,u.Initialize_s_clipPoint=new e.b2Vec2,function(t){t[t.b2_nullState=0]="b2_nullState",t[t.b2_addState=1]="b2_addState",t[t.b2_persistState=2]="b2_persistState",t[t.b2_removeState=3]="b2_removeState"}(s=exports.b2PointState||(exports.b2PointState={})),exports.b2GetPointStates=c;class h{constructor(){this.v=new e.b2Vec2,this.id=new a}Copy(t){return this.v.Copy(t.v),this.id.Copy(t.id),this}}exports.b2ClipVertex=h;class d{constructor(){this.p1=new e.b2Vec2,this.p2=new e.b2Vec2,this.maxFraction=1}Copy(t){return this.p1.Copy(t.p1),this.p2.Copy(t.p2),this.maxFraction=t.maxFraction,this}}exports.b2RayCastInput=d;class b{constructor(){this.normal=new e.b2Vec2,this.fraction=0}Copy(t){return this.normal.Copy(t.normal),this.fraction=t.fraction,this}}exports.b2RayCastOutput=b;class y{constructor(){this.lowerBound=new e.b2Vec2,this.upperBound=new e.b2Vec2}Copy(t){return this.lowerBound.Copy(t.lowerBound),this.upperBound.Copy(t.upperBound),this}IsValid(){return this.lowerBound.IsValid()&&this.upperBound.IsValid()&&this.upperBound.x>=this.lowerBound.x&&this.upperBound.y>=this.lowerBound.y}GetCenter(t){return e.b2Vec2.Mid(this.lowerBound,this.upperBound,t)}GetExtents(t){return e.b2Vec2.Extents(this.lowerBound,this.upperBound,t)}GetPerimeter(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))}Combine1(t){return this.lowerBound.x=Math.min(this.lowerBound.x,t.lowerBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,t.lowerBound.y),this.upperBound.x=Math.max(this.upperBound.x,t.upperBound.x),this.upperBound.y=Math.max(this.upperBound.y,t.upperBound.y),this}Combine2(t,e){return this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y),this}static Combine(t,e,i){return i.Combine2(t,e),i}Contains(t){return this.lowerBound.x<=t.lowerBound.x&&this.lowerBound.y<=t.lowerBound.y&&t.upperBound.x<=this.upperBound.x&&t.upperBound.y<=this.upperBound.y}RayCast(e,i){let o=-t.b2_maxFloat,n=t.b2_maxFloat;const s=i.p1.x,r=i.p1.y,a=i.p2.x-i.p1.x,p=i.p2.y-i.p1.y,l=Math.abs(a),u=Math.abs(p),{normal:c}=e;if(l<t.b2_epsilon){if(s<this.lowerBound.x||this.upperBound.x<s)return!1}else{const t=1/a;let e=(this.lowerBound.x-s)*t,i=(this.upperBound.x-s)*t,r=-1;if(e>i){const t=e;e=i,i=t,r=1}if(e>o&&(c.x=r,c.y=0,o=e),o>(n=Math.min(n,i)))return!1}if(u<t.b2_epsilon){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else{const t=1/p;let e=(this.lowerBound.y-r)*t,i=(this.upperBound.y-r)*t,s=-1;if(e>i){const t=e;e=i,i=t,s=1}if(e>o&&(c.x=0,c.y=s,o=e),o>(n=Math.min(n,i)))return!1}return!(o<0||i.maxFraction<o)&&(e.fraction=o,!0)}TestContain(t){return!(t.x<this.lowerBound.x||this.upperBound.x<t.x)&&!(t.y<this.lowerBound.y||this.upperBound.y<t.y)}TestOverlap(t){return!(this.upperBound.x<t.lowerBound.x)&&(!(this.upperBound.y<t.lowerBound.y)&&(!(t.upperBound.x<this.lowerBound.x)&&!(t.upperBound.y<this.lowerBound.y)))}}function _(t,[i,n],s,r,a){let p=0;const l=e.b2Vec2.Dot(s,i.v)-r,u=e.b2Vec2.Dot(s,n.v)-r;if(l<=0&&t[p++].Copy(i),u<=0&&t[p++].Copy(n),l*u<0){const e=l/(l-u),{v:s,id:r}=t[p];s.x=i.v.x+e*(n.v.x-i.v.x),s.y=i.v.y+e*(n.v.y-i.v.y),r.cf.indexA=a,r.cf.indexB=i.id.cf.indexB,r.cf.typeA=o.e_vertex,r.cf.typeB=o.e_face,++p}return p}exports.b2AABB=y,exports.b2ClipSegmentToLine=_;const m=new i.b2DistanceInput,x=new i.b2SimplexCache,B=new i.b2DistanceOutput;function f(e,o,n,s,r,a){const p=m.Reset();p.proxyA.SetShape(e,o),p.proxyB.SetShape(n,s),p.transformA.Copy(r),p.transformB.Copy(a),p.useRadii=!0;const l=x.Reset();l.count=0;const u=B.Reset();return(0,i.b2Distance)(u,l,p),u.distance<10*t.b2_epsilon}exports.b2TestOverlap=f;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_distance":"hp9S"}],"IcdW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Fixture=exports.b2FixtureProxy=exports.b2DefaultFilter=void 0;const t=require("../common/b2_math"),e=require("../collision/b2_collision"),s=require("../collision/b2_shape"),i=require("../common/b2_common"),r=require("../common/b2_settings"),o={c1:new t.b2Vec2,c2:new t.b2Vec2};exports.b2DefaultFilter={categoryBits:1,maskBits:65535,groupIndex:0};class n{constructor(t,s,i,r){this.aabb=new e.b2AABB,this.fixture=t,this.childIndex=r,t.m_shape.ComputeAABB(this.aabb,i,r),this.treeNode=s.CreateProxy(this.aabb,this)}}exports.b2FixtureProxy=n;const h=new e.b2AABB,a=new e.b2AABB,m=new t.b2Vec2;class u{constructor(t,e){var s,i,o,n,h;this.m_density=0,this.m_next=null,this.m_friction=0,this.m_restitution=0,this.m_restitutionThreshold=0,this.m_proxies=[],this.m_isSensor=!1,this.m_userData=null,this.m_body=t,this.m_shape=e.shape.Clone(),this.m_userData=e.userData,this.m_friction=null!==(s=e.friction)&&void 0!==s?s:.2,this.m_restitution=null!==(i=e.restitution)&&void 0!==i?i:0,this.m_restitutionThreshold=null!==(o=e.restitutionThreshold)&&void 0!==o?o:r.b2_lengthUnitsPerMeter,this.m_filter={...exports.b2DefaultFilter,...e.filter},this.m_isSensor=null!==(n=e.isSensor)&&void 0!==n&&n,this.m_density=null!==(h=e.density)&&void 0!==h?h:0}get m_proxyCount(){return this.m_proxies.length}GetType(){return this.m_shape.GetType()}GetShape(){return this.m_shape}SetSensor(t){t!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=t)}IsSensor(){return this.m_isSensor}SetFilterData(t){var e,s,i;this.m_filter.categoryBits=null!==(e=t.categoryBits)&&void 0!==e?e:exports.b2DefaultFilter.categoryBits,this.m_filter.groupIndex=null!==(s=t.groupIndex)&&void 0!==s?s:exports.b2DefaultFilter.groupIndex,this.m_filter.maskBits=null!==(i=t.maskBits)&&void 0!==i?i:exports.b2DefaultFilter.maskBits,this.Refilter()}GetFilterData(){return this.m_filter}Refilter(){let t=this.m_body.GetContactList();for(;t;){const{contact:e}=t,s=e.GetFixtureA(),i=e.GetFixtureB();s!==this&&i!==this||e.FlagForFiltering(),t=t.next}const e=this.m_body.GetWorld().m_contactManager.m_broadPhase;for(const s of this.m_proxies)e.TouchProxy(s.treeNode)}GetBody(){return this.m_body}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}TestPoint(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)}RayCast(t,e,s){return this.m_shape.RayCast(t,e,this.m_body.GetTransform(),s)}GetMassData(t=new s.b2MassData){return this.m_shape.ComputeMass(t,this.m_density),t}SetDensity(t){this.m_density=t}GetDensity(){return this.m_density}GetFriction(){return this.m_friction}SetFriction(t){this.m_friction=t}GetRestitution(){return this.m_restitution}SetRestitution(t){this.m_restitution=t}SetRestitutionThreshold(t){this.m_restitutionThreshold=t}GetAABB(t){return this.m_proxies[t].aabb}CreateProxies(t,e){(0,i.b2Assert)(0===this.m_proxies.length),this.m_proxies.length=this.m_shape.GetChildCount();for(let s=0;s<this.m_proxies.length;++s)this.m_proxies[s]=new n(this,t,e,s)}DestroyProxies(t){for(const e of this.m_proxies)t.DestroyProxy(e.treeNode);this.m_proxies.length=0}Synchronize(e,s,i){const{c1:r,c2:n}=o,u=m;for(const o of this.m_proxies){const m=h,l=a;this.m_shape.ComputeAABB(m,s,o.childIndex),this.m_shape.ComputeAABB(l,i,o.childIndex),o.aabb.Combine2(m,l),t.b2Vec2.Subtract(l.GetCenter(n),m.GetCenter(r),u),e.MoveProxy(o.treeNode,o.aabb,u)}}}exports.b2Fixture=u;
},{"../common/b2_math":"cQbL","../collision/b2_collision":"PKgf","../collision/b2_shape":"stUN","../common/b2_common":"ReKW","../common/b2_settings":"I6oK"}],"rONj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Body=exports.b2BodyType=void 0;const t=require("../common/b2_math"),e=require("../collision/b2_shape"),s=require("./b2_fixture"),i=require("../common/b2_common");var a;!function(t){t[t.b2_staticBody=0]="b2_staticBody",t[t.b2_kinematicBody=1]="b2_kinematicBody",t[t.b2_dynamicBody=2]="b2_dynamicBody"}(a=exports.b2BodyType||(exports.b2BodyType={}));class m{constructor(e,s){var i,m,_,r,o,n,h,l,c,p,u,y,d,w;this.m_type=a.b2_staticBody,this.m_islandFlag=!1,this.m_awakeFlag=!1,this.m_autoSleepFlag=!1,this.m_bulletFlag=!1,this.m_fixedRotationFlag=!1,this.m_enabledFlag=!1,this.m_toiFlag=!1,this.m_islandIndex=0,this.m_xf=new t.b2Transform,this.m_sweep=new t.b2Sweep,this.m_linearVelocity=new t.b2Vec2,this.m_angularVelocity=0,this.m_force=new t.b2Vec2,this.m_torque=0,this.m_prev=null,this.m_next=null,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_jointList=null,this.m_contactList=null,this.m_mass=1,this.m_invMass=1,this.m_I=0,this.m_invI=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_gravityScale=1,this.m_sleepTime=0,this.m_userData=null,this.m_bulletFlag=null!==(i=e.bullet)&&void 0!==i&&i,this.m_fixedRotationFlag=null!==(m=e.fixedRotation)&&void 0!==m&&m,this.m_autoSleepFlag=null===(_=e.allowSleep)||void 0===_||_,null!==(r=e.awake)&&void 0!==r&&!r||(null!==(o=e.type)&&void 0!==o?o:a.b2_staticBody)===a.b2_staticBody||(this.m_awakeFlag=!0),this.m_enabledFlag=null===(n=e.enabled)||void 0===n||n,this.m_world=s,this.m_xf.p.Copy(null!==(h=e.position)&&void 0!==h?h:t.b2Vec2.ZERO),this.m_xf.q.Set(null!==(l=e.angle)&&void 0!==l?l:0),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a=this.m_xf.q.GetAngle(),this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(null!==(c=e.linearVelocity)&&void 0!==c?c:t.b2Vec2.ZERO),this.m_angularVelocity=null!==(p=e.angularVelocity)&&void 0!==p?p:0,this.m_linearDamping=null!==(u=e.linearDamping)&&void 0!==u?u:0,this.m_angularDamping=null!==(y=e.angularDamping)&&void 0!==y?y:0,this.m_gravityScale=null!==(d=e.gravityScale)&&void 0!==d?d:1,this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=null!==(w=e.type)&&void 0!==w?w:a.b2_staticBody,this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}CreateFixture(t){(0,i.b2Assert)(!this.m_world.IsLocked());const e=new s.b2Fixture(this,t);if(this.m_enabledFlag){const t=this.m_world.m_contactManager.m_broadPhase;e.CreateProxies(t,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_density>0&&this.ResetMassData(),this.m_world.m_newContacts=!0,e}DestroyFixture(t){(0,i.b2Assert)(!this.m_world.IsLocked());let e=this.m_fixtureList,s=null;for(;null!==e;){if(e===t){s?s.m_next=t.m_next:this.m_fixtureList=t.m_next;break}s=e,e=e.m_next}let a=this.m_contactList;for(;a;){const e=a.contact;a=a.next;const s=e.GetFixtureA(),i=e.GetFixtureB();t!==s&&t!==i||this.m_world.m_contactManager.Destroy(e)}if(this.m_enabledFlag){const e=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxies(e)}t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}SetTransformVec(t,e){this.SetTransformXY(t.x,t.y,e)}SetTransformXY(e,s,a){(0,i.b2Assert)(!this.m_world.IsLocked()),this.m_xf.q.Set(a),this.m_xf.p.Set(e,s),t.b2Transform.MultiplyVec2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=a,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=a;const m=this.m_world.m_contactManager.m_broadPhase;for(let t=this.m_fixtureList;t;t=t.m_next)t.Synchronize(m,this.m_xf,this.m_xf);this.m_world.m_newContacts=!0}SetTransform(t){this.SetTransformVec(t.p,t.GetAngle())}GetTransform(){return this.m_xf}GetPosition(){return this.m_xf.p}GetAngle(){return this.m_sweep.a}SetAngle(t){this.SetTransformVec(this.GetPosition(),t)}GetWorldCenter(){return this.m_sweep.c}GetLocalCenter(){return this.m_sweep.localCenter}SetLinearVelocity(e){this.m_type!==a.b2_staticBody&&(t.b2Vec2.Dot(e,e)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(e))}GetLinearVelocity(){return this.m_linearVelocity}SetAngularVelocity(t){this.m_type!==a.b2_staticBody&&(t*t>0&&this.SetAwake(!0),this.m_angularVelocity=t)}GetAngularVelocity(){return this.m_angularVelocity}ApplyForce(t,e,s=!0){this.m_type===a.b2_dynamicBody&&(s&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))}ApplyForceToCenter(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y))}ApplyTorque(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))}ApplyLinearImpulse(t,e,s=!0){this.m_type===a.b2_dynamicBody&&(s&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)))}ApplyLinearImpulseToCenter(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y))}ApplyAngularImpulse(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))}GetMass(){return this.m_mass}GetInertia(){return this.m_I+this.m_mass*t.b2Vec2.Dot(this.m_sweep.localCenter,this.m_sweep.localCenter)}GetMassData(e){return e.mass=this.m_mass,e.I=this.m_I+this.m_mass*t.b2Vec2.Dot(this.m_sweep.localCenter,this.m_sweep.localCenter),e.center.Copy(this.m_sweep.localCenter),e}SetMassData(e){if((0,i.b2Assert)(!this.m_world.IsLocked()),this.m_type!==a.b2_dynamicBody)return;this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&!this.m_fixedRotationFlag&&(this.m_I=e.I-this.m_mass*t.b2Vec2.Dot(e.center,e.center),this.m_invI=1/this.m_I);const s=m.SetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e.center),t.b2Transform.MultiplyVec2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(this.m_sweep.c,s,t.b2Vec2.s_t0),this.m_linearVelocity)}ResetMassData(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===a.b2_staticBody||this.m_type===a.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);const e=m.ResetMassData_s_localCenter.SetZero();for(let t=this.m_fixtureList;t;t=t.m_next){if(0===t.m_density)continue;const s=t.GetMassData(m.ResetMassData_s_massData);this.m_mass+=s.mass,e.AddScaled(s.mass,s.center),this.m_I+=s.I}this.m_mass>0&&(this.m_invMass=1/this.m_mass,e.Scale(this.m_invMass)),this.m_I>0&&!this.m_fixedRotationFlag?(this.m_I-=this.m_mass*t.b2Vec2.Dot(e,e),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);const s=m.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e),t.b2Transform.MultiplyVec2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(this.m_sweep.c,s,t.b2Vec2.s_t0),this.m_linearVelocity)}GetWorldPoint(e,s){return t.b2Transform.MultiplyVec2(this.m_xf,e,s)}GetWorldVector(e,s){return t.b2Rot.MultiplyVec2(this.m_xf.q,e,s)}GetLocalPoint(e,s){return t.b2Transform.TransposeMultiplyVec2(this.m_xf,e,s)}GetLocalVector(e,s){return t.b2Rot.TransposeMultiplyVec2(this.m_xf.q,e,s)}GetLinearVelocityFromWorldPoint(e,s){return t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(e,this.m_sweep.c,t.b2Vec2.s_t0),s)}GetLinearVelocityFromLocalPoint(t,e){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t,e),e)}GetLinearDamping(){return this.m_linearDamping}SetLinearDamping(t){this.m_linearDamping=t}GetAngularDamping(){return this.m_angularDamping}SetAngularDamping(t){this.m_angularDamping=t}GetGravityScale(){return this.m_gravityScale}SetGravityScale(t){this.m_gravityScale=t}SetType(t){if((0,i.b2Assert)(!this.m_world.IsLocked()),this.m_type===t)return;this.m_type=t,this.ResetMassData(),this.m_type===a.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_awakeFlag=!1,this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;let e=this.m_contactList;for(;e;){const t=e;e=e.next,this.m_world.m_contactManager.Destroy(t.contact)}this.m_contactList=null;const s=this.m_world.m_contactManager.m_broadPhase;for(let i=this.m_fixtureList;i;i=i.m_next)for(const t of i.m_proxies)s.TouchProxy(t.treeNode)}GetType(){return this.m_type}SetBullet(t){this.m_bulletFlag=t}IsBullet(){return this.m_bulletFlag}SetSleepingAllowed(t){this.m_autoSleepFlag=t,t||this.SetAwake(!0)}IsSleepingAllowed(){return this.m_autoSleepFlag}SetAwake(t){this.m_type!==a.b2_staticBody&&(t?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0))}IsAwake(){return this.m_awakeFlag}SetEnabled(t){if((0,i.b2Assert)(!this.m_world.IsLocked()),t===this.IsEnabled())return;this.m_enabledFlag=t;const e=this.m_world.m_contactManager.m_broadPhase;if(t){for(let t=this.m_fixtureList;t;t=t.m_next)t.CreateProxies(e,this.m_xf);this.m_world.m_newContacts=!0}else{for(let s=this.m_fixtureList;s;s=s.m_next)s.DestroyProxies(e);let t=this.m_contactList;for(;t;){const e=t;t=t.next,this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null}}IsEnabled(){return this.m_enabledFlag}SetFixedRotation(t){this.m_fixedRotationFlag!==t&&(this.m_fixedRotationFlag=t,this.m_angularVelocity=0,this.ResetMassData())}IsFixedRotation(){return this.m_fixedRotationFlag}GetFixtureList(){return this.m_fixtureList}GetJointList(){return this.m_jointList}GetContactList(){return this.m_contactList}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}GetWorld(){return this.m_world}SynchronizeFixtures(){const e=this.m_world.m_contactManager.m_broadPhase;if(this.m_awakeFlag){const s=m.SynchronizeFixtures_s_xf1;s.q.Set(this.m_sweep.a0),t.b2Rot.MultiplyVec2(s.q,this.m_sweep.localCenter,s.p),t.b2Vec2.Subtract(this.m_sweep.c0,s.p,s.p);for(let t=this.m_fixtureList;t;t=t.m_next)t.Synchronize(e,s,this.m_xf)}else for(let t=this.m_fixtureList;t;t=t.m_next)t.Synchronize(e,this.m_xf,this.m_xf)}SynchronizeTransform(){this.m_xf.q.Set(this.m_sweep.a),t.b2Rot.MultiplyVec2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),t.b2Vec2.Subtract(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}ShouldCollide(t){return(this.m_type===a.b2_dynamicBody||t.m_type===a.b2_dynamicBody)&&this.ShouldCollideConnected(t)}ShouldCollideConnected(t){for(let e=this.m_jointList;e;e=e.next)if(e.other===t&&!e.joint.m_collideConnected)return!1;return!0}Advance(e){this.m_sweep.Advance(e),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.Set(this.m_sweep.a),t.b2Rot.MultiplyVec2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),t.b2Vec2.Subtract(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}}exports.b2Body=m,m.SetMassData_s_oldCenter=new t.b2Vec2,m.ResetMassData_s_localCenter=new t.b2Vec2,m.ResetMassData_s_oldCenter=new t.b2Vec2,m.ResetMassData_s_massData=new e.b2MassData,m.SynchronizeFixtures_s_xf1=new t.b2Transform;
},{"../common/b2_math":"cQbL","../collision/b2_shape":"stUN","./b2_fixture":"IcdW","../common/b2_common":"ReKW"}],"mgAn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawCenterOfMasses=exports.DrawAABBs=exports.DrawPairs=exports.DrawJoints=exports.DrawShapes=exports.GetShapeColor=void 0;const e=require("./b2_math"),t=require("./b2_draw"),o=require("../dynamics/b2_body"),r=require("./b2_common"),s={cA:new e.b2Vec2,cB:new e.b2Vec2,vs:(0,r.b2MakeArray)(4,e.b2Vec2),xf:new e.b2Transform};function n(e){return e.GetType()===o.b2BodyType.b2_dynamicBody&&0===e.m_mass?t.debugColors.badBody:e.IsEnabled()?e.GetType()===o.b2BodyType.b2_staticBody?t.debugColors.staticBody:e.GetType()===o.b2BodyType.b2_kinematicBody?t.debugColors.kinematicBody:e.IsAwake()?t.debugColors.body:t.debugColors.sleepingBody:t.debugColors.disabledBody}function a(e,t){for(let o=0;o<e.m_proxyCount;o++)if(t.TestOverlap(e.GetAABB(o)))return!0;return!1}function d(e,t,o){for(let r=t.GetBodyList();r;r=r.m_next){const t=r.m_xf;e.PushTransform(t);for(let s=r.GetFixtureList();s;s=s.m_next)o&&!a(s,o)||s.GetShape().Draw(e,n(r));e.PopTransform(t)}}function i(e,t){for(let o=t.GetJointList();o;o=o.m_next)o.Draw(e)}function p(e,o){for(let r=o.GetContactList();r;r=r.m_next){const o=r.GetFixtureA(),n=r.GetFixtureB(),a=r.GetChildIndexA(),d=r.GetChildIndexB(),i=o.GetAABB(a).GetCenter(s.cA),p=n.GetAABB(d).GetCenter(s.cB);e.DrawSegment(i,p,t.debugColors.pair)}}function u(e,o,r){const{vs:n}=s;for(let s=o.GetBodyList();s;s=s.m_next)if(s.IsEnabled())for(let o=s.GetFixtureList();o;o=o.m_next)for(let s=0;s<o.m_proxyCount;++s){const{aabb:a}=o.m_proxies[s].treeNode;r&&!r.TestOverlap(a)||(n[0].Set(a.lowerBound.x,a.lowerBound.y),n[1].Set(a.upperBound.x,a.lowerBound.y),n[2].Set(a.upperBound.x,a.upperBound.y),n[3].Set(a.lowerBound.x,a.upperBound.y),e.DrawPolygon(n,4,t.debugColors.aabb))}}function x(e,t){const{xf:o}=s;for(let r=t.GetBodyList();r;r=r.m_next)o.q.Copy(r.m_xf.q),o.p.Copy(r.GetWorldCenter()),e.DrawTransform(o)}exports.GetShapeColor=n,exports.DrawShapes=d,exports.DrawJoints=i,exports.DrawPairs=p,exports.DrawAABBs=u,exports.DrawCenterOfMasses=x;
},{"./b2_math":"cQbL","./b2_draw":"lvls","../dynamics/b2_body":"rONj","./b2_common":"ReKW"}],"ixAk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Timer=void 0;class e{constructor(){this.m_start=performance.now()}Reset(){return this.m_start=performance.now(),this}GetMilliseconds(){return performance.now()-this.m_start}}exports.b2Timer=e;
},{}],"KzIc":[function(require,module,exports) {
"use strict";function e(e,t){for(const n of Object.keys(t)){const o=t[n],r=e[n],s=function(...e){return o.call(this,r.bind(this),...e)};Object.defineProperty(s,"name",{value:n}),e[n]=s}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2_augment=void 0,exports.b2_augment=e;
},{}],"sfrf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2DynamicTree=exports.b2TreeNode=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),i=require("./b2_collision"),a={stack:[],t:new t.b2Vec2,r:new t.b2Vec2,v:new t.b2Vec2,abs_v:new t.b2Vec2,segmentAABB:new i.b2AABB,subInput:new i.b2RayCastInput,combinedAABB:new i.b2AABB,aabb:new i.b2AABB,fatAABB:new i.b2AABB,hugeAABB:new i.b2AABB,c:new t.b2Vec2,h:new t.b2Vec2};let h=0;class r{constructor(){this.aabb=new i.b2AABB,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=0,this.moved=!1,this.id=h++}Reset(){this.child1=null,this.child2=null,this.height=-1,this.userData=null}IsLeaf(){return null===this.child1}GetArea(){if(this.IsLeaf())return 0;let e=this.aabb.GetPerimeter();return this.child1&&(e+=this.child1.GetArea()),this.child2&&(e+=this.child2.GetArea()),e}ComputeHeight(){if(this.IsLeaf())return 0;(0,e.b2Assert)(null!==this.child1&&null!==this.child2);const t=(0,e.b2Verify)(this.child1).ComputeHeight(),i=(0,e.b2Verify)(this.child2).ComputeHeight();return 1+Math.max(t,i)}GetMaxBalance(){if(this.height<=1)return 0;const t=(0,e.b2Verify)(this.child1),i=(0,e.b2Verify)(this.child2);return Math.max(t.GetMaxBalance(),i.GetMaxBalance(),Math.abs(i.height-t.height))}ShiftOrigin(t){this.height<=1||((0,e.b2Verify)(this.child1).ShiftOrigin(t),(0,e.b2Verify)(this.child2).ShiftOrigin(t),this.aabb.lowerBound.Subtract(t),this.aabb.upperBound.Subtract(t))}}exports.b2TreeNode=r;class n{constructor(){this.m_root=null,this.m_freeList=null}Query(e,t){const i=a.stack;i.length=0;let h=this.m_root;for(;h;){if(h.aabb.TestOverlap(e))if(h.IsLeaf()){if(!t(h))return}else i.push(h.child1),i.push(h.child2);h=i.pop()}}QueryPoint(e,t){const i=a.stack;i.length=0;let h=this.m_root;for(;h;){if(h.aabb.TestContain(e))if(h.IsLeaf()){if(!t(h))return}else i.push(h.child1),i.push(h.child2);h=i.pop()}}RayCast(e,i){const{p1:h,p2:r}=e,n=t.b2Vec2.Subtract(r,h,a.r);n.Normalize();const b=t.b2Vec2.CrossOneVec2(n,a.v),o=b.GetAbs(a.abs_v);let{maxFraction:l}=e;const{segmentAABB:s,subInput:c,c:u,h:d,t:p}=a;t.b2Vec2.AddScaled(h,l,t.b2Vec2.Subtract(r,h,p),p),t.b2Vec2.Min(h,p,s.lowerBound),t.b2Vec2.Max(h,p,s.upperBound);const m=a.stack;m.length=0;let f=this.m_root;for(;f;){if(!f.aabb.TestOverlap(s)){f=m.pop();continue}if(f.aabb.GetCenter(u),f.aabb.GetExtents(d),Math.abs(t.b2Vec2.Dot(b,t.b2Vec2.Subtract(h,u,t.b2Vec2.s_t0)))-t.b2Vec2.Dot(o,d)>0)f=m.pop();else{if(f.IsLeaf()){c.p1.Copy(e.p1),c.p2.Copy(e.p2),c.maxFraction=l;const a=i(c,f);if(0===a)return;a>0&&(l=a,t.b2Vec2.AddScaled(h,l,t.b2Vec2.Subtract(r,h,p),p),t.b2Vec2.Min(h,p,s.lowerBound),t.b2Vec2.Max(h,p,s.upperBound))}else m.push(f.child1),m.push(f.child2);f=m.pop()}}}AllocateNode(){if(null===this.m_freeList)return new r;const e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e.height=0,e.moved=!1,e}FreeNode(e){e.parent=this.m_freeList,e.Reset(),this.m_freeList=e}CreateProxy(t,i){const a=this.AllocateNode(),h=e.b2_aabbExtension;return a.aabb.lowerBound.Set(t.lowerBound.x-h,t.lowerBound.y-h),a.aabb.upperBound.Set(t.upperBound.x+h,t.upperBound.y+h),a.userData=i,a.height=0,a.moved=!0,this.InsertLeaf(a),a}DestroyProxy(e){this.RemoveLeaf(e),this.FreeNode(e)}MoveProxy(t,i,h){const{fatAABB:r,hugeAABB:n}=a,b=e.b2_aabbExtension;r.lowerBound.Set(i.lowerBound.x-b,i.lowerBound.y-b),r.upperBound.Set(i.upperBound.x+b,i.upperBound.y+b);const o=e.b2_aabbMultiplier*h.x,l=e.b2_aabbMultiplier*h.y;o<0?r.lowerBound.x+=o:r.upperBound.x+=o,l<0?r.lowerBound.y+=l:r.upperBound.y+=l;const s=t.aabb;if(s.Contains(i)){const t=4*e.b2_aabbExtension;if(n.lowerBound.Set(r.lowerBound.x-t,i.lowerBound.y-t),n.upperBound.Set(r.upperBound.x+t,i.upperBound.y+t),n.Contains(s))return!1}return this.RemoveLeaf(t),t.aabb.Copy(r),this.InsertLeaf(t),t.moved=!0,!0}InsertLeaf(t){if(null===this.m_root)return this.m_root=t,void(this.m_root.parent=null);const{combinedAABB:i,aabb:h}=a,r=t.aabb;let n=this.m_root;for(;!n.IsLeaf();){const t=(0,e.b2Verify)(n.child1),a=(0,e.b2Verify)(n.child2),b=n.aabb.GetPerimeter();i.Combine2(n.aabb,r);const o=i.GetPerimeter(),l=2*o,s=2*(o-b);let c,u,d,p;if(t.IsLeaf()?(h.Combine2(r,t.aabb),c=h.GetPerimeter()+s):(h.Combine2(r,t.aabb),u=t.aabb.GetPerimeter(),c=(d=h.GetPerimeter())-u+s),a.IsLeaf()?(h.Combine2(r,a.aabb),p=h.GetPerimeter()+s):(h.Combine2(r,a.aabb),u=a.aabb.GetPerimeter(),p=(d=h.GetPerimeter())-u+s),l<c&&l<p)break;n=c<p?t:a}const b=n.parent,o=this.AllocateNode();o.parent=b,o.userData=null,o.aabb.Combine2(r,n.aabb),o.height=n.height+1,null!==b?(b.child1===n?b.child1=o:b.child2=o,o.child1=n,o.child2=t,n.parent=o,t.parent=o):(o.child1=n,o.child2=t,n.parent=o,t.parent=o,this.m_root=o);let l=t.parent;for(;null!==l;){l=this.Balance(l);const t=(0,e.b2Verify)(l.child1),i=(0,e.b2Verify)(l.child2);l.height=1+Math.max(t.height,i.height),l.aabb.Combine2(t.aabb,i.aabb),l=l.parent}}RemoveLeaf(t){if(t===this.m_root)return void(this.m_root=null);const i=(0,e.b2Verify)(t.parent),a=i.parent,h=(0,e.b2Verify)(i.child1===t?i.child2:i.child1);if(null!==a){a.child1===i?a.child1=h:a.child2=h,h.parent=a,this.FreeNode(i);let t=a;for(;null!==t;){t=this.Balance(t);const i=(0,e.b2Verify)(t.child1),a=(0,e.b2Verify)(t.child2);t.aabb.Combine2(i.aabb,a.aabb),t.height=1+Math.max(i.height,a.height),t=t.parent}}else this.m_root=h,h.parent=null,this.FreeNode(i)}Balance(t){if(t.IsLeaf()||t.height<2)return t;const i=(0,e.b2Verify)(t.child1),a=(0,e.b2Verify)(t.child2),h=a.height-i.height;if(h>1){const h=(0,e.b2Verify)(a.child1),r=(0,e.b2Verify)(a.child2);return a.child1=t,a.parent=t.parent,t.parent=a,null!==a.parent?a.parent.child1===t?a.parent.child1=a:a.parent.child2=a:this.m_root=a,h.height>r.height?(a.child2=h,t.child2=r,r.parent=t,t.aabb.Combine2(i.aabb,r.aabb),a.aabb.Combine2(t.aabb,h.aabb),t.height=1+Math.max(i.height,r.height),a.height=1+Math.max(t.height,h.height)):(a.child2=r,t.child2=h,h.parent=t,t.aabb.Combine2(i.aabb,h.aabb),a.aabb.Combine2(t.aabb,r.aabb),t.height=1+Math.max(i.height,h.height),a.height=1+Math.max(t.height,r.height)),a}if(h<-1){const h=(0,e.b2Verify)(i.child1),r=(0,e.b2Verify)(i.child2);return i.child1=t,i.parent=t.parent,t.parent=i,null!==i.parent?i.parent.child1===t?i.parent.child1=i:i.parent.child2=i:this.m_root=i,h.height>r.height?(i.child2=h,t.child1=r,r.parent=t,t.aabb.Combine2(a.aabb,r.aabb),i.aabb.Combine2(t.aabb,h.aabb),t.height=1+Math.max(a.height,r.height),i.height=1+Math.max(t.height,h.height)):(i.child2=r,t.child1=h,h.parent=t,t.aabb.Combine2(a.aabb,h.aabb),i.aabb.Combine2(t.aabb,r.aabb),t.height=1+Math.max(a.height,h.height),i.height=1+Math.max(t.height,r.height)),i}return t}GetHeight(){return null===this.m_root?0:this.m_root.height}GetAreaRatio(){if(null===this.m_root)return 0;const e=this.m_root,t=e.aabb.GetPerimeter();return e.GetArea()/t}GetMaxBalance(){return null===this.m_root?0:this.m_root.GetMaxBalance()}ShiftOrigin(e){var t;null===(t=this.m_root)||void 0===t||t.ShiftOrigin(e)}}exports.b2DynamicTree=n;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_collision":"PKgf"}],"q2ad":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2BroadPhase=void 0;const e=require("../common/b2_common"),t=require("./b2_dynamic_tree");class r{constructor(){this.m_tree=new t.b2DynamicTree,this.m_proxyCount=0,this.m_moveCount=0,this.m_moveBuffer=[],this.m_pairCount=0,this.m_pairBuffer=[],this.m_queryProxy=new t.b2TreeNode,this.QueryCallback=(e=>e.id===this.m_queryProxy.id||(!!(e.moved&&e.id>this.m_queryProxy.id)||(this.m_pairBuffer[this.m_pairCount]=e.id<this.m_queryProxy.id?[e,this.m_queryProxy]:[this.m_queryProxy,e],++this.m_pairCount,!0)))}CreateProxy(e,t){const r=this.m_tree.CreateProxy(e,t);return++this.m_proxyCount,this.BufferMove(r),r}DestroyProxy(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}MoveProxy(e,t,r){this.m_tree.MoveProxy(e,t,r)&&this.BufferMove(e)}TouchProxy(e){this.BufferMove(e)}GetProxyCount(){return this.m_proxyCount}UpdatePairs(t){this.m_pairCount=0;for(let e=0;e<this.m_moveCount;++e){const t=this.m_moveBuffer[e];if(null===t)continue;this.m_queryProxy=t;const r=t.aabb;this.m_tree.Query(r,this.QueryCallback)}for(let r=0;r<this.m_pairCount;++r){const o=this.m_pairBuffer[r];t((0,e.b2Verify)(o[0].userData),(0,e.b2Verify)(o[1].userData))}for(let e=0;e<this.m_moveCount;++e){const t=this.m_moveBuffer[e];t&&(t.moved=!1)}this.m_moveCount=0}Query(e,t){this.m_tree.Query(e,t)}QueryPoint(e,t){this.m_tree.QueryPoint(e,t)}RayCast(e,t){this.m_tree.RayCast(e,t)}GetTreeHeight(){return this.m_tree.GetHeight()}GetTreeBalance(){return this.m_tree.GetMaxBalance()}GetTreeQuality(){return this.m_tree.GetAreaRatio()}ShiftOrigin(e){this.m_tree.ShiftOrigin(e)}BufferMove(e){this.m_moveBuffer[this.m_moveCount]=e,++this.m_moveCount}UnBufferMove(e){const t=this.m_moveBuffer.indexOf(e);this.m_moveBuffer[t]=null}}exports.b2BroadPhase=r;
},{"../common/b2_common":"ReKW","./b2_dynamic_tree":"sfrf"}],"skt6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2TimeOfImpact=exports.b2TOIOutput=exports.b2TOIOutputState=exports.b2TOIInput=exports.b2Toi=void 0;const t=require("../common/b2_common"),e=require("../common/b2_settings"),s=require("../common/b2_math"),o=require("../common/b2_timer"),i=require("./b2_distance");exports.b2Toi={time:0,maxTime:0,calls:0,iters:0,maxIters:0,rootIters:0,maxRootIters:0,reset(){this.time=0,this.maxTime=0,this.calls=0,this.iters=0,this.maxIters=0,this.rootIters=0,this.maxRootIters=0}};const r=new s.b2Transform,a=new s.b2Transform,c=new s.b2Vec2,n=new s.b2Vec2,p=new s.b2Vec2,m=new s.b2Vec2,b=new s.b2Vec2;class _{constructor(){this.proxyA=new i.b2DistanceProxy,this.proxyB=new i.b2DistanceProxy,this.sweepA=new s.b2Sweep,this.sweepB=new s.b2Sweep,this.tMax=0}}var l,x;exports.b2TOIInput=_,function(t){t[t.e_unknown=0]="e_unknown",t[t.e_failed=1]="e_failed",t[t.e_overlapped=2]="e_overlapped",t[t.e_touching=3]="e_touching",t[t.e_separated=4]="e_separated"}(l=exports.b2TOIOutputState||(exports.b2TOIOutputState={}));class u{constructor(){this.state=l.e_unknown,this.t=0}}exports.b2TOIOutput=u,function(t){t[t.e_points=0]="e_points",t[t.e_faceA=1]="e_faceA",t[t.e_faceB=2]="e_faceB"}(x||(x={}));class V{constructor(){this.m_sweepA=new s.b2Sweep,this.m_sweepB=new s.b2Sweep,this.m_type=x.e_points,this.m_localPoint=new s.b2Vec2,this.m_axis=new s.b2Vec2}Initialize(t,e,o,i,m,b){this.m_proxyA=e,this.m_proxyB=i;const{count:_}=t;this.m_sweepA.Copy(o),this.m_sweepB.Copy(m);const l=this.m_sweepA.GetTransform(r,b),u=this.m_sweepB.GetTransform(a,b);if(1===_){this.m_type=x.e_points;const e=this.m_proxyA.GetVertex(t.indexA[0]),o=this.m_proxyB.GetVertex(t.indexB[0]),i=s.b2Transform.MultiplyVec2(l,e,c),r=s.b2Transform.MultiplyVec2(u,o,n);return s.b2Vec2.Subtract(r,i,this.m_axis),this.m_axis.Normalize()}if(t.indexA[0]===t.indexA[1]){this.m_type=x.e_faceB;const e=this.m_proxyB.GetVertex(t.indexB[0]),o=this.m_proxyB.GetVertex(t.indexB[1]);s.b2Vec2.CrossVec2One(s.b2Vec2.Subtract(o,e,s.b2Vec2.s_t0),this.m_axis).Normalize();const i=s.b2Rot.MultiplyVec2(u.q,this.m_axis,p);s.b2Vec2.Mid(e,o,this.m_localPoint);const r=s.b2Transform.MultiplyVec2(u,this.m_localPoint,n),a=this.m_proxyA.GetVertex(t.indexA[0]),m=s.b2Transform.MultiplyVec2(l,a,c);let b=s.b2Vec2.Dot(s.b2Vec2.Subtract(m,r,s.b2Vec2.s_t0),i);return b<0&&(this.m_axis.Negate(),b=-b),b}this.m_type=x.e_faceA;const V=this.m_proxyA.GetVertex(t.indexA[0]),h=this.m_proxyA.GetVertex(t.indexA[1]);s.b2Vec2.CrossVec2One(s.b2Vec2.Subtract(h,V,s.b2Vec2.s_t0),this.m_axis).Normalize();const y=s.b2Rot.MultiplyVec2(l.q,this.m_axis,p);s.b2Vec2.Mid(V,h,this.m_localPoint);const f=s.b2Transform.MultiplyVec2(l,this.m_localPoint,c),T=this.m_proxyB.GetVertex(t.indexB[0]),w=s.b2Transform.MultiplyVec2(u,T,n);let M=s.b2Vec2.Dot(s.b2Vec2.Subtract(w,f,s.b2Vec2.s_t0),y);return M<0&&(this.m_axis.Negate(),M=-M),M}FindMinSeparation(t,e,o){const i=this.m_sweepA.GetTransform(r,o),_=this.m_sweepB.GetTransform(a,o);switch(this.m_type){case x.e_points:{const o=s.b2Rot.TransposeMultiplyVec2(i.q,this.m_axis,m),r=s.b2Rot.TransposeMultiplyVec2(_.q,s.b2Vec2.Negate(this.m_axis,s.b2Vec2.s_t0),b);t[0]=this.m_proxyA.GetSupport(o),e[0]=this.m_proxyB.GetSupport(r);const a=this.m_proxyA.GetVertex(t[0]),p=this.m_proxyB.GetVertex(e[0]),l=s.b2Transform.MultiplyVec2(i,a,c),x=s.b2Transform.MultiplyVec2(_,p,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(x,l,s.b2Vec2.s_t0),this.m_axis)}case x.e_faceA:{const o=s.b2Rot.MultiplyVec2(i.q,this.m_axis,p),r=s.b2Transform.MultiplyVec2(i,this.m_localPoint,c),a=s.b2Rot.TransposeMultiplyVec2(_.q,s.b2Vec2.Negate(o,s.b2Vec2.s_t0),b);t[0]=-1,e[0]=this.m_proxyB.GetSupport(a);const m=this.m_proxyB.GetVertex(e[0]),l=s.b2Transform.MultiplyVec2(_,m,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),o)}case x.e_faceB:{const o=s.b2Rot.MultiplyVec2(_.q,this.m_axis,p),r=s.b2Transform.MultiplyVec2(_,this.m_localPoint,n),a=s.b2Rot.TransposeMultiplyVec2(i.q,s.b2Vec2.Negate(o,s.b2Vec2.s_t0),m);e[0]=-1,t[0]=this.m_proxyA.GetSupport(a);const b=this.m_proxyA.GetVertex(t[0]),l=s.b2Transform.MultiplyVec2(i,b,c);return s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),o)}default:return t[0]=-1,e[0]=-1,0}}Evaluate(e,o,i){const m=this.m_sweepA.GetTransform(r,i),b=this.m_sweepB.GetTransform(a,i);switch(this.m_type){case x.e_points:{const t=this.m_proxyA.GetVertex(e),i=this.m_proxyB.GetVertex(o),r=s.b2Transform.MultiplyVec2(m,t,c),a=s.b2Transform.MultiplyVec2(b,i,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(a,r,s.b2Vec2.s_t0),this.m_axis)}case x.e_faceA:{const t=s.b2Rot.MultiplyVec2(m.q,this.m_axis,p),e=s.b2Transform.MultiplyVec2(m,this.m_localPoint,c),i=this.m_proxyB.GetVertex(o),r=s.b2Transform.MultiplyVec2(b,i,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(r,e,s.b2Vec2.s_t0),t)}case x.e_faceB:{const t=s.b2Rot.MultiplyVec2(b.q,this.m_axis,p),o=s.b2Transform.MultiplyVec2(b,this.m_localPoint,n),i=this.m_proxyA.GetVertex(e),r=s.b2Transform.MultiplyVec2(m,i,c);return s.b2Vec2.Dot(s.b2Vec2.Subtract(r,o,s.b2Vec2.s_t0),t)}default:return(0,t.b2Assert)(!1),0}}}const h=new o.b2Timer,y=new i.b2SimplexCache,f=new i.b2DistanceInput,T=new i.b2DistanceOutput,w=new V,M=[0],d=[0],A=new s.b2Sweep,B=new s.b2Sweep;function S(s,o){const c=h.Reset();++exports.b2Toi.calls,s.state=l.e_unknown,s.t=o.tMax;const{proxyA:n,proxyB:p,tMax:m}=o,b=Math.max(e.b2_maxPolygonVertices,n.m_count,p.m_count),_=A.Copy(o.sweepA),x=B.Copy(o.sweepB);_.Normalize(),x.Normalize();const u=n.m_radius+p.m_radius,V=Math.max(t.b2_linearSlop,u-3*t.b2_linearSlop),S=.25*t.b2_linearSlop;let G=0;let I=0;const O=y;O.count=0;const R=f;for(R.proxyA.Copy(o.proxyA),R.proxyB.Copy(o.proxyB),R.useRadii=!1;;){const t=_.GetTransform(r,G),e=x.GetTransform(a,G);R.transformA.Copy(t),R.transformB.Copy(e);const o=T;if((0,i.b2Distance)(o,O,R),o.distance<=0){s.state=l.e_overlapped,s.t=0;break}if(o.distance<V+S){s.state=l.e_touching,s.t=G;break}const c=w;c.Initialize(O,n,_,p,x,G);let u=!1,h=m,y=0;for(;;){const t=M,e=d;let o=c.FindMinSeparation(t,e,h);if(o>V+S){s.state=l.e_separated,s.t=m,u=!0;break}if(o>V-S){G=h;break}let i=c.Evaluate(t[0],e[0],G);if(i<V-S){s.state=l.e_failed,s.t=G,u=!0;break}if(i<=V+S){s.state=l.e_touching,s.t=G,u=!0;break}let r=0,a=G,n=h;for(;;){let s;s=1&r?a+(V-i)*(n-a)/(o-i):.5*(a+n),++r,++exports.b2Toi.rootIters;const p=c.Evaluate(t[0],e[0],s);if(Math.abs(p-V)<S){h=s;break}if(p>V?(a=s,i=p):(n=s,o=p),50===r)break}if(exports.b2Toi.maxRootIters=Math.max(exports.b2Toi.maxRootIters,r),++y===b)break}if(++I,++exports.b2Toi.iters,u)break;if(20===I){s.state=l.e_failed,s.t=G;break}}exports.b2Toi.maxIters=Math.max(exports.b2Toi.maxIters,I);const k=c.GetMilliseconds();exports.b2Toi.maxTime=Math.max(exports.b2Toi.maxTime,k),exports.b2Toi.time+=k}exports.b2TimeOfImpact=S;
},{"../common/b2_common":"ReKW","../common/b2_settings":"I6oK","../common/b2_math":"cQbL","../common/b2_timer":"ixAk","./b2_distance":"hp9S"}],"DoJb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CollidePolygonAndCircle=exports.b2CollideCircles=void 0;const o=require("../common/b2_common"),e=require("../common/b2_math"),t=require("./b2_collision"),c=new e.b2Vec2,n=new e.b2Vec2;function i(o,i,l,r,a){o.pointCount=0;const p=e.b2Transform.MultiplyVec2(l,i.m_p,c),b=e.b2Transform.MultiplyVec2(a,r.m_p,n),s=e.b2Vec2.DistanceSquared(p,b),u=i.m_radius+r.m_radius;s>u*u||(o.type=t.b2ManifoldType.e_circles,o.localPoint.Copy(i.m_p),o.localNormal.SetZero(),o.pointCount=1,o.points[0].localPoint.Copy(r.m_p),o.points[0].id.key=0)}exports.b2CollideCircles=i;const l=new e.b2Vec2,r=new e.b2Vec2,a=new e.b2Vec2;function p(c,n,i,p,b){c.pointCount=0;const s=e.b2Transform.MultiplyVec2(b,p.m_p,l),u=e.b2Transform.TransposeMultiplyVec2(i,s,r);let m=0,_=-o.b2_maxFloat;const y=n.m_radius+p.m_radius,V=n.m_count,d=n.m_vertices,C=n.m_normals;for(let o=0;o<V;++o){const t=e.b2Vec2.Dot(C[o],e.b2Vec2.Subtract(u,d[o],e.b2Vec2.s_t0));if(t>y)return;t>_&&(_=t,m=o)}const f=m,P=f+1<V?f+1:0,M=d[f],S=d[P];if(_<o.b2_epsilon)return c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,c.localNormal.Copy(C[m]),e.b2Vec2.Mid(M,S,c.localPoint),c.points[0].localPoint.Copy(p.m_p),void(c.points[0].id.key=0);const T=e.b2Vec2.Dot(e.b2Vec2.Subtract(u,M,e.b2Vec2.s_t0),e.b2Vec2.Subtract(S,M,e.b2Vec2.s_t1)),D=e.b2Vec2.Dot(e.b2Vec2.Subtract(u,S,e.b2Vec2.s_t0),e.b2Vec2.Subtract(M,S,e.b2Vec2.s_t1));if(T<=0){if(e.b2Vec2.DistanceSquared(u,M)>y*y)return;c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,e.b2Vec2.Subtract(u,M,c.localNormal).Normalize(),c.localPoint.Copy(M),c.points[0].localPoint.Copy(p.m_p),c.points[0].id.key=0}else if(D<=0){if(e.b2Vec2.DistanceSquared(u,S)>y*y)return;c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,e.b2Vec2.Subtract(u,S,c.localNormal).Normalize(),c.localPoint.Copy(S),c.points[0].localPoint.Copy(p.m_p),c.points[0].id.key=0}else{const o=e.b2Vec2.Mid(M,S,a);if(e.b2Vec2.Dot(e.b2Vec2.Subtract(u,o,e.b2Vec2.s_t1),C[f])>y)return;c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,c.localNormal.Copy(C[f]),c.localPoint.Copy(o),c.points[0].localPoint.Copy(p.m_p),c.points[0].id.key=0}}exports.b2CollidePolygonAndCircle=p;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_collision":"PKgf"}],"nWAU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CollidePolygons=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),o=require("./b2_collision"),n=new t.b2Transform,c=new t.b2Vec2,r=new t.b2Vec2;function i(o,i,l,b,s){const a=i.m_count,p=b.m_count,V=i.m_normals,m=i.m_vertices,u=b.m_vertices,y=t.b2Transform.TransposeMultiply(s,l,n);let f=0,_=-e.b2_maxFloat;for(let n=0;n<a;++n){const o=t.b2Rot.MultiplyVec2(y.q,V[n],c),i=t.b2Transform.MultiplyVec2(y,m[n],r);let l=e.b2_maxFloat;for(let e=0;e<p;++e){const n=t.b2Vec2.Dot(o,t.b2Vec2.Subtract(u[e],i,t.b2Vec2.s_t0));n<l&&(l=n)}l>_&&(_=l,f=n)}return o[0]=f,_}const l=new t.b2Vec2;function b(n,c,r,i,b,s){const a=c.m_normals,p=b.m_count,V=b.m_vertices,m=b.m_normals,u=t.b2Rot.TransposeMultiplyVec2(s.q,t.b2Rot.MultiplyVec2(r.q,a[i],t.b2Vec2.s_t0),l);let y=0,f=e.b2_maxFloat;for(let e=0;e<p;++e){const o=t.b2Vec2.Dot(u,m[e]);o<f&&(f=o,y=e)}const _=y,d=_+1<p?_+1:0,x=n[0];t.b2Transform.MultiplyVec2(s,V[_],x.v);const C=x.id.cf;C.indexA=i,C.indexB=_,C.typeA=o.b2ContactFeatureType.e_face,C.typeB=o.b2ContactFeatureType.e_vertex;const T=n[1];t.b2Transform.MultiplyVec2(s,V[d],T.v);const w=T.id.cf;w.indexA=i,w.indexB=d,w.typeA=o.b2ContactFeatureType.e_face,w.typeB=o.b2ContactFeatureType.e_vertex}const s=[new o.b2ClipVertex,new o.b2ClipVertex],a=[new o.b2ClipVertex,new o.b2ClipVertex],p=[new o.b2ClipVertex,new o.b2ClipVertex],V=[0],m=[0],u=new t.b2Vec2,y=new t.b2Vec2,f=new t.b2Vec2,_=new t.b2Vec2,d=new t.b2Vec2,x=new t.b2Vec2,C=new t.b2Vec2,T=new t.b2Vec2;function w(n,c,r,l,w){n.pointCount=0;const M=c.m_radius+l.m_radius,v=V,A=i(v,c,r,l,w);if(A>M)return;const B=m,q=i(B,l,w,c,r);if(q>M)return;let F,D,P,g,S,R;q>A+.1*e.b2_linearSlop?(F=l,D=c,P=w,g=r,S=B[0],n.type=o.b2ManifoldType.e_faceB,R=1):(F=c,D=l,P=r,g=w,S=v[0],n.type=o.b2ManifoldType.e_faceA,R=0);const N=s;b(N,F,P,S,D,g);const O=F.m_count,L=F.m_vertices,h=S,j=S+1<O?S+1:0;let z=L[h],k=L[j];const E=t.b2Vec2.Subtract(k,z,u);E.Normalize();const G=t.b2Vec2.CrossVec2One(E,y),H=t.b2Vec2.Mid(z,k,f),I=t.b2Rot.MultiplyVec2(P.q,E,d),J=t.b2Vec2.CrossVec2One(I,_);z=t.b2Transform.MultiplyVec2(P,z,C),k=t.b2Transform.MultiplyVec2(P,k,T);const K=t.b2Vec2.Dot(J,z),Q=-t.b2Vec2.Dot(I,z)+M,U=t.b2Vec2.Dot(I,k)+M,W=a,X=p,Y=t.b2Vec2.Negate(I,x);let Z=(0,o.b2ClipSegmentToLine)(W,N,Y,Q,h);if(Z<2)return;if((Z=(0,o.b2ClipSegmentToLine)(X,W,I,U,j))<2)return;n.localNormal.Copy(G),n.localPoint.Copy(H);let $=0;for(let o=0;o<e.b2_maxManifoldPoints;++o){const e=X[o];if(t.b2Vec2.Dot(J,e.v)-K<=M){const o=n.points[$];if(t.b2Transform.TransposeMultiplyVec2(g,e.v,o.localPoint),o.id.Copy(e.id),R){const{cf:e}=o.id;e.indexA=e.indexB,e.indexB=e.indexA,e.typeA=e.typeB,e.typeB=e.typeA}++$}}n.pointCount=$}exports.b2CollidePolygons=w;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_collision":"PKgf"}],"bTYS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CollideEdgeAndPolygon=exports.b2CollideEdgeAndCircle=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),o=require("./b2_collision"),n=require("../common/b2_settings"),c=new t.b2Vec2,i=new t.b2Vec2,r=new t.b2Vec2,a=new t.b2Vec2,s=new t.b2Vec2,b=new t.b2Vec2,l=new t.b2Vec2,p=new o.b2ContactID;function d(e,n,d,f,m){e.pointCount=0;const y=t.b2Transform.TransposeMultiplyVec2(d,t.b2Transform.MultiplyVec2(m,f.m_p,t.b2Vec2.s_t0),c),V=n.m_vertex1,u=n.m_vertex2,_=t.b2Vec2.Subtract(u,V,i),x=l.Set(_.y,-_.x),C=t.b2Vec2.Dot(x,t.b2Vec2.Subtract(y,V,t.b2Vec2.s_t0));if(n.m_oneSided&&C<0)return;const v=t.b2Vec2.Dot(_,t.b2Vec2.Subtract(u,y,t.b2Vec2.s_t0)),w=t.b2Vec2.Dot(_,t.b2Vec2.Subtract(y,V,t.b2Vec2.s_t0)),S=n.m_radius+f.m_radius,A=p;if(A.cf.indexB=0,A.cf.typeB=o.b2ContactFeatureType.e_vertex,w<=0){const c=V,i=t.b2Vec2.Subtract(y,c,r);if(t.b2Vec2.Dot(i,i)>S*S)return;if(n.m_oneSided){const e=n.m_vertex0,o=V,c=t.b2Vec2.Subtract(o,e,a);if(t.b2Vec2.Dot(c,t.b2Vec2.Subtract(o,y,t.b2Vec2.s_t0))>0)return}return A.cf.indexA=0,A.cf.typeA=o.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=o.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(c),e.points[0].id.Copy(A),void e.points[0].localPoint.Copy(f.m_p)}if(v<=0){const c=u,i=t.b2Vec2.Subtract(y,c,r);if(t.b2Vec2.Dot(i,i)>S*S)return;if(n.m_oneSided){const e=n.m_vertex3,o=u,c=t.b2Vec2.Subtract(e,o,s);if(t.b2Vec2.Dot(c,t.b2Vec2.Subtract(y,o,t.b2Vec2.s_t0))>0)return}return A.cf.indexA=1,A.cf.typeA=o.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=o.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(c),e.points[0].id.Copy(A),void e.points[0].localPoint.Copy(f.m_p)}const T=t.b2Vec2.Dot(_,_),g=b;g.x=1/T*(v*V.x+w*u.x),g.y=1/T*(v*V.y+w*u.y);const N=t.b2Vec2.Subtract(y,g,r);t.b2Vec2.Dot(N,N)>S*S||(C<0&&x.Set(-x.x,-x.y),x.Normalize(),A.cf.indexA=0,A.cf.typeA=o.b2ContactFeatureType.e_face,e.pointCount=1,e.type=o.b2ManifoldType.e_faceA,e.localNormal.Copy(x),e.localPoint.Copy(V),e.points[0].id.Copy(A),e.points[0].localPoint.Copy(f.m_p))}var f;exports.b2CollideEdgeAndCircle=d,function(e){e[e.e_unknown=0]="e_unknown",e[e.e_edgeA=1]="e_edgeA",e[e.e_edgeB=2]="e_edgeB"}(f||(f={}));class m{constructor(){this.normal=new t.b2Vec2,this.type=f.e_unknown,this.index=0,this.separation=0}}class y{constructor(){this.vertices=(0,e.b2MakeArray)(n.b2_maxPolygonVertices,t.b2Vec2),this.normals=(0,e.b2MakeArray)(n.b2_maxPolygonVertices,t.b2Vec2),this.count=0}}class V{constructor(){this.i1=0,this.i2=0,this.v1=new t.b2Vec2,this.v2=new t.b2Vec2,this.normal=new t.b2Vec2,this.sideNormal1=new t.b2Vec2,this.sideOffset1=0,this.sideNormal2=new t.b2Vec2,this.sideOffset2=0}}const u=new m,_=[new t.b2Vec2,new t.b2Vec2];function x(o,n,c){const i=u;i.type=f.e_edgeA,i.index=-1,i.separation=-e.b2_maxFloat,i.normal.SetZero();const r=_;r[0].Copy(c),t.b2Vec2.Negate(c,r[1]);for(let a=0;a<2;++a){let c=e.b2_maxFloat;for(let e=0;e<o.count;++e){const i=t.b2Vec2.Dot(r[a],t.b2Vec2.Subtract(o.vertices[e],n,t.b2Vec2.s_t0));i<c&&(c=i)}c>i.separation&&(i.index=a,i.separation=c,i.normal.Copy(r[a]))}return i}const C=new m,v=new t.b2Vec2;function w(o,n,c){const i=C;i.type=f.e_unknown,i.index=-1,i.separation=-e.b2_maxFloat,i.normal.SetZero();for(let e=0;e<o.count;++e){const r=t.b2Vec2.Negate(o.normals[e],v),a=t.b2Vec2.Dot(r,t.b2Vec2.Subtract(o.vertices[e],n,t.b2Vec2.s_t0)),s=t.b2Vec2.Dot(r,t.b2Vec2.Subtract(o.vertices[e],c,t.b2Vec2.s_t0)),b=Math.min(a,s);b>i.separation&&(i.type=f.e_edgeB,i.index=e,i.separation=b,i.normal.Copy(r))}return i}const S=new t.b2Transform,A=new t.b2Vec2,T=new t.b2Vec2,g=new t.b2Vec2,N=new t.b2Vec2,D=new t.b2Vec2,M=new t.b2Vec2,h=new t.b2Vec2,B=new y,P=new V,F=[new o.b2ClipVertex,new o.b2ClipVertex],O=[new o.b2ClipVertex,new o.b2ClipVertex],k=[new o.b2ClipVertex,new o.b2ClipVertex];function q(n,c,i,r,a){n.pointCount=0;const s=t.b2Transform.TransposeMultiply(i,a,S),b=t.b2Transform.MultiplyVec2(s,r.m_centroid,A),l=c.m_vertex1,p=c.m_vertex2,d=t.b2Vec2.Subtract(p,l,T);d.Normalize();const m=g.Set(d.y,-d.x),y=t.b2Vec2.Dot(m,t.b2Vec2.Subtract(b,l,t.b2Vec2.s_t0)),V=c.m_oneSided;if(V&&y<0)return;const u=B;u.count=r.m_count;for(let e=0;e<r.m_count;++e)t.b2Transform.MultiplyVec2(s,r.m_vertices[e],u.vertices[e]),t.b2Rot.MultiplyVec2(s.q,r.m_normals[e],u.normals[e]);const _=r.m_radius+c.m_radius,C=x(u,l,m);if(C.separation>_)return;const v=w(u,l,p);if(v.separation>_)return;let q;if(q=v.separation-_>.98*(C.separation-_)+.001?v:C,V){const e=t.b2Vec2.Subtract(l,c.m_vertex0,N);e.Normalize();const o=D.Set(e.y,-e.x),n=t.b2Vec2.Cross(e,d)>=0,i=t.b2Vec2.Subtract(c.m_vertex3,p,M);i.Normalize();const r=h.Set(i.y,-i.x),a=t.b2Vec2.Cross(d,i)>=0,s=.1;if(t.b2Vec2.Dot(q.normal,d)<=0)if(n){if(t.b2Vec2.Cross(q.normal,o)>s)return}else q=C;else if(a){if(t.b2Vec2.Cross(r,q.normal)>s)return}else q=C}const z=F,E=P;if(q.type===f.e_edgeA){n.type=o.b2ManifoldType.e_faceA;let e=0,c=t.b2Vec2.Dot(q.normal,u.normals[0]);for(let o=1;o<u.count;++o){const n=t.b2Vec2.Dot(q.normal,u.normals[o]);n<c&&(c=n,e=o)}const i=e,r=i+1<u.count?i+1:0;z[0].v.Copy(u.vertices[i]),z[0].id.cf.indexA=0,z[0].id.cf.indexB=i,z[0].id.cf.typeA=o.b2ContactFeatureType.e_face,z[0].id.cf.typeB=o.b2ContactFeatureType.e_vertex,z[1].v.Copy(u.vertices[r]),z[1].id.cf.indexA=0,z[1].id.cf.indexB=r,z[1].id.cf.typeA=o.b2ContactFeatureType.e_face,z[1].id.cf.typeB=o.b2ContactFeatureType.e_vertex,E.i1=0,E.i2=1,E.v1.Copy(l),E.v2.Copy(p),E.normal.Copy(q.normal),t.b2Vec2.Negate(d,E.sideNormal1),E.sideNormal2.Copy(d)}else n.type=o.b2ManifoldType.e_faceB,z[0].v.Copy(p),z[0].id.cf.indexA=1,z[0].id.cf.indexB=q.index,z[0].id.cf.typeA=o.b2ContactFeatureType.e_vertex,z[0].id.cf.typeB=o.b2ContactFeatureType.e_face,z[1].v.Copy(l),z[1].id.cf.indexA=0,z[1].id.cf.indexB=q.index,z[1].id.cf.typeA=o.b2ContactFeatureType.e_vertex,z[1].id.cf.typeB=o.b2ContactFeatureType.e_face,E.i1=q.index,E.i2=E.i1+1<u.count?E.i1+1:0,E.v1.Copy(u.vertices[E.i1]),E.v2.Copy(u.vertices[E.i2]),E.normal.Copy(u.normals[E.i1]),E.sideNormal1.Set(E.normal.y,-E.normal.x),t.b2Vec2.Negate(E.sideNormal1,E.sideNormal2);E.sideOffset1=t.b2Vec2.Dot(E.sideNormal1,E.v1),E.sideOffset2=t.b2Vec2.Dot(E.sideNormal2,E.v2);const Z=O,L=k;let j;if((j=(0,o.b2ClipSegmentToLine)(Z,z,E.sideNormal1,E.sideOffset1,E.i1))<e.b2_maxManifoldPoints)return;if((j=(0,o.b2ClipSegmentToLine)(L,Z,E.sideNormal2,E.sideOffset2,E.i2))<e.b2_maxManifoldPoints)return;q.type===f.e_edgeA?(n.localNormal.Copy(E.normal),n.localPoint.Copy(E.v1)):(n.localNormal.Copy(r.m_normals[E.i1]),n.localPoint.Copy(r.m_vertices[E.i1]));let I=0;for(let o=0;o<e.b2_maxManifoldPoints;++o){if(t.b2Vec2.Dot(E.normal,t.b2Vec2.Subtract(L[o].v,E.v1,t.b2Vec2.s_t0))<=_){const e=n.points[I];q.type===f.e_edgeA?(t.b2Transform.TransposeMultiplyVec2(s,L[o].v,e.localPoint),e.id.Copy(L[o].id)):(e.localPoint.Copy(L[o].v),e.id.cf.typeA=L[o].id.cf.typeB,e.id.cf.typeB=L[o].id.cf.typeA,e.id.cf.indexA=L[o].id.cf.indexB,e.id.cf.indexB=L[o].id.cf.indexA),++I}}n.pointCount=I}exports.b2CollideEdgeAndPolygon=q;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_collision":"PKgf","../common/b2_settings":"I6oK"}],"HIjv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CircleShape=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),s=require("./b2_shape");class r extends s.b2Shape{constructor(t=0){super(s.b2ShapeType.e_circle,t),this.m_p=new e.b2Vec2}Set(t,e=this.m_radius){return this.m_p.Copy(t),this.m_radius=e,this}Clone(){return(new r).Copy(this)}Copy(t){return super.Copy(t),this.m_p.Copy(t.m_p),this}GetChildCount(){return 1}TestPoint(t,s){const i=e.b2Transform.MultiplyVec2(t,this.m_p,r.TestPoint_s_center),o=e.b2Vec2.Subtract(s,i,r.TestPoint_s_d);return e.b2Vec2.Dot(o,o)<=this.m_radius**2}RayCast(s,i,o,_){const a=e.b2Transform.MultiplyVec2(o,this.m_p,r.RayCast_s_position),c=e.b2Vec2.Subtract(i.p1,a,r.RayCast_s_s),n=e.b2Vec2.Dot(c,c)-this.m_radius**2,p=e.b2Vec2.Subtract(i.p2,i.p1,r.RayCast_s_r),m=e.b2Vec2.Dot(c,p),u=e.b2Vec2.Dot(p,p),h=m*m-u*n;if(h<0||u<t.b2_epsilon)return!1;let b=-(m+Math.sqrt(h));return b>=0&&b<=i.maxFraction*u&&(b/=u,s.fraction=b,e.b2Vec2.AddScaled(c,b,p,s.normal).Normalize(),!0)}ComputeAABB(t,s,i){const o=e.b2Transform.MultiplyVec2(s,this.m_p,r.ComputeAABB_s_p);t.lowerBound.Set(o.x-this.m_radius,o.y-this.m_radius),t.upperBound.Set(o.x+this.m_radius,o.y+this.m_radius)}ComputeMass(t,s){const r=this.m_radius**2;t.mass=s*Math.PI*r,t.center.Copy(this.m_p),t.I=t.mass*(.5*r+e.b2Vec2.Dot(this.m_p,this.m_p))}SetupDistanceProxy(t,e){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_p),t.m_count=1,t.m_radius=this.m_radius}Draw(t,s){const r=this.m_p,i=this.m_radius,o=e.b2Vec2.UNITX;t.DrawSolidCircle(r,i,o,s)}}exports.b2CircleShape=r,r.TestPoint_s_center=new e.b2Vec2,r.TestPoint_s_d=new e.b2Vec2,r.RayCast_s_position=new e.b2Vec2,r.RayCast_s_s=new e.b2Vec2,r.RayCast_s_r=new e.b2Vec2,r.ComputeAABB_s_p=new e.b2Vec2;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_shape":"stUN"}],"tvYY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PolygonShape=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),s=require("../common/b2_settings"),r=require("./b2_shape"),c={ComputeCentroid:{s:new e.b2Vec2,p1:new e.b2Vec2,p2:new e.b2Vec2,p3:new e.b2Vec2,e1:new e.b2Vec2,e2:new e.b2Vec2},TestPoint:{pLocal:new e.b2Vec2},ComputeAABB:{v:new e.b2Vec2},ComputeMass:{center:new e.b2Vec2,s:new e.b2Vec2,e1:new e.b2Vec2,e2:new e.b2Vec2},Validate:{e:new e.b2Vec2,v:new e.b2Vec2},Set:{r:new e.b2Vec2,v:new e.b2Vec2},RayCast:{p1:new e.b2Vec2,p2:new e.b2Vec2,d:new e.b2Vec2},SetAsBox:{xf:new e.b2Transform}},o=(.5*t.b2_linearSlop)**2;function n(t,s,r){const o=r;o.SetZero();let n=0;const{s:i,p1:m,p2:a,p3:b,e1:u,e2:_}=c.ComputeCentroid;i.Copy(t[0]);for(let c=0;c<s;++c){e.b2Vec2.Subtract(t[0],i,m),e.b2Vec2.Subtract(t[c],i,a),e.b2Vec2.Subtract(t[c+1<s?c+1:0],i,b),e.b2Vec2.Subtract(a,m,u),e.b2Vec2.Subtract(b,m,_);const r=.5*e.b2Vec2.Cross(u,_);n+=r,o.x+=r*(1/3)*(m.x+a.x+b.x),o.y+=r*(1/3)*(m.y+a.y+b.y)}const h=1/n;return o.x=h*o.x+i.x,o.y=h*o.y+i.y,o}class i extends r.b2Shape{constructor(){super(r.b2ShapeType.e_polygon,t.b2_polygonRadius),this.m_centroid=new e.b2Vec2,this.m_vertices=[],this.m_normals=[],this.m_count=0}Clone(){return(new i).Copy(this)}Copy(s){super.Copy(s),this.m_centroid.Copy(s.m_centroid),this.m_count=s.m_count,this.m_vertices=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_normals=(0,t.b2MakeArray)(this.m_count,e.b2Vec2);for(let t=0;t<this.m_count;++t)this.m_vertices[t].Copy(s.m_vertices[t]),this.m_normals[t].Copy(s.m_normals[t]);return this}GetChildCount(){return 1}Set(r,i=r.length){if(i<3)return this.SetAsBox(1,1);let m=Math.min(i,s.b2_maxPolygonVertices);const a=[];for(let t=0;t<m;++t){const s=r[t];a.every(t=>e.b2Vec2.DistanceSquared(s,t)>=o)&&a.push(s)}if((m=a.length)<3)return this.SetAsBox(1,1);let b=0,u=a[0].x;for(let t=1;t<m;++t){const{x:e}=a[t];(e>u||e===u&&a[t].y<a[b].y)&&(b=t,u=e)}const _=[];let h=0,l=b;for(;;){_[h]=l;let t=0;for(let s=1;s<m;++s){if(t===l){t=s;continue}const r=e.b2Vec2.Subtract(a[t],a[_[h]],c.Set.r),o=e.b2Vec2.Subtract(a[s],a[_[h]],c.Set.v),n=e.b2Vec2.Cross(r,o);n<0&&(t=s),0===n&&o.LengthSquared()>r.LengthSquared()&&(t=s)}if(++h,l=t,t===b)break}(0,t.b2Assert)(h>=3,"Polygon is degenerate"),this.m_count=h,this.m_vertices=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_normals=(0,t.b2MakeArray)(this.m_count,e.b2Vec2);for(let t=0;t<h;++t)this.m_vertices[t].Copy(a[_[t]]);for(let t=0;t<h;++t){const s=t,r=t+1<h?t+1:0,c=e.b2Vec2.Subtract(this.m_vertices[r],this.m_vertices[s],e.b2Vec2.s_t0);e.b2Vec2.CrossVec2One(c,this.m_normals[t]).Normalize()}return n(this.m_vertices,h,this.m_centroid),this}SetAsBox(s,r,o,n=0){if(this.m_count=4,this.m_vertices=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_normals=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_vertices[0].Set(-s,-r),this.m_vertices[1].Set(s,-r),this.m_vertices[2].Set(s,r),this.m_vertices[3].Set(-s,r),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),o){this.m_centroid.Copy(o);const{xf:t}=c.SetAsBox;t.SetPosition(o),t.SetRotationAngle(n);for(let s=0;s<this.m_count;++s)e.b2Transform.MultiplyVec2(t,this.m_vertices[s],this.m_vertices[s]),e.b2Rot.MultiplyVec2(t.q,this.m_normals[s],this.m_normals[s])}else this.m_centroid.SetZero();return this}TestPoint(t,s){const r=e.b2Transform.TransposeMultiplyVec2(t,s,c.TestPoint.pLocal);for(let c=0;c<this.m_count;++c){if(e.b2Vec2.Dot(this.m_normals[c],e.b2Vec2.Subtract(r,this.m_vertices[c],e.b2Vec2.s_t0))>0)return!1}return!0}RayCast(t,s,r,o){const n=e.b2Transform.TransposeMultiplyVec2(r,s.p1,c.RayCast.p1),i=e.b2Transform.TransposeMultiplyVec2(r,s.p2,c.RayCast.p2),m=e.b2Vec2.Subtract(i,n,c.RayCast.d);let a=0,b=s.maxFraction,u=-1;for(let c=0;c<this.m_count;++c){const t=e.b2Vec2.Dot(this.m_normals[c],e.b2Vec2.Subtract(this.m_vertices[c],n,e.b2Vec2.s_t0)),s=e.b2Vec2.Dot(this.m_normals[c],m);if(0===s){if(t<0)return!1}else s<0&&t<a*s?(a=t/s,u=c):s>0&&t<b*s&&(b=t/s);if(b<a)return!1}return u>=0&&(t.fraction=a,e.b2Rot.MultiplyVec2(r.q,this.m_normals[u],t.normal),!0)}ComputeAABB(t,s,r){const o=e.b2Transform.MultiplyVec2(s,this.m_vertices[0],t.lowerBound),n=t.upperBound.Copy(o);for(let m=1;m<this.m_count;++m){const t=e.b2Transform.MultiplyVec2(s,this.m_vertices[m],c.ComputeAABB.v);e.b2Vec2.Min(o,t,o),e.b2Vec2.Max(n,t,n)}const i=this.m_radius;o.SubtractXY(i,i),n.AddXY(i,i)}ComputeMass(t,s){const r=c.ComputeMass.center.SetZero();let o=0,n=0;const i=c.ComputeMass.s.Copy(this.m_vertices[0]);for(let m=0;m<this.m_count;++m){const t=e.b2Vec2.Subtract(this.m_vertices[m],i,c.ComputeMass.e1),s=e.b2Vec2.Subtract(this.m_vertices[m+1<this.m_count?m+1:0],i,c.ComputeMass.e2),a=e.b2Vec2.Cross(t,s),b=.5*a;o+=b,r.AddScaled(b*(1/3),e.b2Vec2.Add(t,s,e.b2Vec2.s_t0));const u=t.x,_=t.y,h=s.x,l=s.y;n+=1/3*.25*a*(u*u+h*u+h*h+(_*_+l*_+l*l))}t.mass=s*o,r.Scale(1/o),e.b2Vec2.Add(r,i,t.center),t.I=s*n,t.I+=t.mass*(e.b2Vec2.Dot(t.center,t.center)-e.b2Vec2.Dot(r,r))}Validate(){const{e:t,v:s}=c.Validate;for(let r=0;r<this.m_count;++r){const c=r,o=r<this.m_count-1?c+1:0,n=this.m_vertices[c];e.b2Vec2.Subtract(this.m_vertices[o],n,t);for(let r=0;r<this.m_count;++r){if(r===c||r===o)continue;if(e.b2Vec2.Subtract(this.m_vertices[r],n,s),e.b2Vec2.Cross(t,s)<0)return!1}}return!0}SetupDistanceProxy(t,e){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}Draw(t,e){const s=this.m_count,r=this.m_vertices;t.DrawSolidPolygon(r,s,e)}}exports.b2PolygonShape=i;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","../common/b2_settings":"I6oK","./b2_shape":"stUN"}],"OKJP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2EdgeShape=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),s=require("./b2_shape");class r extends s.b2Shape{constructor(){super(s.b2ShapeType.e_edge,e.b2_polygonRadius),this.m_vertex1=new t.b2Vec2,this.m_vertex2=new t.b2Vec2,this.m_vertex0=new t.b2Vec2,this.m_vertex3=new t.b2Vec2,this.m_oneSided=!1}SetOneSided(e,t,s,r){return this.m_vertex0.Copy(e),this.m_vertex1.Copy(t),this.m_vertex2.Copy(s),this.m_vertex3.Copy(r),this.m_oneSided=!0,this}SetTwoSided(e,t){return this.m_vertex1.Copy(e),this.m_vertex2.Copy(t),this.m_oneSided=!1,this}Clone(){return(new r).Copy(this)}Copy(e){return super.Copy(e),this.m_vertex1.Copy(e.m_vertex1),this.m_vertex2.Copy(e.m_vertex2),this.m_vertex0.Copy(e.m_vertex0),this.m_vertex3.Copy(e.m_vertex3),this.m_oneSided=e.m_oneSided,this}GetChildCount(){return 1}TestPoint(e,t){return!1}RayCast(e,s,o,_){const i=t.b2Transform.TransposeMultiplyVec2(o,s.p1,r.RayCast_s_p1),n=t.b2Transform.TransposeMultiplyVec2(o,s.p2,r.RayCast_s_p2),a=t.b2Vec2.Subtract(n,i,r.RayCast_s_d),m=this.m_vertex1,c=this.m_vertex2,p=t.b2Vec2.Subtract(c,m,r.RayCast_s_e),{normal:u}=e;u.Set(p.y,-p.x).Normalize();const b=t.b2Vec2.Dot(u,t.b2Vec2.Subtract(m,i,t.b2Vec2.s_t0));if(this.m_oneSided&&b>0)return!1;const h=t.b2Vec2.Dot(u,a);if(0===h)return!1;const d=b/h;if(d<0||s.maxFraction<d)return!1;const y=t.b2Vec2.AddScaled(i,d,a,r.RayCast_s_q),v=t.b2Vec2.Subtract(c,m,r.RayCast_s_r),C=t.b2Vec2.Dot(v,v);if(0===C)return!1;const x=t.b2Vec2.Dot(t.b2Vec2.Subtract(y,m,t.b2Vec2.s_t0),v)/C;return!(x<0||x>1)&&(e.fraction=d,t.b2Rot.MultiplyVec2(o.q,e.normal,e.normal),b>0&&e.normal.Negate(),!0)}ComputeAABB(e,s,o){const _=t.b2Transform.MultiplyVec2(s,this.m_vertex1,r.ComputeAABB_s_v1),i=t.b2Transform.MultiplyVec2(s,this.m_vertex2,r.ComputeAABB_s_v2);t.b2Vec2.Min(_,i,e.lowerBound),t.b2Vec2.Max(_,i,e.upperBound);const n=this.m_radius;e.lowerBound.SubtractXY(n,n),e.upperBound.AddXY(n,n)}ComputeMass(e,s){e.mass=0,t.b2Vec2.Mid(this.m_vertex1,this.m_vertex2,e.center),e.I=0}SetupDistanceProxy(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_vertex1),e.m_vertices[1].Copy(this.m_vertex2),e.m_count=2,e.m_radius=this.m_radius}Draw(e,t){const s=this.m_vertex1,r=this.m_vertex2;e.DrawSegment(s,r,t),!1===this.m_oneSided&&(e.DrawPoint(s,4,t),e.DrawPoint(r,4,t))}}exports.b2EdgeShape=r,r.RayCast_s_p1=new t.b2Vec2,r.RayCast_s_p2=new t.b2Vec2,r.RayCast_s_d=new t.b2Vec2,r.RayCast_s_e=new t.b2Vec2,r.RayCast_s_q=new t.b2Vec2,r.RayCast_s_r=new t.b2Vec2,r.ComputeAABB_s_v1=new t.b2Vec2,r.ComputeAABB_s_v2=new t.b2Vec2;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_shape":"stUN"}],"papG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ChainShape=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),s=require("./b2_shape"),r=require("./b2_edge_shape");class i extends s.b2Shape{constructor(){super(s.b2ShapeType.e_chain,e.b2_polygonRadius),this.m_vertices=[],this.m_prevVertex=new t.b2Vec2,this.m_nextVertex=new t.b2Vec2}CreateLoop(e,s=e.length){if(s<3)return this;this.m_vertices.length=s+1;for(let r=0;r<s;++r){const{x:s,y:i}=e[r];this.m_vertices[r]=new t.b2Vec2(s,i)}return this.m_vertices[s]=this.m_vertices[0].Clone(),this.m_prevVertex.Copy(this.m_vertices[this.m_vertices.length-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this}CreateChain(e,s,r,i){this.m_vertices.length=s;for(let _=0;_<s;++_){const{x:s,y:r}=e[_];this.m_vertices[_]=new t.b2Vec2(s,r)}return this.m_prevVertex.Copy(r),this.m_nextVertex.Copy(i),this}Clone(){return(new i).Copy(this)}Copy(e){return super.Copy(e),this.CreateChain(e.m_vertices,e.m_vertices.length,e.m_prevVertex,e.m_nextVertex)}GetChildCount(){return this.m_vertices.length-1}GetChildEdge(e,t){e.m_radius=this.m_radius,e.m_vertex1.Copy(this.m_vertices[t]),e.m_vertex2.Copy(this.m_vertices[t+1]),e.m_oneSided=!0,t>0?e.m_vertex0.Copy(this.m_vertices[t-1]):e.m_vertex0.Copy(this.m_prevVertex),t<this.m_vertices.length-2?e.m_vertex3.Copy(this.m_vertices[t+2]):e.m_vertex3.Copy(this.m_nextVertex)}TestPoint(e,t){return!1}RayCast(e,t,s,r){const _=i.RayCast_s_edgeShape,m=r;let o=r+1;return o===this.m_vertices.length&&(o=0),_.m_vertex1.Copy(this.m_vertices[m]),_.m_vertex2.Copy(this.m_vertices[o]),_.RayCast(e,t,s,0)}ComputeAABB(e,s,r){const _=r;let m=r+1;m===this.m_vertices.length&&(m=0);const o=t.b2Transform.MultiplyVec2(s,this.m_vertices[_],i.ComputeAABB_s_v1),h=t.b2Transform.MultiplyVec2(s,this.m_vertices[m],i.ComputeAABB_s_v2),n=t.b2Vec2.Min(o,h,i.ComputeAABB_s_lower),c=t.b2Vec2.Max(o,h,i.ComputeAABB_s_upper);e.lowerBound.x=n.x-this.m_radius,e.lowerBound.y=n.y-this.m_radius,e.upperBound.x=c.x+this.m_radius,e.upperBound.y=c.y+this.m_radius}ComputeMass(e,t){e.mass=0,e.center.SetZero(),e.I=0}SetupDistanceProxy(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_vertices[t]),t+1<this.m_vertices.length?e.m_vertices[1].Copy(this.m_vertices[t+1]):e.m_vertices[1].Copy(this.m_vertices[0]),e.m_count=2,e.m_radius=this.m_radius}Draw(e,t){const s=this.m_vertices;let r=s[0];for(let i=1;i<s.length;++i){const _=s[i];e.DrawSegment(r,_,t),r=_}}}exports.b2ChainShape=i,i.RayCast_s_edgeShape=new r.b2EdgeShape,i.ComputeAABB_s_v1=new t.b2Vec2,i.ComputeAABB_s_v2=new t.b2Vec2,i.ComputeAABB_s_lower=new t.b2Vec2,i.ComputeAABB_s_upper=new t.b2Vec2;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_shape":"stUN","./b2_edge_shape":"OKJP"}],"Xq2i":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Joint=exports.b2AngularStiffness=exports.b2LinearStiffness=exports.b2JointDef=exports.b2JointEdge=exports.b2JointType=void 0;const t=require("../common/b2_draw"),e=require("../common/b2_math"),n={pA:new e.b2Vec2,pB:new e.b2Vec2};var o;!function(t){t[t.e_unknownJoint=0]="e_unknownJoint",t[t.e_revoluteJoint=1]="e_revoluteJoint",t[t.e_prismaticJoint=2]="e_prismaticJoint",t[t.e_distanceJoint=3]="e_distanceJoint",t[t.e_pulleyJoint=4]="e_pulleyJoint",t[t.e_mouseJoint=5]="e_mouseJoint",t[t.e_gearJoint=6]="e_gearJoint",t[t.e_wheelJoint=7]="e_wheelJoint",t[t.e_weldJoint=8]="e_weldJoint",t[t.e_frictionJoint=9]="e_frictionJoint",t[t.e_motorJoint=10]="e_motorJoint",t[t.e_areaJoint=11]="e_areaJoint"}(o=exports.b2JointType||(exports.b2JointType={}));class i{constructor(t,e){this.prev=null,this.next=null,this.joint=t,this.other=e}}exports.b2JointEdge=i;class s{constructor(t){this.userData=null,this.collideConnected=!1,this.type=t}}function r(t,e,n,o,i){const s=o.GetMass(),r=i.GetMass();let a;a=s>0&&r>0?s*r/(s+r):s>0?s:r;const l=2*Math.PI*e;t.stiffness=a*l*l,t.damping=2*a*n*l}function a(t,e,n,o,i){const s=o.GetInertia(),r=i.GetInertia();let a;a=s>0&&r>0?s*r/(s+r):s>0?s:r;const l=2*Math.PI*e;t.stiffness=a*l*l,t.damping=2*a*n*l}exports.b2JointDef=s,exports.b2LinearStiffness=r,exports.b2AngularStiffness=a;class l{constructor(t){var e;this.m_type=o.e_unknownJoint,this.m_prev=null,this.m_next=null,this.m_islandFlag=!1,this.m_collideConnected=!1,this.m_userData=null,this.m_type=t.type,this.m_edgeA=new i(this,t.bodyB),this.m_edgeB=new i(this,t.bodyA),this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=null!==(e=t.collideConnected)&&void 0!==e&&e,this.m_userData=t.userData}GetType(){return this.m_type}GetBodyA(){return this.m_bodyA}GetBodyB(){return this.m_bodyB}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}IsEnabled(){return this.m_bodyA.IsEnabled()&&this.m_bodyB.IsEnabled()}GetCollideConnected(){return this.m_collideConnected}ShiftOrigin(t){}Draw(e){const o=this.m_bodyA.GetTransform().p,i=this.m_bodyB.GetTransform().p,s=this.GetAnchorA(n.pA),r=this.GetAnchorB(n.pB);e.DrawSegment(o,s,t.debugColors.joint6),e.DrawSegment(s,r,t.debugColors.joint6),e.DrawSegment(i,r,t.debugColors.joint6)}}exports.b2Joint=l;
},{"../common/b2_draw":"lvls","../common/b2_math":"cQbL"}],"xSy1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2DistanceJoint=exports.b2DistanceJointDef=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),i=require("./b2_joint"),e=require("../common/b2_draw"),m={worldPointA:new s.b2Vec2,worldPointB:new s.b2Vec2,vpA:new s.b2Vec2,vpB:new s.b2Vec2,vpBA:new s.b2Vec2,P:new s.b2Vec2,qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,Draw:{pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,pRest:new s.b2Vec2,p1:new s.b2Vec2,p2:new s.b2Vec2}};class h extends i.b2JointDef{constructor(){super(i.b2JointType.e_distanceJoint),this.localAnchorA=new s.b2Vec2,this.localAnchorB=new s.b2Vec2,this.length=1,this.minLength=0,this.maxLength=t.b2_maxFloat,this.stiffness=0,this.damping=0}Initialize(i,e,m,h){this.bodyA=i,this.bodyB=e,this.bodyA.GetLocalPoint(m,this.localAnchorA),this.bodyB.GetLocalPoint(h,this.localAnchorB),this.length=Math.max(s.b2Vec2.Distance(m,h),t.b2_linearSlop),this.minLength=this.length,this.maxLength=this.length}}exports.b2DistanceJointDef=h;class n extends i.b2Joint{constructor(i){var e,m;super(i),this.m_bias=0,this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_gamma=0,this.m_impulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_indexA=0,this.m_indexB=0,this.m_u=new s.b2Vec2,this.m_rA=new s.b2Vec2,this.m_rB=new s.b2Vec2,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_currentLength=0,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_softMass=0,this.m_mass=0,this.m_localAnchorA.Copy(i.localAnchorA),this.m_localAnchorB.Copy(i.localAnchorB),this.m_length=Math.max(i.length,t.b2_linearSlop),this.m_minLength=Math.max(i.minLength,t.b2_linearSlop),this.m_maxLength=Math.max(i.maxLength,this.m_minLength),this.m_stiffness=null!==(e=i.stiffness)&&void 0!==e?e:0,this.m_damping=null!==(m=i.damping)&&void 0!==m?m:0}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){const i=t*(this.m_impulse+this.m_lowerImpulse-this.m_upperImpulse);return s.x=i*this.m_u.x,s.y=i*this.m_u.y,s}GetReactionTorque(t){return 0}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetLength(s){return this.m_impulse=0,this.m_length=Math.max(t.b2_linearSlop,s),this.m_length}GetLength(){return this.m_length}SetMinLength(i){return this.m_lowerImpulse=0,this.m_minLength=(0,s.b2Clamp)(i,t.b2_linearSlop,this.m_maxLength),this.m_minLength}GetMinLength(){return this.m_minLength}SetMaxLength(t){return this.m_upperImpulse=0,this.m_maxLength=Math.max(t,this.m_minLength),this.m_maxLength}GetMaxLength(){return this.m_maxLength}GetCurrentLength(){const t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,m.worldPointA),i=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,m.worldPointB);return s.b2Vec2.Distance(i,t)}SetStiffness(t){this.m_stiffness=t}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t}GetDamping(){return this.m_damping}InitVelocityConstraints(i){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=i.positions[this.m_indexA].c,h=i.positions[this.m_indexA].a,n=i.velocities[this.m_indexA].v;let o=i.velocities[this.m_indexA].w;const _=i.positions[this.m_indexB].c,c=i.positions[this.m_indexB].a,a=i.velocities[this.m_indexB].v;let r=i.velocities[this.m_indexB].w;const{qA:l,qB:b,lalcA:A,lalcB:d}=m;l.Set(h),b.Set(c),s.b2Rot.MultiplyVec2(l,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,A),this.m_rA),s.b2Rot.MultiplyVec2(b,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,d),this.m_rB),this.m_u.x=_.x+this.m_rB.x-e.x-this.m_rA.x,this.m_u.y=_.y+this.m_rB.y-e.y-this.m_rA.y,this.m_currentLength=this.m_u.Length(),this.m_currentLength>t.b2_linearSlop?this.m_u.Scale(1/this.m_currentLength):(this.m_u.SetZero(),this.m_mass=0,this.m_impulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0);const p=s.b2Vec2.Cross(this.m_rA,this.m_u),u=s.b2Vec2.Cross(this.m_rB,this.m_u);let B=this.m_invMassA+this.m_invIA*p*p+this.m_invMassB+this.m_invIB*u*u;if(this.m_mass=0!==B?1/B:0,this.m_stiffness>0&&this.m_minLength<this.m_maxLength){const t=this.m_currentLength-this.m_length,s=this.m_damping,e=this.m_stiffness,m=i.step.dt;this.m_gamma=m*(s+m*e),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=t*m*e*this.m_gamma,B+=this.m_gamma,this.m_softMass=0!==B?1/B:0}else this.m_gamma=0,this.m_bias=0,this.m_softMass=this.m_mass;if(i.step.warmStarting){this.m_impulse*=i.step.dtRatio,this.m_lowerImpulse*=i.step.dtRatio,this.m_upperImpulse*=i.step.dtRatio;const{P:t}=m;s.b2Vec2.Scale(this.m_impulse+this.m_lowerImpulse-this.m_upperImpulse,this.m_u,t),n.SubtractScaled(this.m_invMassA,t),o-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,t),a.AddScaled(this.m_invMassB,t),r+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,t)}else this.m_impulse=0;i.velocities[this.m_indexA].w=o,i.velocities[this.m_indexB].w=r}SolveVelocityConstraints(t){const i=t.velocities[this.m_indexA].v;let e=t.velocities[this.m_indexA].w;const h=t.velocities[this.m_indexB].v;let n=t.velocities[this.m_indexB].w;if(this.m_minLength<this.m_maxLength){if(this.m_stiffness>0){const t=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),o=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),_=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(o,t,m.vpBA)),c=-this.m_softMass*(_+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c;const a=s.b2Vec2.Scale(c,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,a),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,a),h.AddScaled(this.m_invMassB,a),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,a)}{const o=this.m_currentLength-this.m_minLength,_=Math.max(0,o)*t.step.inv_dt,c=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),a=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),r=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(a,c,m.vpBA));let l=-this.m_mass*(r+_);const b=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(0,this.m_lowerImpulse+l),l=this.m_lowerImpulse-b;const A=s.b2Vec2.Scale(l,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,A),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,A),h.AddScaled(this.m_invMassB,A),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,A)}{const o=this.m_maxLength-this.m_currentLength,_=Math.max(0,o)*t.step.inv_dt,c=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),a=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),r=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(c,a,m.vpBA));let l=-this.m_mass*(r+_);const b=this.m_upperImpulse;this.m_upperImpulse=Math.max(0,this.m_upperImpulse+l),l=this.m_upperImpulse-b;const A=s.b2Vec2.Scale(-l,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,A),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,A),h.AddScaled(this.m_invMassB,A),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,A)}}else{const t=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),o=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),_=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(o,t,m.vpBA)),c=-this.m_mass*_;this.m_impulse+=c;const a=s.b2Vec2.Scale(c,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,a),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,a),h.AddScaled(this.m_invMassB,a),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,a)}t.velocities[this.m_indexA].w=e,t.velocities[this.m_indexB].w=n}SolvePositionConstraints(i){const e=i.positions[this.m_indexA].c;let h=i.positions[this.m_indexA].a;const n=i.positions[this.m_indexB].c;let o=i.positions[this.m_indexB].a;const{qA:_,qB:c,lalcA:a,lalcB:r,P:l}=m;_.Set(h),c.Set(o);const b=s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,a),this.m_rA),A=s.b2Rot.MultiplyVec2(c,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,r),this.m_rB);this.m_u.x=n.x+A.x-e.x-b.x,this.m_u.y=n.y+A.y-e.y-b.y;const d=this.m_u.Normalize();let p;if(this.m_minLength===this.m_maxLength)p=d-this.m_minLength;else if(d<this.m_minLength)p=d-this.m_minLength;else{if(!(this.m_maxLength<d))return!0;p=d-this.m_maxLength}const u=-this.m_mass*p;return s.b2Vec2.Scale(u,this.m_u,l),e.SubtractScaled(this.m_invMassA,l),h-=this.m_invIA*s.b2Vec2.Cross(b,l),n.AddScaled(this.m_invMassB,l),o+=this.m_invIB*s.b2Vec2.Cross(A,l),i.positions[this.m_indexA].a=h,i.positions[this.m_indexB].a=o,Math.abs(p)<t.b2_linearSlop}Draw(i){const{pA:h,pB:n,axis:o,pRest:_}=m.Draw,c=this.m_bodyA.GetTransform(),a=this.m_bodyB.GetTransform();if(s.b2Transform.MultiplyVec2(c,this.m_localAnchorA,h),s.b2Transform.MultiplyVec2(a,this.m_localAnchorB,n),s.b2Vec2.Subtract(n,h,o),o.Normalize(),i.DrawSegment(h,n,e.debugColors.joint5),s.b2Vec2.AddScaled(h,this.m_length,o,_),i.DrawPoint(_,8,e.debugColors.joint1),this.m_minLength!==this.m_maxLength){if(this.m_minLength>t.b2_linearSlop){const t=s.b2Vec2.AddScaled(h,this.m_minLength,o,m.Draw.p1);i.DrawPoint(t,4,e.debugColors.joint2)}if(this.m_maxLength<t.b2_maxFloat){const t=s.b2Vec2.AddScaled(h,this.m_maxLength,o,m.Draw.p1);i.DrawPoint(t,4,e.debugColors.joint3)}}}}exports.b2DistanceJoint=n;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_joint":"Xq2i","../common/b2_draw":"lvls"}],"SxzW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2AreaJoint=exports.b2AreaJointDef=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),e=require("./b2_joint"),i=require("./b2_distance_joint");class n extends e.b2JointDef{constructor(){super(e.b2JointType.e_areaJoint),this.bodies=[],this.stiffness=0,this.damping=0}AddBody(t){this.bodies.push(t),1===this.bodies.length?this.bodyA=t:2===this.bodies.length&&(this.bodyB=t)}}exports.b2AreaJointDef=n;class o extends e.b2Joint{constructor(e){var n,o;super(e),this.m_stiffness=0,this.m_damping=0,this.m_impulse=0,this.m_targetArea=0,this.m_joints=[],this.m_delta=new s.b2Vec2,this.m_bodies=e.bodies,this.m_stiffness=null!==(n=e.stiffness)&&void 0!==n?n:0,this.m_damping=null!==(o=e.damping)&&void 0!==o?o:0,this.m_targetLengths=(0,t.b2MakeNumberArray)(e.bodies.length),this.m_normals=(0,t.b2MakeArray)(e.bodies.length,s.b2Vec2),this.m_deltas=(0,t.b2MakeArray)(e.bodies.length,s.b2Vec2);const m=new i.b2DistanceJointDef;m.stiffness=this.m_stiffness,m.damping=this.m_damping,this.m_targetArea=0;for(let t=0;t<this.m_bodies.length;++t){const e=this.m_bodies[t],i=this.m_bodies[(t+1)%this.m_bodies.length],n=e.GetWorldCenter(),o=i.GetWorldCenter();this.m_targetLengths[t]=s.b2Vec2.Distance(n,o),this.m_targetArea+=s.b2Vec2.Cross(n,o),m.Initialize(e,i,n,o),this.m_joints[t]=e.GetWorld().CreateJoint(m)}this.m_targetArea*=.5}GetAnchorA(t){return t}GetAnchorB(t){return t}GetReactionForce(t,s){return s}GetReactionTorque(t){return 0}SetStiffness(t){this.m_stiffness=t;for(const s of this.m_joints)s.SetStiffness(t)}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t;for(const s of this.m_joints)s.SetDamping(t)}GetDamping(){return this.m_damping}InitVelocityConstraints(t){for(let e=0;e<this.m_bodies.length;++e){const i=this.m_bodies[(e+this.m_bodies.length-1)%this.m_bodies.length],n=this.m_bodies[(e+1)%this.m_bodies.length],o=t.positions[i.m_islandIndex].c,m=t.positions[n.m_islandIndex].c,r=this.m_deltas[e];s.b2Vec2.Subtract(m,o,r)}if(t.step.warmStarting){this.m_impulse*=t.step.dtRatio;for(let s=0;s<this.m_bodies.length;++s){const e=this.m_bodies[s],i=t.velocities[e.m_islandIndex].v,n=this.m_deltas[s];i.x+=e.m_invMass*n.y*.5*this.m_impulse,i.y+=e.m_invMass*-n.x*.5*this.m_impulse}}else this.m_impulse=0}SolveVelocityConstraints(t){let e=0,i=0;for(let o=0;o<this.m_bodies.length;++o){const n=this.m_bodies[o],m=t.velocities[n.m_islandIndex].v,r=this.m_deltas[o];e+=r.LengthSquared()/n.GetMass(),i+=s.b2Vec2.Cross(m,r)}const n=-2*i/e;this.m_impulse+=n;for(let s=0;s<this.m_bodies.length;++s){const e=this.m_bodies[s],i=t.velocities[e.m_islandIndex].v,o=this.m_deltas[s];i.x+=e.m_invMass*o.y*.5*n,i.y+=e.m_invMass*-o.x*.5*n}}SolvePositionConstraints(e){let i=0,n=0;for(let r=0;r<this.m_bodies.length;++r){const o=this.m_bodies[r],m=this.m_bodies[(r+1)%this.m_bodies.length],h=e.positions[o.m_islandIndex].c,a=e.positions[m.m_islandIndex].c,_=s.b2Vec2.Subtract(a,h,this.m_delta);let d=_.Length();d<t.b2_epsilon&&(d=1),this.m_normals[r].x=_.y/d,this.m_normals[r].y=-_.x/d,i+=d,n+=s.b2Vec2.Cross(h,a)}n*=.5;const o=.5*(this.m_targetArea-n)/i;let m=!0;for(let r=0;r<this.m_bodies.length;++r){const i=this.m_bodies[r],n=e.positions[i.m_islandIndex].c,h=(r+1)%this.m_bodies.length,a=s.b2Vec2.Add(this.m_normals[r],this.m_normals[h],this.m_delta);a.Scale(o);const _=a.LengthSquared();_>t.b2_maxLinearCorrection**2&&a.Scale(t.b2_maxLinearCorrection/Math.sqrt(_)),_>t.b2_linearSlop**2&&(m=!1),n.Add(a)}return m}}exports.b2AreaJoint=o;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_joint":"Xq2i","./b2_distance_joint":"xSy1"}],"zgG7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2FrictionJoint=exports.b2FrictionJointDef=void 0;const t=require("../common/b2_math"),s=require("./b2_joint"),i={qA:new t.b2Rot,qB:new t.b2Rot,lalcA:new t.b2Vec2,lalcB:new t.b2Vec2,Cdot:new t.b2Vec2,impulse:new t.b2Vec2,oldImpulse:new t.b2Vec2};class e extends s.b2JointDef{constructor(){super(s.b2JointType.e_frictionJoint),this.localAnchorA=new t.b2Vec2,this.localAnchorB=new t.b2Vec2,this.maxForce=0,this.maxTorque=0}Initialize(t,s,i){this.bodyA=t,this.bodyB=s,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB)}}exports.b2FrictionJointDef=e;class n extends s.b2Joint{constructor(s){var i,e;super(s),this.m_localAnchorA=new t.b2Vec2,this.m_localAnchorB=new t.b2Vec2,this.m_linearImpulse=new t.b2Vec2,this.m_angularImpulse=0,this.m_maxForce=0,this.m_maxTorque=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new t.b2Vec2,this.m_rB=new t.b2Vec2,this.m_localCenterA=new t.b2Vec2,this.m_localCenterB=new t.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new t.b2Mat22,this.m_angularMass=0,this.m_localAnchorA.Copy(s.localAnchorA),this.m_localAnchorB.Copy(s.localAnchorB),this.m_linearImpulse.SetZero(),this.m_maxForce=null!==(i=s.maxForce)&&void 0!==i?i:0,this.m_maxTorque=null!==(e=s.maxTorque)&&void 0!==e?e:0}InitVelocityConstraints(s){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=s.positions[this.m_indexA].a,n=s.velocities[this.m_indexA].v;let o=s.velocities[this.m_indexA].w;const m=s.positions[this.m_indexB].a,l=s.velocities[this.m_indexB].v;let r=s.velocities[this.m_indexB].w;const{qA:a,qB:h,lalcA:c,lalcB:_}=i;a.Set(e),h.Set(m),t.b2Rot.MultiplyVec2(a,t.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,c),this.m_rA),t.b2Rot.MultiplyVec2(h,t.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,_),this.m_rB);const u=this.m_invMassA,A=this.m_invMassB,d=this.m_invIA,b=this.m_invIB,x=this.m_linearMass;if(x.ex.x=u+A+d*this.m_rA.y*this.m_rA.y+b*this.m_rB.y*this.m_rB.y,x.ex.y=-d*this.m_rA.x*this.m_rA.y-b*this.m_rB.x*this.m_rB.y,x.ey.x=x.ex.y,x.ey.y=u+A+d*this.m_rA.x*this.m_rA.x+b*this.m_rB.x*this.m_rB.x,x.Inverse(),this.m_angularMass=d+b,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),s.step.warmStarting){this.m_linearImpulse.Scale(s.step.dtRatio),this.m_angularImpulse*=s.step.dtRatio;const i=this.m_linearImpulse;n.SubtractScaled(u,i),o-=d*(t.b2Vec2.Cross(this.m_rA,i)+this.m_angularImpulse),l.AddScaled(A,i),r+=b*(t.b2Vec2.Cross(this.m_rB,i)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;s.velocities[this.m_indexA].w=o,s.velocities[this.m_indexB].w=r}SolveVelocityConstraints(s){const e=s.velocities[this.m_indexA].v;let n=s.velocities[this.m_indexA].w;const o=s.velocities[this.m_indexB].v;let m=s.velocities[this.m_indexB].w;const l=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,h=this.m_invIB,c=s.step.dt;{const s=m-n;let i=-this.m_angularMass*s;const e=this.m_angularImpulse,o=c*this.m_maxTorque;this.m_angularImpulse=(0,t.b2Clamp)(this.m_angularImpulse+i,-o,o),n-=a*(i=this.m_angularImpulse-e),m+=h*i}{const{Cdot:s,impulse:_,oldImpulse:u}=i;t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(o,m,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(e,n,this.m_rA,t.b2Vec2.s_t1),s),t.b2Mat22.MultiplyVec2(this.m_linearMass,s,_).Negate(),u.Copy(this.m_linearImpulse),this.m_linearImpulse.Add(_);const A=c*this.m_maxForce;this.m_linearImpulse.LengthSquared()>A*A&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Scale(A)),t.b2Vec2.Subtract(this.m_linearImpulse,u,_),e.SubtractScaled(l,_),n-=a*t.b2Vec2.Cross(this.m_rA,_),o.AddScaled(r,_),m+=h*t.b2Vec2.Cross(this.m_rB,_)}s.velocities[this.m_indexA].w=n,s.velocities[this.m_indexB].w=m}SolvePositionConstraints(t){return!0}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){return s.x=t*this.m_linearImpulse.x,s.y=t*this.m_linearImpulse.y,s}GetReactionTorque(t){return t*this.m_angularImpulse}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetMaxTorque(t){this.m_maxTorque=t}GetMaxTorque(){return this.m_maxTorque}}exports.b2FrictionJoint=n;
},{"../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"RWFZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2GearJoint=exports.b2GearJointDef=void 0;const t=require("../common/b2_common"),i=require("../common/b2_math"),s=require("./b2_joint"),e={qA:new i.b2Rot,qB:new i.b2Rot,qC:new i.b2Rot,qD:new i.b2Rot,lalcA:new i.b2Vec2,lalcB:new i.b2Vec2,lalcC:new i.b2Vec2,lalcD:new i.b2Vec2,u:new i.b2Vec2,rA:new i.b2Vec2,rB:new i.b2Vec2,rC:new i.b2Vec2,rD:new i.b2Vec2,JvAC:new i.b2Vec2,JvBD:new i.b2Vec2};class m extends s.b2JointDef{constructor(){super(s.b2JointType.e_gearJoint),this.ratio=1}}exports.b2GearJointDef=m;class _ extends s.b2Joint{constructor(t){var e;let m,_;super(t),this.m_typeA=s.b2JointType.e_unknownJoint,this.m_typeB=s.b2JointType.e_unknownJoint,this.m_localAnchorA=new i.b2Vec2,this.m_localAnchorB=new i.b2Vec2,this.m_localAnchorC=new i.b2Vec2,this.m_localAnchorD=new i.b2Vec2,this.m_localAxisC=new i.b2Vec2,this.m_localAxisD=new i.b2Vec2,this.m_referenceAngleA=0,this.m_referenceAngleB=0,this.m_constant=0,this.m_ratio=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_indexC=0,this.m_indexD=0,this.m_lcA=new i.b2Vec2,this.m_lcB=new i.b2Vec2,this.m_lcC=new i.b2Vec2,this.m_lcD=new i.b2Vec2,this.m_mA=0,this.m_mB=0,this.m_mC=0,this.m_mD=0,this.m_iA=0,this.m_iB=0,this.m_iC=0,this.m_iD=0,this.m_JvAC=new i.b2Vec2,this.m_JvBD=new i.b2Vec2,this.m_JwA=0,this.m_JwB=0,this.m_JwC=0,this.m_JwD=0,this.m_mass=0,this.m_joint1=t.joint1,this.m_joint2=t.joint2,this.m_typeA=this.m_joint1.GetType(),this.m_typeB=this.m_joint2.GetType(),this.m_bodyC=this.m_joint1.GetBodyA(),this.m_bodyA=this.m_joint1.GetBodyB();const o=this.m_bodyA.m_xf,h=this.m_bodyA.m_sweep.a,c=this.m_bodyC.m_xf,l=this.m_bodyC.m_sweep.a;if(this.m_typeA===s.b2JointType.e_revoluteJoint){const i=t.joint1;this.m_localAnchorC.Copy(i.m_localAnchorA),this.m_localAnchorA.Copy(i.m_localAnchorB),this.m_referenceAngleA=i.m_referenceAngle,this.m_localAxisC.SetZero(),m=h-l-this.m_referenceAngleA}else{const s=t.joint1;this.m_localAnchorC.Copy(s.m_localAnchorA),this.m_localAnchorA.Copy(s.m_localAnchorB),this.m_referenceAngleA=s.m_referenceAngle,this.m_localAxisC.Copy(s.m_localXAxisA);const e=this.m_localAnchorC,_=i.b2Rot.TransposeMultiplyVec2(c.q,i.b2Rot.MultiplyVec2(o.q,this.m_localAnchorA,i.b2Vec2.s_t0).Add(o.p).Subtract(c.p),i.b2Vec2.s_t0);m=i.b2Vec2.Dot(_.Subtract(e),this.m_localAxisC)}this.m_bodyD=this.m_joint2.GetBodyA(),this.m_bodyB=this.m_joint2.GetBodyB();const n=this.m_bodyB.m_xf,r=this.m_bodyB.m_sweep.a,a=this.m_bodyD.m_xf,A=this.m_bodyD.m_sweep.a;if(this.m_typeB===s.b2JointType.e_revoluteJoint){const i=t.joint2;this.m_localAnchorD.Copy(i.m_localAnchorA),this.m_localAnchorB.Copy(i.m_localAnchorB),this.m_referenceAngleB=i.m_referenceAngle,this.m_localAxisD.SetZero(),_=r-A-this.m_referenceAngleB}else{const s=t.joint2;this.m_localAnchorD.Copy(s.m_localAnchorA),this.m_localAnchorB.Copy(s.m_localAnchorB),this.m_referenceAngleB=s.m_referenceAngle,this.m_localAxisD.Copy(s.m_localXAxisA);const e=this.m_localAnchorD,m=i.b2Rot.TransposeMultiplyVec2(a.q,i.b2Rot.MultiplyVec2(n.q,this.m_localAnchorB,i.b2Vec2.s_t0).Add(n.p).Subtract(a.p),i.b2Vec2.s_t0);_=i.b2Vec2.Dot(m.Subtract(e),this.m_localAxisD)}this.m_ratio=null!==(e=t.ratio)&&void 0!==e?e:1,this.m_constant=m+this.m_ratio*_,this.m_impulse=0}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;const m=t.positions[this.m_indexA].a,_=t.velocities[this.m_indexA].v;let o=t.velocities[this.m_indexA].w;const h=t.positions[this.m_indexB].a,c=t.velocities[this.m_indexB].v;let l=t.velocities[this.m_indexB].w;const n=t.positions[this.m_indexC].a,r=t.velocities[this.m_indexC].v;let a=t.velocities[this.m_indexC].w;const A=t.positions[this.m_indexD].a,b=t.velocities[this.m_indexD].v;let d=t.velocities[this.m_indexD].w;const{qA:p,qB:C,qC:B,qD:y}=e;if(p.Set(m),C.Set(h),B.Set(n),y.Set(A),this.m_mass=0,this.m_typeA===s.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{const{u:t,rC:s,rA:m,lalcA:_,lalcC:o}=e;i.b2Rot.MultiplyVec2(B,this.m_localAxisC,t),i.b2Rot.MultiplyVec2(B,i.b2Vec2.Subtract(this.m_localAnchorC,this.m_lcC,o),s),i.b2Rot.MultiplyVec2(p,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_lcA,_),m),this.m_JvAC.Copy(t),this.m_JwC=i.b2Vec2.Cross(s,t),this.m_JwA=i.b2Vec2.Cross(m,t),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===s.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{const{u:t,rB:s,rD:m,lalcB:_,lalcD:o}=e;i.b2Rot.MultiplyVec2(y,this.m_localAxisD,t),i.b2Rot.MultiplyVec2(y,i.b2Vec2.Subtract(this.m_localAnchorD,this.m_lcD,o),m),i.b2Rot.MultiplyVec2(C,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_lcB,_),s),i.b2Vec2.Scale(this.m_ratio,t,this.m_JvBD),this.m_JwD=this.m_ratio*i.b2Vec2.Cross(m,t),this.m_JwB=this.m_ratio*i.b2Vec2.Cross(s,t),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.step.warmStarting?(_.AddScaled(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,c.AddScaled(this.m_mB*this.m_impulse,this.m_JvBD),l+=this.m_iB*this.m_impulse*this.m_JwB,r.SubtractScaled(this.m_mC*this.m_impulse,this.m_JvAC),a-=this.m_iC*this.m_impulse*this.m_JwC,b.SubtractScaled(this.m_mD*this.m_impulse,this.m_JvBD),d-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=l,t.velocities[this.m_indexC].w=a,t.velocities[this.m_indexD].w=d}SolveVelocityConstraints(t){const s=t.velocities[this.m_indexA].v;let e=t.velocities[this.m_indexA].w;const m=t.velocities[this.m_indexB].v;let _=t.velocities[this.m_indexB].w;const o=t.velocities[this.m_indexC].v;let h=t.velocities[this.m_indexC].w;const c=t.velocities[this.m_indexD].v;let l=t.velocities[this.m_indexD].w,n=i.b2Vec2.Dot(this.m_JvAC,i.b2Vec2.Subtract(s,o,i.b2Vec2.s_t0))+i.b2Vec2.Dot(this.m_JvBD,i.b2Vec2.Subtract(m,c,i.b2Vec2.s_t0));n+=this.m_JwA*e-this.m_JwC*h+(this.m_JwB*_-this.m_JwD*l);const r=-this.m_mass*n;this.m_impulse+=r,s.AddScaled(this.m_mA*r,this.m_JvAC),e+=this.m_iA*r*this.m_JwA,m.AddScaled(this.m_mB*r,this.m_JvBD),_+=this.m_iB*r*this.m_JwB,o.SubtractScaled(this.m_mC*r,this.m_JvAC),h-=this.m_iC*r*this.m_JwC,c.SubtractScaled(this.m_mD*r,this.m_JvBD),l-=this.m_iD*r*this.m_JwD,t.velocities[this.m_indexA].w=e,t.velocities[this.m_indexB].w=_,t.velocities[this.m_indexC].w=h,t.velocities[this.m_indexD].w=l}SolvePositionConstraints(m){const _=m.positions[this.m_indexA].c;let o=m.positions[this.m_indexA].a;const h=m.positions[this.m_indexB].c;let c=m.positions[this.m_indexB].a;const l=m.positions[this.m_indexC].c;let n=m.positions[this.m_indexC].a;const r=m.positions[this.m_indexD].c;let a=m.positions[this.m_indexD].a;const{qA:A,qB:b,qC:d,qD:p,JvAC:C,JvBD:B}=e;A.Set(o),b.Set(c),d.Set(n),p.Set(a);let y,u,D,w,V,J,x=0;if(this.m_typeA===s.b2JointType.e_revoluteJoint)C.SetZero(),D=1,V=1,x+=this.m_iA+this.m_iC,y=o-n-this.m_referenceAngleA;else{const{u:t,rC:s,rA:m,lalcC:o,lalcA:h}=e;i.b2Rot.MultiplyVec2(d,this.m_localAxisC,t),i.b2Rot.MultiplyVec2(d,i.b2Vec2.Subtract(this.m_localAnchorC,this.m_lcC,o),s),i.b2Rot.MultiplyVec2(A,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_lcA,h),m),C.Copy(t),V=i.b2Vec2.Cross(s,t),D=i.b2Vec2.Cross(m,t),x+=this.m_mC+this.m_mA+this.m_iC*V*V+this.m_iA*D*D;const c=o,n=i.b2Rot.TransposeMultiplyVec2(d,i.b2Vec2.Add(m,_,i.b2Vec2.s_t0).Subtract(l),i.b2Vec2.s_t0);y=i.b2Vec2.Dot(i.b2Vec2.Subtract(n,c,i.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===s.b2JointType.e_revoluteJoint)B.SetZero(),w=this.m_ratio,J=this.m_ratio,x+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),u=c-a-this.m_referenceAngleB;else{const{u:t,rD:s,rB:m,lalcD:_,lalcB:o}=e;i.b2Rot.MultiplyVec2(p,this.m_localAxisD,t),i.b2Rot.MultiplyVec2(p,i.b2Vec2.Subtract(this.m_localAnchorD,this.m_lcD,_),s),i.b2Rot.MultiplyVec2(b,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_lcB,o),m),i.b2Vec2.Scale(this.m_ratio,t,B),J=this.m_ratio*i.b2Vec2.Cross(s,t),w=this.m_ratio*i.b2Vec2.Cross(m,t),x+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*J*J+this.m_iB*w*w;const c=_,l=i.b2Rot.TransposeMultiplyVec2(p,i.b2Vec2.Add(m,h,i.b2Vec2.s_t0).Subtract(r),i.b2Vec2.s_t0);u=i.b2Vec2.Dot(l.Subtract(c),this.m_localAxisD)}const v=y+this.m_ratio*u-this.m_constant;let S=0;return x>0&&(S=-v/x),_.AddScaled(this.m_mA*S,C),o+=this.m_iA*S*D,h.AddScaled(this.m_mB*S,B),c+=this.m_iB*S*w,l.SubtractScaled(this.m_mC*S,C),n-=this.m_iC*S*V,r.SubtractScaled(this.m_mD*S,B),a-=this.m_iD*S*J,m.positions[this.m_indexA].a=o,m.positions[this.m_indexB].a=c,m.positions[this.m_indexC].a=n,m.positions[this.m_indexD].a=a,0<t.b2_linearSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){return i.b2Vec2.Scale(t*this.m_impulse,this.m_JvAC,s)}GetReactionTorque(t){return t*this.m_impulse*this.m_JwA}GetJoint1(){return this.m_joint1}GetJoint2(){return this.m_joint2}GetRatio(){return this.m_ratio}SetRatio(t){this.m_ratio=t}}exports.b2GearJoint=_;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"mwAL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2MotorJoint=exports.b2MotorJointDef=void 0;const t=require("../common/b2_math"),e=require("./b2_joint"),s={qA:new t.b2Rot,qB:new t.b2Rot,K:new t.b2Mat22,Cdot:new t.b2Vec2,impulse:new t.b2Vec2,oldImpulse:new t.b2Vec2};class i extends e.b2JointDef{constructor(){super(e.b2JointType.e_motorJoint),this.linearOffset=new t.b2Vec2,this.angularOffset=0,this.maxForce=1,this.maxTorque=1,this.correctionFactor=.3}Initialize(t,e){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(e.GetPosition(),this.linearOffset);const s=t.GetAngle(),i=e.GetAngle();this.angularOffset=i-s}}exports.b2MotorJointDef=i;class n extends e.b2Joint{constructor(e){var s,i,n,r,o;super(e),this.m_linearOffset=new t.b2Vec2,this.m_linearImpulse=new t.b2Vec2,this.m_angularImpulse=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new t.b2Vec2,this.m_rB=new t.b2Vec2,this.m_localCenterA=new t.b2Vec2,this.m_localCenterB=new t.b2Vec2,this.m_linearError=new t.b2Vec2,this.m_angularError=0,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new t.b2Mat22,this.m_angularMass=0,this.m_linearOffset.Copy(null!==(s=e.linearOffset)&&void 0!==s?s:t.b2Vec2.ZERO),this.m_angularOffset=null!==(i=e.angularOffset)&&void 0!==i?i:0,this.m_linearImpulse.SetZero(),this.m_maxForce=null!==(n=e.maxForce)&&void 0!==n?n:1,this.m_maxTorque=null!==(r=e.maxTorque)&&void 0!==r?r:1,this.m_correctionFactor=null!==(o=e.correctionFactor)&&void 0!==o?o:.3}GetAnchorA(t){const e=this.m_bodyA.GetPosition();return t.x=e.x,t.y=e.y,t}GetAnchorB(t){const e=this.m_bodyB.GetPosition();return t.x=e.x,t.y=e.y,t}GetReactionForce(e,s){return t.b2Vec2.Scale(e,this.m_linearImpulse,s)}GetReactionTorque(t){return t*this.m_angularImpulse}SetLinearOffset(e){t.b2Vec2.Equals(e,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(e))}GetLinearOffset(){return this.m_linearOffset}SetAngularOffset(t){t!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=t)}GetAngularOffset(){return this.m_angularOffset}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetMaxTorque(t){this.m_maxTorque=t}GetMaxTorque(){return this.m_maxTorque}GetCorrectionFactor(){return this.m_correctionFactor}SetCorrectionFactor(t){this.m_correctionFactor=t}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=e.positions[this.m_indexA].c,n=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v;let o=e.velocities[this.m_indexA].w;const a=e.positions[this.m_indexB].c,m=e.positions[this.m_indexB].a,l=e.velocities[this.m_indexB].v;let _=e.velocities[this.m_indexB].w;const{qA:c,qB:h}=s;c.Set(n),h.Set(m);const u=t.b2Rot.MultiplyVec2(c,t.b2Vec2.Subtract(this.m_linearOffset,this.m_localCenterA,t.b2Vec2.s_t0),this.m_rA),d=t.b2Rot.MultiplyVec2(h,t.b2Vec2.Negate(this.m_localCenterB,t.b2Vec2.s_t0),this.m_rB),b=this.m_invMassA,x=this.m_invMassB,p=this.m_invIA,A=this.m_invIB,v=this.m_linearMass;if(v.ex.x=b+x+p*u.y*u.y+A*d.y*d.y,v.ex.y=-p*u.x*u.y-A*d.x*d.y,v.ey.x=v.ex.y,v.ey.y=b+x+p*u.x*u.x+A*d.x*d.x,v.Inverse(),this.m_angularMass=p+A,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.b2Vec2.Subtract(t.b2Vec2.Add(a,d,t.b2Vec2.s_t0),t.b2Vec2.Add(i,u,t.b2Vec2.s_t1),this.m_linearError),this.m_angularError=m-n-this.m_angularOffset,e.step.warmStarting){this.m_linearImpulse.Scale(e.step.dtRatio),this.m_angularImpulse*=e.step.dtRatio;const s=this.m_linearImpulse;r.SubtractScaled(b,s),o-=p*(t.b2Vec2.Cross(u,s)+this.m_angularImpulse),l.AddScaled(x,s),_+=A*(t.b2Vec2.Cross(d,s)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;e.velocities[this.m_indexA].w=o,e.velocities[this.m_indexB].w=_}SolveVelocityConstraints(e){const i=e.velocities[this.m_indexA].v;let n=e.velocities[this.m_indexA].w;const r=e.velocities[this.m_indexB].v;let o=e.velocities[this.m_indexB].w;const a=this.m_invMassA,m=this.m_invMassB,l=this.m_invIA,_=this.m_invIB,c=e.step.dt,h=e.step.inv_dt;{const e=o-n+h*this.m_correctionFactor*this.m_angularError;let s=-this.m_angularMass*e;const i=this.m_angularImpulse,r=c*this.m_maxTorque;this.m_angularImpulse=(0,t.b2Clamp)(this.m_angularImpulse+s,-r,r),n-=l*(s=this.m_angularImpulse-i),o+=_*s}{const{impulse:e,oldImpulse:u,Cdot:d}=s;t.b2Vec2.AddScaled(t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(r,o,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(i,n,this.m_rA,t.b2Vec2.s_t1),t.b2Vec2.s_t2),h*this.m_correctionFactor,this.m_linearError,d),t.b2Mat22.MultiplyVec2(this.m_linearMass,d,e).Negate(),u.Copy(this.m_linearImpulse),this.m_linearImpulse.Add(e);const b=c*this.m_maxForce;this.m_linearImpulse.LengthSquared()>b*b&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Scale(b)),t.b2Vec2.Subtract(this.m_linearImpulse,u,e),i.SubtractScaled(a,e),n-=l*t.b2Vec2.Cross(this.m_rA,e),r.AddScaled(m,e),o+=_*t.b2Vec2.Cross(this.m_rB,e)}e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=o}SolvePositionConstraints(t){return!0}}exports.b2MotorJoint=n;
},{"../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"BhEk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2MouseJoint=exports.b2MouseJointDef=void 0;const t=require("../common/b2_draw"),s=require("../common/b2_math"),e=require("./b2_joint"),i={qB:new s.b2Rot,lalcB:new s.b2Vec2,Cdot:new s.b2Vec2,impulse:new s.b2Vec2,oldImpulse:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2};class m extends e.b2JointDef{constructor(){super(e.b2JointType.e_mouseJoint),this.target=new s.b2Vec2,this.maxForce=0,this.stiffness=0,this.damping=0}}exports.b2MouseJointDef=m;class n extends e.b2Joint{constructor(t){var e,i,m,n;super(t),this.m_localAnchorB=new s.b2Vec2,this.m_targetA=new s.b2Vec2,this.m_stiffness=0,this.m_damping=0,this.m_beta=0,this.m_impulse=new s.b2Vec2,this.m_maxForce=0,this.m_gamma=0,this.m_indexB=0,this.m_rB=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassB=0,this.m_invIB=0,this.m_mass=new s.b2Mat22,this.m_C=new s.b2Vec2,this.m_targetA.Copy(null!==(e=t.target)&&void 0!==e?e:s.b2Vec2.ZERO),s.b2Transform.TransposeMultiplyVec2(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB),this.m_maxForce=null!==(i=t.maxForce)&&void 0!==i?i:0,this.m_stiffness=null!==(m=t.stiffness)&&void 0!==m?m:0,this.m_damping=null!==(n=t.damping)&&void 0!==n?n:0,this.m_beta=0,this.m_gamma=0}SetTarget(t){s.b2Vec2.Equals(t,this.m_targetA)||(this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(t))}GetTarget(){return this.m_targetA}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetStiffness(t){this.m_stiffness=t}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t}GetDamping(){return this.m_damping}InitVelocityConstraints(t){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexB].c,m=t.positions[this.m_indexB].a,n=t.velocities[this.m_indexB].v;let o=t.velocities[this.m_indexB].w;const{qB:h,lalcB:r}=i;h.Set(m);const a=this.m_damping,_=this.m_stiffness,c=t.step.dt;this.m_gamma=c*(a+c*_),0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=c*_*this.m_gamma,s.b2Rot.MultiplyVec2(h,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,r),this.m_rB);const l=this.m_mass;l.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,l.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,l.ey.x=l.ex.y,l.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,l.Inverse(),s.b2Vec2.Add(e,this.m_rB,this.m_C).Subtract(this.m_targetA),this.m_C.Scale(this.m_beta),o*=.98,t.step.warmStarting?(this.m_impulse.Scale(t.step.dtRatio),n.AddScaled(this.m_invMassB,this.m_impulse),o+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),t.velocities[this.m_indexB].w=o}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexB].v;let m=t.velocities[this.m_indexB].w;const{Cdot:n,impulse:o,oldImpulse:h}=i;s.b2Vec2.AddCrossScalarVec2(e,m,this.m_rB,n),s.b2Mat22.MultiplyVec2(this.m_mass,s.b2Vec2.Add(n,this.m_C,o).AddScaled(this.m_gamma,this.m_impulse).Negate(),o),h.Copy(this.m_impulse),this.m_impulse.Add(o);const r=t.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>r*r&&this.m_impulse.Scale(r/this.m_impulse.Length()),s.b2Vec2.Subtract(this.m_impulse,h,o),e.AddScaled(this.m_invMassB,o),m+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,o),t.velocities[this.m_indexB].w=m}SolvePositionConstraints(t){return!0}GetAnchorA(t){return t.x=this.m_targetA.x,t.y=this.m_targetA.y,t}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return s.b2Vec2.Scale(t,this.m_impulse,e)}GetReactionTorque(t){return 0}ShiftOrigin(t){this.m_targetA.Subtract(t)}Draw(s){const e=this.GetAnchorA(i.pA),m=this.GetAnchorB(i.pB);s.DrawPoint(e,4,t.debugColors.joint7),s.DrawPoint(m,4,t.debugColors.joint7),s.DrawSegment(e,m,t.debugColors.joint8)}}exports.b2MouseJoint=n;
},{"../common/b2_draw":"lvls","../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"FAa8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PrismaticJoint=exports.b2PrismaticJointDef=void 0;const t=require("../common/b2_common"),e=require("../common/b2_draw"),s=require("../common/b2_math"),i=require("./b2_joint"),o={K3:new s.b2Mat33,K2:new s.b2Mat22,qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,rA:new s.b2Vec2,rB:new s.b2Vec2,GetJointTranslation:{pA:new s.b2Vec2,pB:new s.b2Vec2,d:new s.b2Vec2,axis:new s.b2Vec2},InitVelocityConstraints:{d:new s.b2Vec2,P:new s.b2Vec2},SolveVelocityConstraints:{P:new s.b2Vec2,df:new s.b2Vec2},SolvePositionConstraints:{d:new s.b2Vec2,impulse:new s.b2Vec3,impulse1:new s.b2Vec2,P:new s.b2Vec2},Draw:{p1:new s.b2Vec2,p2:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,lower:new s.b2Vec2,upper:new s.b2Vec2,perp:new s.b2Vec2}};class l extends i.b2JointDef{constructor(){super(i.b2JointType.e_prismaticJoint),this.localAnchorA=new s.b2Vec2,this.localAnchorB=new s.b2Vec2,this.localAxisA=new s.b2Vec2(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0}Initialize(t,e,s,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(s,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.bodyA.GetLocalVector(i,this.localAxisA),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}exports.b2PrismaticJointDef=l;class m extends i.b2Joint{constructor(t){var e,i,o,l,m,n,a,c,r,h;super(t),this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_localXAxisA=new s.b2Vec2,this.m_localYAxisA=new s.b2Vec2,this.m_referenceAngle=0,this.m_impulse=new s.b2Vec2,this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_lowerTranslation=0,this.m_upperTranslation=0,this.m_maxMotorForce=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_enableMotor=!1,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_axis=new s.b2Vec2,this.m_perp=new s.b2Vec2,this.m_s1=0,this.m_s2=0,this.m_a1=0,this.m_a2=0,this.m_K=new s.b2Mat22,this.m_translation=0,this.m_axialMass=0,this.m_localAnchorA.Copy(null!==(e=t.localAnchorA)&&void 0!==e?e:s.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(i=t.localAnchorB)&&void 0!==i?i:s.b2Vec2.ZERO),s.b2Vec2.Normalize(null!==(o=t.localAxisA)&&void 0!==o?o:s.b2Vec2.UNITX,this.m_localXAxisA),s.b2Vec2.CrossOneVec2(this.m_localXAxisA,this.m_localYAxisA),this.m_referenceAngle=null!==(l=t.referenceAngle)&&void 0!==l?l:0,this.m_lowerTranslation=null!==(m=t.lowerTranslation)&&void 0!==m?m:0,this.m_upperTranslation=null!==(n=t.upperTranslation)&&void 0!==n?n:0,this.m_maxMotorForce=null!==(a=t.maxMotorForce)&&void 0!==a?a:0,this.m_motorSpeed=null!==(c=t.motorSpeed)&&void 0!==c?c:0,this.m_enableLimit=null!==(r=t.enableLimit)&&void 0!==r&&r,this.m_enableMotor=null!==(h=t.enableMotor)&&void 0!==h&&h}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].c,i=t.positions[this.m_indexA].a,l=t.velocities[this.m_indexA].v;let m=t.velocities[this.m_indexA].w;const n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,c=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const{qA:h,qB:_,lalcA:b,lalcB:p,rA:d,rB:A}=o;h.Set(i),_.Set(a),s.b2Rot.MultiplyVec2(h,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,b),d),s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,p),A);const u=s.b2Vec2.Subtract(n,e,o.InitVelocityConstraints.d).Add(A).Subtract(d),V=this.m_invMassA,x=this.m_invMassB,S=this.m_invIA,w=this.m_invIB;s.b2Rot.MultiplyVec2(h,this.m_localXAxisA,this.m_axis),this.m_a1=s.b2Vec2.Cross(s.b2Vec2.Add(u,d,s.b2Vec2.s_t0),this.m_axis),this.m_a2=s.b2Vec2.Cross(A,this.m_axis),this.m_axialMass=V+x+S*this.m_a1*this.m_a1+w*this.m_a2*this.m_a2,this.m_axialMass>0&&(this.m_axialMass=1/this.m_axialMass),s.b2Rot.MultiplyVec2(h,this.m_localYAxisA,this.m_perp),this.m_s1=s.b2Vec2.Cross(s.b2Vec2.Add(u,d,s.b2Vec2.s_t0),this.m_perp),this.m_s2=s.b2Vec2.Cross(A,this.m_perp);const y=V+x+S*this.m_s1*this.m_s1+w*this.m_s2*this.m_s2,M=S*this.m_s1+w*this.m_s2;let B=S+w;if(0===B&&(B=1),this.m_K.ex.Set(y,M),this.m_K.ey.Set(M,B),this.m_enableLimit?this.m_translation=s.b2Vec2.Dot(this.m_axis,u):(this.m_lowerImpulse=0,this.m_upperImpulse=0),this.m_enableMotor||(this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse.Scale(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio,this.m_lowerImpulse*=t.step.dtRatio,this.m_upperImpulse*=t.step.dtRatio;const e=this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse,{P:i}=o.InitVelocityConstraints;s.b2Vec2.Scale(this.m_impulse.x,this.m_perp,i).AddScaled(e,this.m_axis);const n=this.m_impulse.x*this.m_s1+this.m_impulse.y+e*this.m_a1,a=this.m_impulse.x*this.m_s2+this.m_impulse.y+e*this.m_a2;l.SubtractScaled(V,i),m-=S*n,c.AddScaled(x,i),r+=w*a}else this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0;t.velocities[this.m_indexA].w=m,t.velocities[this.m_indexB].w=r}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const l=t.velocities[this.m_indexB].v;let m=t.velocities[this.m_indexB].w;const n=this.m_invMassA,a=this.m_invMassB,c=this.m_invIA,r=this.m_invIB,{P:h,df:_}=o.SolveVelocityConstraints;if(this.m_enableMotor){const o=s.b2Vec2.Dot(this.m_axis,s.b2Vec2.Subtract(l,e,s.b2Vec2.s_t0))+this.m_a2*m-this.m_a1*i;let _=this.m_axialMass*(this.m_motorSpeed-o);const b=this.m_motorImpulse,p=t.step.dt*this.m_maxMotorForce;this.m_motorImpulse=(0,s.b2Clamp)(this.m_motorImpulse+_,-p,p),_=this.m_motorImpulse-b,s.b2Vec2.Scale(_,this.m_axis,h);const d=_*this.m_a1,A=_*this.m_a2;e.SubtractScaled(n,h),i-=c*d,l.AddScaled(a,h),m+=r*A}if(this.m_enableLimit){{const o=this.m_translation-this.m_lowerTranslation,_=s.b2Vec2.Dot(this.m_axis,s.b2Vec2.Subtract(l,e,s.b2Vec2.s_t0))+this.m_a2*m-this.m_a1*i;let b=-this.m_axialMass*(_+Math.max(o,0)*t.step.inv_dt);const p=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(this.m_lowerImpulse+b,0),b=this.m_lowerImpulse-p,s.b2Vec2.Scale(b,this.m_axis,h);const d=b*this.m_a1,A=b*this.m_a2;e.SubtractScaled(n,h),i-=c*d,l.AddScaled(a,h),m+=r*A}{const o=this.m_upperTranslation-this.m_translation,_=s.b2Vec2.Dot(this.m_axis,s.b2Vec2.Subtract(e,l,s.b2Vec2.s_t0))+this.m_a1*i-this.m_a2*m;let b=-this.m_axialMass*(_+Math.max(o,0)*t.step.inv_dt);const p=this.m_upperImpulse;this.m_upperImpulse=Math.max(this.m_upperImpulse+b,0),b=this.m_upperImpulse-p,s.b2Vec2.Scale(b,this.m_axis,h);const d=b*this.m_a1,A=b*this.m_a2;e.AddScaled(n,h),i+=c*d,l.SubtractScaled(a,h),m-=r*A}}{const t=s.b2Vec2.Dot(this.m_perp,s.b2Vec2.Subtract(l,e,s.b2Vec2.s_t0))+this.m_s2*m-this.m_s1*i,o=m-i;this.m_K.Solve(-t,-o,_),this.m_impulse.Add(_),s.b2Vec2.Scale(_.x,this.m_perp,h);const b=_.x*this.m_s1+_.y,p=_.x*this.m_s2+_.y;e.SubtractScaled(n,h),i-=c*b,l.AddScaled(a,h),m+=r*p}t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=m}SolvePositionConstraints(e){const i=e.positions[this.m_indexA].c;let l=e.positions[this.m_indexA].a;const m=e.positions[this.m_indexB].c;let n=e.positions[this.m_indexB].a;const{qA:a,qB:c,lalcA:r,lalcB:h,rA:_,rB:b}=o;a.Set(l),c.Set(n);const p=this.m_invMassA,d=this.m_invMassB,A=this.m_invIA,u=this.m_invIB,{d:V,impulse:x,P:S}=o.SolvePositionConstraints;s.b2Rot.MultiplyVec2(a,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),_),s.b2Rot.MultiplyVec2(c,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,h),b),s.b2Vec2.Add(m,b,V).Subtract(i).Subtract(_);const w=s.b2Rot.MultiplyVec2(a,this.m_localXAxisA,this.m_axis),y=s.b2Vec2.Cross(s.b2Vec2.Add(V,_,s.b2Vec2.s_t0),w),M=s.b2Vec2.Cross(b,w),B=s.b2Rot.MultiplyVec2(a,this.m_localYAxisA,this.m_perp),v=s.b2Vec2.Cross(s.b2Vec2.Add(V,_,s.b2Vec2.s_t0),B),I=s.b2Vec2.Cross(b,B),C=s.b2Vec2.Dot(B,V),T=n-l-this.m_referenceAngle;let G=Math.abs(C);const f=Math.abs(T);let g=!1,D=0;if(this.m_enableLimit){const e=s.b2Vec2.Dot(w,V);Math.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(D=e,G=Math.max(G,Math.abs(e)),g=!0):e<=this.m_lowerTranslation?(D=Math.min(e-this.m_lowerTranslation,0),G=Math.max(G,this.m_lowerTranslation-e),g=!0):e>=this.m_upperTranslation&&(D=Math.max(e-this.m_upperTranslation,0),G=Math.max(G,e-this.m_upperTranslation),g=!0)}if(g){const t=p+d+A*v*v+u*I*I,e=A*v+u*I,s=A*v*y+u*I*M;let i=A+u;0===i&&(i=1);const l=A*y+u*M,m=p+d+A*y*y+u*M*M,n=o.K3;n.ex.Set(t,e,s),n.ey.Set(e,i,l),n.ez.Set(s,l,m),n.Solve33(-C,-T,-D,x)}else{const t=p+d+A*v*v+u*I*I,e=A*v+u*I;let s=A+u;0===s&&(s=1);const i=o.K2;i.ex.Set(t,e),i.ey.Set(e,s);const l=i.Solve(-C,-T,o.SolvePositionConstraints.impulse1);x.x=l.x,x.y=l.y,x.z=0}s.b2Vec2.Scale(x.x,B,S).AddScaled(x.z,w);const R=x.x*v+x.y+x.z*y,L=x.x*I+x.y+x.z*M;return i.SubtractScaled(p,S),l-=A*R,m.AddScaled(d,S),n+=u*L,e.positions[this.m_indexA].a=l,e.positions[this.m_indexB].a=n,G<=t.b2_linearSlop&&f<=t.b2_angularSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){const s=this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse;return e.x=t*(this.m_impulse.x*this.m_perp.x+s*this.m_axis.x),e.y=t*(this.m_impulse.x*this.m_perp.y+s*this.m_axis.y),e}GetReactionTorque(t){return t*this.m_impulse.y}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetLocalAxisA(){return this.m_localXAxisA}GetReferenceAngle(){return this.m_referenceAngle}GetJointTranslation(){const{pA:t,pB:e,axis:i,d:l}=o.GetJointTranslation;return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t),this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e),s.b2Vec2.Subtract(e,t,l),this.m_bodyA.GetWorldVector(this.m_localXAxisA,i),s.b2Vec2.Dot(l,i)}GetJointSpeed(){const t=this.m_bodyA,e=this.m_bodyB,{lalcA:i,lalcB:l,rA:m,rB:n}=o;s.b2Rot.MultiplyVec2(t.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorA,t.m_sweep.localCenter,i),m),s.b2Rot.MultiplyVec2(e.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorB,e.m_sweep.localCenter,l),n);const a=s.b2Vec2.Add(t.m_sweep.c,m,s.b2Vec2.s_t0),c=s.b2Vec2.Add(e.m_sweep.c,n,s.b2Vec2.s_t1),r=s.b2Vec2.Subtract(c,a,s.b2Vec2.s_t2),h=s.b2Rot.MultiplyVec2(t.m_xf.q,this.m_localXAxisA,this.m_axis),_=t.m_linearVelocity,b=e.m_linearVelocity,p=t.m_angularVelocity,d=e.m_angularVelocity;return s.b2Vec2.Dot(r,s.b2Vec2.CrossScalarVec2(p,h,s.b2Vec2.s_t0))+s.b2Vec2.Dot(h,s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(b,d,n,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(_,p,m,s.b2Vec2.s_t1),s.b2Vec2.s_t0))}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(t){return t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_lowerImpulse=0,this.m_upperImpulse=0),t}GetLowerLimit(){return this.m_lowerTranslation}GetUpperLimit(){return this.m_upperTranslation}SetLimits(t,e){t===this.m_lowerTranslation&&e===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_lowerImpulse=0,this.m_upperImpulse=0)}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){return t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t),t}SetMotorSpeed(t){return t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t),t}GetMotorSpeed(){return this.m_motorSpeed}SetMaxMotorForce(t){t!==this.m_maxMotorForce&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t)}GetMaxMotorForce(){return this.m_maxMotorForce}GetMotorForce(t){return t*this.m_motorImpulse}Draw(t){const{p1:i,p2:l,pA:m,pB:n,axis:a}=o.Draw,c=this.m_bodyA.GetTransform(),r=this.m_bodyB.GetTransform();if(s.b2Transform.MultiplyVec2(c,this.m_localAnchorA,m),s.b2Transform.MultiplyVec2(r,this.m_localAnchorB,n),s.b2Rot.MultiplyVec2(c.q,this.m_localXAxisA,a),t.DrawSegment(m,n,e.debugColors.joint5),this.m_enableLimit){const{lower:n,upper:r,perp:h}=o.Draw;s.b2Vec2.AddScaled(m,this.m_lowerTranslation,a,n),s.b2Vec2.AddScaled(m,this.m_upperTranslation,a,r),s.b2Rot.MultiplyVec2(c.q,this.m_localYAxisA,h),t.DrawSegment(n,r,e.debugColors.joint1),t.DrawSegment(s.b2Vec2.SubtractScaled(n,.5,h,i),s.b2Vec2.AddScaled(n,.5,h,l),e.debugColors.joint2),t.DrawSegment(s.b2Vec2.SubtractScaled(r,.5,h,i),s.b2Vec2.AddScaled(r,.5,h,l),e.debugColors.joint3)}else t.DrawSegment(s.b2Vec2.Subtract(m,a,i),s.b2Vec2.Add(m,a,l),e.debugColors.joint1);t.DrawPoint(m,5,e.debugColors.joint1),t.DrawPoint(n,5,e.debugColors.joint4)}}exports.b2PrismaticJoint=m;
},{"../common/b2_common":"ReKW","../common/b2_draw":"lvls","../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"smnA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PulleyJoint=exports.b2PulleyJointDef=exports.b2_minPulleyLength=void 0;const t=require("../common/b2_common"),i=require("../common/b2_draw"),s=require("../common/b2_math"),e=require("./b2_joint");exports.b2_minPulleyLength=2;const n={qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,p:new s.b2Vec2,PA:new s.b2Vec2,PB:new s.b2Vec2,vpA:new s.b2Vec2,vpB:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2};class o extends e.b2JointDef{constructor(){super(e.b2JointType.e_pulleyJoint),this.groundAnchorA=new s.b2Vec2(-1,1),this.groundAnchorB=new s.b2Vec2(1,1),this.localAnchorA=new s.b2Vec2(-1,0),this.localAnchorB=new s.b2Vec2(1,0),this.lengthA=0,this.lengthB=0,this.ratio=1,this.collideConnected=!0}Initialize(t,i,e,n,o,h,c){this.bodyA=t,this.bodyB=i,this.groundAnchorA.Copy(e),this.groundAnchorB.Copy(n),this.bodyA.GetLocalPoint(o,this.localAnchorA),this.bodyB.GetLocalPoint(h,this.localAnchorB),this.lengthA=s.b2Vec2.Distance(o,e),this.lengthB=s.b2Vec2.Distance(h,n),this.ratio=c}}exports.b2PulleyJointDef=o;const h=new s.b2Vec2(-1,1),c=s.b2Vec2.UNITX,r=new s.b2Vec2(-1,0),m=s.b2Vec2.UNITX;class _ extends e.b2Joint{constructor(t){var i,e,n,o,_,l,A;super(t),this.m_groundAnchorA=new s.b2Vec2,this.m_groundAnchorB=new s.b2Vec2,this.m_lengthA=0,this.m_lengthB=0,this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_constant=0,this.m_ratio=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_uA=new s.b2Vec2,this.m_uB=new s.b2Vec2,this.m_rA=new s.b2Vec2,this.m_rB=new s.b2Vec2,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0,this.m_groundAnchorA.Copy(null!==(i=t.groundAnchorA)&&void 0!==i?i:h),this.m_groundAnchorB.Copy(null!==(e=t.groundAnchorB)&&void 0!==e?e:c),this.m_localAnchorA.Copy(null!==(n=t.localAnchorA)&&void 0!==n?n:r),this.m_localAnchorB.Copy(null!==(o=t.localAnchorB)&&void 0!==o?o:m),this.m_lengthA=null!==(_=t.lengthA)&&void 0!==_?_:0,this.m_lengthB=null!==(l=t.lengthB)&&void 0!==l?l:0,this.m_ratio=null!==(A=t.ratio)&&void 0!==A?A:1,this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0}InitVelocityConstraints(i){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=i.positions[this.m_indexA].c,o=i.positions[this.m_indexA].a,h=i.velocities[this.m_indexA].v;let c=i.velocities[this.m_indexA].w;const r=i.positions[this.m_indexB].c,m=i.positions[this.m_indexB].a,_=i.velocities[this.m_indexB].v;let l=i.velocities[this.m_indexB].w;const{qA:A,qB:a,lalcA:d,lalcB:b}=n;A.Set(o),a.Set(m),s.b2Rot.MultiplyVec2(A,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,d),this.m_rA),s.b2Rot.MultiplyVec2(a,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,b),this.m_rB),s.b2Vec2.Add(e,this.m_rA,this.m_uA).Subtract(this.m_groundAnchorA),s.b2Vec2.Add(r,this.m_rB,this.m_uB).Subtract(this.m_groundAnchorB);const u=this.m_uA.Length(),B=this.m_uB.Length();u>10*t.b2_linearSlop?this.m_uA.Scale(1/u):this.m_uA.SetZero(),B>10*t.b2_linearSlop?this.m_uB.Scale(1/B):this.m_uB.SetZero();const V=s.b2Vec2.Cross(this.m_rA,this.m_uA),v=s.b2Vec2.Cross(this.m_rB,this.m_uB),p=this.m_invMassA+this.m_invIA*V*V,g=this.m_invMassB+this.m_invIB*v*v;if(this.m_mass=p+this.m_ratio*this.m_ratio*g,this.m_mass>0&&(this.m_mass=1/this.m_mass),i.step.warmStarting){this.m_impulse*=i.step.dtRatio;const{PA:t,PB:e}=n;s.b2Vec2.Scale(-this.m_impulse,this.m_uA,t),s.b2Vec2.Scale(-this.m_ratio*this.m_impulse,this.m_uB,e),h.AddScaled(this.m_invMassA,t),c+=this.m_invIA*s.b2Vec2.Cross(this.m_rA,t),_.AddScaled(this.m_invMassB,e),l+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,e)}else this.m_impulse=0;i.velocities[this.m_indexA].w=c,i.velocities[this.m_indexB].w=l}SolveVelocityConstraints(t){const i=t.velocities[this.m_indexA].v;let e=t.velocities[this.m_indexA].w;const o=t.velocities[this.m_indexB].v;let h=t.velocities[this.m_indexB].w;const{PA:c,PB:r,vpA:m,vpB:_}=n;s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m),s.b2Vec2.AddCrossScalarVec2(o,h,this.m_rB,_);const l=-s.b2Vec2.Dot(this.m_uA,m)-this.m_ratio*s.b2Vec2.Dot(this.m_uB,_),A=-this.m_mass*l;this.m_impulse+=A,s.b2Vec2.Scale(-A,this.m_uA,c),s.b2Vec2.Scale(-this.m_ratio*A,this.m_uB,r),i.AddScaled(this.m_invMassA,c),e+=this.m_invIA*s.b2Vec2.Cross(this.m_rA,c),o.AddScaled(this.m_invMassB,r),h+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,r),t.velocities[this.m_indexA].w=e,t.velocities[this.m_indexB].w=h}SolvePositionConstraints(i){const e=i.positions[this.m_indexA].c;let o=i.positions[this.m_indexA].a;const h=i.positions[this.m_indexB].c;let c=i.positions[this.m_indexB].a;const{qA:r,qB:m,lalcA:_,lalcB:l,PA:A,PB:a}=n;r.Set(o),m.Set(c);const d=s.b2Rot.MultiplyVec2(r,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,_),this.m_rA),b=s.b2Rot.MultiplyVec2(m,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,l),this.m_rB),u=s.b2Vec2.Add(e,d,this.m_uA).Subtract(this.m_groundAnchorA),B=s.b2Vec2.Add(h,b,this.m_uB).Subtract(this.m_groundAnchorB),V=u.Length(),v=B.Length();V>10*t.b2_linearSlop?u.Scale(1/V):u.SetZero(),v>10*t.b2_linearSlop?B.Scale(1/v):B.SetZero();const p=s.b2Vec2.Cross(d,u),g=s.b2Vec2.Cross(b,B),S=this.m_invMassA+this.m_invIA*p*p,w=this.m_invMassB+this.m_invIB*g*g;let y=S+this.m_ratio*this.m_ratio*w;y>0&&(y=1/y);const x=this.m_constant-V-this.m_ratio*v,C=Math.abs(x),G=-y*x;return s.b2Vec2.Scale(-G,u,A),s.b2Vec2.Scale(-this.m_ratio*G,B,a),e.AddScaled(this.m_invMassA,A),o+=this.m_invIA*s.b2Vec2.Cross(d,A),h.AddScaled(this.m_invMassB,a),c+=this.m_invIB*s.b2Vec2.Cross(b,a),i.positions[this.m_indexA].a=o,i.positions[this.m_indexB].a=c,C<t.b2_linearSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,i){return i.x=t*this.m_impulse*this.m_uB.x,i.y=t*this.m_impulse*this.m_uB.y,i}GetReactionTorque(t){return 0}GetGroundAnchorA(){return this.m_groundAnchorA}GetGroundAnchorB(){return this.m_groundAnchorB}GetLengthA(){return this.m_lengthA}GetLengthB(){return this.m_lengthB}GetRatio(){return this.m_ratio}GetCurrentLengthA(){const t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,n.p),i=this.m_groundAnchorA;return s.b2Vec2.Distance(t,i)}GetCurrentLengthB(){const t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,n.p),i=this.m_groundAnchorB;return s.b2Vec2.Distance(t,i)}ShiftOrigin(t){this.m_groundAnchorA.Subtract(t),this.m_groundAnchorB.Subtract(t)}Draw(t){const s=this.GetAnchorA(n.pA),e=this.GetAnchorB(n.pB),o=this.GetGroundAnchorA(),h=this.GetGroundAnchorB();t.DrawSegment(o,s,i.debugColors.joint6),t.DrawSegment(h,e,i.debugColors.joint6),t.DrawSegment(o,h,i.debugColors.joint6)}}exports.b2PulleyJoint=_;
},{"../common/b2_common":"ReKW","../common/b2_draw":"lvls","../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"ELTV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2RevoluteJoint=exports.b2RevoluteJointDef=void 0;const e=require("../common/b2_common"),t=require("../common/b2_draw"),i=require("../common/b2_math"),s=require("./b2_joint"),o={qA:new i.b2Rot,qB:new i.b2Rot,lalcA:new i.b2Vec2,lalcB:new i.b2Vec2,P:new i.b2Vec2,Cdot:new i.b2Vec2,C:new i.b2Vec2,impulse:new i.b2Vec2,p2:new i.b2Vec2,r:new i.b2Vec2,pA:new i.b2Vec2,pB:new i.b2Vec2,rlo:new i.b2Vec2,rhi:new i.b2Vec2};class m extends s.b2JointDef{constructor(){super(s.b2JointType.e_revoluteJoint),this.localAnchorA=new i.b2Vec2,this.localAnchorB=new i.b2Vec2,this.referenceAngle=0,this.enableLimit=!1,this.lowerAngle=0,this.upperAngle=0,this.enableMotor=!1,this.motorSpeed=0,this.maxMotorTorque=0}Initialize(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}exports.b2RevoluteJointDef=m;class l extends s.b2Joint{constructor(e){var t,s,o,m,l,n,r,h,_;super(e),this.m_localAnchorA=new i.b2Vec2,this.m_localAnchorB=new i.b2Vec2,this.m_impulse=new i.b2Vec2,this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_enableMotor=!1,this.m_maxMotorTorque=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_referenceAngle=0,this.m_lowerAngle=0,this.m_upperAngle=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new i.b2Vec2,this.m_rB=new i.b2Vec2,this.m_localCenterA=new i.b2Vec2,this.m_localCenterB=new i.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_K=new i.b2Mat22,this.m_angle=0,this.m_axialMass=0,this.m_localAnchorA.Copy(null!==(t=e.localAnchorA)&&void 0!==t?t:i.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(s=e.localAnchorB)&&void 0!==s?s:i.b2Vec2.ZERO),this.m_referenceAngle=null!==(o=e.referenceAngle)&&void 0!==o?o:0,this.m_impulse.SetZero(),this.m_lowerAngle=null!==(m=e.lowerAngle)&&void 0!==m?m:0,this.m_upperAngle=null!==(l=e.upperAngle)&&void 0!==l?l:0,this.m_maxMotorTorque=null!==(n=e.maxMotorTorque)&&void 0!==n?n:0,this.m_motorSpeed=null!==(r=e.motorSpeed)&&void 0!==r?r:0,this.m_enableLimit=null!==(h=e.enableLimit)&&void 0!==h&&h,this.m_enableMotor=null!==(_=e.enableMotor)&&void 0!==_&&_}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const t=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v;let m=e.velocities[this.m_indexA].w;const l=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v;let r=e.velocities[this.m_indexB].w;const{qA:h,qB:_,lalcA:a,lalcB:c}=o;h.Set(t),_.Set(l),i.b2Rot.MultiplyVec2(h,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,a),this.m_rA),i.b2Rot.MultiplyVec2(_,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,c),this.m_rB);const p=this.m_invMassA,A=this.m_invMassB,u=this.m_invIA,b=this.m_invIB;let d;if(this.m_K.ex.x=p+A+this.m_rA.y*this.m_rA.y*u+this.m_rB.y*this.m_rB.y*b,this.m_K.ey.x=-this.m_rA.y*this.m_rA.x*u-this.m_rB.y*this.m_rB.x*b,this.m_K.ex.y=this.m_K.ey.x,this.m_K.ey.y=p+A+this.m_rA.x*this.m_rA.x*u+this.m_rB.x*this.m_rB.x*b,this.m_axialMass=u+b,this.m_axialMass>0?(this.m_axialMass=1/this.m_axialMass,d=!1):d=!0,this.m_angle=l-t-this.m_referenceAngle,(!1===this.m_enableLimit||d)&&(this.m_lowerImpulse=0,this.m_upperImpulse=0),(!1===this.m_enableMotor||d)&&(this.m_motorImpulse=0),e.step.warmStarting){this.m_impulse.Scale(e.step.dtRatio),this.m_motorImpulse*=e.step.dtRatio,this.m_lowerImpulse*=e.step.dtRatio,this.m_upperImpulse*=e.step.dtRatio;const t=this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse,l=o.P.Set(this.m_impulse.x,this.m_impulse.y);s.SubtractScaled(p,l),m-=u*(i.b2Vec2.Cross(this.m_rA,l)+t),n.AddScaled(A,l),r+=b*(i.b2Vec2.Cross(this.m_rB,l)+t)}else this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0;e.velocities[this.m_indexA].w=m,e.velocities[this.m_indexB].w=r}SolveVelocityConstraints(e){const t=e.velocities[this.m_indexA].v;let s=e.velocities[this.m_indexA].w;const m=e.velocities[this.m_indexB].v;let l=e.velocities[this.m_indexB].w;const n=this.m_invMassA,r=this.m_invMassB,h=this.m_invIA,_=this.m_invIB,a=h+_===0;if(this.m_enableMotor&&!a){const t=l-s-this.m_motorSpeed;let o=-this.m_axialMass*t;const m=this.m_motorImpulse,n=e.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=(0,i.b2Clamp)(this.m_motorImpulse+o,-n,n),s-=h*(o=this.m_motorImpulse-m),l+=_*o}if(this.m_enableLimit&&!a){{const t=this.m_angle-this.m_lowerAngle,i=l-s;let o=-this.m_axialMass*(i+Math.max(t,0)*e.step.inv_dt);const m=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(this.m_lowerImpulse+o,0),s-=h*(o=this.m_lowerImpulse-m),l+=_*o}{const t=this.m_upperAngle-this.m_angle,i=s-l;let o=-this.m_axialMass*(i+Math.max(t,0)*e.step.inv_dt);const m=this.m_upperImpulse;this.m_upperImpulse=Math.max(this.m_upperImpulse+o,0),s+=h*(o=this.m_upperImpulse-m),l-=_*o}}{const{Cdot:e,impulse:a}=o;i.b2Vec2.Subtract(i.b2Vec2.AddCrossScalarVec2(m,l,this.m_rB,i.b2Vec2.s_t0),i.b2Vec2.AddCrossScalarVec2(t,s,this.m_rA,i.b2Vec2.s_t1),e),this.m_K.Solve(-e.x,-e.y,a),this.m_impulse.x+=a.x,this.m_impulse.y+=a.y,t.SubtractScaled(n,a),s-=h*i.b2Vec2.Cross(this.m_rA,a),m.AddScaled(r,a),l+=_*i.b2Vec2.Cross(this.m_rB,a)}e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=l}SolvePositionConstraints(t){const s=t.positions[this.m_indexA].c;let m=t.positions[this.m_indexA].a;const l=t.positions[this.m_indexB].c;let n=t.positions[this.m_indexB].a;const{qA:r,qB:h,lalcA:_,lalcB:a,impulse:c}=o;r.Set(m),h.Set(n);let p=0,A=0;const u=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&!u){const t=n-m-this.m_referenceAngle;let s=0;Math.abs(this.m_upperAngle-this.m_lowerAngle)<2*e.b2_angularSlop?s=(0,i.b2Clamp)(t-this.m_lowerAngle,-e.b2_maxAngularCorrection,e.b2_maxAngularCorrection):t<=this.m_lowerAngle?s=(0,i.b2Clamp)(t-this.m_lowerAngle+e.b2_angularSlop,-e.b2_maxAngularCorrection,0):t>=this.m_upperAngle&&(s=(0,i.b2Clamp)(t-this.m_upperAngle-e.b2_angularSlop,0,e.b2_maxAngularCorrection));const o=-this.m_axialMass*s;m-=this.m_invIA*o,n+=this.m_invIB*o,p=Math.abs(s)}{r.Set(m),h.Set(n);const e=i.b2Rot.MultiplyVec2(r,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,_),this.m_rA),t=i.b2Rot.MultiplyVec2(h,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,a),this.m_rB),p=i.b2Vec2.Add(l,t,o.C).Subtract(s).Subtract(e);A=p.Length();const u=this.m_invMassA,b=this.m_invMassB,d=this.m_invIA,x=this.m_invIB,w=this.m_K;w.ex.x=u+b+d*e.y*e.y+x*t.y*t.y,w.ex.y=-d*e.x*e.y-x*t.x*t.y,w.ey.x=w.ex.y,w.ey.y=u+b+d*e.x*e.x+x*t.x*t.x,w.Solve(p.x,p.y,c).Negate(),s.SubtractScaled(u,c),m-=d*i.b2Vec2.Cross(e,c),l.AddScaled(b,c),n+=x*i.b2Vec2.Cross(t,c)}return t.positions[this.m_indexA].a=m,t.positions[this.m_indexB].a=n,A<=e.b2_linearSlop&&p<=e.b2_angularSlop}GetAnchorA(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}GetAnchorB(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}GetReactionForce(e,t){return t.x=e*this.m_impulse.x,t.y=e*this.m_impulse.y,t}GetReactionTorque(e){return e*(this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse)}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetReferenceAngle(){return this.m_referenceAngle}GetJointAngle(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle}GetJointSpeed(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(e){return e!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e),e}GetMotorTorque(e){return e*this.m_motorImpulse}GetMotorSpeed(){return this.m_motorSpeed}SetMaxMotorTorque(e){e!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=e)}GetMaxMotorTorque(){return this.m_maxMotorTorque}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(e){return e!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e,this.m_lowerImpulse=0,this.m_upperImpulse=0),e}GetLowerLimit(){return this.m_lowerAngle}GetUpperLimit(){return this.m_upperAngle}SetLimits(e,t){e===this.m_lowerAngle&&t===this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_lowerAngle=e,this.m_upperAngle=t)}SetMotorSpeed(e){return e!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e),e}Draw(e){const{p2:s,r:m,pA:l,pB:n}=o,r=this.m_bodyA.GetTransform(),h=this.m_bodyB.GetTransform();i.b2Transform.MultiplyVec2(r,this.m_localAnchorA,l),i.b2Transform.MultiplyVec2(h,this.m_localAnchorB,n),e.DrawPoint(l,5,t.debugColors.joint4),e.DrawPoint(n,5,t.debugColors.joint5);const _=this.m_bodyA.GetAngle(),a=this.m_bodyB.GetAngle()-_-this.m_referenceAngle;if(m.Set(Math.cos(a),Math.sin(a)).Scale(.5),e.DrawSegment(n,i.b2Vec2.Add(n,m,s),t.debugColors.joint1),e.DrawCircle(n,.5,t.debugColors.joint1),this.m_enableLimit){const{rlo:m,rhi:l}=o;m.Set(Math.cos(this.m_lowerAngle),Math.sin(this.m_lowerAngle)).Scale(.5),l.Set(Math.cos(this.m_upperAngle),Math.sin(this.m_upperAngle)).Scale(.5),e.DrawSegment(n,i.b2Vec2.Add(n,m,s),t.debugColors.joint2),e.DrawSegment(n,i.b2Vec2.Add(n,l,s),t.debugColors.joint3)}e.DrawSegment(r.p,l,t.debugColors.joint6),e.DrawSegment(l,n,t.debugColors.joint6),e.DrawSegment(h.p,n,t.debugColors.joint6)}}exports.b2RevoluteJoint=l;
},{"../common/b2_common":"ReKW","../common/b2_draw":"lvls","../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"LRlb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2WeldJoint=exports.b2WeldJointDef=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),s=require("./b2_joint"),i={qA:new t.b2Rot,qB:new t.b2Rot,rA:new t.b2Vec2,rB:new t.b2Vec2,lalcA:new t.b2Vec2,lalcB:new t.b2Vec2,K:new t.b2Mat33,P:new t.b2Vec2,Cdot1:new t.b2Vec3,impulse1:new t.b2Vec2,impulse:new t.b2Vec3,C1:new t.b2Vec2,C:new t.b2Vec3};class m extends s.b2JointDef{constructor(){super(s.b2JointType.e_weldJoint),this.localAnchorA=new t.b2Vec2,this.localAnchorB=new t.b2Vec2,this.referenceAngle=0,this.stiffness=0,this.damping=0}Initialize(e,t,s){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(s,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}exports.b2WeldJointDef=m;class n extends s.b2Joint{constructor(e){var s,i,m,n,c;super(e),this.m_stiffness=0,this.m_damping=0,this.m_bias=0,this.m_localAnchorA=new t.b2Vec2,this.m_localAnchorB=new t.b2Vec2,this.m_referenceAngle=0,this.m_gamma=0,this.m_impulse=new t.b2Vec3,this.m_indexA=0,this.m_indexB=0,this.m_rA=new t.b2Vec2,this.m_rB=new t.b2Vec2,this.m_localCenterA=new t.b2Vec2,this.m_localCenterB=new t.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new t.b2Mat33,this.m_localAnchorA.Copy(null!==(s=e.localAnchorA)&&void 0!==s?s:t.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(i=e.localAnchorB)&&void 0!==i?i:t.b2Vec2.ZERO),this.m_referenceAngle=null!==(m=e.referenceAngle)&&void 0!==m?m:0,this.m_stiffness=null!==(n=e.stiffness)&&void 0!==n?n:0,this.m_damping=null!==(c=e.damping)&&void 0!==c?c:0}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const s=e.positions[this.m_indexA].a,m=e.velocities[this.m_indexA].v;let n=e.velocities[this.m_indexA].w;const c=e.positions[this.m_indexB].a,o=e.velocities[this.m_indexB].v;let h=e.velocities[this.m_indexB].w;const{qA:l,qB:_,lalcA:r,lalcB:a,K:A}=i;l.Set(s),_.Set(c),t.b2Rot.MultiplyVec2(l,t.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),this.m_rA),t.b2Rot.MultiplyVec2(_,t.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,a),this.m_rB);const b=this.m_invMassA,d=this.m_invMassB,x=this.m_invIA,y=this.m_invIB;if(A.ex.x=b+d+this.m_rA.y*this.m_rA.y*x+this.m_rB.y*this.m_rB.y*y,A.ey.x=-this.m_rA.y*this.m_rA.x*x-this.m_rB.y*this.m_rB.x*y,A.ez.x=-this.m_rA.y*x-this.m_rB.y*y,A.ex.y=A.ey.x,A.ey.y=b+d+this.m_rA.x*this.m_rA.x*x+this.m_rB.x*this.m_rB.x*y,A.ez.y=this.m_rA.x*x+this.m_rB.x*y,A.ex.z=A.ez.x,A.ey.z=A.ez.y,A.ez.z=x+y,this.m_stiffness>0){A.GetInverse22(this.m_mass);let t=x+y;const i=c-s-this.m_referenceAngle,m=this.m_damping,n=this.m_stiffness,o=e.step.dt;this.m_gamma=o*(m+o*n),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=i*o*n*this.m_gamma,t+=this.m_gamma,this.m_mass.ez.z=0!==t?1/t:0}else 0===A.ez.z?(A.GetInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(A.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(e.step.warmStarting){this.m_impulse.Scale(e.step.dtRatio);const{P:s}=i;s.Copy(this.m_impulse),m.SubtractScaled(b,s),n-=x*(t.b2Vec2.Cross(this.m_rA,s)+this.m_impulse.z),o.AddScaled(d,s),h+=y*(t.b2Vec2.Cross(this.m_rB,s)+this.m_impulse.z)}else this.m_impulse.SetZero();e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=h}SolveVelocityConstraints(e){const s=e.velocities[this.m_indexA].v;let m=e.velocities[this.m_indexA].w;const n=e.velocities[this.m_indexB].v;let c=e.velocities[this.m_indexB].w;const o=this.m_invMassA,h=this.m_invMassB,l=this.m_invIA,_=this.m_invIB;if(this.m_stiffness>0){const e=c-m,r=-this.m_mass.ez.z*(e+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=r,m-=l*r,c+=_*r;const{Cdot1:a,impulse1:A}=i;t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(n,c,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(s,m,this.m_rA,t.b2Vec2.s_t1),a),t.b2Mat33.MultiplyVec2(this.m_mass,a,A).Negate(),this.m_impulse.x+=A.x,this.m_impulse.y+=A.y;const b=A;s.SubtractScaled(o,b),m-=l*t.b2Vec2.Cross(this.m_rA,b),n.AddScaled(h,b),c+=_*t.b2Vec2.Cross(this.m_rB,b)}else{const{Cdot1:e,impulse:r,P:a}=i;t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(n,c,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(s,m,this.m_rA,t.b2Vec2.s_t1),e),e.z=c-m,t.b2Mat33.MultiplyVec3(this.m_mass,e,r).Negate(),this.m_impulse.Add(r),a.Set(r.x,r.y),s.SubtractScaled(o,a),m-=l*(t.b2Vec2.Cross(this.m_rA,a)+r.z),n.AddScaled(h,a),c+=_*(t.b2Vec2.Cross(this.m_rB,a)+r.z)}e.velocities[this.m_indexA].w=m,e.velocities[this.m_indexB].w=c}SolvePositionConstraints(s){const m=s.positions[this.m_indexA].c;let n=s.positions[this.m_indexA].a;const c=s.positions[this.m_indexB].c;let o=s.positions[this.m_indexB].a;const{qA:h,qB:l,lalcA:_,lalcB:r,K:a,C1:A,P:b,rA:d,rB:x}=i;h.Set(n),l.Set(o);const y=this.m_invMassA,u=this.m_invMassB,B=this.m_invIA,p=this.m_invIB;let V,v;if(t.b2Rot.MultiplyVec2(h,t.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,_),d),t.b2Rot.MultiplyVec2(l,t.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,r),x),a.ex.x=y+u+d.y*d.y*B+x.y*x.y*p,a.ey.x=-d.y*d.x*B-x.y*x.x*p,a.ez.x=-d.y*B-x.y*p,a.ex.y=a.ey.x,a.ey.y=y+u+d.x*d.x*B+x.x*x.x*p,a.ez.y=d.x*B+x.x*p,a.ex.z=a.ez.x,a.ey.z=a.ez.y,a.ez.z=B+p,this.m_stiffness>0)t.b2Vec2.Add(c,x,A).Subtract(m).Subtract(d),V=A.Length(),v=0,a.Solve22(A.x,A.y,b).Negate(),m.SubtractScaled(y,b),n-=B*t.b2Vec2.Cross(d,b),c.AddScaled(u,b),o+=p*t.b2Vec2.Cross(x,b);else{t.b2Vec2.Add(c,x,A).Subtract(m).Subtract(d),t.b2Vec2.Subtract(t.b2Vec2.Add(c,x,t.b2Vec2.s_t0),t.b2Vec2.Add(m,d,t.b2Vec2.s_t1),A);const e=o-n-this.m_referenceAngle;V=A.Length(),v=Math.abs(e);const{impulse:s,C:h}=i;h.Set(A.x,A.y,e),a.ez.z>0?a.Solve33(h.x,h.y,h.z,s).Negate():(a.Solve22(A.x,A.y,s).Negate(),s.z=0),b.Copy(s),m.SubtractScaled(y,b),n-=B*(t.b2Vec2.Cross(d,b)+s.z),c.AddScaled(u,b),o+=p*(t.b2Vec2.Cross(x,b)+s.z)}return s.positions[this.m_indexA].a=n,s.positions[this.m_indexB].a=o,V<=e.b2_linearSlop&&v<=e.b2_angularSlop}GetAnchorA(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}GetAnchorB(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}GetReactionForce(e,t){return t.x=e*this.m_impulse.x,t.y=e*this.m_impulse.y,t}GetReactionTorque(e){return e*this.m_impulse.z}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetReferenceAngle(){return this.m_referenceAngle}SetStiffness(e){this.m_stiffness=e}GetStiffness(){return this.m_stiffness}SetDamping(e){this.m_damping=e}GetDamping(){return this.m_damping}}exports.b2WeldJoint=n;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_joint":"Xq2i"}],"yJEF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2WheelJoint=exports.b2WheelJointDef=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),i=require("./b2_joint"),e=require("../common/b2_draw"),m={qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,rA:new s.b2Vec2,rB:new s.b2Vec2,d:new s.b2Vec2,P:new s.b2Vec2,ay:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,Draw:{p1:new s.b2Vec2,p2:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,lower:new s.b2Vec2,upper:new s.b2Vec2,perp:new s.b2Vec2}};class o extends i.b2JointDef{constructor(){super(i.b2JointType.e_wheelJoint),this.localAnchorA=new s.b2Vec2,this.localAnchorB=new s.b2Vec2,this.localAxisA=new s.b2Vec2(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorTorque=0,this.motorSpeed=0,this.stiffness=0,this.damping=0}Initialize(t,s,i,e){this.bodyA=t,this.bodyB=s,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(e,this.localAxisA)}}exports.b2WheelJointDef=o;class a extends i.b2Joint{constructor(t){var i,e,m,o,a,l,h,n,_,r,c;super(t),this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_localXAxisA=new s.b2Vec2,this.m_localYAxisA=new s.b2Vec2,this.m_impulse=0,this.m_motorImpulse=0,this.m_springImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_translation=0,this.m_lowerTranslation=0,this.m_upperTranslation=0,this.m_maxMotorTorque=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_enableMotor=!1,this.m_stiffness=0,this.m_damping=0,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_ax=new s.b2Vec2,this.m_ay=new s.b2Vec2,this.m_sAx=0,this.m_sBx=0,this.m_sAy=0,this.m_sBy=0,this.m_mass=0,this.m_motorMass=0,this.m_axialMass=0,this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_localAnchorA.Copy(null!==(i=t.localAnchorA)&&void 0!==i?i:s.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(e=t.localAnchorB)&&void 0!==e?e:s.b2Vec2.ZERO),this.m_localXAxisA.Copy(null!==(m=t.localAxisA)&&void 0!==m?m:s.b2Vec2.UNITX),s.b2Vec2.CrossOneVec2(this.m_localXAxisA,this.m_localYAxisA),this.m_lowerTranslation=null!==(o=t.lowerTranslation)&&void 0!==o?o:0,this.m_upperTranslation=null!==(a=t.upperTranslation)&&void 0!==a?a:0,this.m_enableLimit=null!==(l=t.enableLimit)&&void 0!==l&&l,this.m_maxMotorTorque=null!==(h=t.maxMotorTorque)&&void 0!==h?h:0,this.m_motorSpeed=null!==(n=t.motorSpeed)&&void 0!==n?n:0,this.m_enableMotor=null!==(_=t.enableMotor)&&void 0!==_&&_,this.m_ax.SetZero(),this.m_ay.SetZero(),this.m_stiffness=null!==(r=t.stiffness)&&void 0!==r?r:0,this.m_damping=null!==(c=t.damping)&&void 0!==c?c:0}GetMotorSpeed(){return this.m_motorSpeed}GetMaxMotorTorque(){return this.m_maxMotorTorque}SetStiffness(t){this.m_stiffness=t}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t}GetDamping(){return this.m_damping}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=this.m_invMassA,e=this.m_invMassB,o=this.m_invIA,a=this.m_invIB,l=t.positions[this.m_indexA].c,h=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v;let _=t.velocities[this.m_indexA].w;const r=t.positions[this.m_indexB].c,c=t.positions[this.m_indexB].a,b=t.velocities[this.m_indexB].v;let p=t.velocities[this.m_indexB].w;const{qA:A,qB:u,lalcA:d,lalcB:V,rA:x,rB:S,d:B}=m;A.Set(h),u.Set(c),s.b2Rot.MultiplyVec2(A,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,d),x),s.b2Rot.MultiplyVec2(u,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,V),S),s.b2Vec2.Add(r,S,B).Subtract(l).Subtract(x),s.b2Rot.MultiplyVec2(A,this.m_localYAxisA,this.m_ay),this.m_sAy=s.b2Vec2.Cross(s.b2Vec2.Add(B,x,s.b2Vec2.s_t0),this.m_ay),this.m_sBy=s.b2Vec2.Cross(S,this.m_ay),this.m_mass=i+e+o*this.m_sAy*this.m_sAy+a*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),s.b2Rot.MultiplyVec2(A,this.m_localXAxisA,this.m_ax),this.m_sAx=s.b2Vec2.Cross(s.b2Vec2.Add(B,x,s.b2Vec2.s_t0),this.m_ax),this.m_sBx=s.b2Vec2.Cross(S,this.m_ax);const y=i+e+o*this.m_sAx*this.m_sAx+a*this.m_sBx*this.m_sBx;if(this.m_axialMass=y>0?1/y:0,this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_stiffness>0&&y>0){this.m_springMass=1/y;const i=s.b2Vec2.Dot(B,this.m_ax),e=t.step.dt;this.m_gamma=e*(this.m_damping+e*this.m_stiffness),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=i*e*this.m_stiffness*this.m_gamma,this.m_springMass=y+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}else this.m_springImpulse=0;if(this.m_enableLimit?this.m_translation=s.b2Vec2.Dot(this.m_ax,B):(this.m_lowerImpulse=0,this.m_upperImpulse=0),this.m_enableMotor?(this.m_motorMass=o+a,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse*=t.step.dtRatio,this.m_springImpulse*=t.step.dtRatio,this.m_motorImpulse*=t.step.dtRatio;const i=this.m_springImpulse+this.m_lowerImpulse-this.m_upperImpulse,{P:e}=m;s.b2Vec2.Scale(this.m_impulse,this.m_ay,e).AddScaled(i,this.m_ax);const o=this.m_impulse*this.m_sAy+i*this.m_sAx+this.m_motorImpulse,a=this.m_impulse*this.m_sBy+i*this.m_sBx+this.m_motorImpulse;n.SubtractScaled(this.m_invMassA,e),_-=this.m_invIA*o,b.AddScaled(this.m_invMassB,e),p+=this.m_invIB*a}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0;t.velocities[this.m_indexA].w=_,t.velocities[this.m_indexB].w=p}SolveVelocityConstraints(t){const i=this.m_invMassA,e=this.m_invMassB,o=this.m_invIA,a=this.m_invIB,l=t.velocities[this.m_indexA].v;let h=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let _=t.velocities[this.m_indexB].w;const{P:r}=m;{const t=s.b2Vec2.Dot(this.m_ax,s.b2Vec2.Subtract(n,l,s.b2Vec2.s_t0))+this.m_sBx*_-this.m_sAx*h,m=-this.m_springMass*(t+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=m,s.b2Vec2.Scale(m,this.m_ax,r);const c=m*this.m_sAx,b=m*this.m_sBx;l.SubtractScaled(i,r),h-=o*c,n.AddScaled(e,r),_+=a*b}{const i=_-h-this.m_motorSpeed;let e=-this.m_motorMass*i;const m=this.m_motorImpulse,l=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=(0,s.b2Clamp)(this.m_motorImpulse+e,-l,l),h-=o*(e=this.m_motorImpulse-m),_+=a*e}if(this.m_enableLimit){{const m=this.m_translation-this.m_lowerTranslation,c=s.b2Vec2.Dot(this.m_ax,s.b2Vec2.Subtract(n,l,s.b2Vec2.s_t0))+this.m_sBx*_-this.m_sAx*h;let b=-this.m_axialMass*(c+Math.max(m,0)*t.step.inv_dt);const p=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(this.m_lowerImpulse+b,0),b=this.m_lowerImpulse-p,s.b2Vec2.Scale(b,this.m_ax,r);const A=b*this.m_sAx,u=b*this.m_sBx;l.SubtractScaled(i,r),h-=o*A,n.AddScaled(e,r),_+=a*u}{const m=this.m_upperTranslation-this.m_translation,c=s.b2Vec2.Dot(this.m_ax,s.b2Vec2.Subtract(l,n,s.b2Vec2.s_t0))+this.m_sAx*h-this.m_sBx*_;let b=-this.m_axialMass*(c+Math.max(m,0)*t.step.inv_dt);const p=this.m_upperImpulse;this.m_upperImpulse=Math.max(this.m_upperImpulse+b,0),b=this.m_upperImpulse-p,s.b2Vec2.Scale(b,this.m_ax,r);const A=b*this.m_sAx,u=b*this.m_sBx;l.AddScaled(i,r),h+=o*A,n.SubtractScaled(e,r),_-=a*u}}{const t=s.b2Vec2.Dot(this.m_ay,s.b2Vec2.Subtract(n,l,s.b2Vec2.s_t0))+this.m_sBy*_-this.m_sAy*h,m=-this.m_mass*t;this.m_impulse+=m,s.b2Vec2.Scale(m,this.m_ay,r);const c=m*this.m_sAy,b=m*this.m_sBy;l.SubtractScaled(i,r),h-=o*c,n.AddScaled(e,r),_+=a*b}t.velocities[this.m_indexA].w=h,t.velocities[this.m_indexB].w=_}SolvePositionConstraints(i){const e=i.positions[this.m_indexA].c;let o=i.positions[this.m_indexA].a;const a=i.positions[this.m_indexB].c;let l=i.positions[this.m_indexB].a,h=0;const{qA:n,qB:_,lalcA:r,lalcB:c,rA:b,rB:p,d:A,P:u,ay:d}=m;if(this.m_enableLimit){n.Set(o),_.Set(l),s.b2Rot.MultiplyVec2(n,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),b),s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,c),p),s.b2Vec2.Subtract(a,e,A).Add(p).Subtract(b);const i=s.b2Rot.MultiplyVec2(n,this.m_localXAxisA,this.m_ax),m=s.b2Vec2.Cross(s.b2Vec2.Add(A,b,s.b2Vec2.s_t0),this.m_ax),d=s.b2Vec2.Cross(p,this.m_ax);let V=0;const x=s.b2Vec2.Dot(i,A);if(Math.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?V=x:x<=this.m_lowerTranslation?V=Math.min(x-this.m_lowerTranslation,0):x>=this.m_upperTranslation&&(V=Math.max(x-this.m_upperTranslation,0)),0!==V){const t=this.m_invMassA+this.m_invMassB+this.m_invIA*m*m+this.m_invIB*d*d;let n=0;0!==t&&(n=-V/t),s.b2Vec2.Scale(n,i,u);const _=n*m,r=n*d;e.SubtractScaled(this.m_invMassA,u),o-=this.m_invIA*_,a.AddScaled(this.m_invMassB,u),l+=this.m_invIB*r,h=Math.abs(V)}}{n.Set(o),_.Set(l),s.b2Rot.MultiplyVec2(n,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),b),s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,c),p),s.b2Vec2.Subtract(a,e,A).Add(p).Subtract(b),s.b2Rot.MultiplyVec2(n,this.m_localYAxisA,d);const t=s.b2Vec2.Cross(s.b2Vec2.Add(A,b,s.b2Vec2.s_t0),d),i=s.b2Vec2.Cross(p,d),m=s.b2Vec2.Dot(A,d),V=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;let x=0;0!==V&&(x=-m/V),s.b2Vec2.Scale(x,d,u);const S=x*t,B=x*i;e.SubtractScaled(this.m_invMassA,u),o-=this.m_invIA*S,a.AddScaled(this.m_invMassB,u),l+=this.m_invIB*B,h=Math.max(h,Math.abs(m))}return i.positions[this.m_indexA].a=o,i.positions[this.m_indexB].a=l,h<=t.b2_linearSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){const i=this.m_springImpulse+this.m_lowerImpulse-this.m_upperImpulse;return s.x=t*(this.m_impulse*this.m_ay.x+i*this.m_ax.x),s.y=t*(this.m_impulse*this.m_ay.y+i*this.m_ax.y),s}GetReactionTorque(t){return t*this.m_motorImpulse}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetLocalAxisA(){return this.m_localXAxisA}GetJointTranslation(){const t=this.m_bodyA,i=this.m_bodyB,{pA:e,pB:o,d:a,axis:l}=m;return t.GetWorldPoint(this.m_localAnchorA,e),i.GetWorldPoint(this.m_localAnchorB,o),s.b2Vec2.Subtract(o,e,a),t.GetWorldVector(this.m_localXAxisA,l),s.b2Vec2.Dot(a,l)}GetJointLinearSpeed(){const t=this.m_bodyA,i=this.m_bodyB,{rA:e,rB:o,lalcA:a,lalcB:l,axis:h}=m;s.b2Rot.MultiplyVec2(t.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorA,t.m_sweep.localCenter,a),e),s.b2Rot.MultiplyVec2(i.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorB,i.m_sweep.localCenter,l),o);const n=s.b2Vec2.Add(t.m_sweep.c,e,s.b2Vec2.s_t0),_=s.b2Vec2.Add(i.m_sweep.c,o,s.b2Vec2.s_t1),r=s.b2Vec2.Subtract(_,n,s.b2Vec2.s_t2);s.b2Rot.MultiplyVec2(t.m_xf.q,this.m_localXAxisA,h);const c=t.m_linearVelocity,b=i.m_linearVelocity,p=t.m_angularVelocity,A=i.m_angularVelocity;return s.b2Vec2.Dot(r,s.b2Vec2.CrossScalarVec2(p,h,s.b2Vec2.s_t0))+s.b2Vec2.Dot(h,s.b2Vec2.AddCrossScalarVec2(b,A,o,s.b2Vec2.s_t0).Subtract(c).Subtract(s.b2Vec2.CrossScalarVec2(p,e,s.b2Vec2.s_t1)))}GetJointAngle(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a}GetJointAngularSpeed(){const t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){return t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t),t}SetMotorSpeed(t){return t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t),t}SetMaxMotorTorque(t){t!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=t)}GetMotorTorque(t){return t*this.m_motorImpulse}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(t){return t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_lowerImpulse=0,this.m_upperImpulse=0),t}GetLowerLimit(){return this.m_lowerTranslation}GetUpperLimit(){return this.m_upperTranslation}SetLimits(t,s){t===this.m_lowerTranslation&&s===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=s,this.m_lowerImpulse=0,this.m_upperImpulse=0)}Draw(t){const{p1:i,p2:o,pA:a,pB:l,axis:h}=m.Draw,n=this.m_bodyA.GetTransform(),_=this.m_bodyB.GetTransform();if(s.b2Transform.MultiplyVec2(n,this.m_localAnchorA,a),s.b2Transform.MultiplyVec2(_,this.m_localAnchorB,l),s.b2Rot.MultiplyVec2(n.q,this.m_localXAxisA,h),t.DrawSegment(a,l,e.debugColors.joint5),this.m_enableLimit){const{lower:l,upper:_,perp:r}=m.Draw;s.b2Vec2.AddScaled(a,this.m_lowerTranslation,h,l),s.b2Vec2.AddScaled(a,this.m_upperTranslation,h,_),s.b2Rot.MultiplyVec2(n.q,this.m_localYAxisA,r),t.DrawSegment(l,_,e.debugColors.joint1),t.DrawSegment(s.b2Vec2.SubtractScaled(l,.5,r,i),s.b2Vec2.AddScaled(l,.5,r,o),e.debugColors.joint2),t.DrawSegment(s.b2Vec2.SubtractScaled(_,.5,r,i),s.b2Vec2.AddScaled(_,.5,r,o),e.debugColors.joint3)}else t.DrawSegment(s.b2Vec2.Subtract(a,h,i),s.b2Vec2.Add(a,h,o),e.debugColors.joint1);t.DrawPoint(a,5,e.debugColors.joint1),t.DrawPoint(l,5,e.debugColors.joint4)}}exports.b2WheelJoint=a;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","./b2_joint":"Xq2i","../common/b2_draw":"lvls"}],"UQyq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Contact=exports.b2ContactEdge=exports.b2MixRestitutionThreshold=exports.b2MixRestitution=exports.b2MixFriction=void 0;const t=require("../common/b2_common"),i=require("../collision/b2_collision");function e(t,i){return Math.sqrt(t*i)}function s(t,i){return t>i?t:i}function n(t,i){return t<i?t:i}exports.b2MixFriction=e,exports.b2MixRestitution=s,exports.b2MixRestitutionThreshold=n;class o{constructor(t){this.m_other=null,this.prev=null,this.next=null,this.contact=t}get other(){return(0,t.b2Assert)(null!==this.m_other),this.m_other}set other(i){(0,t.b2Assert)(null===this.m_other),this.m_other=i}Reset(){this.m_other=null,this.prev=null,this.next=null}}exports.b2ContactEdge=o;class h{constructor(){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_prev=null,this.m_next=null,this.m_nodeA=new o(this),this.m_nodeB=new o(this),this.m_indexA=0,this.m_indexB=0,this.m_manifold=new i.b2Manifold,this.m_toiCount=0,this.m_toi=0,this.m_friction=0,this.m_restitution=0,this.m_restitutionThreshold=0,this.m_tangentSpeed=0,this.m_oldManifold=new i.b2Manifold}GetManifold(){return this.m_manifold}GetWorldManifold(t){const i=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),s=this.GetShapeA(),n=this.GetShapeB();t.Initialize(this.m_manifold,i.GetTransform(),s.m_radius,e.GetTransform(),n.m_radius)}IsTouching(){return this.m_touchingFlag}SetEnabled(t){this.m_enabledFlag=t}IsEnabled(){return this.m_enabledFlag}GetNext(){return this.m_next}GetFixtureA(){return this.m_fixtureA}GetChildIndexA(){return this.m_indexA}GetShapeA(){return this.m_fixtureA.GetShape()}GetFixtureB(){return this.m_fixtureB}GetChildIndexB(){return this.m_indexB}GetShapeB(){return this.m_fixtureB.GetShape()}FlagForFiltering(){this.m_filterFlag=!0}SetFriction(t){this.m_friction=t}GetFriction(){return this.m_friction}ResetFriction(){this.m_friction=e(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)}SetRestitution(t){this.m_restitution=t}GetRestitution(){return this.m_restitution}ResetRestitution(){this.m_restitution=s(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)}SetRestitutionThreshold(t){this.m_restitutionThreshold=t}GetRestitutionThreshold(){return this.m_restitutionThreshold}ResetRestitutionThreshold(){this.m_restitutionThreshold=n(this.m_fixtureA.m_restitutionThreshold,this.m_fixtureB.m_restitutionThreshold)}SetTangentSpeed(t){this.m_tangentSpeed=t}GetTangentSpeed(){return this.m_tangentSpeed}Reset(t,i,o,h){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!0,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_fixtureA=t,this.m_fixtureB=o,this.m_indexA=i,this.m_indexB=h,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.Reset(),this.m_nodeB.Reset(),this.m_toiCount=0,this.m_friction=e(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=s(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_restitutionThreshold=n(this.m_fixtureA.m_restitutionThreshold,this.m_fixtureB.m_restitutionThreshold)}Update(t){const e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_enabledFlag=!0;let s=!1;const n=this.m_touchingFlag,o=this.m_fixtureA.IsSensor(),h=this.m_fixtureB.IsSensor(),r=o||h,m=this.m_fixtureA.GetBody(),l=this.m_fixtureB.GetBody(),_=m.GetTransform(),u=l.GetTransform();if(r){const t=this.GetShapeA(),e=this.GetShapeB();s=(0,i.b2TestOverlap)(t,this.m_indexA,e,this.m_indexB,_,u),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,_,u),s=this.m_manifold.pointCount>0;for(let t=0;t<this.m_manifold.pointCount;++t){const i=this.m_manifold.points[t];i.normalImpulse=0,i.tangentImpulse=0;const e=i.id;for(let t=0;t<this.m_oldManifold.pointCount;++t){const s=this.m_oldManifold.points[t];if(s.id.key===e.key){i.normalImpulse=s.normalImpulse,i.tangentImpulse=s.tangentImpulse;break}}}s!==n&&(m.SetAwake(!0),l.SetAwake(!0))}this.m_touchingFlag=s,!n&&s&&t&&t.BeginContact(this),n&&!s&&t&&t.EndContact(this),!r&&s&&t&&t.PreSolve(this,this.m_oldManifold)}}exports.b2Contact=h;
},{"../common/b2_common":"ReKW","../collision/b2_collision":"PKgf"}],"Rrpm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CircleContact=void 0;const e=require("../collision/b2_collide_circle"),t=require("./b2_contact");class c extends t.b2Contact{Evaluate(t,c,i){(0,e.b2CollideCircles)(t,this.GetShapeA(),c,this.GetShapeB(),i)}}exports.b2CircleContact=c;
},{"../collision/b2_collide_circle":"DoJb","./b2_contact":"UQyq"}],"OG4W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PolygonContact=void 0;const e=require("../collision/b2_collide_polygon"),o=require("./b2_contact");class t extends o.b2Contact{Evaluate(o,t,l){(0,e.b2CollidePolygons)(o,this.GetShapeA(),t,this.GetShapeB(),l)}}exports.b2PolygonContact=t;
},{"../collision/b2_collide_polygon":"nWAU","./b2_contact":"UQyq"}],"e4Qu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PolygonAndCircleContact=void 0;const e=require("../collision/b2_collide_circle"),t=require("./b2_contact");class o extends t.b2Contact{Evaluate(t,o,l){(0,e.b2CollidePolygonAndCircle)(t,this.GetShapeA(),o,this.GetShapeB(),l)}}exports.b2PolygonAndCircleContact=o;
},{"../collision/b2_collide_circle":"DoJb","./b2_contact":"UQyq"}],"ycyC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2EdgeAndCircleContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("./b2_contact");class o extends t.b2Contact{Evaluate(t,o,c){(0,e.b2CollideEdgeAndCircle)(t,this.GetShapeA(),o,this.GetShapeB(),c)}}exports.b2EdgeAndCircleContact=o;
},{"../collision/b2_collide_edge":"bTYS","./b2_contact":"UQyq"}],"eBtq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2EdgeAndPolygonContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("./b2_contact");class o extends t.b2Contact{Evaluate(t,o,n){(0,e.b2CollideEdgeAndPolygon)(t,this.GetShapeA(),o,this.GetShapeB(),n)}}exports.b2EdgeAndPolygonContact=o;
},{"../collision/b2_collide_edge":"bTYS","./b2_contact":"UQyq"}],"fgka":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ChainAndCircleContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("../collision/b2_edge_shape"),i=require("./b2_contact");class s extends i.b2Contact{Evaluate(t,i,a){const d=s.Evaluate_s_edge;this.GetShapeA().GetChildEdge(d,this.m_indexA),(0,e.b2CollideEdgeAndCircle)(t,d,i,this.GetShapeB(),a)}}exports.b2ChainAndCircleContact=s,s.Evaluate_s_edge=new t.b2EdgeShape;
},{"../collision/b2_collide_edge":"bTYS","../collision/b2_edge_shape":"OKJP","./b2_contact":"UQyq"}],"WjvU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ChainAndPolygonContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("../collision/b2_edge_shape"),o=require("./b2_contact");class n extends o.b2Contact{Evaluate(t,o,i){const s=n.Evaluate_s_edge;this.GetShapeA().GetChildEdge(s,this.m_indexA),(0,e.b2CollideEdgeAndPolygon)(t,s,o,this.GetShapeB(),i)}}exports.b2ChainAndPolygonContact=n,n.Evaluate_s_edge=new t.b2EdgeShape;
},{"../collision/b2_collide_edge":"bTYS","../collision/b2_edge_shape":"OKJP","./b2_contact":"UQyq"}],"FpyL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactFactory=void 0;const e=require("../collision/b2_shape"),t=require("./b2_circle_contact"),c=require("./b2_polygon_contact"),o=require("./b2_polygon_circle_contact"),r=require("./b2_edge_circle_contact"),n=require("./b2_edge_polygon_contact"),p=require("./b2_chain_circle_contact"),y=require("./b2_chain_polygon_contact");class i{constructor(){const i=new Array(e.b2ShapeType.e_typeCount);for(let t=0;t<e.b2ShapeType.e_typeCount;t++)i[t]=new Array(e.b2ShapeType.e_typeCount);this.m_registers=i,this.AddType(t.b2CircleContact,e.b2ShapeType.e_circle,e.b2ShapeType.e_circle),this.AddType(o.b2PolygonAndCircleContact,e.b2ShapeType.e_polygon,e.b2ShapeType.e_circle),this.AddType(c.b2PolygonContact,e.b2ShapeType.e_polygon,e.b2ShapeType.e_polygon),this.AddType(r.b2EdgeAndCircleContact,e.b2ShapeType.e_edge,e.b2ShapeType.e_circle),this.AddType(n.b2EdgeAndPolygonContact,e.b2ShapeType.e_edge,e.b2ShapeType.e_polygon),this.AddType(p.b2ChainAndCircleContact,e.b2ShapeType.e_chain,e.b2ShapeType.e_circle),this.AddType(y.b2ChainAndPolygonContact,e.b2ShapeType.e_chain,e.b2ShapeType.e_polygon)}AddType(e,t,c){const o=[],r=e=>{o.push(e)};this.m_registers[t][c]={createFcn(t,c,r,n){var p;const y=null!==(p=o.pop())&&void 0!==p?p:new e;return y.Reset(t,c,r,n),y},destroyFcn:r},t!==c&&(this.m_registers[c][t]={createFcn(t,c,r,n){var p;const y=null!==(p=o.pop())&&void 0!==p?p:new e;return y.Reset(r,n,t,c),y},destroyFcn:r})}Create(e,t,c,o){const r=e.GetType(),n=c.GetType(),p=this.m_registers[r][n];return p?p.createFcn(e,t,c,o):null}Destroy(e){const t=e.m_fixtureA.GetType(),c=e.m_fixtureB.GetType(),o=this.m_registers[t][c];null==o||o.destroyFcn(e)}}exports.b2ContactFactory=i;
},{"../collision/b2_shape":"stUN","./b2_circle_contact":"Rrpm","./b2_polygon_contact":"OG4W","./b2_polygon_circle_contact":"e4Qu","./b2_edge_circle_contact":"ycyC","./b2_edge_polygon_contact":"eBtq","./b2_chain_circle_contact":"fgka","./b2_chain_polygon_contact":"WjvU"}],"G1MF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactListener=exports.b2ContactImpulse=exports.b2ContactFilter=exports.b2DestructionListener=void 0;const t=require("../common/b2_common");class e{SayGoodbyeJoint(t){}SayGoodbyeFixture(t){}}exports.b2DestructionListener=e;class o{ShouldCollide(t,e){const o=t.GetFilterData(),s=e.GetFilterData();return o.groupIndex===s.groupIndex&&0!==o.groupIndex?o.groupIndex>0:0!=(o.maskBits&s.categoryBits)&&0!=(o.categoryBits&s.maskBits)}}exports.b2ContactFilter=o,o.b2_defaultFilter=new o;class s{constructor(){this.normalImpulses=(0,t.b2MakeNumberArray)(t.b2_maxManifoldPoints),this.tangentImpulses=(0,t.b2MakeNumberArray)(t.b2_maxManifoldPoints),this.count=0}}exports.b2ContactImpulse=s;class r{BeginContact(t){}EndContact(t){}PreSolve(t,e){}PostSolve(t,e){}}exports.b2ContactListener=r,r.b2_defaultListener=new r;
},{"../common/b2_common":"ReKW"}],"PdJY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactManager=void 0;const t=require("../collision/b2_broad_phase"),e=require("./b2_contact_factory"),n=require("./b2_body"),o=require("./b2_world_callbacks");class i{constructor(){this.m_broadPhase=new t.b2BroadPhase,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=o.b2ContactFilter.b2_defaultFilter,this.m_contactListener=o.b2ContactListener.b2_defaultListener,this.m_contactFactory=new e.b2ContactFactory,this.AddPair=((t,e)=>{let n=t.fixture,o=e.fixture,i=t.childIndex,c=e.childIndex,r=n.GetBody(),_=o.GetBody();if(r===_)return;let s=_.GetContactList();for(;s;){if(s.other===r){const t=s.contact.GetFixtureA(),e=s.contact.GetFixtureB(),r=s.contact.GetChildIndexA(),_=s.contact.GetChildIndexB();if(t===n&&e===o&&r===i&&_===c)return;if(t===o&&e===n&&r===c&&_===i)return}s=s.next}if(!1===_.ShouldCollide(r))return;if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(n,o))return;const a=this.m_contactFactory.Create(n,i,o,c);null!==a&&(n=a.GetFixtureA(),o=a.GetFixtureB(),i=a.GetChildIndexA(),c=a.GetChildIndexB(),r=n.m_body,_=o.m_body,a.m_prev=null,a.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=a),this.m_contactList=a,a.m_nodeA.other=_,a.m_nodeA.prev=null,a.m_nodeA.next=r.m_contactList,null!==r.m_contactList&&(r.m_contactList.prev=a.m_nodeA),r.m_contactList=a.m_nodeA,a.m_nodeB.other=r,a.m_nodeB.prev=null,a.m_nodeB.next=_.m_contactList,null!==_.m_contactList&&(_.m_contactList.prev=a.m_nodeB),_.m_contactList=a.m_nodeB,++this.m_contactCount)})}FindNewContacts(){this.m_broadPhase.UpdatePairs(this.AddPair)}Destroy(t){const e=t.GetFixtureA(),n=t.GetFixtureB(),o=e.GetBody(),i=n.GetBody();this.m_contactListener&&t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_contactList&&(this.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===i.m_contactList&&(i.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&!e.IsSensor()&&!n.IsSensor()&&(e.GetBody().SetAwake(!0),n.GetBody().SetAwake(!0)),this.m_contactFactory.Destroy(t),--this.m_contactCount}Collide(){let t=this.m_contactList;for(;t;){const e=t.GetFixtureA(),o=t.GetFixtureB(),i=t.GetChildIndexA(),c=t.GetChildIndexB(),r=e.GetBody(),_=o.GetBody();if(t.m_filterFlag){if(!_.ShouldCollide(r)||this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(e,o)){const e=t;t=e.m_next,this.Destroy(e);continue}t.m_filterFlag=!1}const s=r.IsAwake()&&r.m_type!==n.b2BodyType.b2_staticBody,a=_.IsAwake()&&_.m_type!==n.b2BodyType.b2_staticBody;if(!s&&!a){t=t.m_next;continue}const m=e.m_proxies[i].treeNode,d=o.m_proxies[c].treeNode;if(m.aabb.TestOverlap(d.aabb))t.Update(this.m_contactListener),t=t.m_next;else{const e=t;t=e.m_next,this.Destroy(e)}}}}exports.b2ContactManager=i;
},{"../collision/b2_broad_phase":"q2ad","./b2_contact_factory":"FpyL","./b2_body":"rONj","./b2_world_callbacks":"G1MF"}],"w6W3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2SolverData=exports.b2Velocity=exports.b2Position=exports.b2TimeStep=exports.b2Profile=void 0;const t=require("../common/b2_math");class s{constructor(){this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0}Reset(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this}}exports.b2Profile=s;class i{constructor(){this.dt=0,this.inv_dt=0,this.dtRatio=0,this.config={velocityIterations:0,positionIterations:0},this.warmStarting=!1}static Create(){return new i}Copy(t){return this.dt=t.dt,this.inv_dt=t.inv_dt,this.dtRatio=t.dtRatio,this.config={...t.config},this.warmStarting=t.warmStarting,this}}exports.b2TimeStep=i;class o{constructor(){this.c=new t.b2Vec2,this.a=0}}exports.b2Position=o;class e{constructor(){this.v=new t.b2Vec2,this.w=0}}exports.b2Velocity=e;class r{constructor(){this.step=i.Create()}}exports.b2SolverData=r;
},{"../common/b2_math":"cQbL"}],"DnH3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactSolver=exports.b2ContactSolverDef=exports.b2ContactVelocityConstraint=exports.b2GetBlockSolve=exports.b2SetBlockSolve=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),o=require("../collision/b2_collision"),e=require("./b2_time_step");let i=!0;function n(t){i=t}function a(){return i}exports.b2SetBlockSolve=n,exports.b2GetBlockSolve=a;class c{constructor(){this.rA=new s.b2Vec2,this.rB=new s.b2Vec2,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}}class r{constructor(){this.points=(0,t.b2MakeArray)(t.b2_maxManifoldPoints,c),this.normal=new s.b2Vec2,this.tangent=new s.b2Vec2,this.normalMass=new s.b2Mat22,this.K=new s.b2Mat22,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.threshold=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}}exports.b2ContactVelocityConstraint=r;class l{constructor(){this.localPoints=(0,t.b2MakeArray)(t.b2_maxManifoldPoints,s.b2Vec2),this.localNormal=new s.b2Vec2,this.localPoint=new s.b2Vec2,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new s.b2Vec2,this.localCenterB=new s.b2Vec2,this.invIA=0,this.invIB=0,this.type=o.b2ManifoldType.e_circles,this.radiusA=0,this.radiusB=0,this.pointCount=0}}class _{constructor(){this.step=e.b2TimeStep.Create(),this.count=0}}exports.b2ContactSolverDef=_;class b{constructor(){this.normal=new s.b2Vec2,this.point=new s.b2Vec2,this.separation=0}Initialize(t,e,i,n){const a=b.Initialize_s_pointA,c=b.Initialize_s_pointB,r=b.Initialize_s_planePoint,l=b.Initialize_s_clipPoint;switch(t.type){case o.b2ManifoldType.e_circles:s.b2Transform.MultiplyVec2(e,t.localPoint,a),s.b2Transform.MultiplyVec2(i,t.localPoints[0],c),s.b2Vec2.Subtract(c,a,this.normal).Normalize(),s.b2Vec2.Mid(a,c,this.point),this.separation=s.b2Vec2.Dot(s.b2Vec2.Subtract(c,a,s.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB;break;case o.b2ManifoldType.e_faceA:s.b2Rot.MultiplyVec2(e.q,t.localNormal,this.normal),s.b2Transform.MultiplyVec2(e,t.localPoint,r),s.b2Transform.MultiplyVec2(i,t.localPoints[n],l),this.separation=s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB,this.point.Copy(l);break;case o.b2ManifoldType.e_faceB:s.b2Rot.MultiplyVec2(i.q,t.localNormal,this.normal),s.b2Transform.MultiplyVec2(i,t.localPoint,r),s.b2Transform.MultiplyVec2(e,t.localPoints[n],l),this.separation=s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB,this.point.Copy(l),this.normal.Negate()}}}b.Initialize_s_pointA=new s.b2Vec2,b.Initialize_s_pointB=new s.b2Vec2,b.Initialize_s_planePoint=new s.b2Vec2,b.Initialize_s_clipPoint=new s.b2Vec2;class m{constructor(){this.m_step=e.b2TimeStep.Create(),this.m_positionConstraints=(0,t.b2MakeArray)(1024,l),this.m_velocityConstraints=(0,t.b2MakeArray)(1024,r),this.m_count=0}Initialize(t){if(this.m_step.Copy(t.step),this.m_count=t.count,this.m_positionConstraints.length<this.m_count){const t=Math.max(2*this.m_positionConstraints.length,this.m_count);for(;this.m_positionConstraints.length<t;)this.m_positionConstraints[this.m_positionConstraints.length]=new l}if(this.m_velocityConstraints.length<this.m_count){const t=Math.max(2*this.m_velocityConstraints.length,this.m_count);for(;this.m_velocityConstraints.length<t;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new r}this.m_positions=t.positions,this.m_velocities=t.velocities,this.m_contacts=t.contacts;for(let s=0;s<this.m_count;++s){const t=this.m_contacts[s],o=t.m_fixtureA,e=t.m_fixtureB,i=o.GetShape(),n=e.GetShape(),a=i.m_radius,c=n.m_radius,r=o.GetBody(),l=e.GetBody(),_=t.GetManifold(),{pointCount:b}=_,m=this.m_velocityConstraints[s];m.friction=t.m_friction,m.restitution=t.m_restitution,m.threshold=t.m_restitutionThreshold,m.tangentSpeed=t.m_tangentSpeed,m.indexA=r.m_islandIndex,m.indexB=l.m_islandIndex,m.invMassA=r.m_invMass,m.invMassB=l.m_invMass,m.invIA=r.m_invI,m.invIB=l.m_invI,m.contactIndex=s,m.pointCount=b,m.K.SetZero(),m.normalMass.SetZero();const V=this.m_positionConstraints[s];V.indexA=r.m_islandIndex,V.indexB=l.m_islandIndex,V.invMassA=r.m_invMass,V.invMassB=l.m_invMass,V.localCenterA.Copy(r.m_sweep.localCenter),V.localCenterB.Copy(l.m_sweep.localCenter),V.invIA=r.m_invI,V.invIB=l.m_invI,V.localNormal.Copy(_.localNormal),V.localPoint.Copy(_.localPoint),V.pointCount=b,V.radiusA=a,V.radiusB=c,V.type=_.type;for(let s=0;s<b;++s){const t=_.points[s],o=m.points[s];this.m_step.warmStarting?(o.normalImpulse=this.m_step.dtRatio*t.normalImpulse,o.tangentImpulse=this.m_step.dtRatio*t.tangentImpulse):(o.normalImpulse=0,o.tangentImpulse=0),o.rA.SetZero(),o.rB.SetZero(),o.normalMass=0,o.tangentMass=0,o.velocityBias=0,V.localPoints[s].Copy(t.localPoint)}}return this}InitializeVelocityConstraints(){const t=m.InitializeVelocityConstraints_s_xfA,o=m.InitializeVelocityConstraints_s_xfB,e=m.InitializeVelocityConstraints_s_worldManifold;for(let n=0;n<this.m_count;++n){const a=this.m_velocityConstraints[n],c=this.m_positionConstraints[n],{radiusA:r,radiusB:l,localCenterA:_,localCenterB:b}=c,m=this.m_contacts[a.contactIndex].GetManifold(),{indexA:V,indexB:p,tangent:C,pointCount:S}=a,h=a.invMassA,u=a.invMassB,v=a.invIA,d=a.invIB,y=this.m_positions[V].c,A=this.m_positions[V].a,I=this.m_velocities[V].v,B=this.m_velocities[V].w,x=this.m_positions[p].c,M=this.m_positions[p].a,f=this.m_velocities[p].v,w=this.m_velocities[p].w;t.q.Set(A),o.q.Set(M),s.b2Vec2.Subtract(y,s.b2Rot.MultiplyVec2(t.q,_,s.b2Vec2.s_t0),t.p),s.b2Vec2.Subtract(x,s.b2Rot.MultiplyVec2(o.q,b,s.b2Vec2.s_t0),o.p),e.Initialize(m,t,r,o,l),a.normal.Copy(e.normal),s.b2Vec2.CrossVec2One(a.normal,C);for(let t=0;t<S;++t){const o=a.points[t];s.b2Vec2.Subtract(e.points[t],y,o.rA),s.b2Vec2.Subtract(e.points[t],x,o.rB);const i=s.b2Vec2.Cross(o.rA,a.normal),n=s.b2Vec2.Cross(o.rB,a.normal),c=h+u+v*i*i+d*n*n;o.normalMass=c>0?1/c:0;const r=s.b2Vec2.Cross(o.rA,C),l=s.b2Vec2.Cross(o.rB,C),_=h+u+v*r*r+d*l*l;o.tangentMass=_>0?1/_:0,o.velocityBias=0;const b=s.b2Vec2.Dot(a.normal,s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,o.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(I,B,o.rA,s.b2Vec2.s_t1),s.b2Vec2.s_t0));b<-a.threshold&&(o.velocityBias=-a.restitution*b)}if(2===a.pointCount&&i){const t=a.points[0],o=a.points[1],e=s.b2Vec2.Cross(t.rA,a.normal),i=s.b2Vec2.Cross(t.rB,a.normal),n=s.b2Vec2.Cross(o.rA,a.normal),c=s.b2Vec2.Cross(o.rB,a.normal),r=h+u+v*e*e+d*i*i,l=h+u+v*n*n+d*c*c,_=h+u+v*e*n+d*i*c;r*r<1e3*(r*l-_*_)?(a.K.ex.Set(r,_),a.K.ey.Set(_,l),a.K.GetInverse(a.normalMass)):a.pointCount=1}}}WarmStart(){const t=m.WarmStart_s_P;for(let o=0;o<this.m_count;++o){const e=this.m_velocityConstraints[o],{indexA:i,indexB:n,pointCount:a,normal:c,tangent:r}=e,l=e.invMassA,_=e.invIA,b=e.invMassB,m=e.invIB,V=this.m_velocities[i].v;let p=this.m_velocities[i].w;const C=this.m_velocities[n].v;let S=this.m_velocities[n].w;for(let o=0;o<a;++o){const i=e.points[o];s.b2Vec2.Add(s.b2Vec2.Scale(i.normalImpulse,c,s.b2Vec2.s_t0),s.b2Vec2.Scale(i.tangentImpulse,r,s.b2Vec2.s_t1),t),p-=_*s.b2Vec2.Cross(i.rA,t),V.SubtractScaled(l,t),S+=m*s.b2Vec2.Cross(i.rB,t),C.AddScaled(b,t)}this.m_velocities[i].w=p,this.m_velocities[n].w=S}}SolveVelocityConstraints(){const t=m.SolveVelocityConstraints_s_dv,o=m.SolveVelocityConstraints_s_dv1,e=m.SolveVelocityConstraints_s_dv2,n=m.SolveVelocityConstraints_s_P,a=m.SolveVelocityConstraints_s_a,c=m.SolveVelocityConstraints_s_b,r=m.SolveVelocityConstraints_s_x,l=m.SolveVelocityConstraints_s_d,_=m.SolveVelocityConstraints_s_P1,b=m.SolveVelocityConstraints_s_P2,V=m.SolveVelocityConstraints_s_P1P2;for(let m=0;m<this.m_count;++m){const p=this.m_velocityConstraints[m],{indexA:C,indexB:S,pointCount:h,normal:u,tangent:v,friction:d}=p,y=p.invMassA,A=p.invIA,I=p.invMassB,B=p.invIB,x=this.m_velocities[C].v;let M=this.m_velocities[C].w;const f=this.m_velocities[S].v;let w=this.m_velocities[S].w;for(let o=0;o<h;++o){const e=p.points[o];s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,e.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,e.rA,s.b2Vec2.s_t1),t);const i=s.b2Vec2.Dot(t,v)-p.tangentSpeed;let a=e.tangentMass*-i;const c=d*e.normalImpulse,r=(0,s.b2Clamp)(e.tangentImpulse+a,-c,c);a=r-e.tangentImpulse,e.tangentImpulse=r,s.b2Vec2.Scale(a,v,n),x.SubtractScaled(y,n),M-=A*s.b2Vec2.Cross(e.rA,n),f.AddScaled(I,n),w+=B*s.b2Vec2.Cross(e.rB,n)}if(1===p.pointCount||!1===i)for(let o=0;o<h;++o){const e=p.points[o];s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,e.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,e.rA,s.b2Vec2.s_t1),t);const i=s.b2Vec2.Dot(t,u);let a=-e.normalMass*(i-e.velocityBias);const c=Math.max(e.normalImpulse+a,0);a=c-e.normalImpulse,e.normalImpulse=c,s.b2Vec2.Scale(a,u,n),x.SubtractScaled(y,n),M-=A*s.b2Vec2.Cross(e.rA,n),f.AddScaled(I,n),w+=B*s.b2Vec2.Cross(e.rB,n)}else{const t=p.points[0],i=p.points[1];a.Set(t.normalImpulse,i.normalImpulse),s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,t.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,t.rA,s.b2Vec2.s_t1),o),s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,i.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,i.rA,s.b2Vec2.s_t1),e);let n=s.b2Vec2.Dot(o,u),m=s.b2Vec2.Dot(e,u);for(c.x=n-t.velocityBias,c.y=m-i.velocityBias,c.Subtract(s.b2Mat22.MultiplyVec2(p.K,a,s.b2Vec2.s_t0));;){if(s.b2Mat22.MultiplyVec2(p.normalMass,c,r).Negate(),r.x>=0&&r.y>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}if(r.x=-t.normalMass*c.x,r.y=0,n=0,m=p.K.ex.y*r.x+c.y,r.x>=0&&m>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}if(r.x=0,r.y=-i.normalMass*c.y,n=p.K.ey.x*r.y+c.x,m=0,r.y>=0&&n>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}if(r.x=0,r.y=0,n=c.x,m=c.y,n>=0&&m>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}break}}this.m_velocities[C].w=M,this.m_velocities[S].w=w}}StoreImpulses(){for(let t=0;t<this.m_count;++t){const s=this.m_velocityConstraints[t],o=this.m_contacts[s.contactIndex].GetManifold();for(let t=0;t<s.pointCount;++t)o.points[t].normalImpulse=s.points[t].normalImpulse,o.points[t].tangentImpulse=s.points[t].tangentImpulse}}SolvePositionConstraints(){const o=m.SolvePositionConstraints_s_xfA,e=m.SolvePositionConstraints_s_xfB,i=m.SolvePositionConstraints_s_psm,n=m.SolvePositionConstraints_s_rA,a=m.SolvePositionConstraints_s_rB,c=m.SolvePositionConstraints_s_P;let r=0;for(let l=0;l<this.m_count;++l){const _=this.m_positionConstraints[l],{indexA:b,indexB:m,localCenterA:V,localCenterB:p,pointCount:C}=_,S=_.invMassA,h=_.invIA,u=_.invMassB,v=_.invIB,d=this.m_positions[b].c;let y=this.m_positions[b].a;const A=this.m_positions[m].c;let I=this.m_positions[m].a;for(let l=0;l<C;++l){o.q.Set(y),e.q.Set(I),s.b2Vec2.Subtract(d,s.b2Rot.MultiplyVec2(o.q,V,s.b2Vec2.s_t0),o.p),s.b2Vec2.Subtract(A,s.b2Rot.MultiplyVec2(e.q,p,s.b2Vec2.s_t0),e.p),i.Initialize(_,o,e,l);const{normal:b,point:m,separation:C}=i;s.b2Vec2.Subtract(m,d,n),s.b2Vec2.Subtract(m,A,a),r=Math.min(r,C);const B=(0,s.b2Clamp)(t.b2_baumgarte*(C+t.b2_linearSlop),-t.b2_maxLinearCorrection,0),x=s.b2Vec2.Cross(n,b),M=s.b2Vec2.Cross(a,b),f=S+u+h*x*x+v*M*M,w=f>0?-B/f:0;s.b2Vec2.Scale(w,b,c),d.SubtractScaled(S,c),y-=h*s.b2Vec2.Cross(n,c),A.AddScaled(u,c),I+=v*s.b2Vec2.Cross(a,c)}this.m_positions[b].c.Copy(d),this.m_positions[b].a=y,this.m_positions[m].c.Copy(A),this.m_positions[m].a=I}return r>=-3*t.b2_linearSlop}SolveTOIPositionConstraints(o,e){const i=m.SolveTOIPositionConstraints_s_xfA,n=m.SolveTOIPositionConstraints_s_xfB,a=m.SolveTOIPositionConstraints_s_psm,c=m.SolveTOIPositionConstraints_s_rA,r=m.SolveTOIPositionConstraints_s_rB,l=m.SolveTOIPositionConstraints_s_P;let _=0;for(let b=0;b<this.m_count;++b){const m=this.m_positionConstraints[b],{indexA:V,indexB:p,localCenterA:C,localCenterB:S,pointCount:h}=m;let u=0,v=0;V!==o&&V!==e||(u=m.invMassA,v=m.invIA);let d=0,y=0;p!==o&&p!==e||(d=m.invMassB,y=m.invIB);const A=this.m_positions[V].c;let I=this.m_positions[V].a;const B=this.m_positions[p].c;let x=this.m_positions[p].a;for(let o=0;o<h;++o){i.q.Set(I),n.q.Set(x),s.b2Vec2.Subtract(A,s.b2Rot.MultiplyVec2(i.q,C,s.b2Vec2.s_t0),i.p),s.b2Vec2.Subtract(B,s.b2Rot.MultiplyVec2(n.q,S,s.b2Vec2.s_t0),n.p),a.Initialize(m,i,n,o);const{normal:e,point:b,separation:V}=a;s.b2Vec2.Subtract(b,A,c),s.b2Vec2.Subtract(b,B,r),_=Math.min(_,V);const p=(0,s.b2Clamp)(t.b2_toiBaumgarte*(V+t.b2_linearSlop),-t.b2_maxLinearCorrection,0),h=s.b2Vec2.Cross(c,e),M=s.b2Vec2.Cross(r,e),f=u+d+v*h*h+y*M*M,w=f>0?-p/f:0;s.b2Vec2.Scale(w,e,l),A.SubtractScaled(u,l),I-=v*s.b2Vec2.Cross(c,l),B.AddScaled(d,l),x+=y*s.b2Vec2.Cross(r,l)}this.m_positions[V].a=I,this.m_positions[p].a=x}return _>=-1.5*t.b2_linearSlop}}exports.b2ContactSolver=m,m.InitializeVelocityConstraints_s_xfA=new s.b2Transform,m.InitializeVelocityConstraints_s_xfB=new s.b2Transform,m.InitializeVelocityConstraints_s_worldManifold=new o.b2WorldManifold,m.WarmStart_s_P=new s.b2Vec2,m.SolveVelocityConstraints_s_dv=new s.b2Vec2,m.SolveVelocityConstraints_s_dv1=new s.b2Vec2,m.SolveVelocityConstraints_s_dv2=new s.b2Vec2,m.SolveVelocityConstraints_s_P=new s.b2Vec2,m.SolveVelocityConstraints_s_a=new s.b2Vec2,m.SolveVelocityConstraints_s_b=new s.b2Vec2,m.SolveVelocityConstraints_s_x=new s.b2Vec2,m.SolveVelocityConstraints_s_d=new s.b2Vec2,m.SolveVelocityConstraints_s_P1=new s.b2Vec2,m.SolveVelocityConstraints_s_P2=new s.b2Vec2,m.SolveVelocityConstraints_s_P1P2=new s.b2Vec2,m.SolvePositionConstraints_s_xfA=new s.b2Transform,m.SolvePositionConstraints_s_xfB=new s.b2Transform,m.SolvePositionConstraints_s_psm=new b,m.SolvePositionConstraints_s_rA=new s.b2Vec2,m.SolvePositionConstraints_s_rB=new s.b2Vec2,m.SolvePositionConstraints_s_P=new s.b2Vec2,m.SolveTOIPositionConstraints_s_xfA=new s.b2Transform,m.SolveTOIPositionConstraints_s_xfB=new s.b2Transform,m.SolveTOIPositionConstraints_s_psm=new b,m.SolveTOIPositionConstraints_s_rA=new s.b2Vec2,m.SolveTOIPositionConstraints_s_rB=new s.b2Vec2,m.SolveTOIPositionConstraints_s_P=new s.b2Vec2;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","../collision/b2_collision":"PKgf","./b2_time_step":"w6W3"}],"DDAc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Island=void 0;const t=require("../common/b2_common"),o=require("../common/b2_math"),i=require("../common/b2_timer"),s=require("./b2_contact_solver"),e=require("./b2_body"),n=require("./b2_time_step"),a=require("./b2_world_callbacks");class m{constructor(o,i,s,e){this.m_bodyCount=0,this.m_jointCount=0,this.m_contactCount=0,this.m_bodyCapacity=o,this.m_listener=e,this.m_bodies=new Array(o),this.m_contacts=new Array(i),this.m_joints=new Array(s),this.m_velocities=(0,t.b2MakeArray)(o,n.b2Velocity),this.m_positions=(0,t.b2MakeArray)(o,n.b2Position),this.Resize(o)}Resize(t){for(;this.m_bodyCapacity<t;)this.m_velocities[this.m_bodyCapacity]=new n.b2Velocity,this.m_positions[this.m_bodyCapacity]=new n.b2Position,this.m_bodyCapacity++}Clear(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}AddBody(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount]=t,++this.m_bodyCount}AddContact(t){this.m_contacts[this.m_contactCount++]=t}AddJoint(t){this.m_joints[this.m_jointCount++]=t}Solve(i,s,n,a){const c=m.s_timer.Reset(),_=s.dt;for(let t=0;t<this.m_bodyCount;++t){const o=this.m_bodies[t];this.m_positions[t].c.Copy(o.m_sweep.c);const{a:i}=o.m_sweep,s=this.m_velocities[t].v.Copy(o.m_linearVelocity);let a=o.m_angularVelocity;o.m_sweep.c0.Copy(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_type===e.b2BodyType.b2_dynamicBody&&(s.x+=_*o.m_invMass*(o.m_gravityScale*o.m_mass*n.x+o.m_force.x),s.y+=_*o.m_invMass*(o.m_gravityScale*o.m_mass*n.y+o.m_force.y),a+=_*o.m_invI*o.m_torque,s.Scale(1/(1+_*o.m_linearDamping)),a*=1/(1+_*o.m_angularDamping)),this.m_positions[t].a=i,this.m_velocities[t].w=a}c.Reset();const l=m.s_solverData;l.step.Copy(s),l.positions=this.m_positions,l.velocities=this.m_velocities;const r=m.s_contactSolverDef;r.step.Copy(s),r.contacts=this.m_contacts,r.count=this.m_contactCount,r.positions=this.m_positions,r.velocities=this.m_velocities;const h=m.s_contactSolver.Initialize(r);h.InitializeVelocityConstraints(),s.warmStarting&&h.WarmStart();for(let t=0;t<this.m_jointCount;++t)this.m_joints[t].InitVelocityConstraints(l);i.solveInit=c.GetMilliseconds(),c.Reset();for(let t=0;t<s.config.velocityIterations;++t){for(let t=0;t<this.m_jointCount;++t)this.m_joints[t].SolveVelocityConstraints(l);h.SolveVelocityConstraints()}h.StoreImpulses(),i.solveVelocity=c.GetMilliseconds();for(let e=0;e<this.m_bodyCount;++e){const{c:i}=this.m_positions[e];let{a:s}=this.m_positions[e];const{v:n}=this.m_velocities[e];let{w:a}=this.m_velocities[e];const c=o.b2Vec2.Scale(_,n,m.s_translation);if(o.b2Vec2.Dot(c,c)>t.b2_maxTranslationSquared){const o=t.b2_maxTranslation/c.Length();n.Scale(o)}const l=_*a;if(l*l>t.b2_maxRotationSquared){a*=t.b2_maxRotation/Math.abs(l)}i.AddScaled(_,n),s+=_*a,this.m_positions[e].a=s,this.m_velocities[e].w=a}c.Reset();let p=!1;for(let t=0;t<s.config.positionIterations;++t){const t=h.SolvePositionConstraints();let o=!0;for(let i=0;i<this.m_jointCount;++i){const t=this.m_joints[i].SolvePositionConstraints(l);o=o&&t}if(t&&o){p=!0;break}}for(let t=0;t<this.m_bodyCount;++t){const o=this.m_bodies[t];o.m_sweep.c.Copy(this.m_positions[t].c),o.m_sweep.a=this.m_positions[t].a,o.m_linearVelocity.Copy(this.m_velocities[t].v),o.m_angularVelocity=this.m_velocities[t].w,o.SynchronizeTransform()}if(i.solvePosition=c.GetMilliseconds(),this.Report(h.m_velocityConstraints),a){let i=t.b2_maxFloat;const s=t.b2_linearSleepTolerance*t.b2_linearSleepTolerance,n=t.b2_angularSleepTolerance*t.b2_angularSleepTolerance;for(let t=0;t<this.m_bodyCount;++t){const a=this.m_bodies[t];a.GetType()!==e.b2BodyType.b2_staticBody&&(!a.m_autoSleepFlag||a.m_angularVelocity*a.m_angularVelocity>n||o.b2Vec2.Dot(a.m_linearVelocity,a.m_linearVelocity)>s?(a.m_sleepTime=0,i=0):(a.m_sleepTime+=_,i=Math.min(i,a.m_sleepTime)))}if(i>=t.b2_timeToSleep&&p)for(let t=0;t<this.m_bodyCount;++t){this.m_bodies[t].SetAwake(!1)}}}SolveTOI(i,s,e){for(let t=0;t<this.m_bodyCount;++t){const o=this.m_bodies[t];this.m_positions[t].c.Copy(o.m_sweep.c),this.m_positions[t].a=o.m_sweep.a,this.m_velocities[t].v.Copy(o.m_linearVelocity),this.m_velocities[t].w=o.m_angularVelocity}const n=m.s_contactSolverDef;n.contacts=this.m_contacts,n.count=this.m_contactCount,n.step.Copy(i),n.positions=this.m_positions,n.velocities=this.m_velocities;const a=m.s_contactSolver.Initialize(n);for(let t=0;t<i.config.positionIterations;++t){if(a.SolveTOIPositionConstraints(s,e))break}this.m_bodies[s].m_sweep.c0.Copy(this.m_positions[s].c),this.m_bodies[s].m_sweep.a0=this.m_positions[s].a,this.m_bodies[e].m_sweep.c0.Copy(this.m_positions[e].c),this.m_bodies[e].m_sweep.a0=this.m_positions[e].a,a.InitializeVelocityConstraints();for(let t=0;t<i.config.velocityIterations;++t)a.SolveVelocityConstraints();const c=i.dt;for(let _=0;_<this.m_bodyCount;++_){const{c:i}=this.m_positions[_];let{a:s}=this.m_positions[_];const{v:e}=this.m_velocities[_];let{w:n}=this.m_velocities[_];const a=o.b2Vec2.Scale(c,e,m.s_translation);if(o.b2Vec2.Dot(a,a)>t.b2_maxTranslationSquared){const o=t.b2_maxTranslation/a.Length();e.Scale(o)}const l=c*n;if(l*l>t.b2_maxRotationSquared){n*=t.b2_maxRotation/Math.abs(l)}i.AddScaled(c,e),s+=c*n,this.m_positions[_].a=s,this.m_velocities[_].w=n;const r=this.m_bodies[_];r.m_sweep.c.Copy(i),r.m_sweep.a=s,r.m_linearVelocity.Copy(e),r.m_angularVelocity=n,r.SynchronizeTransform()}this.Report(a.m_velocityConstraints)}Report(t){for(let o=0;o<this.m_contactCount;++o){const i=this.m_contacts[o],s=t[o],e=m.s_impulse;e.count=s.pointCount;for(let t=0;t<s.pointCount;++t)e.normalImpulses[t]=s.points[t].normalImpulse,e.tangentImpulses[t]=s.points[t].tangentImpulse;this.m_listener.PostSolve(i,e)}}}exports.b2Island=m,m.s_timer=new i.b2Timer,m.s_solverData=new n.b2SolverData,m.s_contactSolverDef=new s.b2ContactSolverDef,m.s_contactSolver=new s.b2ContactSolver,m.s_translation=new o.b2Vec2,m.s_impulse=new a.b2ContactImpulse;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","../common/b2_timer":"ixAk","./b2_contact_solver":"DnH3","./b2_body":"rONj","./b2_time_step":"w6W3","./b2_world_callbacks":"G1MF"}],"H7LA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2World=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),i=require("../common/b2_timer"),n=require("../collision/b2_collision"),o=require("../collision/b2_time_of_impact"),s=require("./b2_joint"),r=require("./b2_area_joint"),_=require("./b2_distance_joint"),a=require("./b2_friction_joint"),m=require("./b2_gear_joint"),l=require("./b2_motor_joint"),c=require("./b2_mouse_joint"),u=require("./b2_prismatic_joint"),d=require("./b2_pulley_joint"),p=require("./b2_revolute_joint"),h=require("./b2_weld_joint"),y=require("./b2_wheel_joint"),b=require("./b2_body"),g=require("./b2_contact_manager"),S=require("./b2_island"),f=require("./b2_time_step");class x{constructor(i){this.m_contactManager=new g.b2ContactManager,this.m_bodyList=null,this.m_jointList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_gravity=new e.b2Vec2,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_inv_dt0=0,this.m_newContacts=!1,this.m_locked=!1,this.m_clearForces=!0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new f.b2Profile,this.m_island=new S.b2Island(2*t.b2_maxTOIContacts,t.b2_maxTOIContacts,0,this.m_contactManager.m_contactListener),this.s_stack=[],this.m_gravity.Copy(i)}static Create(t){return new x(t)}SetDestructionListener(t){this.m_destructionListener=t}GetDestructionListener(){return this.m_destructionListener}SetContactFilter(t){this.m_contactManager.m_contactFilter=t}SetContactListener(t){this.m_contactManager.m_contactListener=t,this.m_island.m_listener=t}CreateBody(e={}){(0,t.b2Assert)(!this.IsLocked());const i=new b.b2Body(e,this);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i}DestroyBody(e){var i,n;(0,t.b2Assert)(!this.IsLocked());let o=e.m_jointList;for(;o;){const t=o;o=o.next,null===(i=this.m_destructionListener)||void 0===i||i.SayGoodbyeJoint(t.joint),this.DestroyJoint(t.joint),e.m_jointList=o}e.m_jointList=null;let s=e.m_contactList;for(;s;){const t=s;s=s.next,this.m_contactManager.Destroy(t.contact)}e.m_contactList=null;const r=this.m_contactManager.m_broadPhase;let _=e.m_fixtureList;for(;_;){const t=_;_=_.m_next,null===(n=this.m_destructionListener)||void 0===n||n.SayGoodbyeFixture(t),t.DestroyProxies(r),e.m_fixtureList=_,e.m_fixtureCount-=1}e.m_fixtureList=null,e.m_fixtureCount=0,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_bodyList&&(this.m_bodyList=e.m_next),--this.m_bodyCount}static Joint_Create(t){switch(t.type){case s.b2JointType.e_distanceJoint:return new _.b2DistanceJoint(t);case s.b2JointType.e_mouseJoint:return new c.b2MouseJoint(t);case s.b2JointType.e_prismaticJoint:return new u.b2PrismaticJoint(t);case s.b2JointType.e_revoluteJoint:return new p.b2RevoluteJoint(t);case s.b2JointType.e_pulleyJoint:return new d.b2PulleyJoint(t);case s.b2JointType.e_gearJoint:return new m.b2GearJoint(t);case s.b2JointType.e_wheelJoint:return new y.b2WheelJoint(t);case s.b2JointType.e_weldJoint:return new h.b2WeldJoint(t);case s.b2JointType.e_frictionJoint:return new a.b2FrictionJoint(t);case s.b2JointType.e_motorJoint:return new l.b2MotorJoint(t);case s.b2JointType.e_areaJoint:return new r.b2AreaJoint(t)}throw new Error}CreateJoint(e){(0,t.b2Assert)(!this.IsLocked());const i=x.Joint_Create(e);i.m_prev=null,i.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=i),this.m_jointList=i,++this.m_jointCount,i.m_edgeA.prev=null,i.m_edgeA.next=i.m_bodyA.m_jointList,i.m_bodyA.m_jointList&&(i.m_bodyA.m_jointList.prev=i.m_edgeA),i.m_bodyA.m_jointList=i.m_edgeA,i.m_edgeB.prev=null,i.m_edgeB.next=i.m_bodyB.m_jointList,i.m_bodyB.m_jointList&&(i.m_bodyB.m_jointList.prev=i.m_edgeB),i.m_bodyB.m_jointList=i.m_edgeB;const n=i.m_bodyA,o=i.m_bodyB;if(!e.collideConnected){let t=o.GetContactList();for(;t;)t.other===n&&t.contact.FlagForFiltering(),t=t.next}return i}DestroyJoint(e){(0,t.b2Assert)(!this.IsLocked()),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_jointList&&(this.m_jointList=e.m_next);const i=e.m_bodyA,n=e.m_bodyB,o=e.m_collideConnected;if(i.SetAwake(!0),n.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA===i.m_jointList&&(i.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB===n.m_jointList&&(n.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,--this.m_jointCount,!o){let t=n.GetContactList();for(;t;)t.other===i&&t.contact.FlagForFiltering(),t=t.next}}Step(t,e){const i=x.Step_s_stepTimer.Reset();this.m_newContacts&&(this.m_contactManager.FindNewContacts(),this.m_newContacts=!1),this.m_locked=!0;const n=x.Step_s_step;n.dt=t,n.config={...e},n.inv_dt=t>0?1/t:0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=this.m_warmStarting;{const t=x.Step_s_timer.Reset();this.m_contactManager.Collide(),this.m_profile.collide=t.GetMilliseconds()}if(this.m_stepComplete&&n.dt>0){const t=x.Step_s_timer.Reset();this.Solve(n),this.m_profile.solve=t.GetMilliseconds()}if(this.m_continuousPhysics&&n.dt>0){const t=x.Step_s_timer.Reset();this.SolveTOI(n),this.m_profile.solveTOI=t.GetMilliseconds()}n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_clearForces&&this.ClearForces(),this.m_locked=!1,this.m_profile.step=i.GetMilliseconds()}ClearForces(){for(let t=this.m_bodyList;t;t=t.GetNext())t.m_force.SetZero(),t.m_torque=0}QueryAABB(e,i){this.m_contactManager.m_broadPhase.Query(e,e=>{const n=(0,t.b2Verify)(e.userData);return i(n.fixture)})}QueryAllAABB(t,e=[]){return this.QueryAABB(t,t=>(e.push(t),!0)),e}QueryPointAABB(e,i){this.m_contactManager.m_broadPhase.QueryPoint(e,e=>{const n=(0,t.b2Verify)(e.userData);return i(n.fixture)})}QueryAllPointAABB(t,e=[]){return this.QueryPointAABB(t,t=>(e.push(t),!0)),e}QueryFixtureShape(e,i,o,s){const r=x.QueryFixtureShape_s_aabb;e.ComputeAABB(r,o,i),this.m_contactManager.m_broadPhase.Query(r,r=>{const _=(0,t.b2Verify)(r.userData),{fixture:a}=_;return!(0,n.b2TestOverlap)(e,i,a.GetShape(),_.childIndex,o,a.GetBody().GetTransform())||s(a)})}QueryAllFixtureShape(t,e,i,n=[]){return this.QueryFixtureShape(t,e,i,t=>(n.push(t),!0)),n}QueryFixturePoint(e,i){this.m_contactManager.m_broadPhase.QueryPoint(e,n=>{const o=(0,t.b2Verify)(n.userData),{fixture:s}=o;return!s.TestPoint(e)||i(s)})}QueryAllFixturePoint(t,e=[]){return this.QueryFixturePoint(t,t=>(e.push(t),!0)),e}RayCast(e,i,n){const o=x.RayCast_s_input;o.maxFraction=1,o.p1.Copy(e),o.p2.Copy(i),this.m_contactManager.m_broadPhase.RayCast(o,(o,s)=>{const r=(0,t.b2Verify)(s.userData),{fixture:_}=r,a=r.childIndex,m=x.RayCast_s_output;if(_.RayCast(m,o,a)){const{fraction:t}=m,o=x.RayCast_s_point;return o.Set((1-t)*e.x+t*i.x,(1-t)*e.y+t*i.y),n(_,o,m.normal,t)}return o.maxFraction})}RayCastOne(t,e){let i=null,n=1;return this.RayCast(t,e,(t,e,o,s)=>(s<n&&(n=s,i=t),n)),i}RayCastAll(t,e,i=[]){return this.RayCast(t,e,t=>(i.push(t),1)),i}GetBodyList(){return this.m_bodyList}GetJointList(){return this.m_jointList}GetContactList(){return this.m_contactManager.m_contactList}SetAllowSleeping(t){if(t!==this.m_allowSleep&&(this.m_allowSleep=t,!this.m_allowSleep))for(let e=this.m_bodyList;e;e=e.m_next)e.SetAwake(!0)}GetAllowSleeping(){return this.m_allowSleep}SetWarmStarting(t){this.m_warmStarting=t}GetWarmStarting(){return this.m_warmStarting}SetContinuousPhysics(t){this.m_continuousPhysics=t}GetContinuousPhysics(){return this.m_continuousPhysics}SetSubStepping(t){this.m_subStepping=t}GetSubStepping(){return this.m_subStepping}GetProxyCount(){return this.m_contactManager.m_broadPhase.GetProxyCount()}GetBodyCount(){return this.m_bodyCount}GetJointCount(){return this.m_jointCount}GetContactCount(){return this.m_contactManager.m_contactCount}GetTreeHeight(){return this.m_contactManager.m_broadPhase.GetTreeHeight()}GetTreeBalance(){return this.m_contactManager.m_broadPhase.GetTreeBalance()}GetTreeQuality(){return this.m_contactManager.m_broadPhase.GetTreeQuality()}SetGravity(t){this.m_gravity.Copy(t)}GetGravity(){return this.m_gravity}IsLocked(){return this.m_locked}SetAutoClearForces(t){this.m_clearForces=t}GetAutoClearForces(){return this.m_clearForces}ShiftOrigin(e){(0,t.b2Assert)(!this.IsLocked());for(let t=this.m_bodyList;t;t=t.m_next)t.m_xf.p.Subtract(e),t.m_sweep.c0.Subtract(e),t.m_sweep.c.Subtract(e);for(let t=this.m_jointList;t;t=t.m_next)t.ShiftOrigin(e);this.m_contactManager.m_broadPhase.ShiftOrigin(e)}GetContactManager(){return this.m_contactManager}GetProfile(){return this.m_profile}Solve(e){this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;const n=this.m_island;n.Resize(this.m_bodyCount),n.Clear();for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=this.m_contactManager.m_contactList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=this.m_jointList;t;t=t.m_next)t.m_islandFlag=!1;const o=this.s_stack;for(let i=this.m_bodyList;i;i=i.m_next){if(i.m_islandFlag)continue;if(!i.IsAwake()||!i.IsEnabled())continue;if(i.GetType()===b.b2BodyType.b2_staticBody)continue;n.Clear();let s=0;for(o[s++]=i,i.m_islandFlag=!0;s>0;){const e=o[--s];if((0,t.b2Assert)(null!==e),n.AddBody(e),e.GetType()!==b.b2BodyType.b2_staticBody){e.m_awakeFlag=!0;for(let t=e.m_contactList;t;t=t.next){const{contact:e}=t;if(e.m_islandFlag)continue;if(!e.IsEnabled()||!e.IsTouching())continue;const i=e.m_fixtureA.m_isSensor,r=e.m_fixtureB.m_isSensor;if(i||r)continue;n.AddContact(e),e.m_islandFlag=!0;const{other:_}=t;_.m_islandFlag||(o[s++]=_,_.m_islandFlag=!0)}for(let t=e.m_jointList;t;t=t.next){if(t.joint.m_islandFlag)continue;const{other:e}=t;e.IsEnabled()&&(n.AddJoint(t.joint),t.joint.m_islandFlag=!0,e.m_islandFlag||(o[s++]=e,e.m_islandFlag=!0))}}}const r=new f.b2Profile;n.Solve(r,e,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=r.solveInit,this.m_profile.solveVelocity+=r.solveVelocity,this.m_profile.solvePosition+=r.solvePosition;for(let t=0;t<n.m_bodyCount;++t){const e=n.m_bodies[t];e.GetType()===b.b2BodyType.b2_staticBody&&(e.m_islandFlag=!1)}}for(let t=0;t<o.length&&o[t];++t)o[t]=null;const s=new i.b2Timer;for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag&&t.GetType()!==b.b2BodyType.b2_staticBody&&t.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=s.GetMilliseconds()}SolveTOI(e){const i=this.m_island;if(i.Clear(),this.m_stepComplete){for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1,t.m_sweep.alpha0=0;for(let t=this.m_contactManager.m_contactList;t;t=t.m_next)t.m_toiFlag=!1,t.m_islandFlag=!1,t.m_toiCount=0,t.m_toi=1}for(;;){let n=null,s=1;for(let e=this.m_contactManager.m_contactList;e;e=e.m_next){if(!e.IsEnabled())continue;if(e.m_toiCount>t.b2_maxSubSteps)continue;let i=1;if(e.m_toiFlag)i=e.m_toi;else{const t=e.GetFixtureA(),n=e.GetFixtureB();if(t.IsSensor()||n.IsSensor())continue;const s=t.GetBody(),r=n.GetBody(),_=s.m_type,a=r.m_type,m=s.IsAwake()&&_!==b.b2BodyType.b2_staticBody,l=r.IsAwake()&&a!==b.b2BodyType.b2_staticBody;if(!m&&!l)continue;const c=s.IsBullet()||_!==b.b2BodyType.b2_dynamicBody,u=r.IsBullet()||a!==b.b2BodyType.b2_dynamicBody;if(!c&&!u)continue;let{alpha0:d}=s.m_sweep;s.m_sweep.alpha0<r.m_sweep.alpha0?(d=r.m_sweep.alpha0,s.m_sweep.Advance(d)):r.m_sweep.alpha0<s.m_sweep.alpha0&&(d=s.m_sweep.alpha0,r.m_sweep.Advance(d));const p=e.GetChildIndexA(),h=e.GetChildIndexB(),y=x.SolveTOI_s_toi_input;y.proxyA.SetShape(t.GetShape(),p),y.proxyB.SetShape(n.GetShape(),h),y.sweepA.Copy(s.m_sweep),y.sweepB.Copy(r.m_sweep),y.tMax=1;const g=x.SolveTOI_s_toi_output;(0,o.b2TimeOfImpact)(g,y);const S=g.t;i=g.state===o.b2TOIOutputState.e_touching?Math.min(d+(1-d)*S,1):1,e.m_toi=i,e.m_toiFlag=!0}i<s&&(n=e,s=i)}if(null===n||1-10*t.b2_epsilon<s){this.m_stepComplete=!0;break}const r=n.GetFixtureA(),_=n.GetFixtureB(),a=r.GetBody(),m=_.GetBody(),l=x.SolveTOI_s_backup1.Copy(a.m_sweep),c=x.SolveTOI_s_backup2.Copy(m.m_sweep);if(a.Advance(s),m.Advance(s),n.Update(this.m_contactManager.m_contactListener),n.m_toiFlag=!1,++n.m_toiCount,!n.IsEnabled()||!n.IsTouching()){n.SetEnabled(!1),a.m_sweep.Copy(l),m.m_sweep.Copy(c),a.SynchronizeTransform(),m.SynchronizeTransform();continue}a.SetAwake(!0),m.SetAwake(!0),i.Clear(),i.AddBody(a),i.AddBody(m),i.AddContact(n),a.m_islandFlag=!0,m.m_islandFlag=!0,n.m_islandFlag=!0;for(let e=0;e<2;++e){const n=0===e?a:m;if(n.m_type===b.b2BodyType.b2_dynamicBody)for(let e=n.m_contactList;e&&i.m_bodyCount!==i.m_bodyCapacity&&i.m_contactCount!==t.b2_maxTOIContacts;e=e.next){const{contact:t}=e;if(t.m_islandFlag)continue;const{other:o}=e;if(o.m_type===b.b2BodyType.b2_dynamicBody&&!n.IsBullet()&&!o.IsBullet())continue;const r=t.m_fixtureA.m_isSensor,_=t.m_fixtureB.m_isSensor;if(r||_)continue;const a=x.SolveTOI_s_backup.Copy(o.m_sweep);o.m_islandFlag||o.Advance(s),t.Update(this.m_contactManager.m_contactListener),t.IsEnabled()&&t.IsTouching()?(t.m_islandFlag=!0,i.AddContact(t),o.m_islandFlag||(o.m_islandFlag=!0,o.m_type!==b.b2BodyType.b2_staticBody&&o.SetAwake(!0),i.AddBody(o))):(o.m_sweep.Copy(a),o.SynchronizeTransform())}}const u=x.SolveTOI_s_subStep;u.dt=(1-s)*e.dt,u.inv_dt=1/u.dt,u.dtRatio=1,u.config={...e.config,positionIterations:20},u.warmStarting=!1,i.SolveTOI(u,a.m_islandIndex,m.m_islandIndex);for(let t=0;t<i.m_bodyCount;++t){const e=i.m_bodies[t];if(e.m_islandFlag=!1,e.m_type===b.b2BodyType.b2_dynamicBody){e.SynchronizeFixtures();for(let t=e.m_contactList;t;t=t.next)t.contact.m_toiFlag=!1,t.contact.m_islandFlag=!1}}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}}}exports.b2World=x,x.Step_s_step=f.b2TimeStep.Create(),x.Step_s_stepTimer=new i.b2Timer,x.Step_s_timer=new i.b2Timer,x.QueryFixtureShape_s_aabb=new n.b2AABB,x.RayCast_s_input=new n.b2RayCastInput,x.RayCast_s_output=new n.b2RayCastOutput,x.RayCast_s_point=new e.b2Vec2,x.SolveTOI_s_subStep=f.b2TimeStep.Create(),x.SolveTOI_s_backup=new e.b2Sweep,x.SolveTOI_s_backup1=new e.b2Sweep,x.SolveTOI_s_backup2=new e.b2Sweep,x.SolveTOI_s_toi_input=new o.b2TOIInput,x.SolveTOI_s_toi_output=new o.b2TOIOutput;
},{"../common/b2_common":"ReKW","../common/b2_math":"cQbL","../common/b2_timer":"ixAk","../collision/b2_collision":"PKgf","../collision/b2_time_of_impact":"skt6","./b2_joint":"Xq2i","./b2_area_joint":"SxzW","./b2_distance_joint":"xSy1","./b2_friction_joint":"zgG7","./b2_gear_joint":"RWFZ","./b2_motor_joint":"mwAL","./b2_mouse_joint":"BhEk","./b2_prismatic_joint":"FAa8","./b2_pulley_joint":"smnA","./b2_revolute_joint":"ELTV","./b2_weld_joint":"LRlb","./b2_wheel_joint":"yJEF","./b2_body":"rONj","./b2_contact_manager":"PdJY","./b2_island":"DDAc","./b2_time_step":"w6W3"}],"YV35":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Rope=exports.b2RopeTuning=exports.b2BendingModel=exports.b2StretchingModel=void 0;const t=require("../common/b2_common"),s=require("../common/b2_draw"),e=require("../common/b2_math"),i={J1:new e.b2Vec2,J2:new e.b2Vec2,J3:new e.b2Vec2,r:new e.b2Vec2,e1:new e.b2Vec2,e2:new e.b2Vec2,Jd1:new e.b2Vec2,Jd2:new e.b2Vec2,d:new e.b2Vec2,u:new e.b2Vec2,dp1:new e.b2Vec2,dp2:new e.b2Vec2,dp3:new e.b2Vec2,d1:new e.b2Vec2,d2:new e.b2Vec2,dHat:new e.b2Vec2};var n,o;!function(t){t[t.b2_pbdStretchingModel=0]="b2_pbdStretchingModel",t[t.b2_xpbdStretchingModel=1]="b2_xpbdStretchingModel"}(n=exports.b2StretchingModel||(exports.b2StretchingModel={})),function(t){t[t.b2_springAngleBendingModel=0]="b2_springAngleBendingModel",t[t.b2_pbdAngleBendingModel=1]="b2_pbdAngleBendingModel",t[t.b2_xpbdAngleBendingModel=2]="b2_xpbdAngleBendingModel",t[t.b2_pbdDistanceBendingModel=3]="b2_pbdDistanceBendingModel",t[t.b2_pbdHeightBendingModel=4]="b2_pbdHeightBendingModel",t[t.b2_pbdTriangleBendingModel=5]="b2_pbdTriangleBendingModel"}(o=exports.b2BendingModel||(exports.b2BendingModel={}));class c{constructor(){this.stretchingModel=n.b2_pbdStretchingModel,this.bendingModel=o.b2_pbdAngleBendingModel,this.damping=0,this.stretchStiffness=1,this.stretchHertz=0,this.stretchDamping=0,this.bendStiffness=.5,this.bendHertz=1,this.bendDamping=0,this.isometric=!1,this.fixedEffectiveMass=!1,this.warmStart=!1}Copy(t){return this.stretchingModel=t.stretchingModel,this.bendingModel=t.bendingModel,this.damping=t.damping,this.stretchStiffness=t.stretchStiffness,this.stretchHertz=t.stretchHertz,this.stretchDamping=t.stretchDamping,this.bendStiffness=t.bendStiffness,this.bendHertz=t.bendHertz,this.bendDamping=t.bendDamping,this.isometric=t.isometric,this.fixedEffectiveMass=t.fixedEffectiveMass,this.warmStart=t.warmStart,this}}exports.b2RopeTuning=c;class h{constructor(){this.i1=0,this.i2=0,this.invMass1=0,this.invMass2=0,this.L=0,this.lambda=0,this.spring=0,this.damper=0}}class a{constructor(){this.i1=0,this.i2=0,this.i3=0,this.invMass1=0,this.invMass2=0,this.invMass3=0,this.invEffectiveMass=0,this.lambda=0,this.L1=0,this.L2=0,this.alpha1=0,this.alpha2=0,this.spring=0,this.damper=0}}class d{constructor(s){this.m_position=new e.b2Vec2,this.m_count=0,this.m_stretchCount=0,this.m_bendCount=0,this.m_gravity=new e.b2Vec2,this.m_tuning=new c,(0,t.b2Assert)(s.vertices.length>=3),this.m_position.Copy(s.position),this.m_count=s.vertices.length,this.m_bindPositions=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_ps=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_p0s=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_vs=(0,t.b2MakeArray)(this.m_count,e.b2Vec2),this.m_invMasses=(0,t.b2MakeNumberArray)(this.m_count);for(let t=0;t<this.m_count;++t){this.m_bindPositions[t].Copy(s.vertices[t]),e.b2Vec2.Add(s.vertices[t],this.m_position,this.m_ps[t]),e.b2Vec2.Add(s.vertices[t],this.m_position,this.m_p0s[t]),this.m_vs[t].SetZero();const i=s.masses[t];this.m_invMasses[t]=i>0?1/i:0}this.m_stretchCount=this.m_count-1,this.m_bendCount=this.m_count-2,this.m_stretchConstraints=new Array(this.m_stretchCount);for(let t=0;t<this.m_stretchCount;t++)this.m_stretchConstraints[t]=new h;this.m_bendConstraints=new Array(this.m_bendCount);for(let t=0;t<this.m_bendCount;t++)this.m_bendConstraints[t]=new a;for(let t=0;t<this.m_stretchCount;++t){const s=this.m_stretchConstraints[t],i=this.m_ps[t],n=this.m_ps[t+1];s.i1=t,s.i2=t+1,s.L=e.b2Vec2.Distance(i,n),s.invMass1=this.m_invMasses[t],s.invMass2=this.m_invMasses[t+1],s.lambda=0,s.damper=0,s.spring=0}const{J1:n,J2:o,r:d,e1:b,e2:r,Jd1:m,Jd2:_}=i;for(let t=0;t<this.m_bendCount;++t){const s=this.m_bendConstraints[t],i=this.m_ps[t],c=this.m_ps[t+1],h=this.m_ps[t+2];s.i1=t,s.i2=t+1,s.i3=t+2,s.invMass1=this.m_invMasses[t],s.invMass2=this.m_invMasses[t+1],s.invMass3=this.m_invMasses[t+2],s.invEffectiveMass=0,s.L1=e.b2Vec2.Distance(i,c),s.L2=e.b2Vec2.Distance(c,h),s.lambda=0,e.b2Vec2.Subtract(c,i,b),e.b2Vec2.Subtract(h,c,r);const a=b.LengthSquared(),l=r.LengthSquared();if(a*l==0)continue;e.b2Vec2.Skew(b,m).Scale(-1/a),e.b2Vec2.Skew(r,_).Scale(1/l),e.b2Vec2.Negate(m,n),e.b2Vec2.Subtract(m,_,o);const p=_;s.invEffectiveMass=s.invMass1*e.b2Vec2.Dot(n,n)+s.invMass2*e.b2Vec2.Dot(o,o)+s.invMass3*e.b2Vec2.Dot(p,p),e.b2Vec2.Subtract(h,i,d);const g=d.LengthSquared();0!==g&&(s.alpha1=e.b2Vec2.Dot(r,d)/g,s.alpha2=e.b2Vec2.Dot(b,d)/g)}this.m_gravity.Copy(s.gravity),this.SetTuning(s.tuning)}SetTuning(t){this.m_tuning.Copy(t);const s=2*Math.PI*this.m_tuning.bendHertz;for(let i=0;i<this.m_bendCount;++i){const t=this.m_bendConstraints[i],e=t.L1*t.L1,n=t.L2*t.L2;if(e*n==0){t.spring=0,t.damper=0;continue}const o=1/t.L1+1/t.L2,c=t.invMass1/e+t.invMass2*o*o+t.invMass3/n;if(0===c){t.spring=0,t.damper=0;continue}const h=1/c;t.spring=h*s*s,t.damper=2*h*this.m_tuning.bendDamping*s}const e=2*Math.PI*this.m_tuning.stretchHertz;for(let i=0;i<this.m_stretchCount;++i){const t=this.m_stretchConstraints[i],s=t.invMass1+t.invMass2;if(0===s)continue;const n=1/s;t.spring=n*e*e,t.damper=2*n*this.m_tuning.stretchDamping*e}}Step(t,s,e){if(0===t)return;const i=1/t,c=Math.exp(-t*this.m_tuning.damping);for(let n=0;n<this.m_count;++n)this.m_invMasses[n]>0?(this.m_vs[n].Scale(c),this.m_vs[n].AddScaled(t,this.m_gravity)):(this.m_vs[n].x=i*(this.m_bindPositions[n].x+e.x-this.m_p0s[n].x),this.m_vs[n].y=i*(this.m_bindPositions[n].y+e.y-this.m_p0s[n].y));this.m_tuning.bendingModel===o.b2_springAngleBendingModel&&this.ApplyBendForces(t);for(let n=0;n<this.m_bendCount;++n)this.m_bendConstraints[n].lambda=0;for(let n=0;n<this.m_stretchCount;++n)this.m_stretchConstraints[n].lambda=0;for(let n=0;n<this.m_count;++n)this.m_ps[n].AddScaled(t,this.m_vs[n]);for(let h=0;h<s;++h)this.m_tuning.bendingModel===o.b2_pbdAngleBendingModel?this.SolveBend_PBD_Angle():this.m_tuning.bendingModel===o.b2_xpbdAngleBendingModel?this.SolveBend_XPBD_Angle(t):this.m_tuning.bendingModel===o.b2_pbdDistanceBendingModel?this.SolveBend_PBD_Distance():this.m_tuning.bendingModel===o.b2_pbdHeightBendingModel?this.SolveBend_PBD_Height():this.m_tuning.bendingModel===o.b2_pbdTriangleBendingModel&&this.SolveBend_PBD_Triangle(),this.m_tuning.stretchingModel===n.b2_pbdStretchingModel?this.SolveStretch_PBD():this.m_tuning.stretchingModel===n.b2_xpbdStretchingModel&&this.SolveStretch_XPBD(t);for(let n=0;n<this.m_count;++n)this.m_vs[n].x=i*(this.m_ps[n].x-this.m_p0s[n].x),this.m_vs[n].y=i*(this.m_ps[n].y-this.m_p0s[n].y),this.m_p0s[n].Copy(this.m_ps[n])}Reset(t){this.m_position.Copy(t);for(let s=0;s<this.m_count;++s)e.b2Vec2.Add(this.m_bindPositions[s],this.m_position,this.m_ps[s]),this.m_p0s[s].Copy(this.m_ps[s]),this.m_vs[s].SetZero();for(let s=0;s<this.m_bendCount;++s)this.m_bendConstraints[s].lambda=0;for(let s=0;s<this.m_stretchCount;++s)this.m_stretchConstraints[s].lambda=0}SolveStretch_PBD(){const t=this.m_tuning.stretchStiffness,{d:s}=i;for(let i=0;i<this.m_stretchCount;++i){const n=this.m_stretchConstraints[i],o=this.m_ps[n.i1],c=this.m_ps[n.i2];e.b2Vec2.Subtract(c,o,s);const h=s.Normalize(),a=n.invMass1+n.invMass2;if(0===a)continue;const d=n.invMass1/a,b=n.invMass2/a;o.SubtractScaled(t*d*(n.L-h),s),c.AddScaled(t*b*(n.L-h),s)}}SolveStretch_XPBD(t){const{dp1:s,dp2:n,u:o,J1:c}=i;for(let i=0;i<this.m_stretchCount;++i){const h=this.m_stretchConstraints[i],a=this.m_ps[h.i1],d=this.m_ps[h.i2];e.b2Vec2.Subtract(a,this.m_p0s[h.i1],s),e.b2Vec2.Subtract(d,this.m_p0s[h.i2],n),e.b2Vec2.Subtract(d,a,o);const b=o.Normalize();e.b2Vec2.Negate(o,c);const r=o,m=h.invMass1+h.invMass2;if(0===m)continue;const _=1/(h.spring*t*t),l=_*(t*t*h.damper)/t,p=b-h.L,g=e.b2Vec2.Dot(c,s)+e.b2Vec2.Dot(r,n),u=-(p+_*h.lambda+l*g)/((1+l)*m+_);a.AddScaled(h.invMass1*u,c),d.AddScaled(h.invMass2*u,r),h.lambda+=u}}SolveBend_PBD_Angle(){const t=this.m_tuning.bendStiffness,{Jd1:s,Jd2:n,J1:o,J2:c,d1:h,d2:a}=i;for(let i=0;i<this.m_bendCount;++i){const d=this.m_bendConstraints[i],b=this.m_ps[d.i1],r=this.m_ps[d.i2],m=this.m_ps[d.i3];e.b2Vec2.Subtract(r,b,h),e.b2Vec2.Subtract(m,r,a);const _=e.b2Vec2.Cross(h,a),l=e.b2Vec2.Dot(h,a),p=Math.atan2(_,l);let g,u;if(this.m_tuning.isometric?(g=d.L1*d.L1,u=d.L2*d.L2):(g=h.LengthSquared(),u=a.LengthSquared()),g*u==0)continue;e.b2Vec2.Skew(h,s).Scale(-1/g),e.b2Vec2.Skew(a,n).Scale(1/u),e.b2Vec2.Negate(s,o),e.b2Vec2.Subtract(s,n,c);const M=n;let v;0===(v=this.m_tuning.fixedEffectiveMass?d.invEffectiveMass:d.invMass1*e.b2Vec2.Dot(o,o)+d.invMass2*e.b2Vec2.Dot(c,c)+d.invMass3*e.b2Vec2.Dot(M,M))&&(v=d.invEffectiveMass);const S=-t*p/v;b.AddScaled(d.invMass1*S,o),r.AddScaled(d.invMass2*S,c),m.AddScaled(d.invMass3*S,M)}}SolveBend_XPBD_Angle(t){const{dp1:s,dp2:n,dp3:o,d1:c,d2:h,Jd1:a,Jd2:d,J1:b,J2:r}=i;for(let i=0;i<this.m_bendCount;++i){const m=this.m_bendConstraints[i],_=this.m_ps[m.i1],l=this.m_ps[m.i2],p=this.m_ps[m.i3];let g,u;if(e.b2Vec2.Subtract(_,this.m_p0s[m.i1],s),e.b2Vec2.Subtract(l,this.m_p0s[m.i2],n),e.b2Vec2.Subtract(p,this.m_p0s[m.i3],o),e.b2Vec2.Subtract(l,_,c),e.b2Vec2.Subtract(p,l,h),this.m_tuning.isometric?(g=m.L1*m.L1,u=m.L2*m.L2):(g=c.LengthSquared(),u=h.LengthSquared()),g*u==0)continue;const M=e.b2Vec2.Cross(c,h),v=e.b2Vec2.Dot(c,h),S=Math.atan2(M,v);e.b2Vec2.Skew(c,a).Scale(-1/g),e.b2Vec2.Skew(h,d).Scale(1/u),e.b2Vec2.Negate(a,b),e.b2Vec2.Subtract(a,d,r);const f=d;let V;if(0===(V=this.m_tuning.fixedEffectiveMass?m.invEffectiveMass:m.invMass1*e.b2Vec2.Dot(b,b)+m.invMass2*e.b2Vec2.Dot(r,r)+m.invMass3*e.b2Vec2.Dot(f,f)))continue;const D=1/(m.spring*t*t),C=D*(t*t*m.damper)/t,A=S,B=e.b2Vec2.Dot(b,s)+e.b2Vec2.Dot(r,n)+e.b2Vec2.Dot(f,o),L=-(A+D*m.lambda+C*B)/((1+C)*V+D);_.AddScaled(m.invMass1*L,b),l.AddScaled(m.invMass2*L,r),p.AddScaled(m.invMass3*L,f),m.lambda+=L}}SolveBend_PBD_Distance(){const t=this.m_tuning.bendStiffness,{d:s}=i;for(let i=0;i<this.m_bendCount;++i){const n=this.m_bendConstraints[i],{i1:o}=n,c=n.i3,h=this.m_ps[o],a=this.m_ps[c];e.b2Vec2.Subtract(a,h,s);const d=s.Normalize(),b=n.invMass1+n.invMass3;if(0===b)continue;const r=n.invMass1/b,m=n.invMass3/b;h.SubtractScaled(t*r*(n.L1+n.L2-d),s),a.AddScaled(t*m*(n.L1+n.L2-d),s)}}SolveBend_PBD_Height(){const t=this.m_tuning.bendStiffness,{dHat:s,J1:n,J2:o,J3:c,d:h}=i;for(let i=0;i<this.m_bendCount;++i){const a=this.m_bendConstraints[i],d=this.m_ps[a.i1],b=this.m_ps[a.i2],r=this.m_ps[a.i3];h.x=a.alpha1*d.x+a.alpha2*r.x-b.x,h.y=a.alpha1*d.y+a.alpha2*r.y-b.y;const m=h.Length();if(0===m)continue;e.b2Vec2.Scale(1/m,h,s),e.b2Vec2.Scale(a.alpha1,s,n),e.b2Vec2.Negate(s,o),e.b2Vec2.Scale(a.alpha2,s,c);const _=a.invMass1*a.alpha1*a.alpha1+a.invMass2+a.invMass3*a.alpha2*a.alpha2;if(0===_)continue;const l=-t*(1/_)*m;d.AddScaled(a.invMass1*l,n),b.AddScaled(a.invMass2*l,o),r.AddScaled(a.invMass3*l,c)}}SolveBend_PBD_Triangle(){const t=this.m_tuning.bendStiffness,{d:s}=i;for(let e=0;e<this.m_bendCount;++e){const i=this.m_bendConstraints[e],n=this.m_ps[i.i1],o=this.m_ps[i.i2],c=this.m_ps[i.i3],h=i.invMass1,a=i.invMass2,d=i.invMass3,b=t/(h+d+2*a);s.x=o.x-1/3*(n.x+o.x+c.x),s.y=o.y-1/3*(n.y+o.y+c.y),n.AddScaled(2*h*b,s),o.AddScaled(-4*a*b,s),c.AddScaled(2*d*b,s)}}ApplyBendForces(t){const s=2*Math.PI*this.m_tuning.bendHertz,{d1:n,d2:o,Jd1:c,Jd2:h,J1:a,J2:d}=i;for(let i=0;i<this.m_bendCount;++i){const b=this.m_bendConstraints[i],r=this.m_ps[b.i1],m=this.m_ps[b.i2],_=this.m_ps[b.i3],l=this.m_vs[b.i1],p=this.m_vs[b.i2],g=this.m_vs[b.i3];let u,M;if(e.b2Vec2.Subtract(m,r,n),e.b2Vec2.Subtract(_,m,o),this.m_tuning.isometric?(u=b.L1*b.L1,M=b.L2*b.L2):(u=n.LengthSquared(),M=o.LengthSquared()),u*M==0)continue;const v=e.b2Vec2.Cross(n,o),S=e.b2Vec2.Dot(n,o),f=Math.atan2(v,S);e.b2Vec2.Skew(n,c).Scale(-1/u),e.b2Vec2.Skew(o,h).Scale(1/M),e.b2Vec2.Negate(c,a),e.b2Vec2.Subtract(c,h,d);const V=h;let D;if(0===(D=this.m_tuning.fixedEffectiveMass?b.invEffectiveMass:b.invMass1*e.b2Vec2.Dot(a,a)+b.invMass2*e.b2Vec2.Dot(d,d)+b.invMass3*e.b2Vec2.Dot(V,V)))continue;const C=1/D,A=-t*(C*s*s*f+2*C*this.m_tuning.bendDamping*s*(e.b2Vec2.Dot(a,l)+e.b2Vec2.Dot(d,p)+e.b2Vec2.Dot(V,g)));this.m_vs[b.i1].AddScaled(b.invMass1*A,a),this.m_vs[b.i2].AddScaled(b.invMass2*A,d),this.m_vs[b.i3].AddScaled(b.invMass3*A,V)}}Draw(t){for(let i=0;i<this.m_count-1;++i){t.DrawSegment(this.m_ps[i],this.m_ps[i+1],s.debugColors.rope);const e=this.m_invMasses[i]>0?s.debugColors.ropePointD:s.debugColors.ropePointG;t.DrawPoint(this.m_ps[i],5,e)}const e=this.m_invMasses[this.m_count-1]>0?s.debugColors.ropePointD:s.debugColors.ropePointG;t.DrawPoint(this.m_ps[this.m_count-1],5,e)}}exports.b2Rope=d;
},{"../common/b2_common":"ReKW","../common/b2_draw":"lvls","../common/b2_math":"cQbL"}],"FjWk":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,o,i){void 0===i&&(i=o);var t=Object.getOwnPropertyDescriptor(r,o);t&&("get"in t?r.__esModule:!t.writable&&!t.configurable)||(t={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(e,i,t)}:function(e,r,o,i){void 0===i&&(i=o),e[i]=r[o]}),r=this&&this.__exportStar||function(r,o){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(o,i)||e(o,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2GetBlockSolve=exports.b2SetBlockSolve=exports.b2World=exports.b2BodyType=exports.b2Body=void 0,r(require("./common/b2_common"),exports),r(require("./common/b2_settings"),exports),r(require("./common/b2_math"),exports),r(require("./common/b2_draw"),exports),r(require("./common/b2_draw_helper"),exports),r(require("./common/b2_timer"),exports),r(require("./common/b2_augment"),exports),r(require("./collision/b2_collision"),exports),r(require("./collision/b2_distance"),exports),r(require("./collision/b2_broad_phase"),exports),r(require("./collision/b2_dynamic_tree"),exports),r(require("./collision/b2_time_of_impact"),exports),r(require("./collision/b2_collide_circle"),exports),r(require("./collision/b2_collide_polygon"),exports),r(require("./collision/b2_collide_edge"),exports),r(require("./collision/b2_shape"),exports),r(require("./collision/b2_circle_shape"),exports),r(require("./collision/b2_polygon_shape"),exports),r(require("./collision/b2_edge_shape"),exports),r(require("./collision/b2_chain_shape"),exports),r(require("./dynamics/b2_fixture"),exports);var o=require("./dynamics/b2_body");Object.defineProperty(exports,"b2Body",{enumerable:!0,get:function(){return o.b2Body}}),Object.defineProperty(exports,"b2BodyType",{enumerable:!0,get:function(){return o.b2BodyType}});var i=require("./dynamics/b2_world");Object.defineProperty(exports,"b2World",{enumerable:!0,get:function(){return i.b2World}}),r(require("./dynamics/b2_world_callbacks"),exports),r(require("./dynamics/b2_time_step"),exports),r(require("./dynamics/b2_contact_manager"),exports),r(require("./dynamics/b2_contact"),exports),r(require("./dynamics/b2_contact_factory"),exports);var t=require("./dynamics/b2_contact_solver");Object.defineProperty(exports,"b2SetBlockSolve",{enumerable:!0,get:function(){return t.b2SetBlockSolve}}),Object.defineProperty(exports,"b2GetBlockSolve",{enumerable:!0,get:function(){return t.b2GetBlockSolve}}),r(require("./dynamics/b2_joint"),exports),r(require("./dynamics/b2_area_joint"),exports),r(require("./dynamics/b2_distance_joint"),exports),r(require("./dynamics/b2_friction_joint"),exports),r(require("./dynamics/b2_gear_joint"),exports),r(require("./dynamics/b2_motor_joint"),exports),r(require("./dynamics/b2_mouse_joint"),exports),r(require("./dynamics/b2_prismatic_joint"),exports),r(require("./dynamics/b2_pulley_joint"),exports),r(require("./dynamics/b2_revolute_joint"),exports),r(require("./dynamics/b2_weld_joint"),exports),r(require("./dynamics/b2_wheel_joint"),exports),r(require("./rope/b2_rope"),exports);
},{"./common/b2_common":"ReKW","./common/b2_settings":"I6oK","./common/b2_math":"cQbL","./common/b2_draw":"lvls","./common/b2_draw_helper":"mgAn","./common/b2_timer":"ixAk","./common/b2_augment":"KzIc","./collision/b2_collision":"PKgf","./collision/b2_distance":"hp9S","./collision/b2_broad_phase":"q2ad","./collision/b2_dynamic_tree":"sfrf","./collision/b2_time_of_impact":"skt6","./collision/b2_collide_circle":"DoJb","./collision/b2_collide_polygon":"nWAU","./collision/b2_collide_edge":"bTYS","./collision/b2_shape":"stUN","./collision/b2_circle_shape":"HIjv","./collision/b2_polygon_shape":"tvYY","./collision/b2_edge_shape":"OKJP","./collision/b2_chain_shape":"papG","./dynamics/b2_fixture":"IcdW","./dynamics/b2_body":"rONj","./dynamics/b2_world":"H7LA","./dynamics/b2_world_callbacks":"G1MF","./dynamics/b2_time_step":"w6W3","./dynamics/b2_contact_manager":"PdJY","./dynamics/b2_contact":"UQyq","./dynamics/b2_contact_factory":"FpyL","./dynamics/b2_contact_solver":"DnH3","./dynamics/b2_joint":"Xq2i","./dynamics/b2_area_joint":"SxzW","./dynamics/b2_distance_joint":"xSy1","./dynamics/b2_friction_joint":"zgG7","./dynamics/b2_gear_joint":"RWFZ","./dynamics/b2_motor_joint":"mwAL","./dynamics/b2_mouse_joint":"BhEk","./dynamics/b2_prismatic_joint":"FAa8","./dynamics/b2_pulley_joint":"smnA","./dynamics/b2_revolute_joint":"ELTV","./dynamics/b2_weld_joint":"LRlb","./dynamics/b2_wheel_joint":"yJEF","./rope/b2_rope":"YV35"}],"ewl9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DebugDraw=void 0;const t=require("@box2d/core"),i=new t.b2Color(.5,.9,.5);class e{constructor(i){this.center=new t.b2Vec2,this.zoom=1,this.ctx=i}Prepare(t,i,e,s=!1){this.center.Set(t,i),this.zoom=e,this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.save(),this.ctx.translate(.5*this.ctx.canvas.width,.5*this.ctx.canvas.height),s&&this.ctx.scale(1,-1),this.ctx.scale(e,e),this.ctx.lineWidth/=e,this.ctx.translate(-t,-i)}Finish(){this.ctx.restore()}PushTransform(t){this.ctx.save(),this.ctx.translate(t.p.x,t.p.y),this.ctx.rotate(t.q.GetAngle())}PopTransform(t){this.ctx.restore()}DrawPolygon(t,i,s){this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(let e=1;e<i;e++)this.ctx.lineTo(t[e].x,t[e].y);this.ctx.closePath(),this.ctx.strokeStyle=e.MakeStyleString(s,1),this.ctx.stroke()}DrawSolidPolygon(t,i,s){this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(let e=1;e<i;e++)this.ctx.lineTo(t[e].x,t[e].y);this.ctx.closePath(),this.ctx.fillStyle=e.MakeStyleString(s,.5),this.ctx.fill(),this.ctx.strokeStyle=e.MakeStyleString(s,1),this.ctx.stroke()}DrawCircle(t,i,s){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,i,0,2*Math.PI,!0),this.ctx.strokeStyle=e.MakeStyleString(s,1),this.ctx.stroke()}DrawSolidCircle(t,i,s,c){const h=t.x,r=t.y;this.ctx.beginPath(),this.ctx.arc(h,r,i,0,2*Math.PI,!0),this.ctx.moveTo(h,r),this.ctx.lineTo(h+s.x*i,r+s.y*i),this.ctx.fillStyle=e.MakeStyleString(c,.5),this.ctx.fill(),this.ctx.strokeStyle=e.MakeStyleString(c,1),this.ctx.stroke()}DrawParticles(t,i,s,c){if(s)for(let h=0;h<c;++h){const c=t[h],r=s[h];this.ctx.fillStyle=e.MakeStyleString(r),this.ctx.beginPath(),this.ctx.arc(c.x,c.y,i,0,2*Math.PI,!0),this.ctx.fill()}else{this.ctx.fillStyle="rgba(255,255,255,0.5)";for(let e=0;e<c;++e){const s=t[e];this.ctx.beginPath(),this.ctx.arc(s.x,s.y,i,0,2*Math.PI,!0),this.ctx.fill()}}}DrawSegment(t,i,s){this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(i.x,i.y),this.ctx.strokeStyle=e.MakeStyleString(s,1),this.ctx.stroke()}DrawTransform(i){this.PushTransform(i),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(1,0),this.ctx.strokeStyle=e.MakeStyleString(t.b2Color.RED),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(0,1),this.ctx.strokeStyle=e.MakeStyleString(t.b2Color.GREEN),this.ctx.stroke(),this.PopTransform(i)}DrawPoint(t,i,s){this.ctx.fillStyle=e.MakeStyleString(s);const c=(i/=this.zoom)/2;this.ctx.fillRect(t.x-c,t.y-c,i,i)}DrawString(i,s,c,h){this.ctx.font="16px Open Sans",this.ctx.textAlign=c,this.ctx.fillStyle=e.MakeStyleString(t.b2Color.WHITE),this.ctx.fillText(h,i,s)}DrawStringWorld(t,s,c){const h=(t-this.center.x)*this.zoom+.5*this.ctx.canvas.width,r=(s-this.center.y)*-this.zoom+.5*this.ctx.canvas.height;this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.font="15px Open Sans",this.ctx.fillStyle=e.MakeStyleString(i),this.ctx.fillText(c,h,r),this.ctx.restore()}DrawAABB(t,i){this.ctx.strokeStyle=e.MakeStyleString(i);const{x:s,y:c}=t.lowerBound,h=t.upperBound.x-s,r=t.upperBound.y-c;this.ctx.strokeRect(s,c,h,r)}static MakeStyleString(i,e=i.a){const s=(0,t.b2Clamp)(255*i.r,0,255),c=(0,t.b2Clamp)(255*i.g,0,255),h=(0,t.b2Clamp)(255*i.b,0,255);return e<1?`rgba(${s},${c},${h},${e=(0,t.b2Clamp)(e,0,1)})`:`rgb(${s},${c},${h})`}}exports.DebugDraw=e;
},{"@box2d/core":"FjWk"}],"dno1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Collector=void 0;class e{constructor(e){this.emit=((...t)=>{e.emitCollecting(this,t)})}}exports.Collector=e;
},{}],"T33n":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectorArray=void 0;const e=require("./Collector");class t extends e.Collector{constructor(){super(...arguments),this.result=[]}handleResult(e){return this.result.push(e),!0}getResult(){return this.result}reset(){this.result.length=0}}exports.CollectorArray=t;
},{"./Collector":"dno1"}],"f9yJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectorLast=void 0;const e=require("./Collector");class t extends e.Collector{handleResult(e){return this.result=e,!0}getResult(){return this.result}reset(){delete this.result}}exports.CollectorLast=t;
},{"./Collector":"dno1"}],"PHPd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectorUntil0=void 0;const e=require("./Collector");class t extends e.Collector{constructor(){super(...arguments),this.result=!1}handleResult(e){return this.result=e,this.result}getResult(){return this.result}reset(){this.result=!1}}exports.CollectorUntil0=t;
},{"./Collector":"dno1"}],"TYJK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectorWhile0=void 0;const e=require("./Collector");class t extends e.Collector{constructor(){super(...arguments),this.result=!1}handleResult(e){return this.result=e,!this.result}getResult(){return this.result}reset(){this.result=!1}}exports.CollectorWhile0=t;
},{"./Collector":"dno1"}],"j6Uj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignalConnectionImpl=void 0;class n{constructor(n,e){this.link=n,this.parentCleanup=e}disconnect(){return null!==this.link&&(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0)}set enabled(n){this.link&&this.link.setEnabled(n)}get enabled(){return null!==this.link&&this.link.isEnabled()}}exports.SignalConnectionImpl=n;
},{}],"pBXC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignalLink=void 0;class e{constructor(e=null,t=null,n=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=null!=e?e:this,this.next=null!=t?t:this,this.order=n}isEnabled(){return this.enabled&&!this.newLink}setEnabled(e){this.enabled=e}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,n){let s=this.prev;for(;s!==this&&!(s.order<=n);)s=s.prev;const i=new e(s,s.next,n);return i.callback=t,s.next=i,i.next.prev=i,i}}exports.SignalLink=e;
},{}],"q5QQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Signal=void 0;const t=require("./SignalConnection"),n=require("./SignalLink");class e{constructor(){this.head=new n.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(n,e=0){this.connectionsCount++;const i=this.head.insert(n,e);return this.emitDepth>0&&(this.hasNewLinks=!0,i.newLink=!0),new t.SignalConnectionImpl(i,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let n=this.head.next;n!==this.head;n=n.next)if(n.callback===t)return this.decrementConnectionCount(),n.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let n=this.head.next;n!==this.head;n=n.next)n.isEnabled()&&n.callback&&n.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,n){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)if(e.isEnabled()&&e.callback){const i=e.callback.apply(null,n);if(!t.handleResult(i))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&0===this.emitDepth){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}exports.Signal=e;
},{"./SignalConnection":"j6Uj","./SignalLink":"pBXC"}],"ylrV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignalConnections=void 0;class t{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return 0===this.list.length}}exports.SignalConnections=t;
},{}],"kwcl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignalConnections=exports.Signal=exports.CollectorWhile0=exports.CollectorUntil0=exports.CollectorLast=exports.CollectorArray=exports.Collector=void 0;var e=require("./Collector");Object.defineProperty(exports,"Collector",{enumerable:!0,get:function(){return e.Collector}});var r=require("./CollectorArray");Object.defineProperty(exports,"CollectorArray",{enumerable:!0,get:function(){return r.CollectorArray}});var t=require("./CollectorLast");Object.defineProperty(exports,"CollectorLast",{enumerable:!0,get:function(){return t.CollectorLast}});var o=require("./CollectorUntil0");Object.defineProperty(exports,"CollectorUntil0",{enumerable:!0,get:function(){return o.CollectorUntil0}});var l=require("./CollectorWhile0");Object.defineProperty(exports,"CollectorWhile0",{enumerable:!0,get:function(){return l.CollectorWhile0}});var n=require("./Signal");Object.defineProperty(exports,"Signal",{enumerable:!0,get:function(){return n.Signal}});var i=require("./SignalConnections");Object.defineProperty(exports,"SignalConnections",{enumerable:!0,get:function(){return i.SignalConnections}});
},{"./Collector":"dno1","./CollectorArray":"T33n","./CollectorLast":"f9yJ","./CollectorUntil0":"PHPd","./CollectorWhile0":"TYJK","./Signal":"q5QQ","./SignalConnections":"ylrV"}],"W43s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setMatrixArrayType=e,exports.toRadian=s,exports.equals=n,exports.RANDOM=exports.ARRAY_TYPE=exports.EPSILON=void 0;var t=1e-6;exports.EPSILON=t;var r="undefined"!=typeof Float32Array?Float32Array:Array;exports.ARRAY_TYPE=r;var a=Math.random;function e(t){exports.ARRAY_TYPE=r=t}exports.RANDOM=a;var o=Math.PI/180;function s(t){return t*o}function n(r,a){return Math.abs(r-a)<=t*Math.max(1,Math.abs(r),Math.abs(a))}Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});
},{}],"Ax7R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.copy=a,exports.identity=u,exports.fromValues=s,exports.set=i,exports.transpose=c,exports.invert=p,exports.adjoint=f,exports.determinant=x,exports.multiply=l,exports.rotate=M,exports.scale=h,exports.fromRotation=b,exports.fromScaling=v,exports.str=y,exports.frob=d,exports.LDU=m,exports.add=P,exports.subtract=O,exports.exactEquals=A,exports.equals=j,exports.multiplyScalar=E,exports.multiplyScalarAndAdd=R,exports.sub=exports.mul=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function o(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function a(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function s(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function i(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function c(t,r){if(t===r){var e=r[1];t[1]=r[2],t[2]=e}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t}function p(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],u=e*a-o*n;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-o*u,t[3]=e*u,t):null}function f(t,r){var e=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=e,t}function x(t){return t[0]*t[3]-t[2]*t[1]}function l(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],c=e[2],p=e[3];return t[0]=n*s+a*i,t[1]=o*s+u*i,t[2]=n*c+a*p,t[3]=o*c+u*p,t}function M(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=Math.sin(e),i=Math.cos(e);return t[0]=n*i+a*s,t[1]=o*i+u*s,t[2]=n*-s+a*i,t[3]=o*-s+u*i,t}function h(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1];return t[0]=n*s,t[1]=o*s,t[2]=a*i,t[3]=u*i,t}function b(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t}function v(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t}function y(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function d(t){return Math.hypot(t[0],t[1],t[2],t[3])}function m(t,r,e,n){return t[2]=n[2]/n[0],e[0]=n[0],e[1]=n[1],e[3]=n[3]-t[2]*e[1],[t,r,e]}function P(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function O(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function A(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function j(r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],c=e[2],p=e[3];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(u-p)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))}function E(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function R(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}var Y=l;exports.mul=Y;var _=O;exports.sub=_;
},{"./common.js":"W43s"}],"GxfJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=a,exports.copy=o,exports.identity=u,exports.fromValues=s,exports.set=i,exports.invert=c,exports.determinant=p,exports.multiply=f,exports.rotate=x,exports.scale=l,exports.translate=M,exports.fromRotation=h,exports.fromScaling=b,exports.fromTranslation=v,exports.str=m,exports.frob=y,exports.add=d,exports.subtract=P,exports.multiplyScalar=O,exports.multiplyScalarAndAdd=A,exports.exactEquals=E,exports.equals=R,exports.sub=exports.mul=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var u=a?Object.getOwnPropertyDescriptor(t,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function a(r){var e=new t.ARRAY_TYPE(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function o(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function s(r,e,n,a,o,u){var s=new t.ARRAY_TYPE(6);return s[0]=r,s[1]=e,s[2]=n,s[3]=a,s[4]=o,s[5]=u,s}function i(t,r,e,n,a,o,u){return t[0]=r,t[1]=e,t[2]=n,t[3]=a,t[4]=o,t[5]=u,t}function c(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=r[5],i=e*o-n*a;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-a*i,t[3]=e*i,t[4]=(a*s-o*u)*i,t[5]=(n*u-e*s)*i,t):null}function p(t){return t[0]*t[3]-t[1]*t[2]}function f(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1],f=e[2],x=e[3],l=e[4],M=e[5];return t[0]=n*c+o*p,t[1]=a*c+u*p,t[2]=n*f+o*x,t[3]=a*f+u*x,t[4]=n*l+o*M+s,t[5]=a*l+u*M+i,t}function x(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=Math.sin(e),p=Math.cos(e);return t[0]=n*p+o*c,t[1]=a*p+u*c,t[2]=n*-c+o*p,t[3]=a*-c+u*p,t[4]=s,t[5]=i,t}function l(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1];return t[0]=n*c,t[1]=a*c,t[2]=o*p,t[3]=u*p,t[4]=s,t[5]=i,t}function M(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=u,t[4]=n*c+o*p+s,t[5]=a*c+u*p+i,t}function h(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t[4]=0,t[5]=0,t}function b(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t[4]=0,t[5]=0,t}function v(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=r[0],t[5]=r[1],t}function m(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function y(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function d(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t}function P(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t[4]=r[4]-e[4],t[5]=r[5]-e[5],t}function O(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t}function A(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t[4]=r[4]+e[4]*n,t[5]=r[5]+e[5]*n,t}function E(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]}function R(r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1],f=e[2],x=e[3],l=e[4],M=e[5];return Math.abs(n-c)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-p)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-f)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(u-x)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(s-l)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-M)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))}var S=f;exports.mul=S;var j=P;exports.sub=j;
},{"./common.js":"W43s"}],"ezba":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=a,exports.fromMat4=e,exports.clone=o,exports.copy=u,exports.fromValues=s,exports.set=i,exports.identity=c,exports.transpose=f,exports.invert=p,exports.adjoint=M,exports.determinant=x,exports.multiply=h,exports.translate=b,exports.rotate=l,exports.scale=m,exports.fromTranslation=v,exports.fromRotation=P,exports.fromScaling=O,exports.fromMat2d=d,exports.fromQuat=y,exports.normalFromMat4=E,exports.projection=S,exports.str=A,exports.frob=j,exports.add=I,exports.subtract=L,exports.multiplyScalar=N,exports.multiplyScalarAndAdd=R,exports.exactEquals=Y,exports.equals=_,exports.sub=exports.mul=void 0;var t=n(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=r();if(n&&n.has(t))return n.get(t);var a={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var u=e?Object.getOwnPropertyDescriptor(t,o):null;u&&(u.get||u.set)?Object.defineProperty(a,o,u):a[o]=t[o]}return a.default=t,n&&n.set(t,a),a}function a(){var r=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function e(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function o(r){var n=new t.ARRAY_TYPE(9);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function s(r,n,a,e,o,u,s,i,c){var f=new t.ARRAY_TYPE(9);return f[0]=r,f[1]=n,f[2]=a,f[3]=e,f[4]=o,f[5]=u,f[6]=s,f[7]=i,f[8]=c,f}function i(t,r,n,a,e,o,u,s,i,c){return t[0]=r,t[1]=n,t[2]=a,t[3]=e,t[4]=o,t[5]=u,t[6]=s,t[7]=i,t[8]=c,t}function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function f(t,r){if(t===r){var n=r[1],a=r[2],e=r[5];t[1]=r[3],t[2]=r[6],t[3]=n,t[5]=r[7],t[6]=a,t[7]=e}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function p(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8],p=f*u-s*c,M=-f*o+s*i,x=c*o-u*i,h=n*p+a*M+e*x;return h?(h=1/h,t[0]=p*h,t[1]=(-f*a+e*c)*h,t[2]=(s*a-e*u)*h,t[3]=M*h,t[4]=(f*n-e*i)*h,t[5]=(-s*n+e*o)*h,t[6]=x*h,t[7]=(-c*n+a*i)*h,t[8]=(u*n-a*o)*h,t):null}function M(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8];return t[0]=u*f-s*c,t[1]=e*c-a*f,t[2]=a*s-e*u,t[3]=s*i-o*f,t[4]=n*f-e*i,t[5]=e*o-n*s,t[6]=o*c-u*i,t[7]=a*i-n*c,t[8]=n*u-a*o,t}function x(t){var r=t[0],n=t[1],a=t[2],e=t[3],o=t[4],u=t[5],s=t[6],i=t[7],c=t[8];return r*(c*o-u*i)+n*(-c*e+u*s)+a*(i*e-o*s)}function h(t,r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=n[0],x=n[1],h=n[2],b=n[3],l=n[4],m=n[5],v=n[6],P=n[7],O=n[8];return t[0]=M*a+x*u+h*c,t[1]=M*e+x*s+h*f,t[2]=M*o+x*i+h*p,t[3]=b*a+l*u+m*c,t[4]=b*e+l*s+m*f,t[5]=b*o+l*i+m*p,t[6]=v*a+P*u+O*c,t[7]=v*e+P*s+O*f,t[8]=v*o+P*i+O*p,t}function b(t,r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=n[0],x=n[1];return t[0]=a,t[1]=e,t[2]=o,t[3]=u,t[4]=s,t[5]=i,t[6]=M*a+x*u+c,t[7]=M*e+x*s+f,t[8]=M*o+x*i+p,t}function l(t,r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=Math.sin(n),x=Math.cos(n);return t[0]=x*a+M*u,t[1]=x*e+M*s,t[2]=x*o+M*i,t[3]=x*u-M*a,t[4]=x*s-M*e,t[5]=x*i-M*o,t[6]=c,t[7]=f,t[8]=p,t}function m(t,r,n){var a=n[0],e=n[1];return t[0]=a*r[0],t[1]=a*r[1],t[2]=a*r[2],t[3]=e*r[3],t[4]=e*r[4],t[5]=e*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function v(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t}function P(t,r){var n=Math.sin(r),a=Math.cos(r);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function O(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function d(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t}function y(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=n+n,s=a+a,i=e+e,c=n*u,f=a*u,p=a*s,M=e*u,x=e*s,h=e*i,b=o*u,l=o*s,m=o*i;return t[0]=1-p-h,t[3]=f-m,t[6]=M+l,t[1]=f+m,t[4]=1-c-h,t[7]=x-b,t[2]=M-l,t[5]=x+b,t[8]=1-c-p,t}function E(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8],p=r[9],M=r[10],x=r[11],h=r[12],b=r[13],l=r[14],m=r[15],v=n*s-a*u,P=n*i-e*u,O=n*c-o*u,d=a*i-e*s,y=a*c-o*s,E=e*c-o*i,S=f*b-p*h,A=f*l-M*h,j=f*m-x*h,I=p*l-M*b,L=p*m-x*b,N=M*m-x*l,R=v*N-P*L+O*I+d*j-y*A+E*S;return R?(R=1/R,t[0]=(s*N-i*L+c*I)*R,t[1]=(i*j-u*N-c*A)*R,t[2]=(u*L-s*j+c*S)*R,t[3]=(e*L-a*N-o*I)*R,t[4]=(n*N-e*j+o*A)*R,t[5]=(a*j-n*L-o*S)*R,t[6]=(b*E-l*y+m*d)*R,t[7]=(l*O-h*E-m*P)*R,t[8]=(h*y-b*O+m*v)*R,t):null}function S(t,r,n){return t[0]=2/r,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function A(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function j(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function I(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t}function L(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t}function N(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t}function R(t,r,n,a){return t[0]=r[0]+n[0]*a,t[1]=r[1]+n[1]*a,t[2]=r[2]+n[2]*a,t[3]=r[3]+n[3]*a,t[4]=r[4]+n[4]*a,t[5]=r[5]+n[5]*a,t[6]=r[6]+n[6]*a,t[7]=r[7]+n[7]*a,t[8]=r[8]+n[8]*a,t}function Y(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]}function _(r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=n[0],x=n[1],h=n[2],b=n[3],l=n[4],m=n[5],v=n[6],P=n[7],O=n[8];return Math.abs(a-M)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(e-x)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-b)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(s-l)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-m)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(c-v)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(f-P)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(p-O)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(O))}var w=h;exports.mul=w;var g=L;exports.sub=g;
},{"./common.js":"W43s"}],"c4g7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=e,exports.copy=o,exports.fromValues=s,exports.set=u,exports.identity=h,exports.transpose=M,exports.invert=i,exports.adjoint=p,exports.determinant=c,exports.multiply=f,exports.translate=x,exports.scale=b,exports.rotate=v,exports.rotateX=l,exports.rotateY=m,exports.rotateZ=P,exports.fromTranslation=O,exports.fromScaling=E,exports.fromRotation=S,exports.fromXRotation=y,exports.fromYRotation=I,exports.fromZRotation=N,exports.fromRotationTranslation=L,exports.fromQuat2=R,exports.getTranslation=d,exports.getScaling=g,exports.getRotation=A,exports.fromRotationTranslationScale=Y,exports.fromRotationTranslationScaleOrigin=T,exports.fromQuat=w,exports.frustum=_,exports.perspectiveNO=j,exports.perspectiveZO=D,exports.perspectiveFromFieldOfView=Z,exports.orthoNO=k,exports.orthoZO=Q,exports.lookAt=V,exports.targetTo=W,exports.str=X,exports.frob=z,exports.add=B,exports.subtract=C,exports.multiplyScalar=G,exports.multiplyScalarAndAdd=H,exports.exactEquals=J,exports.equals=K,exports.sub=exports.mul=exports.ortho=exports.perspective=void 0;var t=a(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var a=r();if(a&&a.has(t))return a.get(t);var n={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=e?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,a&&a.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function e(r){var a=new t.ARRAY_TYPE(16);return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a}function o(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function s(r,a,n,e,o,s,u,h,M,i,p,c,f,x,b,v){var l=new t.ARRAY_TYPE(16);return l[0]=r,l[1]=a,l[2]=n,l[3]=e,l[4]=o,l[5]=s,l[6]=u,l[7]=h,l[8]=M,l[9]=i,l[10]=p,l[11]=c,l[12]=f,l[13]=x,l[14]=b,l[15]=v,l}function u(t,r,a,n,e,o,s,u,h,M,i,p,c,f,x,b,v){return t[0]=r,t[1]=a,t[2]=n,t[3]=e,t[4]=o,t[5]=s,t[6]=u,t[7]=h,t[8]=M,t[9]=i,t[10]=p,t[11]=c,t[12]=f,t[13]=x,t[14]=b,t[15]=v,t}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function M(t,r){if(t===r){var a=r[1],n=r[2],e=r[3],o=r[6],s=r[7],u=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=a,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=o,t[11]=r[14],t[12]=e,t[13]=s,t[14]=u}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function i(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=r[4],u=r[5],h=r[6],M=r[7],i=r[8],p=r[9],c=r[10],f=r[11],x=r[12],b=r[13],v=r[14],l=r[15],m=a*u-n*s,P=a*h-e*s,O=a*M-o*s,E=n*h-e*u,S=n*M-o*u,y=e*M-o*h,I=i*b-p*x,N=i*v-c*x,L=i*l-f*x,R=p*v-c*b,d=p*l-f*b,g=c*l-f*v,A=m*g-P*d+O*R+E*L-S*N+y*I;return A?(A=1/A,t[0]=(u*g-h*d+M*R)*A,t[1]=(e*d-n*g-o*R)*A,t[2]=(b*y-v*S+l*E)*A,t[3]=(c*S-p*y-f*E)*A,t[4]=(h*L-s*g-M*N)*A,t[5]=(a*g-e*L+o*N)*A,t[6]=(v*O-x*y-l*P)*A,t[7]=(i*y-c*O+f*P)*A,t[8]=(s*d-u*L+M*I)*A,t[9]=(n*L-a*d-o*I)*A,t[10]=(x*S-b*O+l*m)*A,t[11]=(p*O-i*S-f*m)*A,t[12]=(u*N-s*R-h*I)*A,t[13]=(a*R-n*N+e*I)*A,t[14]=(b*P-x*E-v*m)*A,t[15]=(i*E-p*P+c*m)*A,t):null}function p(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=r[4],u=r[5],h=r[6],M=r[7],i=r[8],p=r[9],c=r[10],f=r[11],x=r[12],b=r[13],v=r[14],l=r[15];return t[0]=u*(c*l-f*v)-p*(h*l-M*v)+b*(h*f-M*c),t[1]=-(n*(c*l-f*v)-p*(e*l-o*v)+b*(e*f-o*c)),t[2]=n*(h*l-M*v)-u*(e*l-o*v)+b*(e*M-o*h),t[3]=-(n*(h*f-M*c)-u*(e*f-o*c)+p*(e*M-o*h)),t[4]=-(s*(c*l-f*v)-i*(h*l-M*v)+x*(h*f-M*c)),t[5]=a*(c*l-f*v)-i*(e*l-o*v)+x*(e*f-o*c),t[6]=-(a*(h*l-M*v)-s*(e*l-o*v)+x*(e*M-o*h)),t[7]=a*(h*f-M*c)-s*(e*f-o*c)+i*(e*M-o*h),t[8]=s*(p*l-f*b)-i*(u*l-M*b)+x*(u*f-M*p),t[9]=-(a*(p*l-f*b)-i*(n*l-o*b)+x*(n*f-o*p)),t[10]=a*(u*l-M*b)-s*(n*l-o*b)+x*(n*M-o*u),t[11]=-(a*(u*f-M*p)-s*(n*f-o*p)+i*(n*M-o*u)),t[12]=-(s*(p*v-c*b)-i*(u*v-h*b)+x*(u*c-h*p)),t[13]=a*(p*v-c*b)-i*(n*v-e*b)+x*(n*c-e*p),t[14]=-(a*(u*v-h*b)-s*(n*v-e*b)+x*(n*h-e*u)),t[15]=a*(u*c-h*p)-s*(n*c-e*p)+i*(n*h-e*u),t}function c(t){var r=t[0],a=t[1],n=t[2],e=t[3],o=t[4],s=t[5],u=t[6],h=t[7],M=t[8],i=t[9],p=t[10],c=t[11],f=t[12],x=t[13],b=t[14],v=t[15];return(r*s-a*o)*(p*v-c*b)-(r*u-n*o)*(i*v-c*x)+(r*h-e*o)*(i*b-p*x)+(a*u-n*s)*(M*v-c*f)-(a*h-e*s)*(M*b-p*f)+(n*h-e*u)*(M*x-i*f)}function f(t,r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],h=r[5],M=r[6],i=r[7],p=r[8],c=r[9],f=r[10],x=r[11],b=r[12],v=r[13],l=r[14],m=r[15],P=a[0],O=a[1],E=a[2],S=a[3];return t[0]=P*n+O*u+E*p+S*b,t[1]=P*e+O*h+E*c+S*v,t[2]=P*o+O*M+E*f+S*l,t[3]=P*s+O*i+E*x+S*m,P=a[4],O=a[5],E=a[6],S=a[7],t[4]=P*n+O*u+E*p+S*b,t[5]=P*e+O*h+E*c+S*v,t[6]=P*o+O*M+E*f+S*l,t[7]=P*s+O*i+E*x+S*m,P=a[8],O=a[9],E=a[10],S=a[11],t[8]=P*n+O*u+E*p+S*b,t[9]=P*e+O*h+E*c+S*v,t[10]=P*o+O*M+E*f+S*l,t[11]=P*s+O*i+E*x+S*m,P=a[12],O=a[13],E=a[14],S=a[15],t[12]=P*n+O*u+E*p+S*b,t[13]=P*e+O*h+E*c+S*v,t[14]=P*o+O*M+E*f+S*l,t[15]=P*s+O*i+E*x+S*m,t}function x(t,r,a){var n,e,o,s,u,h,M,i,p,c,f,x,b=a[0],v=a[1],l=a[2];return r===t?(t[12]=r[0]*b+r[4]*v+r[8]*l+r[12],t[13]=r[1]*b+r[5]*v+r[9]*l+r[13],t[14]=r[2]*b+r[6]*v+r[10]*l+r[14],t[15]=r[3]*b+r[7]*v+r[11]*l+r[15]):(n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],h=r[5],M=r[6],i=r[7],p=r[8],c=r[9],f=r[10],x=r[11],t[0]=n,t[1]=e,t[2]=o,t[3]=s,t[4]=u,t[5]=h,t[6]=M,t[7]=i,t[8]=p,t[9]=c,t[10]=f,t[11]=x,t[12]=n*b+u*v+p*l+r[12],t[13]=e*b+h*v+c*l+r[13],t[14]=o*b+M*v+f*l+r[14],t[15]=s*b+i*v+x*l+r[15]),t}function b(t,r,a){var n=a[0],e=a[1],o=a[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=r[11]*o,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function v(r,a,n,e){var o,s,u,h,M,i,p,c,f,x,b,v,l,m,P,O,E,S,y,I,N,L,R,d,g=e[0],A=e[1],Y=e[2],T=Math.hypot(g,A,Y);return T<t.EPSILON?null:(g*=T=1/T,A*=T,Y*=T,o=Math.sin(n),u=1-(s=Math.cos(n)),h=a[0],M=a[1],i=a[2],p=a[3],c=a[4],f=a[5],x=a[6],b=a[7],v=a[8],l=a[9],m=a[10],P=a[11],O=g*g*u+s,E=A*g*u+Y*o,S=Y*g*u-A*o,y=g*A*u-Y*o,I=A*A*u+s,N=Y*A*u+g*o,L=g*Y*u+A*o,R=A*Y*u-g*o,d=Y*Y*u+s,r[0]=h*O+c*E+v*S,r[1]=M*O+f*E+l*S,r[2]=i*O+x*E+m*S,r[3]=p*O+b*E+P*S,r[4]=h*y+c*I+v*N,r[5]=M*y+f*I+l*N,r[6]=i*y+x*I+m*N,r[7]=p*y+b*I+P*N,r[8]=h*L+c*R+v*d,r[9]=M*L+f*R+l*d,r[10]=i*L+x*R+m*d,r[11]=p*L+b*R+P*d,a!==r&&(r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15]),r)}function l(t,r,a){var n=Math.sin(a),e=Math.cos(a),o=r[4],s=r[5],u=r[6],h=r[7],M=r[8],i=r[9],p=r[10],c=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=o*e+M*n,t[5]=s*e+i*n,t[6]=u*e+p*n,t[7]=h*e+c*n,t[8]=M*e-o*n,t[9]=i*e-s*n,t[10]=p*e-u*n,t[11]=c*e-h*n,t}function m(t,r,a){var n=Math.sin(a),e=Math.cos(a),o=r[0],s=r[1],u=r[2],h=r[3],M=r[8],i=r[9],p=r[10],c=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*e-M*n,t[1]=s*e-i*n,t[2]=u*e-p*n,t[3]=h*e-c*n,t[8]=o*n+M*e,t[9]=s*n+i*e,t[10]=u*n+p*e,t[11]=h*n+c*e,t}function P(t,r,a){var n=Math.sin(a),e=Math.cos(a),o=r[0],s=r[1],u=r[2],h=r[3],M=r[4],i=r[5],p=r[6],c=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*e+M*n,t[1]=s*e+i*n,t[2]=u*e+p*n,t[3]=h*e+c*n,t[4]=M*e-o*n,t[5]=i*e-s*n,t[6]=p*e-u*n,t[7]=c*e-h*n,t}function O(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function E(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(r,a,n){var e,o,s,u=n[0],h=n[1],M=n[2],i=Math.hypot(u,h,M);return i<t.EPSILON?null:(u*=i=1/i,h*=i,M*=i,e=Math.sin(a),s=1-(o=Math.cos(a)),r[0]=u*u*s+o,r[1]=h*u*s+M*e,r[2]=M*u*s-h*e,r[3]=0,r[4]=u*h*s-M*e,r[5]=h*h*s+o,r[6]=M*h*s+u*e,r[7]=0,r[8]=u*M*s+h*e,r[9]=h*M*s-u*e,r[10]=M*M*s+o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function y(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=n+n,h=e+e,M=o+o,i=n*u,p=n*h,c=n*M,f=e*h,x=e*M,b=o*M,v=s*u,l=s*h,m=s*M;return t[0]=1-(f+b),t[1]=p+m,t[2]=c-l,t[3]=0,t[4]=p-m,t[5]=1-(i+b),t[6]=x+v,t[7]=0,t[8]=c+l,t[9]=x-v,t[10]=1-(i+f),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function R(r,a){var n=new t.ARRAY_TYPE(3),e=-a[0],o=-a[1],s=-a[2],u=a[3],h=a[4],M=a[5],i=a[6],p=a[7],c=e*e+o*o+s*s+u*u;return c>0?(n[0]=2*(h*u+p*e+M*s-i*o)/c,n[1]=2*(M*u+p*o+i*e-h*s)/c,n[2]=2*(i*u+p*s+h*o-M*e)/c):(n[0]=2*(h*u+p*e+M*s-i*o),n[1]=2*(M*u+p*o+i*e-h*s),n[2]=2*(i*u+p*s+h*o-M*e)),L(r,a,n),r}function d(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t}function g(t,r){var a=r[0],n=r[1],e=r[2],o=r[4],s=r[5],u=r[6],h=r[8],M=r[9],i=r[10];return t[0]=Math.hypot(a,n,e),t[1]=Math.hypot(o,s,u),t[2]=Math.hypot(h,M,i),t}function A(r,a){var n=new t.ARRAY_TYPE(3);g(n,a);var e=1/n[0],o=1/n[1],s=1/n[2],u=a[0]*e,h=a[1]*o,M=a[2]*s,i=a[4]*e,p=a[5]*o,c=a[6]*s,f=a[8]*e,x=a[9]*o,b=a[10]*s,v=u+p+b,l=0;return v>0?(l=2*Math.sqrt(v+1),r[3]=.25*l,r[0]=(c-x)/l,r[1]=(f-M)/l,r[2]=(h-i)/l):u>p&&u>b?(l=2*Math.sqrt(1+u-p-b),r[3]=(c-x)/l,r[0]=.25*l,r[1]=(h+i)/l,r[2]=(f+M)/l):p>b?(l=2*Math.sqrt(1+p-u-b),r[3]=(f-M)/l,r[0]=(h+i)/l,r[1]=.25*l,r[2]=(c+x)/l):(l=2*Math.sqrt(1+b-u-p),r[3]=(h-i)/l,r[0]=(f+M)/l,r[1]=(c+x)/l,r[2]=.25*l),r}function Y(t,r,a,n){var e=r[0],o=r[1],s=r[2],u=r[3],h=e+e,M=o+o,i=s+s,p=e*h,c=e*M,f=e*i,x=o*M,b=o*i,v=s*i,l=u*h,m=u*M,P=u*i,O=n[0],E=n[1],S=n[2];return t[0]=(1-(x+v))*O,t[1]=(c+P)*O,t[2]=(f-m)*O,t[3]=0,t[4]=(c-P)*E,t[5]=(1-(p+v))*E,t[6]=(b+l)*E,t[7]=0,t[8]=(f+m)*S,t[9]=(b-l)*S,t[10]=(1-(p+x))*S,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function T(t,r,a,n,e){var o=r[0],s=r[1],u=r[2],h=r[3],M=o+o,i=s+s,p=u+u,c=o*M,f=o*i,x=o*p,b=s*i,v=s*p,l=u*p,m=h*M,P=h*i,O=h*p,E=n[0],S=n[1],y=n[2],I=e[0],N=e[1],L=e[2],R=(1-(b+l))*E,d=(f+O)*E,g=(x-P)*E,A=(f-O)*S,Y=(1-(c+l))*S,T=(v+m)*S,w=(x+P)*y,_=(v-m)*y,j=(1-(c+b))*y;return t[0]=R,t[1]=d,t[2]=g,t[3]=0,t[4]=A,t[5]=Y,t[6]=T,t[7]=0,t[8]=w,t[9]=_,t[10]=j,t[11]=0,t[12]=a[0]+I-(R*I+A*N+w*L),t[13]=a[1]+N-(d*I+Y*N+_*L),t[14]=a[2]+L-(g*I+T*N+j*L),t[15]=1,t}function w(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=a+a,u=n+n,h=e+e,M=a*s,i=n*s,p=n*u,c=e*s,f=e*u,x=e*h,b=o*s,v=o*u,l=o*h;return t[0]=1-p-x,t[1]=i+l,t[2]=c-v,t[3]=0,t[4]=i-l,t[5]=1-M-x,t[6]=f+b,t[7]=0,t[8]=c+v,t[9]=f-b,t[10]=1-M-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,r,a,n,e,o,s){var u=1/(a-r),h=1/(e-n),M=1/(o-s);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*h,t[6]=0,t[7]=0,t[8]=(a+r)*u,t[9]=(e+n)*h,t[10]=(s+o)*M,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*M,t[15]=0,t}function j(t,r,a,n,e){var o,s=1/Math.tan(r/2);return t[0]=s/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(o=1/(n-e),t[10]=(e+n)*o,t[14]=2*e*n*o):(t[10]=-1,t[14]=-2*n),t}var q=j;function D(t,r,a,n,e){var o,s=1/Math.tan(r/2);return t[0]=s/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(o=1/(n-e),t[10]=e*o,t[14]=e*n*o):(t[10]=-1,t[14]=-n),t}function Z(t,r,a,n){var e=Math.tan(r.upDegrees*Math.PI/180),o=Math.tan(r.downDegrees*Math.PI/180),s=Math.tan(r.leftDegrees*Math.PI/180),u=Math.tan(r.rightDegrees*Math.PI/180),h=2/(s+u),M=2/(e+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=M,t[6]=0,t[7]=0,t[8]=-(s-u)*h*.5,t[9]=(e-o)*M*.5,t[10]=n/(a-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*a/(a-n),t[15]=0,t}function k(t,r,a,n,e,o,s){var u=1/(r-a),h=1/(n-e),M=1/(o-s);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*M,t[11]=0,t[12]=(r+a)*u,t[13]=(e+n)*h,t[14]=(s+o)*M,t[15]=1,t}exports.perspective=q;var F=k;function Q(t,r,a,n,e,o,s){var u=1/(r-a),h=1/(n-e),M=1/(o-s);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=M,t[11]=0,t[12]=(r+a)*u,t[13]=(e+n)*h,t[14]=o*M,t[15]=1,t}function V(r,a,n,e){var o,s,u,M,i,p,c,f,x,b,v=a[0],l=a[1],m=a[2],P=e[0],O=e[1],E=e[2],S=n[0],y=n[1],I=n[2];return Math.abs(v-S)<t.EPSILON&&Math.abs(l-y)<t.EPSILON&&Math.abs(m-I)<t.EPSILON?h(r):(c=v-S,f=l-y,x=m-I,o=O*(x*=b=1/Math.hypot(c,f,x))-E*(f*=b),s=E*(c*=b)-P*x,u=P*f-O*c,(b=Math.hypot(o,s,u))?(o*=b=1/b,s*=b,u*=b):(o=0,s=0,u=0),M=f*u-x*s,i=x*o-c*u,p=c*s-f*o,(b=Math.hypot(M,i,p))?(M*=b=1/b,i*=b,p*=b):(M=0,i=0,p=0),r[0]=o,r[1]=M,r[2]=c,r[3]=0,r[4]=s,r[5]=i,r[6]=f,r[7]=0,r[8]=u,r[9]=p,r[10]=x,r[11]=0,r[12]=-(o*v+s*l+u*m),r[13]=-(M*v+i*l+p*m),r[14]=-(c*v+f*l+x*m),r[15]=1,r)}function W(t,r,a,n){var e=r[0],o=r[1],s=r[2],u=n[0],h=n[1],M=n[2],i=e-a[0],p=o-a[1],c=s-a[2],f=i*i+p*p+c*c;f>0&&(i*=f=1/Math.sqrt(f),p*=f,c*=f);var x=h*c-M*p,b=M*i-u*c,v=u*p-h*i;return(f=x*x+b*b+v*v)>0&&(x*=f=1/Math.sqrt(f),b*=f,v*=f),t[0]=x,t[1]=b,t[2]=v,t[3]=0,t[4]=p*v-c*b,t[5]=c*x-i*v,t[6]=i*b-p*x,t[7]=0,t[8]=i,t[9]=p,t[10]=c,t[11]=0,t[12]=e,t[13]=o,t[14]=s,t[15]=1,t}function X(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function z(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function B(t,r,a){return t[0]=r[0]+a[0],t[1]=r[1]+a[1],t[2]=r[2]+a[2],t[3]=r[3]+a[3],t[4]=r[4]+a[4],t[5]=r[5]+a[5],t[6]=r[6]+a[6],t[7]=r[7]+a[7],t[8]=r[8]+a[8],t[9]=r[9]+a[9],t[10]=r[10]+a[10],t[11]=r[11]+a[11],t[12]=r[12]+a[12],t[13]=r[13]+a[13],t[14]=r[14]+a[14],t[15]=r[15]+a[15],t}function C(t,r,a){return t[0]=r[0]-a[0],t[1]=r[1]-a[1],t[2]=r[2]-a[2],t[3]=r[3]-a[3],t[4]=r[4]-a[4],t[5]=r[5]-a[5],t[6]=r[6]-a[6],t[7]=r[7]-a[7],t[8]=r[8]-a[8],t[9]=r[9]-a[9],t[10]=r[10]-a[10],t[11]=r[11]-a[11],t[12]=r[12]-a[12],t[13]=r[13]-a[13],t[14]=r[14]-a[14],t[15]=r[15]-a[15],t}function G(t,r,a){return t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t[3]=r[3]*a,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=r[11]*a,t[12]=r[12]*a,t[13]=r[13]*a,t[14]=r[14]*a,t[15]=r[15]*a,t}function H(t,r,a,n){return t[0]=r[0]+a[0]*n,t[1]=r[1]+a[1]*n,t[2]=r[2]+a[2]*n,t[3]=r[3]+a[3]*n,t[4]=r[4]+a[4]*n,t[5]=r[5]+a[5]*n,t[6]=r[6]+a[6]*n,t[7]=r[7]+a[7]*n,t[8]=r[8]+a[8]*n,t[9]=r[9]+a[9]*n,t[10]=r[10]+a[10]*n,t[11]=r[11]+a[11]*n,t[12]=r[12]+a[12]*n,t[13]=r[13]+a[13]*n,t[14]=r[14]+a[14]*n,t[15]=r[15]+a[15]*n,t}function J(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]}function K(r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],h=r[5],M=r[6],i=r[7],p=r[8],c=r[9],f=r[10],x=r[11],b=r[12],v=r[13],l=r[14],m=r[15],P=a[0],O=a[1],E=a[2],S=a[3],y=a[4],I=a[5],N=a[6],L=a[7],R=a[8],d=a[9],g=a[10],A=a[11],Y=a[12],T=a[13],w=a[14],_=a[15];return Math.abs(n-P)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(P))&&Math.abs(e-O)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(O))&&Math.abs(o-E)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(s-S)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-y)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-I)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(M-N)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(i-L)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(L))&&Math.abs(p-R)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(c-d)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(f-g)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(g))&&Math.abs(x-A)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(A))&&Math.abs(b-Y)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(Y))&&Math.abs(v-T)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(l-w)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(m-_)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(_))}exports.ortho=F;var U=f;exports.mul=U;var $=C;exports.sub=$;
},{"./common.js":"W43s"}],"d0Px":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.length=a,exports.fromValues=s,exports.copy=u,exports.set=i,exports.add=c,exports.subtract=p,exports.multiply=f,exports.divide=x,exports.ceil=h,exports.floor=M,exports.min=v,exports.max=l,exports.round=d,exports.scale=m,exports.scaleAndAdd=b,exports.distance=y,exports.squaredDistance=O,exports.squaredLength=P,exports.negate=q,exports.inverse=A,exports.normalize=g,exports.dot=E,exports.cross=R,exports.lerp=Y,exports.hermite=j,exports.bezier=_,exports.random=w,exports.transformMat4=D,exports.transformMat3=L,exports.transformQuat=N,exports.rotateX=I,exports.rotateY=T,exports.rotateZ=z,exports.angle=S,exports.zero=k,exports.str=W,exports.exactEquals=F,exports.equals=Q,exports.forEach=exports.sqrLen=exports.len=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function o(r){var e=new t.ARRAY_TYPE(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function a(t){var r=t[0],e=t[1],n=t[2];return Math.hypot(r,e,n)}function s(r,e,n){var o=new t.ARRAY_TYPE(3);return o[0]=r,o[1]=e,o[2]=n,o}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function i(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function c(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function p(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function f(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function x(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t}function h(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t}function M(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t}function v(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function l(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function d(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t}function m(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function b(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t}function y(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return Math.hypot(e,n,o)}function O(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return e*e+n*n+o*o}function P(t){var r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n}function q(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t}function A(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t}function g(t,r){var e=r[0],n=r[1],o=r[2],a=e*e+n*n+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function R(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return t[0]=o*i-a*u,t[1]=a*s-n*i,t[2]=n*u-o*s,t}function Y(t,r,e,n){var o=r[0],a=r[1],s=r[2];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t}function j(t,r,e,n,o,a){var s=a*a,u=s*(2*a-3)+1,i=s*(a-2)+a,c=s*(a-1),p=s*(3-2*a);return t[0]=r[0]*u+e[0]*i+n[0]*c+o[0]*p,t[1]=r[1]*u+e[1]*i+n[1]*c+o[1]*p,t[2]=r[2]*u+e[2]*i+n[2]*c+o[2]*p,t}function _(t,r,e,n,o,a){var s=1-a,u=s*s,i=a*a,c=u*s,p=3*a*u,f=3*i*s,x=i*a;return t[0]=r[0]*c+e[0]*p+n[0]*f+o[0]*x,t[1]=r[1]*c+e[1]*p+n[1]*f+o[1]*x,t[2]=r[2]*c+e[2]*p+n[2]*f+o[2]*x,t}function w(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI,o=2*t.RANDOM()-1,a=Math.sqrt(1-o*o)*e;return r[0]=Math.cos(n)*a,r[1]=Math.sin(n)*a,r[2]=o*e,r}function D(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[3]*n+e[7]*o+e[11]*a+e[15];return s=s||1,t[0]=(e[0]*n+e[4]*o+e[8]*a+e[12])/s,t[1]=(e[1]*n+e[5]*o+e[9]*a+e[13])/s,t[2]=(e[2]*n+e[6]*o+e[10]*a+e[14])/s,t}function L(t,r,e){var n=r[0],o=r[1],a=r[2];return t[0]=n*e[0]+o*e[3]+a*e[6],t[1]=n*e[1]+o*e[4]+a*e[7],t[2]=n*e[2]+o*e[5]+a*e[8],t}function N(t,r,e){var n=e[0],o=e[1],a=e[2],s=e[3],u=r[0],i=r[1],c=r[2],p=o*c-a*i,f=a*u-n*c,x=n*i-o*u,h=o*x-a*f,M=a*p-n*x,v=n*f-o*p,l=2*s;return p*=l,f*=l,x*=l,h*=2,M*=2,v*=2,t[0]=u+p+h,t[1]=i+f+M,t[2]=c+x+v,t}function I(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0],a[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),a[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function T(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),a[1]=o[1],a[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function z(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),a[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),a[2]=o[2],t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function S(t,r){var e=t[0],n=t[1],o=t[2],a=r[0],s=r[1],u=r[2],i=Math.sqrt(e*e+n*n+o*o)*Math.sqrt(a*a+s*s+u*u),c=i&&E(t,r)/i;return Math.acos(Math.min(Math.max(c,-1),1))}function k(t){return t[0]=0,t[1]=0,t[2]=0,t}function W(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function F(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function Q(r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-i)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))}var V=p;exports.sub=V;var X=f;exports.mul=X;var Z=x;exports.div=Z;var B=y;exports.dist=B;var C=O;exports.sqrDist=C;var G=a;exports.len=G;var H=P;exports.sqrLen=H;var J=function(){var t=n();return function(r,e,n,o,a,s){var u,i;for(e||(e=3),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,u=n;u<i;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],a(t,t,s),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2];return r}}();exports.forEach=J;
},{"./common.js":"W43s"}],"vUkg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.fromValues=a,exports.copy=u,exports.set=s,exports.add=i,exports.subtract=c,exports.multiply=p,exports.divide=f,exports.ceil=x,exports.floor=h,exports.min=M,exports.max=l,exports.round=v,exports.scale=d,exports.scaleAndAdd=m,exports.distance=b,exports.squaredDistance=O,exports.length=y,exports.squaredLength=A,exports.negate=P,exports.inverse=R,exports.normalize=q,exports.dot=E,exports.cross=g,exports.lerp=w,exports.random=D,exports.transformMat4=j,exports.transformQuat=N,exports.zero=Y,exports.str=_,exports.exactEquals=L,exports.equals=I,exports.forEach=exports.sqrLen=exports.len=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function o(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function a(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function s(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function c(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function p(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t[3]=r[3]*e[3],t}function f(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t[3]=r[3]/e[3],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t[3]=Math.ceil(r[3]),t}function h(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t[3]=Math.floor(r[3]),t}function M(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t[3]=Math.min(r[3],e[3]),t}function l(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t[3]=Math.max(r[3],e[3]),t}function v(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t[3]=Math.round(r[3]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return Math.hypot(e,n,o,a)}function O(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return e*e+n*n+o*o+a*a}function y(t){var r=t[0],e=t[1],n=t[2],o=t[3];return Math.hypot(r,e,n,o)}function A(t){var r=t[0],e=t[1],n=t[2],o=t[3];return r*r+e*e+n*n+o*o}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function R(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t[3]=1/r[3],t}function q(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],u=e*e+n*n+o*o+a*a;return u>0&&(u=1/Math.sqrt(u)),t[0]=e*u,t[1]=n*u,t[2]=o*u,t[3]=a*u,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]}function g(t,r,e,n){var o=e[0]*n[1]-e[1]*n[0],a=e[0]*n[2]-e[2]*n[0],u=e[0]*n[3]-e[3]*n[0],s=e[1]*n[2]-e[2]*n[1],i=e[1]*n[3]-e[3]*n[1],c=e[2]*n[3]-e[3]*n[2],p=r[0],f=r[1],x=r[2],h=r[3];return t[0]=f*c-x*i+h*s,t[1]=-p*c+x*u-h*a,t[2]=p*i-f*u+h*o,t[3]=-p*s+f*a-x*o,t}function w(t,r,e,n){var o=r[0],a=r[1],u=r[2],s=r[3];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=u+n*(e[2]-u),t[3]=s+n*(e[3]-s),t}function D(r,e){var n,o,a,u,s,i;e=e||1;do{s=(n=2*t.RANDOM()-1)*n+(o=2*t.RANDOM()-1)*o}while(s>=1);do{i=(a=2*t.RANDOM()-1)*a+(u=2*t.RANDOM()-1)*u}while(i>=1);var c=Math.sqrt((1-s)/i);return r[0]=e*n,r[1]=e*o,r[2]=e*a*c,r[3]=e*u*c,r}function j(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3];return t[0]=e[0]*n+e[4]*o+e[8]*a+e[12]*u,t[1]=e[1]*n+e[5]*o+e[9]*a+e[13]*u,t[2]=e[2]*n+e[6]*o+e[10]*a+e[14]*u,t[3]=e[3]*n+e[7]*o+e[11]*a+e[15]*u,t}function N(t,r,e){var n=r[0],o=r[1],a=r[2],u=e[0],s=e[1],i=e[2],c=e[3],p=c*n+s*a-i*o,f=c*o+i*n-u*a,x=c*a+u*o-s*n,h=-u*n-s*o-i*a;return t[0]=p*c+h*-u+f*-i-x*-s,t[1]=f*c+h*-s+x*-u-p*-i,t[2]=x*c+h*-i+p*-s-f*-u,t[3]=r[3],t}function Y(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function _(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function L(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function I(r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],c=e[2],p=e[3];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(u-p)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))}var S=c;exports.sub=S;var T=p;exports.mul=T;var k=f;exports.div=k;var z=b;exports.dist=z;var W=O;exports.sqrDist=W;var F=y;exports.len=F;var Q=A;exports.sqrLen=Q;var V=function(){var t=n();return function(r,e,n,o,a,u){var s,i;for(e||(e=4),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,s=n;s<i;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],t[3]=r[s+3],a(t,t,u),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2],r[s+3]=t[3];return r}}();exports.forEach=V;
},{"./common.js":"W43s"}],"AJB2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=s,exports.identity=u,exports.setAxisAngle=p,exports.getAxisAngle=c,exports.getAngle=i,exports.multiply=x,exports.rotateX=l,exports.rotateY=f,exports.rotateZ=v,exports.calculateW=h,exports.exp=M,exports.ln=q,exports.pow=d,exports.slerp=m,exports.random=g,exports.invert=y,exports.conjugate=P,exports.fromMat3=A,exports.fromEuler=O,exports.str=j,exports.setAxes=exports.sqlerp=exports.rotationTo=exports.equals=exports.exactEquals=exports.normalize=exports.sqrLen=exports.squaredLength=exports.len=exports.length=exports.lerp=exports.dot=exports.scale=exports.mul=exports.add=exports.set=exports.copy=exports.fromValues=exports.clone=void 0;var t=n(require("./common.js")),r=n(require("./mat3.js")),e=n(require("./vec3.js")),o=n(require("./vec4.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a();if(r&&r.has(t))return r.get(t);var e={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=o?Object.getOwnPropertyDescriptor(t,n):null;s&&(s.get||s.set)?Object.defineProperty(e,n,s):e[n]=t[n]}return e.default=t,r&&r.set(t,e),e}function s(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function u(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function p(t,r,e){e*=.5;var o=Math.sin(e);return t[0]=o*r[0],t[1]=o*r[1],t[2]=o*r[2],t[3]=Math.cos(e),t}function c(r,e){var o=2*Math.acos(e[3]),a=Math.sin(o/2);return a>t.EPSILON?(r[0]=e[0]/a,r[1]=e[1]/a,r[2]=e[2]/a):(r[0]=1,r[1]=0,r[2]=0),o}function i(t,r){var e=D(t,r);return Math.acos(2*e*e-1)}function x(t,r,e){var o=r[0],a=r[1],n=r[2],s=r[3],u=e[0],p=e[1],c=e[2],i=e[3];return t[0]=o*i+s*u+a*c-n*p,t[1]=a*i+s*p+n*u-o*c,t[2]=n*i+s*c+o*p-a*u,t[3]=s*i-o*u-a*p-n*c,t}function l(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p+s*u,t[1]=a*p+n*u,t[2]=n*p-a*u,t[3]=s*p-o*u,t}function f(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p-n*u,t[1]=a*p+s*u,t[2]=n*p+o*u,t[3]=s*p-a*u,t}function v(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p+a*u,t[1]=a*p-o*u,t[2]=n*p+s*u,t[3]=s*p-n*u,t}function h(t,r){var e=r[0],o=r[1],a=r[2];return t[0]=e,t[1]=o,t[2]=a,t[3]=Math.sqrt(Math.abs(1-e*e-o*o-a*a)),t}function M(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=Math.sqrt(e*e+o*o+a*a),u=Math.exp(n),p=s>0?u*Math.sin(s)/s:0;return t[0]=e*p,t[1]=o*p,t[2]=a*p,t[3]=u*Math.cos(s),t}function q(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=Math.sqrt(e*e+o*o+a*a),u=s>0?Math.atan2(s,n)/s:0;return t[0]=e*u,t[1]=o*u,t[2]=a*u,t[3]=.5*Math.log(e*e+o*o+a*a+n*n),t}function d(t,r,e){return q(t,r),_(t,t,e),M(t,t),t}function m(r,e,o,a){var n,s,u,p,c,i=e[0],x=e[1],l=e[2],f=e[3],v=o[0],h=o[1],M=o[2],q=o[3];return(s=i*v+x*h+l*M+f*q)<0&&(s=-s,v=-v,h=-h,M=-M,q=-q),1-s>t.EPSILON?(n=Math.acos(s),u=Math.sin(n),p=Math.sin((1-a)*n)/u,c=Math.sin(a*n)/u):(p=1-a,c=a),r[0]=p*i+c*v,r[1]=p*x+c*h,r[2]=p*l+c*M,r[3]=p*f+c*q,r}function g(r){var e=t.RANDOM(),o=t.RANDOM(),a=t.RANDOM(),n=Math.sqrt(1-e),s=Math.sqrt(e);return r[0]=n*Math.sin(2*Math.PI*o),r[1]=n*Math.cos(2*Math.PI*o),r[2]=s*Math.sin(2*Math.PI*a),r[3]=s*Math.cos(2*Math.PI*a),r}function y(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=e*e+o*o+a*a+n*n,u=s?1/s:0;return t[0]=-e*u,t[1]=-o*u,t[2]=-a*u,t[3]=n*u,t}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t}function A(t,r){var e,o=r[0]+r[4]+r[8];if(o>0)e=Math.sqrt(o+1),t[3]=.5*e,e=.5/e,t[0]=(r[5]-r[7])*e,t[1]=(r[6]-r[2])*e,t[2]=(r[1]-r[3])*e;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[3*a+a]&&(a=2);var n=(a+1)%3,s=(a+2)%3;e=Math.sqrt(r[3*a+a]-r[3*n+n]-r[3*s+s]+1),t[a]=.5*e,e=.5/e,t[3]=(r[3*n+s]-r[3*s+n])*e,t[n]=(r[3*n+a]+r[3*a+n])*e,t[s]=(r[3*s+a]+r[3*a+s])*e}return t}function O(t,r,e,o){var a=.5*Math.PI/180;r*=a,e*=a,o*=a;var n=Math.sin(r),s=Math.cos(r),u=Math.sin(e),p=Math.cos(e),c=Math.sin(o),i=Math.cos(o);return t[0]=n*p*i-s*u*c,t[1]=s*u*i+n*p*c,t[2]=s*p*c-n*u*i,t[3]=s*p*i+n*u*c,t}function j(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var b=o.clone;exports.clone=b;var E=o.fromValues;exports.fromValues=E;var I=o.copy;exports.copy=I;var L=o.set;exports.set=L;var R=o.add;exports.add=R;var w=x;exports.mul=w;var _=o.scale;exports.scale=_;var D=o.dot;exports.dot=D;var N=o.lerp;exports.lerp=N;var V=o.length;exports.length=V;var Y=V;exports.len=Y;var z=o.squaredLength;exports.squaredLength=z;var T=z;exports.sqrLen=T;var W=o.normalize;exports.normalize=W;var k=o.exactEquals;exports.exactEquals=k;var S=o.equals;exports.equals=S;var F=function(){var t=e.create(),r=e.fromValues(1,0,0),o=e.fromValues(0,1,0);return function(a,n,s){var u=e.dot(n,s);return u<-.999999?(e.cross(t,r,n),e.len(t)<1e-6&&e.cross(t,o,n),e.normalize(t,t),p(a,t,Math.PI),a):u>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(e.cross(t,n,s),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+u,W(a,a))}}();exports.rotationTo=F;var X=function(){var t=s(),r=s();return function(e,o,a,n,s,u){return m(t,o,s,u),m(r,a,n,u),m(e,t,r,2*u*(1-u)),e}}();exports.sqlerp=X;var Z=function(){var t=r.create();return function(r,e,o,a){return t[0]=o[0],t[3]=o[1],t[6]=o[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],W(r,A(r,t))}}();exports.setAxes=Z;
},{"./common.js":"W43s","./mat3.js":"ezba","./vec3.js":"d0Px","./vec4.js":"vUkg"}],"Kq3q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=o,exports.clone=s,exports.fromValues=u,exports.fromRotationTranslationValues=p,exports.fromRotationTranslation=i,exports.fromTranslation=c,exports.fromRotation=f,exports.fromMat4=x,exports.copy=h,exports.identity=l,exports.set=M,exports.getDual=b,exports.setDual=m,exports.getTranslation=d,exports.translate=R,exports.rotateX=y,exports.rotateY=O,exports.rotateZ=g,exports.rotateByQuatAppend=A,exports.rotateByQuatPrepend=E,exports.rotateAroundAxis=L,exports.add=Y,exports.multiply=q,exports.scale=T,exports.lerp=w,exports.invert=I,exports.conjugate=N,exports.normalize=Q,exports.str=V,exports.exactEquals=W,exports.equals=X,exports.sqrLen=exports.squaredLength=exports.len=exports.length=exports.dot=exports.mul=exports.setReal=exports.getReal=void 0;var t=n(require("./common.js")),r=n(require("./quat.js")),e=n(require("./mat4.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a();if(r&&r.has(t))return r.get(t);var e={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(e,o,s):e[o]=t[o]}return e.default=t,r&&r.set(t,e),e}function o(){var r=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function s(r){var e=new t.ARRAY_TYPE(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function u(r,e,a,n,o,s,u,p){var i=new t.ARRAY_TYPE(8);return i[0]=r,i[1]=e,i[2]=a,i[3]=n,i[4]=o,i[5]=s,i[6]=u,i[7]=p,i}function p(r,e,a,n,o,s,u){var p=new t.ARRAY_TYPE(8);p[0]=r,p[1]=e,p[2]=a,p[3]=n;var i=.5*o,c=.5*s,f=.5*u;return p[4]=i*n+c*a-f*e,p[5]=c*n+f*r-i*a,p[6]=f*n+i*e-c*r,p[7]=-i*r-c*e-f*a,p}function i(t,r,e){var a=.5*e[0],n=.5*e[1],o=.5*e[2],s=r[0],u=r[1],p=r[2],i=r[3];return t[0]=s,t[1]=u,t[2]=p,t[3]=i,t[4]=a*i+n*p-o*u,t[5]=n*i+o*s-a*p,t[6]=o*i+a*u-n*s,t[7]=-a*s-n*u-o*p,t}function c(t,r){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*r[0],t[5]=.5*r[1],t[6]=.5*r[2],t[7]=0,t}function f(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function x(a,n){var o=r.create();e.getRotation(o,n);var s=new t.ARRAY_TYPE(3);return e.getTranslation(s,n),i(a,o,s),a}function h(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t}function l(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function M(t,r,e,a,n,o,s,u,p){return t[0]=r,t[1]=e,t[2]=a,t[3]=n,t[4]=o,t[5]=s,t[6]=u,t[7]=p,t}var v=r.copy;function b(t,r){return t[0]=r[4],t[1]=r[5],t[2]=r[6],t[3]=r[7],t}exports.getReal=v;var P=r.copy;function m(t,r){return t[4]=r[0],t[5]=r[1],t[6]=r[2],t[7]=r[3],t}function d(t,r){var e=r[4],a=r[5],n=r[6],o=r[7],s=-r[0],u=-r[1],p=-r[2],i=r[3];return t[0]=2*(e*i+o*s+a*p-n*u),t[1]=2*(a*i+o*u+n*s-e*p),t[2]=2*(n*i+o*p+e*u-a*s),t}function R(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=.5*e[0],p=.5*e[1],i=.5*e[2],c=r[4],f=r[5],x=r[6],h=r[7];return t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=s*u+n*i-o*p+c,t[5]=s*p+o*u-a*i+f,t[6]=s*i+a*p-n*u+x,t[7]=-a*u-n*p-o*i+h,t}function y(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],c=e[6],f=e[7],x=p*u+f*n+i*s-c*o,h=i*u+f*o+c*n-p*s,l=c*u+f*s+p*o-i*n,M=f*u-p*n-i*o-c*s;return r.rotateX(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=x*u+M*n+h*s-l*o,t[5]=h*u+M*o+l*n-x*s,t[6]=l*u+M*s+x*o-h*n,t[7]=M*u-x*n-h*o-l*s,t}function O(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],c=e[6],f=e[7],x=p*u+f*n+i*s-c*o,h=i*u+f*o+c*n-p*s,l=c*u+f*s+p*o-i*n,M=f*u-p*n-i*o-c*s;return r.rotateY(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=x*u+M*n+h*s-l*o,t[5]=h*u+M*o+l*n-x*s,t[6]=l*u+M*s+x*o-h*n,t[7]=M*u-x*n-h*o-l*s,t}function g(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],c=e[6],f=e[7],x=p*u+f*n+i*s-c*o,h=i*u+f*o+c*n-p*s,l=c*u+f*s+p*o-i*n,M=f*u-p*n-i*o-c*s;return r.rotateZ(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=x*u+M*n+h*s-l*o,t[5]=h*u+M*o+l*n-x*s,t[6]=l*u+M*s+x*o-h*n,t[7]=M*u-x*n-h*o-l*s,t}function A(t,r,e){var a=e[0],n=e[1],o=e[2],s=e[3],u=r[0],p=r[1],i=r[2],c=r[3];return t[0]=u*s+c*a+p*o-i*n,t[1]=p*s+c*n+i*a-u*o,t[2]=i*s+c*o+u*n-p*a,t[3]=c*s-u*a-p*n-i*o,u=r[4],p=r[5],i=r[6],c=r[7],t[4]=u*s+c*a+p*o-i*n,t[5]=p*s+c*n+i*a-u*o,t[6]=i*s+c*o+u*n-p*a,t[7]=c*s-u*a-p*n-i*o,t}function E(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=e[0],p=e[1],i=e[2],c=e[3];return t[0]=a*c+s*u+n*i-o*p,t[1]=n*c+s*p+o*u-a*i,t[2]=o*c+s*i+a*p-n*u,t[3]=s*c-a*u-n*p-o*i,u=e[4],p=e[5],i=e[6],c=e[7],t[4]=a*c+s*u+n*i-o*p,t[5]=n*c+s*p+o*u-a*i,t[6]=o*c+s*i+a*p-n*u,t[7]=s*c-a*u-n*p-o*i,t}function L(r,e,a,n){if(Math.abs(n)<t.EPSILON)return h(r,e);var o=Math.hypot(a[0],a[1],a[2]);n*=.5;var s=Math.sin(n),u=s*a[0]/o,p=s*a[1]/o,i=s*a[2]/o,c=Math.cos(n),f=e[0],x=e[1],l=e[2],M=e[3];r[0]=f*c+M*u+x*i-l*p,r[1]=x*c+M*p+l*u-f*i,r[2]=l*c+M*i+f*p-x*u,r[3]=M*c-f*u-x*p-l*i;var v=e[4],b=e[5],P=e[6],m=e[7];return r[4]=v*c+m*u+b*i-P*p,r[5]=b*c+m*p+P*u-v*i,r[6]=P*c+m*i+v*p-b*u,r[7]=m*c-v*u-b*p-P*i,r}function Y(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t[6]=r[6]+e[6],t[7]=r[7]+e[7],t}function q(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=e[4],p=e[5],i=e[6],c=e[7],f=r[4],x=r[5],h=r[6],l=r[7],M=e[0],v=e[1],b=e[2],P=e[3];return t[0]=a*P+s*M+n*b-o*v,t[1]=n*P+s*v+o*M-a*b,t[2]=o*P+s*b+a*v-n*M,t[3]=s*P-a*M-n*v-o*b,t[4]=a*c+s*u+n*i-o*p+f*P+l*M+x*b-h*v,t[5]=n*c+s*p+o*u-a*i+x*P+l*v+h*M-f*b,t[6]=o*c+s*i+a*p-n*u+h*P+l*b+f*v-x*M,t[7]=s*c-a*u-n*p-o*i+l*P-f*M-x*v-h*b,t}exports.setReal=P;var j=q;function T(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t}exports.mul=j;var _=r.dot;function w(t,r,e,a){var n=1-a;return _(r,e)<0&&(a=-a),t[0]=r[0]*n+e[0]*a,t[1]=r[1]*n+e[1]*a,t[2]=r[2]*n+e[2]*a,t[3]=r[3]*n+e[3]*a,t[4]=r[4]*n+e[4]*a,t[5]=r[5]*n+e[5]*a,t[6]=r[6]*n+e[6]*a,t[7]=r[7]*n+e[7]*a,t}function I(t,r){var e=k(r);return t[0]=-r[0]/e,t[1]=-r[1]/e,t[2]=-r[2]/e,t[3]=r[3]/e,t[4]=-r[4]/e,t[5]=-r[5]/e,t[6]=-r[6]/e,t[7]=r[7]/e,t}function N(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t[4]=-r[4],t[5]=-r[5],t[6]=-r[6],t[7]=r[7],t}exports.dot=_;var S=r.length;exports.length=S;var D=S;exports.len=D;var k=r.squaredLength;exports.squaredLength=k;var B=k;function Q(t,r){var e=k(r);if(e>0){e=Math.sqrt(e);var a=r[0]/e,n=r[1]/e,o=r[2]/e,s=r[3]/e,u=r[4],p=r[5],i=r[6],c=r[7],f=a*u+n*p+o*i+s*c;t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=(u-a*f)/e,t[5]=(p-n*f)/e,t[6]=(i-o*f)/e,t[7]=(c-s*f)/e}return t}function V(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function W(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]}function X(r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],c=r[7],f=e[0],x=e[1],h=e[2],l=e[3],M=e[4],v=e[5],b=e[6],P=e[7];return Math.abs(a-f)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(n-x)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-l)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(u-M)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(p-v)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(v))&&Math.abs(i-b)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(c-P)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(P))}exports.sqrLen=B;
},{"./common.js":"W43s","./quat.js":"AJB2","./mat4.js":"c4g7"}],"RpzK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.fromValues=a,exports.copy=u,exports.set=s,exports.add=i,exports.subtract=c,exports.multiply=p,exports.divide=f,exports.ceil=x,exports.floor=h,exports.min=v,exports.max=M,exports.round=l,exports.scale=d,exports.scaleAndAdd=m,exports.distance=b,exports.squaredDistance=y,exports.length=P,exports.squaredLength=q,exports.negate=A,exports.inverse=O,exports.normalize=g,exports.dot=E,exports.cross=R,exports.lerp=j,exports.random=Y,exports.transformMat2=_,exports.transformMat2d=w,exports.transformMat3=D,exports.transformMat4=L,exports.rotate=T,exports.angle=I,exports.zero=N,exports.str=k,exports.exactEquals=z,exports.equals=S,exports.forEach=exports.sqrLen=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=exports.len=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function o(r){var e=new t.ARRAY_TYPE(2);return e[0]=r[0],e[1]=r[1],e}function a(r,e){var n=new t.ARRAY_TYPE(2);return n[0]=r,n[1]=e,n}function u(t,r){return t[0]=r[0],t[1]=r[1],t}function s(t,r,e){return t[0]=r,t[1]=e,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t}function c(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t}function p(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t}function f(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t}function h(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t}function v(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t}function M(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t}function l(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1];return Math.hypot(e,n)}function y(t,r){var e=r[0]-t[0],n=r[1]-t[1];return e*e+n*n}function P(t){var r=t[0],e=t[1];return Math.hypot(r,e)}function q(t){var r=t[0],e=t[1];return r*r+e*e}function A(t,r){return t[0]=-r[0],t[1]=-r[1],t}function O(t,r){return t[0]=1/r[0],t[1]=1/r[1],t}function g(t,r){var e=r[0],n=r[1],o=e*e+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=r[0]*o,t[1]=r[1]*o,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]}function R(t,r,e){var n=r[0]*e[1]-r[1]*e[0];return t[0]=t[1]=0,t[2]=n,t}function j(t,r,e,n){var o=r[0],a=r[1];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t}function Y(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI;return r[0]=Math.cos(n)*e,r[1]=Math.sin(n)*e,r}function _(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o,t[1]=e[1]*n+e[3]*o,t}function w(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o+e[4],t[1]=e[1]*n+e[3]*o+e[5],t}function D(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[3]*o+e[6],t[1]=e[1]*n+e[4]*o+e[7],t}function L(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[4]*o+e[12],t[1]=e[1]*n+e[5]*o+e[13],t}function T(t,r,e,n){var o=r[0]-e[0],a=r[1]-e[1],u=Math.sin(n),s=Math.cos(n);return t[0]=o*s-a*u+e[0],t[1]=o*u+a*s+e[1],t}function I(t,r){var e=t[0],n=t[1],o=r[0],a=r[1],u=Math.sqrt(e*e+n*n)*Math.sqrt(o*o+a*a),s=u&&(e*o+n*a)/u;return Math.acos(Math.min(Math.max(s,-1),1))}function N(t){return t[0]=0,t[1]=0,t}function k(t){return"vec2("+t[0]+", "+t[1]+")"}function z(t,r){return t[0]===r[0]&&t[1]===r[1]}function S(r,e){var n=r[0],o=r[1],a=e[0],u=e[1];return Math.abs(n-a)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))}var W=P;exports.len=W;var F=c;exports.sub=F;var V=p;exports.mul=V;var B=f;exports.div=B;var C=b;exports.dist=C;var G=y;exports.sqrDist=G;var H=q;exports.sqrLen=H;var J=function(){var t=n();return function(r,e,n,o,a,u){var s,i;for(e||(e=2),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,s=n;s<i;s+=e)t[0]=r[s],t[1]=r[s+1],a(t,t,u),r[s]=t[0],r[s+1]=t[1];return r}}();exports.forEach=J;
},{"./common.js":"W43s"}],"MVBX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec4=exports.vec3=exports.vec2=exports.quat2=exports.quat=exports.mat4=exports.mat3=exports.mat2d=exports.mat2=exports.glMatrix=void 0;var e=v(require("./common.js"));exports.glMatrix=e;var r=v(require("./mat2.js"));exports.mat2=r;var t=v(require("./mat2d.js"));exports.mat2d=t;var o=v(require("./mat3.js"));exports.mat3=o;var a=v(require("./mat4.js"));exports.mat4=a;var s=v(require("./quat.js"));exports.quat=s;var u=v(require("./quat2.js"));exports.quat2=u;var p=v(require("./vec2.js"));exports.vec2=p;var i=v(require("./vec3.js"));exports.vec3=i;var n=v(require("./vec4.js"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function v(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c();if(r&&r.has(e))return r.get(e);var t={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(t,a,s):t[a]=e[a]}return t.default=e,r&&r.set(e,t),t}exports.vec4=n;
},{"./common.js":"W43s","./mat2.js":"Ax7R","./mat2d.js":"GxfJ","./mat3.js":"ezba","./mat4.js":"c4g7","./quat.js":"AJB2","./quat2.js":"Kq3q","./vec2.js":"RpzK","./vec3.js":"d0Px","./vec4.js":"vUkg"}],"GUc7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.g_camera=exports.Camera=void 0;const t=require("@box2d/core"),e=require("gl-matrix"),i=[0,-1,0],h=[0,0,1],s=e.vec3.create(),o={x:0,y:0};function r(t,e,i,h){const s=1/(t*i[3]+e*i[7]+i[15]);h.x=(t*i[0]+e*i[4]+i[12])*s,h.y=(t*i[1]+e*i[5]+i[13])*s}class n{constructor(){this.center=new t.b2Vec2(0,20),this.zoom=1,this.projection=e.mat4.create(),this.modelView=e.mat4.create(),this.combined=e.mat4.create(),this.inverse=e.mat4.create(),this.width=0,this.height=0}getZoom(){return this.zoom}getCenter(){return this.center}getWidth(){return this.width}getHeight(){return this.height}update(){const t=1/(2*this.zoom),o=this.width*t,r=this.height*t;e.mat4.ortho(this.projection,-o,o,r,-r,0,1e4);const n=[this.center.x,this.center.y,0];e.mat4.lookAt(this.modelView,n,e.vec3.add(s,n,h),i),e.mat4.mul(this.combined,this.projection,this.modelView),e.mat4.invert(this.inverse,this.combined)}resize(t,e){this.width=t,this.height=e,this.update()}setPositionAndZoom(t,e,i){this.center.Set(t,e),this.zoom=i,this.update()}setPosition(t,e){this.center.Set(t,e),this.update()}setZoom(t){this.zoom=t,this.update()}project(t,e){return r(t.x,t.y,this.combined,o),e.x=this.width*(o.x+1)/2,e.y=this.height-this.height*(o.y+1)/2,e}unproject({x:t,y:e},i){return r(2*t/this.width-1,2*(this.height-e)/this.height-1,this.inverse,i),i}}exports.Camera=n,exports.g_camera=new n;
},{"@box2d/core":"FjWk","gl-matrix":"MVBX"}],"EV9t":[function(require,module,exports) {
"use strict";function e(e,t,o,r=!1){return{key:e,description:t,callback:o,step:r}}function t(t,o,r){return e(t,o,e=>{e&&r()})}function o(t,o,r){return e(t,o,e=>{e||r()})}function r(t,o,r){return e(t,o,r,!0)}function s(t,o,r,s){return e(t,o,e=>{r[s]=e})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.hotKeyState=exports.hotKeyStep=exports.hotKeyRelease=exports.hotKeyPress=exports.hotKey=void 0,exports.hotKey=e,exports.hotKeyPress=t,exports.hotKeyRelease=o,exports.hotKeyStep=r,exports.hotKeyState=s;
},{}],"hiWW":[function(require,module,exports) {
module.exports="marble.99140e9f.png";
},{}],"ptES":[function(require,module,exports) {
module.exports="bg.384e68d4.png";
},{}],"QiTb":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.preloadTextures=exports.loadImages=void 0;const t=e(require("../../images/marble.png")),r=e(require("../../images/bg.png")),a={marble:t.default,bg:r.default};async function T(e,t){const r={},a=Object.keys(t).map(a=>new Promise(T=>{const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);const i=new Image,E={width:0,height:0,texture:s};i.onload=(()=>{E.width=i.width,E.height=i.height,e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),T()}),i.src=t[a],r[a]=E}));return await Promise.all(a),r}exports.loadImages=T;const s=e=>T(e,a);exports.preloadTextures=s;
},{"../../images/marble.png":"hiWW","../../images/bg.png":"ptES"}],"S7Lm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.factoriesGl1=void 0,exports.factoriesGl1={uniform1f:(t,i)=>({location:i,set:r=>t.uniform1f(i,r),setV:r=>t.uniform1fv(i,r)}),uniform2f:(t,i)=>({location:i,set:(r,e)=>t.uniform2f(i,r,e),setV:r=>t.uniform2fv(i,r)}),uniform3f:(t,i)=>({location:i,set:(r,e,o)=>t.uniform3f(i,r,e,o),setV:r=>t.uniform3fv(i,r)}),uniform4f:(t,i)=>({location:i,set:(r,e,o,f)=>t.uniform4f(i,r,e,o,f),setV:r=>t.uniform4fv(i,r)}),uniform1i:(t,i)=>({location:i,set:r=>t.uniform1i(i,r),setV:r=>t.uniform1iv(i,r)}),uniform2i:(t,i)=>({location:i,set:(r,e)=>t.uniform2i(i,r,e),setV:r=>t.uniform2iv(i,r)}),uniform3i:(t,i)=>({location:i,set:(r,e,o)=>t.uniform3i(i,r,e,o),setV:r=>t.uniform3iv(i,r)}),uniform4i:(t,i)=>({location:i,set:(r,e,o,f)=>t.uniform4i(i,r,e,o,f),setV:r=>t.uniform4iv(i,r)}),uniformMatrix2f:(t,i)=>({location:i,set:(r,e)=>t.uniformMatrix2fv(i,r,e)}),uniformMatrix3f:(t,i)=>({location:i,set:(r,e)=>t.uniformMatrix3fv(i,r,e)}),uniformMatrix4f:(t,i)=>({location:i,set:(r,e)=>t.uniformMatrix4fv(i,r,e)}),vertexAttrib1f:(t,i)=>({location:i,set:r=>t.vertexAttrib1f(i,r),setV:r=>t.vertexAttrib1fv(i,r)}),vertexAttrib2f:(t,i)=>({location:i,set:(r,e)=>t.vertexAttrib2f(i,r,e),setV:r=>t.vertexAttrib2fv(i,r)}),vertexAttrib3f:(t,i)=>({location:i,set:(r,e,o)=>t.vertexAttrib3f(i,r,e,o),setV:r=>t.vertexAttrib3fv(i,r)}),vertexAttrib4f:(t,i)=>({location:i,set:(r,e,o,f)=>t.vertexAttrib4f(i,r,e,o,f),setV:r=>t.vertexAttrib4fv(i,r)}),vertexAttribPointer:(t,i)=>({location:i,enable:()=>t.enableVertexAttribArray(i),disable:()=>t.disableVertexAttribArray(i),set:(r,e,o,f,n)=>t.vertexAttribPointer(i,r,e,o,f,n)})};
},{}],"hfIE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.factoriesGl2=void 0;const i=require("./webgl1");exports.factoriesGl2=Object.assign(Object.assign({},i.factoriesGl1),{uniform1ui:(i,t)=>({location:t,set:r=>i.uniform1ui(t,r),setV:(r,e,o)=>i.uniform1uiv(t,r,e,o)}),uniform2ui:(i,t)=>({location:t,set:(r,e)=>i.uniform2ui(t,r,e),setV:(r,e,o)=>i.uniform2uiv(t,r,e,o)}),uniform3ui:(i,t)=>({location:t,set:(r,e,o)=>i.uniform3ui(t,r,e,o),setV:(r,e,o)=>i.uniform3uiv(t,r,e,o)}),uniform4ui:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniform4ui(t,r,e,o,n),setV:(r,e,o)=>i.uniform4uiv(t,r,e,o)}),uniformMatrix2x3f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix2x3fv(t,r,e,o,n)}),uniformMatrix2x4f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix2x4fv(t,r,e,o,n)}),uniformMatrix3x2f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix3x2fv(t,r,e,o,n)}),uniformMatrix3x4f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix3x4fv(t,r,e,o,n)}),uniformMatrix4x2f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix4x2fv(t,r,e,o,n)}),uniformMatrix4x3f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix4x3fv(t,r,e,o,n)}),vertexAttribDivisor:(i,t)=>({location:t,set:r=>i.vertexAttribDivisor(t,r)}),vertexAttribI4i:(i,t)=>({location:t,set:(r,e,o,n)=>i.vertexAttribI4i(t,r,e,o,n),setV:r=>i.vertexAttribI4iv(t,r)}),vertexAttribI4ui:(i,t)=>({location:t,set:(r,e,o,n)=>i.vertexAttribI4ui(t,r,e,o,n),setV:r=>i.vertexAttribI4uiv(t,r)}),vertexAttribIPointer:(i,t)=>({location:t,enable:()=>i.enableVertexAttribArray(t),disable:()=>i.disableVertexAttribArray(t),set:(r,e,o,n)=>i.vertexAttribIPointer(t,r,e,o,n)})});
},{"./webgl1":"S7Lm"}],"DjuP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createShaderProgram=exports.glsl=void 0;const e=require("./webgl2");function r(e,...r){let t="";for(let o=0;o<r.length;o++)t+=e[o],t+=r[o];return t.replace(/^[\r\n]+/,"")+e[e.length-1]}function t(e,r,t,o){const a=e.createShader(t);return e.shaderSource(a,o),e.compileShader(a),e.attachShader(r,a),a}function o(r,o,a,s){const n=r.createProgram(),c={},l=t(r,n,r.VERTEX_SHADER,o),i=t(r,n,r.FRAGMENT_SHADER,a);r.linkProgram(n),r.useProgram(n);for(const t of Object.keys(s)){const o=s[t],a=e.factoriesGl2[o];if(!a)throw new Error(`Can't handle ${o}!`);const l=o.startsWith("uniform")?r.getUniformLocation(n,t):r.getAttribLocation(n,t);c[t]=a(r,l)}return Object.assign(Object.assign({},c),{use(){r.useProgram(n)},dispose(){r.useProgram(null),r.deleteShader(i),r.deleteShader(l),r.deleteProgram(n)}})}exports.glsl=r,exports.createShaderProgram=o;
},{"./webgl2":"hfIE"}],"isif":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDefaultShader=void 0;const t=require("typed-glsl"),r=t.glsl`
attribute vec2 position;
attribute vec2 uv;
varying vec2 vUV;

uniform mat4 uMVMatrix;
uniform mat4 uPMatrix;

void main() {
    vUV = uv;
    gl_Position = uPMatrix * uMVMatrix * vec4(position, 500.0, 1.0);
}
`,e=t.glsl`
precision highp float;
varying vec2 vUV;
uniform float opacity;
uniform sampler2D textureID;
uniform vec2 uvOffset;

void main() {
    gl_FragColor = texture2D(textureID, vUV + uvOffset);
    gl_FragColor.w *= opacity;
}
`;function i(i){return(0,t.createShaderProgram)(i,r,e,{position:"vertexAttribPointer",uv:"vertexAttribPointer",uMVMatrix:"uniformMatrix4f",uPMatrix:"uniformMatrix4f",textureID:"uniform1i",opacity:"uniform1f",uvOffset:"uniform2f"})}exports.createDefaultShader=i;
},{"typed-glsl":"DjuP"}],"FFRI":[function(require,module,exports) {
"use strict";function e(e){const n=e.getContext("webgl");return n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE),n.enable(n.BLEND),t(e,n,e.clientWidth,e.clientHeight),n}function t(e,t,n,r){e.width=n,e.height=r,t.viewport(0,0,n,r)}function n(e,t,n,r,a){e.clearColor(t,n,r,a),e.clear(e.COLOR_BUFFER_BIT)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.clearGlCanvas=exports.resizeGlCanvas=exports.initGlCanvas=void 0,exports.initGlCanvas=e,exports.resizeGlCanvas=t,exports.clearGlCanvas=n;
},{}],"UVin":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2_barrierCollisionTime=exports.b2_minParticleSystemBufferCapacity=exports.b2_maxTriadDistanceSquared=exports.b2_maxTriadDistance=exports.b2_maxParticleForce=exports.b2_maxParticlePressure=exports.b2_minParticleWeight=exports.b2_particleStride=exports.b2_maxParticleIndex=exports.b2_invalidParticleIndex=void 0,exports.b2_invalidParticleIndex=-1,exports.b2_maxParticleIndex=2147483647,exports.b2_particleStride=.75,exports.b2_minParticleWeight=1,exports.b2_maxParticlePressure=.25,exports.b2_maxParticleForce=.5,exports.b2_maxTriadDistance=2,exports.b2_maxTriadDistanceSquared=exports.b2_maxTriadDistance*exports.b2_maxTriadDistance,exports.b2_minParticleSystemBufferCapacity=256,exports.b2_barrierCollisionTime=2.5;
},{}],"WnZB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ParticleHandle=exports.b2CalculateParticleIterations=exports.b2ParticleDef=exports.b2ParticleFlag=void 0;const e=require("@box2d/core"),t=require("./b2_settings");var r;!function(e){e[e.b2_waterParticle=0]="b2_waterParticle",e[e.b2_zombieParticle=2]="b2_zombieParticle",e[e.b2_wallParticle=4]="b2_wallParticle",e[e.b2_springParticle=8]="b2_springParticle",e[e.b2_elasticParticle=16]="b2_elasticParticle",e[e.b2_viscousParticle=32]="b2_viscousParticle",e[e.b2_powderParticle=64]="b2_powderParticle",e[e.b2_tensileParticle=128]="b2_tensileParticle",e[e.b2_colorMixingParticle=256]="b2_colorMixingParticle",e[e.b2_destructionListenerParticle=512]="b2_destructionListenerParticle",e[e.b2_barrierParticle=1024]="b2_barrierParticle",e[e.b2_staticPressureParticle=2048]="b2_staticPressureParticle",e[e.b2_reactiveParticle=4096]="b2_reactiveParticle",e[e.b2_repulsiveParticle=8192]="b2_repulsiveParticle",e[e.b2_fixtureContactListenerParticle=16384]="b2_fixtureContactListenerParticle",e[e.b2_particleContactListenerParticle=32768]="b2_particleContactListenerParticle",e[e.b2_fixtureContactFilterParticle=65536]="b2_fixtureContactFilterParticle",e[e.b2_particleContactFilterParticle=131072]="b2_particleContactFilterParticle"}(r=exports.b2ParticleFlag||(exports.b2ParticleFlag={}));class i{constructor(){this.flags=0,this.position=new e.b2Vec2,this.velocity=new e.b2Vec2,this.color=new e.b2Color(0,0,0,0),this.lifetime=0,this.userData=null,this.group=null}}function a(t,r,i){const a=Math.ceil(Math.sqrt(t/(.01*r))*i);return(0,e.b2Clamp)(a,1,8)}exports.b2ParticleDef=i,exports.b2CalculateParticleIterations=a;class l{constructor(){this.m_index=t.b2_invalidParticleIndex}GetIndex(){return this.m_index}SetIndex(e){this.m_index=e}}exports.b2ParticleHandle=l;
},{"@box2d/core":"FjWk","./b2_settings":"UVin"}],"T8II":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ParticleGroup=exports.b2ParticleGroupDef=exports.b2ParticleGroupFlag=void 0;const t=require("@box2d/core");var e;!function(t){t[t.b2_solidParticleGroup=1]="b2_solidParticleGroup",t[t.b2_rigidParticleGroup=2]="b2_rigidParticleGroup",t[t.b2_particleGroupCanBeEmpty=4]="b2_particleGroupCanBeEmpty",t[t.b2_particleGroupWillBeDestroyed=8]="b2_particleGroupWillBeDestroyed",t[t.b2_particleGroupNeedsUpdateDepth=16]="b2_particleGroupNeedsUpdateDepth",t[t.b2_particleGroupInternalMask=24]="b2_particleGroupInternalMask"}(e=exports.b2ParticleGroupFlag||(exports.b2ParticleGroupFlag={}));class s{constructor(){this.flags=0,this.groupFlags=0,this.position=new t.b2Vec2,this.angle=0,this.linearVelocity=new t.b2Vec2,this.angularVelocity=0,this.color=new t.b2Color,this.strength=1,this.shapeCount=0,this.stride=0,this.particleCount=0,this.lifetime=0,this.userData=null,this.group=null}}exports.b2ParticleGroupDef=s;class i{constructor(e){this.m_firstIndex=0,this.m_lastIndex=0,this.m_groupFlags=0,this.m_strength=1,this.m_prev=null,this.m_next=null,this.m_timestamp=-1,this.m_mass=0,this.m_inertia=0,this.m_center=new t.b2Vec2,this.m_linearVelocity=new t.b2Vec2,this.m_angularVelocity=0,this.m_transform=new t.b2Transform,this.m_userData=null,this.m_system=e}GetNext(){return this.m_next}GetParticleSystem(){return this.m_system}GetParticleCount(){return this.m_lastIndex-this.m_firstIndex}GetBufferIndex(){return this.m_firstIndex}ContainsParticle(t){return this.m_firstIndex<=t&&t<this.m_lastIndex}GetAllParticleFlags(){(0,t.b2Assert)(null!==this.m_system.m_flagsBuffer.data);let e=0;for(let t=this.m_firstIndex;t<this.m_lastIndex;t++)e|=this.m_system.m_flagsBuffer.data[t];return e}GetGroupFlags(){return this.m_groupFlags}SetGroupFlags(t){t|=this.m_groupFlags&e.b2_particleGroupInternalMask,this.m_system.SetGroupFlags(this,t)}GetMass(){return this.UpdateStatistics(),this.m_mass}GetInertia(){return this.UpdateStatistics(),this.m_inertia}GetCenter(){return this.UpdateStatistics(),this.m_center}GetLinearVelocity(){return this.UpdateStatistics(),this.m_linearVelocity}GetAngularVelocity(){return this.UpdateStatistics(),this.m_angularVelocity}GetTransform(){return this.m_transform}GetPosition(){return this.m_transform.p}GetAngle(){return this.m_transform.q.GetAngle()}GetLinearVelocityFromWorldPoint(e,s){const r=i.GetLinearVelocityFromWorldPoint_s_t0;return this.UpdateStatistics(),t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(e,this.m_center,r),s)}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}ApplyForce(t){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,t)}ApplyLinearImpulse(t){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,t)}DestroyParticles(e){(0,t.b2Assert)(!this.m_system.m_world.IsLocked());for(let t=this.m_firstIndex;t<this.m_lastIndex;t++)this.m_system.DestroyParticle(t,e)}UpdateStatistics(){(0,t.b2Assert)(null!==this.m_system.m_positionBuffer.data),(0,t.b2Assert)(null!==this.m_system.m_velocityBuffer.data);const e=new t.b2Vec2,s=new t.b2Vec2;if(this.m_timestamp!==this.m_system.m_timestamp){const i=this.m_system.GetParticleMass();this.m_mass=i*(this.m_lastIndex-this.m_firstIndex),this.m_center.SetZero(),this.m_linearVelocity.SetZero();for(let t=this.m_firstIndex;t<this.m_lastIndex;t++)this.m_center.AddScaled(i,this.m_system.m_positionBuffer.data[t]),this.m_linearVelocity.AddScaled(i,this.m_system.m_velocityBuffer.data[t]);if(this.m_mass>0){const t=1/this.m_mass;this.m_center.Scale(t),this.m_linearVelocity.Scale(t)}this.m_inertia=0,this.m_angularVelocity=0;for(let r=this.m_firstIndex;r<this.m_lastIndex;r++)t.b2Vec2.Subtract(this.m_system.m_positionBuffer.data[r],this.m_center,e),t.b2Vec2.Subtract(this.m_system.m_velocityBuffer.data[r],this.m_linearVelocity,s),this.m_inertia+=i*t.b2Vec2.Dot(e,e),this.m_angularVelocity+=i*t.b2Vec2.Cross(e,s);this.m_inertia>0&&(this.m_angularVelocity*=1/this.m_inertia),this.m_timestamp=this.m_system.m_timestamp}}}exports.b2ParticleGroup=i,i.GetLinearVelocityFromWorldPoint_s_t0=new t.b2Vec2;
},{"@box2d/core":"FjWk"}],"JKs5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2StackQueue=void 0;const t=require("@box2d/core");class s{constructor(t){this.m_buffer=[],this.m_front=0,this.m_back=0,this.m_buffer.fill(null,0,t)}get m_capacity(){return this.m_buffer.length}Push(t){if(this.m_back>=this.m_capacity){for(let t=this.m_front;t<this.m_back;t++)this.m_buffer[t-this.m_front]=this.m_buffer[t];this.m_back-=this.m_front,this.m_front=0}this.m_buffer[this.m_back]=t,this.m_back++}Pop(){this.m_buffer[this.m_front]=null,this.m_front++}Empty(){return this.m_front===this.m_back}Front(){const s=this.m_buffer[this.m_front];return(0,t.b2Assert)(null!==s),s}}exports.b2StackQueue=s;
},{"@box2d/core":"FjWk"}],"fvR8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2VoronoiDiagram_Task=exports.b2VoronoiDiagram_Generator=exports.b2VoronoiDiagram=void 0;const t=require("@box2d/core"),e=require("./b2_stack_queue");class o{constructor(t){this.m_generatorCapacity=0,this.m_generatorCount=0,this.m_countX=0,this.m_countY=0,this.m_diagram=[],this.m_generatorBuffer=new Array(t);for(let e=0;e<t;e++)this.m_generatorBuffer[e]=new s;this.m_generatorCapacity=t}AddGenerator(t,e,o){const s=this.m_generatorBuffer[this.m_generatorCount++];s.center.Copy(t),s.tag=e,s.necessary=o}Generate(o,s){const n=1/o,i=new t.b2Vec2(+t.b2_maxFloat,+t.b2_maxFloat),a=new t.b2Vec2(-t.b2_maxFloat,-t.b2_maxFloat);let m=0;for(let e=0;e<this.m_generatorCount;e++){const o=this.m_generatorBuffer[e];o.necessary&&(t.b2Vec2.Min(i,o.center,i),t.b2Vec2.Max(a,o.center,a),++m)}if(0===m)return this.m_countX=0,void(this.m_countY=0);i.x-=s,i.y-=s,a.x+=s,a.y+=s,this.m_countX=1+Math.floor(n*(a.x-i.x)),this.m_countY=1+Math.floor(n*(a.y-i.y)),this.m_diagram=[];const c=new e.b2StackQueue(4*this.m_countX*this.m_countY);for(let t=0;t<this.m_generatorCount;t++){const e=this.m_generatorBuffer[t];e.center.Subtract(i).Scale(n);const o=Math.floor(e.center.x),s=Math.floor(e.center.y);o>=0&&s>=0&&o<this.m_countX&&s<this.m_countY&&c.Push(new r(o,s,o+s*this.m_countX,e))}for(;!c.Empty();){const t=c.Front(),e=t.m_x,o=t.m_y,s=t.m_i,n=t.m_generator;c.Pop(),this.m_diagram[s]||(this.m_diagram[s]=n,e>0&&c.Push(new r(e-1,o,s-1,n)),o>0&&c.Push(new r(e,o-1,s-this.m_countX,n)),e<this.m_countX-1&&c.Push(new r(e+1,o,s+1,n)),o<this.m_countY-1&&c.Push(new r(e,o+1,s+this.m_countX,n)))}for(let t=0;t<this.m_countY;t++)for(let e=0;e<this.m_countX-1;e++){const o=e+t*this.m_countX,s=this.m_diagram[o],n=this.m_diagram[o+1];s!==n&&(c.Push(new r(e,t,o,n)),c.Push(new r(e+1,t,o+1,s)))}for(let t=0;t<this.m_countY-1;t++)for(let e=0;e<this.m_countX;e++){const o=e+t*this.m_countX,s=this.m_diagram[o],n=this.m_diagram[o+this.m_countX];s!==n&&(c.Push(new r(e,t,o,n)),c.Push(new r(e,t+1,o+this.m_countX,s)))}for(;!c.Empty();){const t=c.Front(),e=t.m_x,o=t.m_y,s=t.m_i,n=t.m_generator;c.Pop();const i=this.m_diagram[s],a=n;if(i!==a){const t=i.center.x-e,n=i.center.y-o,m=a.center.x-e,h=a.center.y-o;t*t+n*n>m*m+h*h&&(this.m_diagram[s]=a,e>0&&c.Push(new r(e-1,o,s-1,a)),o>0&&c.Push(new r(e,o-1,s-this.m_countX,a)),e<this.m_countX-1&&c.Push(new r(e+1,o,s+1,a)),o<this.m_countY-1&&c.Push(new r(e,o+1,s+this.m_countX,a)))}}}GetNodes(t){for(let e=0;e<this.m_countY-1;e++)for(let o=0;o<this.m_countX-1;o++){const s=o+e*this.m_countX,r=this.m_diagram[s],n=this.m_diagram[s+1],i=this.m_diagram[s+this.m_countX],a=this.m_diagram[s+1+this.m_countX];n!==i&&(r!==n&&r!==i&&(r.necessary||n.necessary||i.necessary)&&t(r.tag,n.tag,i.tag),a!==n&&a!==i&&(r.necessary||n.necessary||i.necessary)&&t(n.tag,a.tag,i.tag))}}}exports.b2VoronoiDiagram=o;class s{constructor(){this.center=new t.b2Vec2,this.tag=0,this.necessary=!1}}exports.b2VoronoiDiagram_Generator=s;class r{constructor(t,e,o,s){this.m_x=t,this.m_y=e,this.m_i=o,this.m_generator=s}}exports.b2VoronoiDiagram_Task=r;
},{"@box2d/core":"FjWk","./b2_stack_queue":"JKs5"}],"ql9o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeDistance=void 0;const e=require("@box2d/core"),t=new e.b2EdgeShape,c=new e.b2Vec2,r=new e.b2Vec2,o=new e.b2Vec2,n=new e.b2Vec2,b=new e.b2Vec2,s=new e.b2Vec2,a=new e.b2Vec2,u=new e.b2Vec2,l=new e.b2Vec2,V=[(t,c,r,o)=>{const n=e.b2Transform.MultiplyVec2(c,t.m_p,l);return e.b2Vec2.Subtract(r,n,o),o.Normalize()-t.m_radius},(t,c,r,o)=>{const n=e.b2Transform.MultiplyVec2(c,t.m_vertex1,b),l=e.b2Transform.MultiplyVec2(c,t.m_vertex2,s),V=e.b2Vec2.Subtract(r,n,a),p=e.b2Vec2.Subtract(l,n,u),m=e.b2Vec2.Dot(V,p);if(m>0){const t=e.b2Vec2.Dot(p,p);m>t?e.b2Vec2.Subtract(r,l,V):V.SubtractScaled(m/t,p)}return o.Copy(V),o.Normalize()},(t,b,s,a)=>{const u=e.b2Transform.TransposeMultiplyVec2(b,s,c);let l=-e.b2_maxFloat;const V=r.Copy(u);for(let c=0;c<t.m_count;++c){const r=e.b2Vec2.Dot(t.m_normals[c],e.b2Vec2.Subtract(u,t.m_vertices[c],e.b2Vec2.s_t0));r>l&&(l=r,V.Copy(t.m_normals[c]))}if(l>0){const c=o.Copy(V);let r=l*l;for(let o=0;o<t.m_count;++o){const b=e.b2Vec2.Subtract(u,t.m_vertices[o],n),s=b.LengthSquared();r>s&&(c.Copy(b),r=s)}return e.b2Rot.MultiplyVec2(b.q,c,a),a.Normalize(),Math.sqrt(r)}return e.b2Rot.MultiplyVec2(b.q,V,a),l},(c,r,o,n,b)=>(c.GetChildEdge(t,b),V[e.b2ShapeType.e_edge](t,r,o,n,0))],p=(e,t,c,r,o)=>{const n=V[e.GetType()];return n?n(e,t,c,r,o):0};exports.computeDistance=p;
},{"@box2d/core":"FjWk"}],"SHy1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ParticleSystem_SolveCollisionCallback=exports.b2ParticleSystem_UpdateBodyContactsCallback=exports.b2FixtureParticleQueryCallback=void 0;const t=require("@box2d/core"),e=require("./b2_compute_distance"),r=require("./b2_particle");class s{constructor(t){this.m_system=t}ReportFixture(t){if(t.IsSensor())return!0;const e=t.GetShape().GetChildCount();for(let r=0;r<e;r++){const e=t.GetAABB(r),s=this.m_system.GetInsideBoundsEnumerator(e);let i;for(;(i=s.GetNext())>=0;)this.ReportFixtureAndParticle(t,r,i)}return!0}}exports.b2FixtureParticleQueryCallback=s;class i extends s{constructor(){super(...arguments),this.m_contactFilter=null}ShouldCollideFixtureParticle(t,e){if(this.m_contactFilter){if(this.m_system.GetFlagsBuffer()[e]&r.b2ParticleFlag.b2_fixtureContactFilterParticle)return this.m_contactFilter.ShouldCollideFixtureParticle(t,this.m_system,e)}return!0}ReportFixtureAndParticle(s,a,o){const c=i.ReportFixtureAndParticle_s_n,l=i.ReportFixtureAndParticle_s_rp,n=this.m_system.m_positionBuffer.data[o],_=c,p=(0,e.computeDistance)(s.GetShape(),s.GetBody().GetTransform(),n,_,a);if(p<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(s,o)){const e=s.GetBody(),i=e.GetWorldCenter(),a=e.GetMass(),c=e.GetInertia()-a*e.GetLocalCenter().LengthSquared(),u=a>0?1/a:0,m=c>0?1/c:0,d=this.m_system.m_flagsBuffer.data[o]&r.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),y=t.b2Vec2.Subtract(n,i,l),x=t.b2Vec2.Cross(y,_),b=d+u+m*x*x,f=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];f.index=o,f.body=e,f.fixture=s,f.weight=1-p*this.m_system.m_inverseDiameter,f.normal.Copy(_.Negate()),f.mass=b>0?1/b:0,this.m_system.DetectStuckParticle(o)}}}exports.b2ParticleSystem_UpdateBodyContactsCallback=i,i.ReportFixtureAndParticle_s_n=new t.b2Vec2,i.ReportFixtureAndParticle_s_rp=new t.b2Vec2;class a extends s{constructor(){super(...arguments),this.m_step=null}ReportFixtureAndParticle(e,r,s){const i=a.ReportFixtureAndParticle_s_p1,o=a.ReportFixtureAndParticle_s_output,c=a.ReportFixtureAndParticle_s_input,l=a.ReportFixtureAndParticle_s_p,n=a.ReportFixtureAndParticle_s_v,_=a.ReportFixtureAndParticle_s_f,p=e.GetBody(),u=this.m_system.m_positionBuffer.data[s],m=this.m_system.m_velocityBuffer.data[s],d=o,y=c;if(0===this.m_system.m_iterationIndex){const r=p.GetTransform(),s=t.b2Transform.TransposeMultiplyVec2(p.m_xf0,u,i);e.GetShape().GetType()===t.b2ShapeType.e_circle&&(s.Subtract(p.GetLocalCenter()),t.b2Rot.MultiplyVec2(p.m_xf0.q,s,s),t.b2Rot.TransposeMultiplyVec2(r.q,s,s),s.Add(p.GetLocalCenter())),t.b2Transform.MultiplyVec2(r,s,y.p1)}else y.p1.Copy(u);const x=(0,t.b2Verify)(this.m_step);if(t.b2Vec2.AddScaled(u,x.dt,m,y.p2),y.maxFraction=1,e.RayCast(d,y,r)){const e=d.normal,r=l;r.x=(1-d.fraction)*y.p1.x+d.fraction*y.p2.x+t.b2_linearSlop*e.x,r.y=(1-d.fraction)*y.p1.y+d.fraction*y.p2.y+t.b2_linearSlop*e.y;const i=n;i.x=x.inv_dt*(r.x-u.x),i.y=x.inv_dt*(r.y-u.y),this.m_system.m_velocityBuffer.data[s].Copy(i);const a=_;a.x=x.inv_dt*this.m_system.GetParticleMass()*(m.x-i.x),a.y=x.inv_dt*this.m_system.GetParticleMass()*(m.y-i.y),this.m_system.ParticleApplyForce(s,a)}}}exports.b2ParticleSystem_SolveCollisionCallback=a,a.ReportFixtureAndParticle_s_p1=new t.b2Vec2,a.ReportFixtureAndParticle_s_output=new t.b2RayCastOutput,a.ReportFixtureAndParticle_s_input=new t.b2RayCastInput,a.ReportFixtureAndParticle_s_p=new t.b2Vec2,a.ReportFixtureAndParticle_s_v=new t.b2Vec2,a.ReportFixtureAndParticle_s_f=new t.b2Vec2;
},{"@box2d/core":"FjWk","./b2_compute_distance":"ql9o","./b2_particle":"WnZB"}],"SMjx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ParticleSystem_ReactiveFilter=exports.b2ParticleSystem_CompositeShape=exports.b2ParticleSystem_JoinParticleGroupsFilter=exports.b2ParticleSystem_ConnectionFilter=exports.b2ParticlePairSet=exports.b2ParticleSystem_ParticlePair=exports.b2ParticleSystem_FixtureParticleSet=exports.b2ParticleSystem_FixtureParticle=exports.b2ParticleSystem_FixedSetAllocator=exports.b2ParticleSystem_ParticleListNode=exports.b2ParticleSystem_InsideBoundsEnumerator=exports.b2ParticleSystem_Proxy=exports.b2ParticleSystem=exports.b2ParticleSystemDef=exports.b2ParticleTriad=exports.b2ParticlePair=exports.b2ParticleBodyContact=exports.b2ParticleContact=exports.b2ParticleSystem_UserOverridableBuffer=exports.b2GrowableBuffer=void 0;const t=require("@box2d/core"),e=require("./b2_settings"),i=require("./b2_particle"),r=require("./b2_particle_group"),a=require("./b2_voronoi_diagram"),s=require("./b2_compute_distance"),o=require("./b2_fixture_particle_query_callbacks");function n(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function c(t,e){return t<e}function l(t,e=0,i=t.length-e,r=c){let a=e;const s=[];let o=0;for(;;){for(;a+1<i;i++){const e=t[a+Math.floor(Math.random()*(i-a))];s[o++]=i;for(let s=a-1;;){for(;r(t[++s],e);)continue;for(;r(e,t[--i]);)continue;if(s>=i)break;n(t,s,i)}}if(0===o)break;a=i,i=s[--o]}return t}function f(t,e=0,i=t.length-e,r=c){return l(t,e,i,r)}function u(t,e,i=t.length){let r=0;for(let a=0;a<i;++a)e(t[a])||(a!==r?n(t,r++,a):++r);return r}function h(t,e,i,r,a){let s=i-e;for(;s>0;){const i=Math.floor(s/2);let o=e+i;a(t[o],r)?(e=++o,s-=i+1):s=i}return e}function d(t,e,i,r,a){let s=i-e;for(;s>0;){const i=Math.floor(s/2);let o=e+i;a(r,t[o])?s=i:(e=++o,s-=i+1)}return e}function _(t,e,i,r){let a=i;for(;e!==a;)n(t,e++,a++),a===r?a=i:e===i&&(i=a)}function m(t,e,i,r){if(e===i)return i;let a=e;for(;++e!==i;)r(t[a],t[e])||n(t,++a,e);return++a}class p{constructor(t){this.data=[],this.count=0,this.capacity=0,this.allocator=t}Append(){return this.count>=this.capacity&&this.Grow(),this.count++}Reserve(t){if(!(this.capacity>=t)){for(let e=this.capacity;e<t;++e)this.data[e]=this.allocator();this.capacity=t}}Grow(){const t=this.capacity?2*this.capacity:e.b2_minParticleSystemBufferCapacity;this.Reserve(t)}Free(){0!==this.data.length&&(this.data=[],this.capacity=0,this.count=0)}Shorten(t){}Data(){return this.data}GetCount(){return this.count}SetCount(t){this.count=t}GetCapacity(){return this.capacity}RemoveIf(t){this.count=u(this.data,t,this.count)}Unique(t){this.count=m(this.data,0,this.count,t)}}exports.b2GrowableBuffer=p;class B{constructor(){this.m_data=null,this.userSuppliedCapacity=0}get data(){return this.m_data}set data(t){this.m_data=t}}exports.b2ParticleSystem_UserOverridableBuffer=B;class b{constructor(){this.indexA=0,this.indexB=0,this.weight=0,this.normal=new t.b2Vec2,this.flags=0}SetIndices(t,e){this.indexA=t,this.indexB=e}SetWeight(t){this.weight=t}SetNormal(t){this.normal.Copy(t)}SetFlags(t){this.flags=t}GetIndexA(){return this.indexA}GetIndexB(){return this.indexB}GetWeight(){return this.weight}GetNormal(){return this.normal}GetFlags(){return this.flags}IsEqual(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&this.weight===t.weight&&this.normal.x===t.normal.x&&this.normal.y===t.normal.y}IsNotEqual(t){return!this.IsEqual(t)}ApproximatelyEqual(e){return this.indexA===e.indexA&&this.indexB===e.indexB&&this.flags===e.flags&&Math.abs(this.weight-e.weight)<.01&&t.b2Vec2.DistanceSquared(this.normal,e.normal)<1e-4}}exports.b2ParticleContact=b;class g{constructor(){this.index=0,this.weight=0,this.normal=new t.b2Vec2,this.mass=0}}exports.b2ParticleBodyContact=g;class x{constructor(){this.indexA=0,this.indexB=0,this.flags=0,this.strength=0,this.distance=0}}exports.b2ParticlePair=x;class y{constructor(){this.indexA=0,this.indexB=0,this.indexC=0,this.flags=0,this.strength=0,this.pa=new t.b2Vec2,this.pb=new t.b2Vec2,this.pc=new t.b2Vec2,this.ka=0,this.kb=0,this.kc=0,this.s=0}}exports.b2ParticleTriad=y;class P{constructor(){this.strictContactCheck=!1,this.density=1,this.gravityScale=1,this.radius=1,this.maxCount=0,this.pressureStrength=.005,this.dampingStrength=1,this.elasticStrength=.25,this.springStrength=.25,this.viscousStrength=.25,this.surfaceTensionPressureStrength=.2,this.surfaceTensionNormalStrength=.2,this.repulsiveStrength=1,this.powderStrength=.5,this.ejectionStrength=.5,this.staticPressureStrength=.2,this.staticPressureRelaxation=.2,this.staticPressureIterations=8,this.colorMixingStrength=.5,this.destroyByAge=!0,this.lifetimeGranularity=1/60}Copy(t){return this.strictContactCheck=t.strictContactCheck,this.density=t.density,this.gravityScale=t.gravityScale,this.radius=t.radius,this.maxCount=t.maxCount,this.pressureStrength=t.pressureStrength,this.dampingStrength=t.dampingStrength,this.elasticStrength=t.elasticStrength,this.springStrength=t.springStrength,this.viscousStrength=t.viscousStrength,this.surfaceTensionPressureStrength=t.surfaceTensionPressureStrength,this.surfaceTensionNormalStrength=t.surfaceTensionNormalStrength,this.repulsiveStrength=t.repulsiveStrength,this.powderStrength=t.powderStrength,this.ejectionStrength=t.ejectionStrength,this.staticPressureStrength=t.staticPressureStrength,this.staticPressureRelaxation=t.staticPressureRelaxation,this.staticPressureIterations=t.staticPressureIterations,this.colorMixingStrength=t.colorMixingStrength,this.destroyByAge=t.destroyByAge,this.lifetimeGranularity=t.lifetimeGranularity,this}Clone(){return(new P).Copy(this)}}exports.b2ParticleSystemDef=P;class S{constructor(t,e){this.m_paused=!1,this.m_timestamp=0,this.m_allParticleFlags=0,this.m_needsUpdateAllParticleFlags=!1,this.m_allGroupFlags=0,this.m_needsUpdateAllGroupFlags=!1,this.m_hasForce=!1,this.m_iterationIndex=0,this.m_inverseDensity=0,this.m_particleDiameter=0,this.m_inverseDiameter=0,this.m_squaredDiameter=0,this.m_count=0,this.m_internalAllocatedCapacity=0,this.m_handleIndexBuffer=new B,this.m_flagsBuffer=new B,this.m_positionBuffer=new B,this.m_velocityBuffer=new B,this.m_forceBuffer=[],this.m_weightBuffer=[],this.m_staticPressureBuffer=[],this.m_accumulationBuffer=[],this.m_accumulation2Buffer=[],this.m_depthBuffer=[],this.m_colorBuffer=new B,this.m_groupBuffer=[],this.m_userDataBuffer=new B,this.m_stuckThreshold=0,this.m_lastBodyContactStepBuffer=new B,this.m_bodyContactCountBuffer=new B,this.m_consecutiveContactStepsBuffer=new B,this.m_stuckParticleBuffer=new p(()=>0),this.m_proxyBuffer=new p(()=>new C),this.m_contactBuffer=new p(()=>new b),this.m_bodyContactBuffer=new p(()=>new g),this.m_pairBuffer=new p(()=>new x),this.m_triadBuffer=new p(()=>new y),this.m_expirationTimeBuffer=new B,this.m_indexByExpirationTimeBuffer=new B,this.m_timeElapsed=0,this.m_expirationTimeBufferRequiresSorting=!1,this.m_groupCount=0,this.m_groupList=null,this.m_def=new P,this.m_prev=null,this.m_next=null,this.UpdateBodyContacts_callback=new o.b2ParticleSystem_UpdateBodyContactsCallback(this),this.SolveCollision_callback=new o.b2ParticleSystem_SolveCollisionCallback(this),this.SetStrictContactCheck(t.strictContactCheck),this.SetDensity(t.density),this.SetGravityScale(t.gravityScale),this.SetRadius(t.radius),this.SetMaxParticleCount(t.maxCount),this.m_def=t.Clone(),this.m_world=e,this.SetDestructionByAge(this.m_def.destroyByAge)}static computeTag(t,e){return(e+S.yOffset>>>0<<S.yShift)+(S.xScale*t+S.xOffset>>>0)>>>0}static computeRelativeTag(t,e,i){return t+(i<<S.yShift)+(e<<S.xShift)>>>0}Drop(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer),this.FreeUserOverridableBuffer(this.m_flagsBuffer),this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer),this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer),this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer),this.FreeUserOverridableBuffer(this.m_positionBuffer),this.FreeUserOverridableBuffer(this.m_velocityBuffer),this.FreeUserOverridableBuffer(this.m_colorBuffer),this.FreeUserOverridableBuffer(this.m_userDataBuffer),this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer),this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer),this.FreeBuffer(this.m_forceBuffer),this.FreeBuffer(this.m_weightBuffer),this.FreeBuffer(this.m_staticPressureBuffer),this.FreeBuffer(this.m_accumulationBuffer),this.FreeBuffer(this.m_accumulation2Buffer),this.FreeBuffer(this.m_depthBuffer),this.FreeBuffer(this.m_groupBuffer)}CreateParticle(i){var r,a,s,o,n,c;if((0,t.b2Assert)(!this.m_world.IsLocked()),this.m_count>=this.m_internalAllocatedCapacity){const t=this.m_count?2*this.m_count:e.b2_minParticleSystemBufferCapacity;this.ReallocateInternalAllocatedBuffers(t)}if(this.m_count>=this.m_internalAllocatedCapacity){if(!this.m_def.destroyByAge)return e.b2_invalidParticleIndex;this.DestroyOldestParticle(0,!1),this.SolveZombie()}const l=this.m_count++;this.m_flagsBuffer.data[l]=0,this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[l]=0),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[l]=0),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[l]=0),this.m_positionBuffer.data[l]=(this.m_positionBuffer.data[l]||new t.b2Vec2).Copy(null!==(r=i.position)&&void 0!==r?r:t.b2Vec2.ZERO),this.m_velocityBuffer.data[l]=(this.m_velocityBuffer.data[l]||new t.b2Vec2).Copy(null!==(a=i.velocity)&&void 0!==a?a:t.b2Vec2.ZERO),this.m_weightBuffer[l]=0,this.m_forceBuffer[l]=(this.m_forceBuffer[l]||new t.b2Vec2).SetZero(),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[l]=0),this.m_depthBuffer&&(this.m_depthBuffer[l]=0);const f=(new t.b2Color).Copy(null!==(s=i.color)&&void 0!==s?s:t.b2Color.ZERO);!this.m_colorBuffer.data&&f.IsZero()||(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[l]=(this.m_colorBuffer.data[l]||new t.b2Color).Copy(f)),(this.m_userDataBuffer.data||i.userData)&&(this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[l]=i.userData),this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[l]=null);const u=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],h=null!==(o=i.lifetime)&&void 0!==o?o:0,d=h>0;(this.m_expirationTimeBuffer.data||d)&&(this.SetParticleLifetime(l,d?h:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),this.m_indexByExpirationTimeBuffer.data[l]=l),u.index=l;const _=null!==(n=i.group)&&void 0!==n?n:null;return this.m_groupBuffer[l]=_,_&&(_.m_firstIndex<_.m_lastIndex?(this.RotateBuffer(_.m_firstIndex,_.m_lastIndex,l),_.m_lastIndex=l+1):(_.m_firstIndex=l,_.m_lastIndex=l+1)),this.SetParticleFlags(l,null!==(c=i.flags)&&void 0!==c?c:0),l}GetParticleHandleFromIndex(t){this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);let e=this.m_handleIndexBuffer.data[t];return e||((e=new i.b2ParticleHandle).SetIndex(t),this.m_handleIndexBuffer.data[t]=e,e)}DestroyParticle(t,e=!1){let r=i.b2ParticleFlag.b2_zombieParticle;e&&(r|=i.b2ParticleFlag.b2_destructionListenerParticle),this.SetParticleFlags(t,this.m_flagsBuffer.data[t]|r)}DestroyOldestParticle(t,e=!1){const i=this.GetParticleCount(),r=this.m_indexByExpirationTimeBuffer.data[i-(t+1)],a=this.m_indexByExpirationTimeBuffer.data[t];this.DestroyParticle(this.m_expirationTimeBuffer.data[r]>0?r:a,e)}DestroyParticlesInShape(e,i,r=!1){const a=S.DestroyParticlesInShape_s_aabb;(0,t.b2Assert)(!this.m_world.IsLocked());const s=a;e.ComputeAABB(s,i,0);let o=0;return this.QueryAABB(s,t=>(e.TestPoint(i,this.m_positionBuffer.data[t])&&(this.DestroyParticle(t,r),o++),!0)),o}CreateParticleGroup(e){var i,a,s,o,n,c;const l=S.CreateParticleGroup_s_transform;(0,t.b2Assert)(!this.m_world.IsLocked());const f=l;f.SetPositionAngle(null!==(i=e.position)&&void 0!==i?i:t.b2Vec2.ZERO,null!==(a=e.angle)&&void 0!==a?a:0);const u=this.m_count;if(e.shape&&this.CreateParticlesWithShapeForGroup(e.shape,e,f),e.shapes&&this.CreateParticlesWithShapesForGroup(e.shapes,null!==(s=e.shapeCount)&&void 0!==s?s:e.shapes.length,e,f),e.positionData){const t=null!==(o=e.particleCount)&&void 0!==o?o:e.positionData.length;for(let i=0;i<t;i++){const t=e.positionData[i];this.CreateParticleForGroup(e,f,t)}}const h=this.m_count;let d=new r.b2ParticleGroup(this);d.m_firstIndex=u,d.m_lastIndex=h,d.m_strength=null!==(n=e.strength)&&void 0!==n?n:1,d.m_userData=e.userData,d.m_transform.Copy(f),d.m_prev=null,d.m_next=this.m_groupList,this.m_groupList&&(this.m_groupList.m_prev=d),this.m_groupList=d,++this.m_groupCount;for(let t=u;t<h;t++)this.m_groupBuffer[t]=d;this.SetGroupFlags(d,null!==(c=e.groupFlags)&&void 0!==c?c:0);const _=new D;return this.UpdateContacts(!0),this.UpdatePairsAndTriads(u,h,_),e.group&&(this.JoinParticleGroups(e.group,d),d=e.group),d}JoinParticleGroups(e,i){(0,t.b2Assert)(!this.m_world.IsLocked()),this.RotateBuffer(i.m_firstIndex,i.m_lastIndex,this.m_count),this.RotateBuffer(e.m_firstIndex,e.m_lastIndex,i.m_firstIndex);const r=new T(i.m_firstIndex);this.UpdateContacts(!0),this.UpdatePairsAndTriads(e.m_firstIndex,i.m_lastIndex,r);for(let t=i.m_firstIndex;t<i.m_lastIndex;t++)this.m_groupBuffer[t]=e;const a=e.m_groupFlags|i.m_groupFlags;this.SetGroupFlags(e,a),e.m_lastIndex=i.m_lastIndex,i.m_firstIndex=i.m_lastIndex,this.DestroyParticleGroup(i)}SplitParticleGroup(t){this.UpdateContacts(!0);const e=t.GetParticleCount(),i=new Array(e);for(let a=0;a<e;a++)i[a]=new F;S.InitializeParticleLists(t,i),this.MergeParticleListsInContact(t,i);const r=S.FindLongestParticleList(t,i);this.MergeZombieParticleListNodes(t,i,r),this.CreateParticleGroupsFromParticleList(t,i,r),this.UpdatePairsAndTriadsWithParticleList(t,i)}GetParticleGroupList(){return this.m_groupList}GetParticleGroupCount(){return this.m_groupCount}GetParticleCount(){return this.m_count}GetMaxParticleCount(){return this.m_def.maxCount}SetMaxParticleCount(t){this.m_def.maxCount=t}GetAllParticleFlags(){return this.m_allParticleFlags}GetAllGroupFlags(){return this.m_allGroupFlags}SetPaused(t){this.m_paused=t}GetPaused(){return this.m_paused}SetDensity(t){this.m_def.density=t,this.m_inverseDensity=1/this.m_def.density}GetDensity(){return this.m_def.density}SetGravityScale(t){this.m_def.gravityScale=t}GetGravityScale(){return this.m_def.gravityScale}SetDamping(t){this.m_def.dampingStrength=t}GetDamping(){return this.m_def.dampingStrength}SetStaticPressureIterations(t){this.m_def.staticPressureIterations=t}GetStaticPressureIterations(){return this.m_def.staticPressureIterations}SetRadius(t){this.m_particleDiameter=2*t,this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter,this.m_inverseDiameter=1/this.m_particleDiameter}GetRadius(){return this.m_particleDiameter/2}GetPositionBuffer(){return this.m_positionBuffer.data}GetVelocityBuffer(){return this.m_velocityBuffer.data}GetColorBuffer(){return this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data}GetGroupBuffer(){return this.m_groupBuffer}GetWeightBuffer(){return this.m_weightBuffer}GetUserDataBuffer(){return this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data}GetFlagsBuffer(){return this.m_flagsBuffer.data}SetParticleFlags(t,e){this.m_flagsBuffer.data[t]&~e&&(this.m_needsUpdateAllParticleFlags=!0),~this.m_allParticleFlags&e&&(e&i.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),e&i.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=e),this.m_flagsBuffer.data[t]=e}GetParticleFlags(t){return this.m_flagsBuffer.data[t]}SetFlagsBuffer(t){this.SetUserOverridableBuffer(this.m_flagsBuffer,t)}SetPositionBuffer(t){this.SetUserOverridableBuffer(this.m_positionBuffer,t)}SetVelocityBuffer(t){this.SetUserOverridableBuffer(this.m_velocityBuffer,t)}SetColorBuffer(t){this.SetUserOverridableBuffer(this.m_colorBuffer,t)}SetUserDataBuffer(t){this.SetUserOverridableBuffer(this.m_userDataBuffer,t)}GetContacts(){return this.m_contactBuffer.data}GetContactCount(){return this.m_contactBuffer.count}GetBodyContacts(){return this.m_bodyContactBuffer.data}GetBodyContactCount(){return this.m_bodyContactBuffer.count}GetPairs(){return this.m_pairBuffer.data}GetPairCount(){return this.m_pairBuffer.count}GetTriads(){return this.m_triadBuffer.data}GetTriadCount(){return this.m_triadBuffer.count}SetStuckThreshold(t){this.m_stuckThreshold=t,t>0&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))}GetStuckCandidates(){return this.m_stuckParticleBuffer.Data()}GetStuckCandidateCount(){return this.m_stuckParticleBuffer.GetCount()}ComputeCollisionEnergy(){const e=S.ComputeCollisionEnergy_s_v,i=this.m_velocityBuffer.data;let r=0;for(let a=0;a<this.m_contactBuffer.count;a++){const s=this.m_contactBuffer.data[a],o=s.indexA,n=s.indexB,c=s.normal,l=t.b2Vec2.Subtract(i[n],i[o],e),f=t.b2Vec2.Dot(l,c);f<0&&(r+=f*f)}return.5*this.GetParticleMass()*r}SetStrictContactCheck(t){this.m_def.strictContactCheck=t}GetStrictContactCheck(){return this.m_def.strictContactCheck}SetParticleLifetime(t,e){const i=null===this.m_indexByExpirationTimeBuffer.data;if(this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),i){const t=this.GetParticleCount();for(let e=0;e<t;++e)this.m_indexByExpirationTimeBuffer.data[e]=e}const r=e/this.m_def.lifetimeGranularity,a=r>0?this.GetQuantizedTimeElapsed()+r:r;a!==this.m_expirationTimeBuffer.data[t]&&(this.m_expirationTimeBuffer.data[t]=a,this.m_expirationTimeBufferRequiresSorting=!0)}GetParticleLifetime(t){return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[t])}SetDestructionByAge(t){t&&this.GetExpirationTimeBuffer(),this.m_def.destroyByAge=t}GetDestructionByAge(){return this.m_def.destroyByAge}GetExpirationTimeBuffer(){return this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_expirationTimeBuffer.data}ExpirationTimeToLifetime(t){return(t>0?t-this.GetQuantizedTimeElapsed():t)*this.m_def.lifetimeGranularity}GetIndexByExpirationTimeBuffer(){return this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data}ParticleApplyLinearImpulse(t,e){this.ApplyLinearImpulse(t,t+1,e)}ApplyLinearImpulse(e,i,r){const a=this.m_velocityBuffer.data,s=(i-e)*this.GetParticleMass(),o=t.b2Vec2.Scale(1/s,r,new t.b2Vec2);for(let t=e;t<i;t++)a[t].Add(o)}static IsSignificantForce(t){return 0!==t.x||0!==t.y}ParticleApplyForce(t,e){S.IsSignificantForce(e)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[t])&&(this.PrepareForceBuffer(),this.m_forceBuffer[t].Add(e))}ApplyForce(e,i,r){const a=t.b2Vec2.Scale(1/(i-e),r,new t.b2Vec2);if(S.IsSignificantForce(a)){this.PrepareForceBuffer();for(let t=e;t<i;t++)this.m_forceBuffer[t].Add(a)}}GetNext(){return this.m_next}QueryAABB(t,e){if(0===this.m_proxyBuffer.count)return;const i=this.m_proxyBuffer.count,r=h(this.m_proxyBuffer.data,0,i,S.computeTag(this.m_inverseDiameter*t.lowerBound.x,this.m_inverseDiameter*t.lowerBound.y),C.CompareProxyTag),a=d(this.m_proxyBuffer.data,r,i,S.computeTag(this.m_inverseDiameter*t.upperBound.x,this.m_inverseDiameter*t.upperBound.y),C.CompareTagProxy),s=this.m_positionBuffer.data;for(let o=r;o<a;++o){const i=this.m_proxyBuffer.data[o].index,r=s[i];if(t.lowerBound.x<r.x&&r.x<t.upperBound.x&&t.lowerBound.y<r.y&&r.y<t.upperBound.y&&!e(i))break}}QueryShapeAABB(t,e,i,r){const a=S.QueryShapeAABB_s_aabb;t.ComputeAABB(a,e,i),this.QueryAABB(a,r)}QueryPointAABB(t,e,i){const r=S.QueryPointAABB_s_aabb;r.lowerBound.Set(t.x-e,t.y-e),r.upperBound.Set(t.x+e,t.y+e),this.QueryAABB(r,i)}RayCast(e,i,r){const a=S.RayCast_s_aabb,s=S.RayCast_s_p,o=S.RayCast_s_v,n=S.RayCast_s_n,c=S.RayCast_s_point;if(0===this.m_proxyBuffer.count)return;const l=this.m_positionBuffer.data,f=a;t.b2Vec2.Min(e,i,f.lowerBound),t.b2Vec2.Max(e,i,f.upperBound);let u=1;const h=t.b2Vec2.Subtract(i,e,o),d=t.b2Vec2.Dot(h,h),_=this.GetInsideBoundsEnumerator(f);let m;for(;(m=_.GetNext())>=0;){const i=t.b2Vec2.Subtract(e,l[m],s),a=t.b2Vec2.Dot(i,h),o=a*a-d*(t.b2Vec2.Dot(i,i)-this.m_squaredDiameter);if(o>=0){const s=Math.sqrt(o);let l=(-a-s)/d;if(l>u)continue;if(l<0&&((l=(-a+s)/d)<0||l>u))continue;const f=t.b2Vec2.AddScaled(i,l,h,n);f.Normalize();const _=r(m,t.b2Vec2.AddScaled(e,l,h,c),f,l);if((u=Math.min(u,_))<=0)break}}}ComputeAABB(e){const i=this.GetParticleCount();e.lowerBound.x=+t.b2_maxFloat,e.lowerBound.y=+t.b2_maxFloat,e.upperBound.x=-t.b2_maxFloat,e.upperBound.y=-t.b2_maxFloat;const r=this.m_positionBuffer.data;for(let a=0;a<i;a++){const i=r[a];t.b2Vec2.Min(e.lowerBound,i,e.lowerBound),t.b2Vec2.Max(e.upperBound,i,e.upperBound)}e.lowerBound.x-=this.m_particleDiameter,e.lowerBound.y-=this.m_particleDiameter,e.upperBound.x+=this.m_particleDiameter,e.upperBound.y+=this.m_particleDiameter}FreeBuffer(t){null!==t&&(t.length=0)}FreeUserOverridableBuffer(t){0===t.userSuppliedCapacity&&this.FreeBuffer(t.data)}ReallocateBuffer3(e,i,r){(0,t.b2Assert)(r>i);const a=e?e.slice():[];return a.length=r,a}ReallocateBuffer5(e,i,r,a,s){return(0,t.b2Assert)(a>r),(0,t.b2Assert)(!i||a<=i),s&&!e||i||(e=this.ReallocateBuffer3(e,r,a)),e}ReallocateBuffer4(t,e,i,r){return this.ReallocateBuffer5(t.data,t.userSuppliedCapacity,e,i,r)}RequestBuffer(t){return t||(0===this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(e.b2_minParticleSystemBufferCapacity),(t=[]).length=this.m_internalAllocatedCapacity),t}ReallocateHandleBuffers(t){this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,t,!0)}ReallocateInternalAllocatedBuffers(t){function e(e){return e&&t>e?e:t}if(t=e(this.m_def.maxCount),t=e(this.m_flagsBuffer.userSuppliedCapacity),t=e(this.m_positionBuffer.userSuppliedCapacity),t=e(this.m_velocityBuffer.userSuppliedCapacity),t=e(this.m_colorBuffer.userSuppliedCapacity),t=e(this.m_userDataBuffer.userSuppliedCapacity),this.m_internalAllocatedCapacity<t){this.ReallocateHandleBuffers(t),this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,this.m_internalAllocatedCapacity,t,!1);const e=this.m_stuckThreshold>0;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,t,e),this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,t,e),this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,t,e),this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_accumulationBuffer=this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_internalAllocatedCapacity=t}}CreateParticleForGroup(e,r,a){var s,o,n,c,l,f;const u=new i.b2ParticleDef;u.flags=null!==(s=e.flags)&&void 0!==s?s:0,t.b2Transform.MultiplyVec2(r,a,u.position),t.b2Vec2.Add(null!==(o=e.linearVelocity)&&void 0!==o?o:t.b2Vec2.ZERO,t.b2Vec2.CrossScalarVec2(null!==(n=e.angularVelocity)&&void 0!==n?n:0,t.b2Vec2.Subtract(u.position,null!==(c=e.position)&&void 0!==c?c:t.b2Vec2.ZERO,t.b2Vec2.s_t0),t.b2Vec2.s_t0),u.velocity),u.color.Copy(null!==(l=e.color)&&void 0!==l?l:t.b2Color.ZERO),u.lifetime=null!==(f=e.lifetime)&&void 0!==f?f:0,u.userData=e.userData,this.CreateParticle(u)}CreateParticlesStrokeShapeForGroup(e,i,r){var a;const s=S.CreateParticlesStrokeShapeForGroup_s_edge,o=S.CreateParticlesStrokeShapeForGroup_s_d,n=S.CreateParticlesStrokeShapeForGroup_s_p;let c=null!==(a=i.stride)&&void 0!==a?a:0;0===c&&(c=this.GetParticleStride());let l=0;const f=e.GetChildCount();for(let u=0;u<f;u++){let a=null;e.GetType()===t.b2ShapeType.e_edge?a=e:(a=s,e.GetChildEdge(a,u));const f=t.b2Vec2.Subtract(a.m_vertex2,a.m_vertex1,o),h=f.Length();for(;l<h;){const e=t.b2Vec2.AddScaled(a.m_vertex1,l/h,f,n);this.CreateParticleForGroup(i,r,e),l+=c}l-=h}}CreateParticlesFillShapeForGroup(e,i,r){var a;const s=S.CreateParticlesFillShapeForGroup_s_aabb,o=S.CreateParticlesFillShapeForGroup_s_p;let n=null!==(a=i.stride)&&void 0!==a?a:0;0===n&&(n=this.GetParticleStride());const c=t.b2Transform.IDENTITY,l=s;e.ComputeAABB(l,c,0);for(let t=Math.floor(l.lowerBound.y/n)*n;t<l.upperBound.y;t+=n)for(let a=Math.floor(l.lowerBound.x/n)*n;a<l.upperBound.x;a+=n){const s=o.Set(a,t);e.TestPoint(c,s)&&this.CreateParticleForGroup(i,r,s)}}CreateParticlesWithShapeForGroup(e,i,r){switch(e.GetType()){case t.b2ShapeType.e_edge:case t.b2ShapeType.e_chain:this.CreateParticlesStrokeShapeForGroup(e,i,r);break;case t.b2ShapeType.e_polygon:case t.b2ShapeType.e_circle:this.CreateParticlesFillShapeForGroup(e,i,r)}}CreateParticlesWithShapesForGroup(t,e,i,r){const a=new R(t,e);this.CreateParticlesFillShapeForGroup(a,i,r)}CloneParticle(t,e){const r=new i.b2ParticleDef;r.flags=this.m_flagsBuffer.data[t],r.position.Copy(this.m_positionBuffer.data[t]),r.velocity.Copy(this.m_velocityBuffer.data[t]),this.m_colorBuffer.data&&r.color.Copy(this.m_colorBuffer.data[t]),this.m_userDataBuffer.data&&(r.userData=this.m_userDataBuffer.data[t]),r.group=e;const a=this.CreateParticle(r);if(this.m_handleIndexBuffer.data){const e=this.m_handleIndexBuffer.data[t];e&&e.SetIndex(a),this.m_handleIndexBuffer.data[a]=e,this.m_handleIndexBuffer.data[t]=null}return this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[a]=this.m_lastBodyContactStepBuffer.data[t]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[a]=this.m_bodyContactCountBuffer.data[t]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[a]=this.m_consecutiveContactStepsBuffer.data[t]),this.m_hasForce&&this.m_forceBuffer[a].Copy(this.m_forceBuffer[t]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[a]=this.m_staticPressureBuffer[t]),this.m_depthBuffer&&(this.m_depthBuffer[a]=this.m_depthBuffer[t]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[a]=this.m_expirationTimeBuffer.data[t]),a}DestroyParticlesInGroup(t,e=!1){for(let i=t.m_firstIndex;i<t.m_lastIndex;i++)this.DestroyParticle(i,e)}DestroyParticleGroup(t){const e=this.m_world.GetDestructionListener();null==e||e.SayGoodbyeParticleGroup(t),this.SetGroupFlags(t,0);for(let i=t.m_firstIndex;i<t.m_lastIndex;i++)this.m_groupBuffer[i]=null;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_groupList&&(this.m_groupList=t.m_next),--this.m_groupCount}static ParticleCanBeConnected(t,e){return 0!=(t&(i.b2ParticleFlag.b2_wallParticle|i.b2ParticleFlag.b2_springParticle|i.b2ParticleFlag.b2_elasticParticle))||null!==e&&0!=(e.GetGroupFlags()&r.b2ParticleGroupFlag.b2_rigidParticleGroup)}UpdatePairsAndTriads(r,s,o){const n=S.UpdatePairsAndTriads_s_dab,c=S.UpdatePairsAndTriads_s_dbc,l=S.UpdatePairsAndTriads_s_dca,u=this.m_positionBuffer.data;let h=0;for(let t=r;t<s;t++)h|=this.m_flagsBuffer.data[t];if(h&S.k_pairFlags)for(let e=0;e<this.m_contactBuffer.count;e++){const a=this.m_contactBuffer.data[e],n=a.indexA,c=a.indexB,l=this.m_flagsBuffer.data[n],h=this.m_flagsBuffer.data[c],d=this.m_groupBuffer[n],_=this.m_groupBuffer[c];if(n>=r&&n<s&&c>=r&&c<s&&!((l|h)&i.b2ParticleFlag.b2_zombieParticle)&&(l|h)&S.k_pairFlags&&(o.IsNecessary(n)||o.IsNecessary(c))&&S.ParticleCanBeConnected(l,d)&&S.ParticleCanBeConnected(h,_)&&o.ShouldCreatePair(n,c)){const e=this.m_pairBuffer.data[this.m_pairBuffer.Append()];e.indexA=n,e.indexB=c,e.flags=a.flags,e.strength=Math.min(d?d.m_strength:1,_?_.m_strength:1),e.distance=t.b2Vec2.Distance(u[n],u[c])}f(this.m_pairBuffer.data,0,this.m_pairBuffer.count,S.ComparePairIndices),this.m_pairBuffer.Unique(S.MatchPairIndices)}if(h&S.k_triadFlags){const h=new a.b2VoronoiDiagram(s-r);for(let t=r;t<s;t++){const e=this.m_flagsBuffer.data[t],r=this.m_groupBuffer[t];e&i.b2ParticleFlag.b2_zombieParticle||!S.ParticleCanBeConnected(e,r)||h.AddGenerator(u[t],t,o.IsNecessary(t))}const d=this.GetParticleStride();h.Generate(d/2,2*d),h.GetNodes((i,r,a)=>{const s=this.m_flagsBuffer.data[i],f=this.m_flagsBuffer.data[r],h=this.m_flagsBuffer.data[a];if((s|f|h)&S.k_triadFlags&&o.ShouldCreateTriad(i,r,a)){const o=u[i],d=u[r],_=u[a],m=t.b2Vec2.Subtract(o,d,n),p=t.b2Vec2.Subtract(d,_,c),B=t.b2Vec2.Subtract(_,o,l),b=e.b2_maxTriadDistanceSquared*this.m_squaredDiameter;if(t.b2Vec2.Dot(m,m)>b||t.b2Vec2.Dot(p,p)>b||t.b2Vec2.Dot(B,B)>b)return;const g=this.m_groupBuffer[i],x=this.m_groupBuffer[r],y=this.m_groupBuffer[a],P=this.m_triadBuffer.data[this.m_triadBuffer.Append()];P.indexA=i,P.indexB=r,P.indexC=a,P.flags=s|f|h,P.strength=Math.min(Math.min(g?g.m_strength:1,x?x.m_strength:1),y?y.m_strength:1);const S=(o.x+d.x+_.x)/3,C=(o.y+d.y+_.y)/3;P.pa.x=o.x-S,P.pa.y=o.y-C,P.pb.x=d.x-S,P.pb.y=d.y-C,P.pc.x=_.x-S,P.pc.y=_.y-C,P.ka=-t.b2Vec2.Dot(B,m),P.kb=-t.b2Vec2.Dot(m,p),P.kc=-t.b2Vec2.Dot(p,B),P.s=t.b2Vec2.Cross(o,d)+t.b2Vec2.Cross(d,_)+t.b2Vec2.Cross(_,o)}}),f(this.m_triadBuffer.data,0,this.m_triadBuffer.count,S.CompareTriadIndices),this.m_triadBuffer.Unique(S.MatchTriadIndices)}}UpdatePairsAndTriadsWithReactiveParticles(){const t=new M(this.m_flagsBuffer);this.UpdatePairsAndTriads(0,this.m_count,t);for(let e=0;e<this.m_count;e++)this.m_flagsBuffer.data[e]&=~i.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~i.b2ParticleFlag.b2_reactiveParticle}static ComparePairIndices(t,e){const i=t.indexA-e.indexA;return 0!==i?i<0:t.indexB<e.indexB}static MatchPairIndices(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB}static CompareTriadIndices(t,e){const i=t.indexA-e.indexA;if(0!==i)return i<0;const r=t.indexB-e.indexB;return 0!==r?r<0:t.indexC<e.indexC}static MatchTriadIndices(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB&&t.indexC===e.indexC}static InitializeParticleLists(t,e){const i=t.GetBufferIndex(),r=t.GetParticleCount();for(let a=0;a<r;a++){const t=e[a];t.list=t,t.next=null,t.count=1,t.index=a+i}}MergeParticleListsInContact(t,e){const i=t.GetBufferIndex();for(let r=0;r<this.m_contactBuffer.count;r++){const a=this.m_contactBuffer.data[r],s=a.indexA,o=a.indexB;if(!t.ContainsParticle(s)||!t.ContainsParticle(o))continue;let n=e[s-i].list,c=e[o-i].list;if(n!==c){if(n.count<c.count){const t=n;n=c,c=t}S.MergeParticleLists(n,c)}}}static MergeParticleLists(t,e){for(let i=e;;){i.list=t;const e=i.next;if(!e){i.next=t.next;break}i=e}t.next=e,t.count+=e.count,e.count=0}static FindLongestParticleList(t,e){const i=t.GetParticleCount();let r=e[0];for(let a=0;a<i;a++){const t=e[a];r.count<t.count&&(r=t)}return r}MergeZombieParticleListNodes(t,e,r){const a=t.GetParticleCount();for(let s=0;s<a;s++){const t=e[s];t!==r&&this.m_flagsBuffer.data[t.index]&i.b2ParticleFlag.b2_zombieParticle&&S.MergeParticleListAndNode(r,t)}}static MergeParticleListAndNode(t,e){e.list=t,e.next=t.next,t.next=e,t.count++,e.count=0}CreateParticleGroupsFromParticleList(t,e,a){const s=t.GetParticleCount(),o=new r.b2ParticleGroupDef;o.groupFlags=t.GetGroupFlags(),o.userData=t.GetUserData();for(let r=0;r<s;r++){const t=e[r];if(!t.count||t===a)continue;const s=this.CreateParticleGroup(o);for(let e=t;e;e=e.next){const t=e.index,r=this.CloneParticle(t,s);this.m_flagsBuffer.data[t]|=i.b2ParticleFlag.b2_zombieParticle,e.index=r}}}UpdatePairsAndTriadsWithParticleList(t,e){const i=t.GetBufferIndex();for(let r=0;r<this.m_pairBuffer.count;r++){const a=this.m_pairBuffer.data[r],s=a.indexA,o=a.indexB;t.ContainsParticle(s)&&(a.indexA=e[s-i].index),t.ContainsParticle(o)&&(a.indexB=e[o-i].index)}for(let r=0;r<this.m_triadBuffer.count;r++){const a=this.m_triadBuffer.data[r],s=a.indexA,o=a.indexB,n=a.indexC;t.ContainsParticle(s)&&(a.indexA=e[s-i].index),t.ContainsParticle(o)&&(a.indexB=e[o-i].index),t.ContainsParticle(n)&&(a.indexC=e[n-i].index)}}ComputeDepth(){const e=[];let i=0;for(let t=0;t<this.m_contactBuffer.count;t++){const a=this.m_contactBuffer.data[t],s=a.indexA,o=a.indexB,n=this.m_groupBuffer[s],c=this.m_groupBuffer[o];n&&n===c&&n.m_groupFlags&r.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(e[i++]=a)}const a=[];let s=0;for(let t=this.m_groupList;t;t=t.GetNext())if(t.m_groupFlags&r.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth){a[s++]=t,this.SetGroupFlags(t,t.m_groupFlags&~r.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);for(let e=t.m_firstIndex;e<t.m_lastIndex;e++)this.m_accumulationBuffer[e]=0}for(let t=0;t<i;t++){const i=e[t],r=i.indexA,a=i.indexB,s=i.weight;this.m_accumulationBuffer[r]+=s,this.m_accumulationBuffer[a]+=s}for(let r=0;r<s;r++){const e=a[r];for(let i=e.m_firstIndex;i<e.m_lastIndex;i++){const e=this.m_accumulationBuffer[i];this.m_depthBuffer[i]=e<.8?0:t.b2_maxFloat}}const o=Math.sqrt(this.m_count)>>0;for(let t=0;t<o;t++){let t=!1;for(let r=0;r<i;r++){const i=e[r],a=i.indexA,s=i.indexB,o=1-i.weight,n=this.m_depthBuffer[a],c=this.m_depthBuffer[s],l=c+o,f=n+o;n>l&&(this.m_depthBuffer[a]=l,t=!0),c>f&&(this.m_depthBuffer[s]=f,t=!0)}if(!t)break}for(let r=0;r<s;r++){const e=a[r];for(let i=e.m_firstIndex;i<e.m_lastIndex;i++)this.m_depthBuffer[i]<t.b2_maxFloat?this.m_depthBuffer[i]*=this.m_particleDiameter:this.m_depthBuffer[i]=0}}GetInsideBoundsEnumerator(t){const e=S.computeTag(this.m_inverseDiameter*t.lowerBound.x-1,this.m_inverseDiameter*t.lowerBound.y-1),i=S.computeTag(this.m_inverseDiameter*t.upperBound.x+1,this.m_inverseDiameter*t.upperBound.y+1),r=this.m_proxyBuffer.count,a=h(this.m_proxyBuffer.data,0,r,e,C.CompareProxyTag),s=d(this.m_proxyBuffer.data,0,r,i,C.CompareTagProxy);return new v(this,e,i,a,s)}UpdateAllParticleFlags(){this.m_allParticleFlags=0;for(let t=0;t<this.m_count;t++)this.m_allParticleFlags|=this.m_flagsBuffer.data[t];this.m_needsUpdateAllParticleFlags=!1}UpdateAllGroupFlags(){this.m_allGroupFlags=0;for(let t=this.m_groupList;t;t=t.GetNext())this.m_allGroupFlags|=t.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1}AddContact(e,i){const r=this.m_flagsBuffer.data,a=this.m_positionBuffer.data,s=t.b2Vec2.Subtract(a[i],a[e],S.AddContact_s_d),o=t.b2Vec2.Dot(s,s);if(o>0&&o<this.m_squaredDiameter){const t=1/Math.sqrt(o),a=this.m_contactBuffer.data[this.m_contactBuffer.Append()];a.indexA=e,a.indexB=i,a.flags=r[e]|r[i],a.weight=1-o*t*this.m_inverseDiameter,a.normal.x=t*s.x,a.normal.y=t*s.y}}FindContacts_Reference(){const t=this.m_proxyBuffer.count;this.m_contactBuffer.count=0;for(let e=0,i=0;e<t;e++){const r=S.computeRelativeTag(this.m_proxyBuffer.data[e].tag,1,0);for(let i=e+1;i<t&&!(r<this.m_proxyBuffer.data[i].tag);i++)this.AddContact(this.m_proxyBuffer.data[e].index,this.m_proxyBuffer.data[i].index);const a=S.computeRelativeTag(this.m_proxyBuffer.data[e].tag,-1,1);for(;i<t&&!(a<=this.m_proxyBuffer.data[i].tag);i++);const s=S.computeRelativeTag(this.m_proxyBuffer.data[e].tag,1,1);for(let o=i;o<t&&!(s<this.m_proxyBuffer.data[o].tag);o++)this.AddContact(this.m_proxyBuffer.data[e].index,this.m_proxyBuffer.data[o].index)}}FindContacts(){this.FindContacts_Reference()}UpdateProxies_Reference(){const t=this.m_positionBuffer.data,e=this.m_inverseDiameter;for(let i=0;i<this.m_proxyBuffer.count;++i){const r=this.m_proxyBuffer.data[i],a=t[r.index];r.tag=S.computeTag(e*a.x,e*a.y)}}UpdateProxies(){this.UpdateProxies_Reference()}SortProxies(){l(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,C.CompareProxyProxy)}FilterContacts(){const t=this.GetParticleContactFilter();null!==t&&this.m_contactBuffer.RemoveIf(e=>0!=(e.flags&i.b2ParticleFlag.b2_particleContactFilterParticle)&&!t.ShouldCollideParticleParticle(this,e.indexA,e.indexB))}NotifyContactListenerPreContact(t){if(null!==this.GetParticleContactListener())throw t.Initialize(this.m_contactBuffer,this.m_flagsBuffer),new Error}NotifyContactListenerPostContact(t){const e=this.GetParticleContactListener();if(null!==e){for(let i=0;i<this.m_contactBuffer.count;++i){const r=this.m_contactBuffer.data[i],a=-1;a>=0?t.Invalidate(a):e.BeginContactParticleParticle(this,r)}throw new Error}}static b2ParticleContactIsZombie(t){return(t.flags&i.b2ParticleFlag.b2_zombieParticle)===i.b2ParticleFlag.b2_zombieParticle}UpdateContacts(t){this.UpdateProxies(),this.SortProxies();const e=new I;this.NotifyContactListenerPreContact(e),this.FindContacts(),this.FilterContacts(),this.NotifyContactListenerPostContact(e),t&&this.m_contactBuffer.RemoveIf(S.b2ParticleContactIsZombie)}NotifyBodyContactListenerPreContact(t){if(null!==this.GetFixtureContactListener())throw t.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer),new Error}NotifyBodyContactListenerPostContact(t){const e=this.GetFixtureContactListener();if(null!==e){for(let i=0;i<this.m_bodyContactBuffer.count;i++){const r=this.m_bodyContactBuffer.data[i],a=-1;a>=0?t.Invalidate(a):e.BeginContactFixtureParticle(this,r)}throw new Error}}UpdateBodyContacts(){const t=S.UpdateBodyContacts_s_aabb,e=new w;if(this.NotifyBodyContactListenerPreContact(e),this.m_stuckThreshold>0){const t=this.GetParticleCount();for(let e=0;e<t;e++)this.m_bodyContactCountBuffer.data[e]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[e]+1&&(this.m_consecutiveContactStepsBuffer.data[e]=0)}this.m_bodyContactBuffer.SetCount(0),this.m_stuckParticleBuffer.SetCount(0);const i=t;this.ComputeAABB(i);const r=this.UpdateBodyContacts_callback;r.m_contactFilter=this.GetFixtureContactFilter(),this.m_world.QueryAABB(i,t=>r.ReportFixture(t)),this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts(),this.NotifyBodyContactListenerPostContact(e)}Solve(t){const e=S.Solve_s_subStep;if(0===this.m_count)return;if(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(t),this.m_allParticleFlags&i.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),this.m_paused)return;const{particleIterations:a}=t.config;for(this.m_iterationIndex=0;this.m_iterationIndex<a;this.m_iterationIndex++){++this.m_timestamp;const s=e.Copy(t);s.dt/=a,s.inv_dt*=a,this.UpdateContacts(!1),this.UpdateBodyContacts(),this.ComputeWeight(),this.m_allGroupFlags&r.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth(),this.m_allParticleFlags&i.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles(),this.m_hasForce&&this.SolveForce(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous(),this.m_allParticleFlags&i.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(s),this.m_allGroupFlags&r.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing(),this.SolveGravity(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_staticPressureParticle&&this.SolveStaticPressure(s),this.SolvePressure(s),this.SolveDamping(s),this.m_allParticleFlags&S.k_extraDampingFlags&&this.SolveExtraDamping(),this.m_allParticleFlags&i.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_springParticle&&this.SolveSpring(s),this.LimitVelocity(s),this.m_allGroupFlags&r.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping(),this.m_allParticleFlags&i.b2ParticleFlag.b2_barrierParticle&&this.SolveBarrier(s),this.SolveCollision(s),this.m_allGroupFlags&r.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(s),this.m_allParticleFlags&i.b2ParticleFlag.b2_wallParticle&&this.SolveWall();for(let t=0;t<this.m_count;t++)this.m_positionBuffer.data[t].AddScaled(s.dt,this.m_velocityBuffer.data[t])}}SolveCollision(e){const i=S.SolveCollision_s_aabb,r=this.m_positionBuffer.data,a=this.m_velocityBuffer.data,s=i;s.lowerBound.x=+t.b2_maxFloat,s.lowerBound.y=+t.b2_maxFloat,s.upperBound.x=-t.b2_maxFloat,s.upperBound.y=-t.b2_maxFloat;for(let t=0;t<this.m_count;t++){const i=a[t],o=r[t],n=o.x+e.dt*i.x,c=o.y+e.dt*i.y;s.lowerBound.x=Math.min(s.lowerBound.x,Math.min(o.x,n)),s.lowerBound.y=Math.min(s.lowerBound.y,Math.min(o.y,c)),s.upperBound.x=Math.max(s.upperBound.x,Math.max(o.x,n)),s.upperBound.y=Math.max(s.upperBound.y,Math.max(o.y,c))}const o=this.SolveCollision_callback;o.m_step=e,this.m_world.QueryAABB(s,t=>o.ReportFixture(t))}LimitVelocity(e){const i=this.m_velocityBuffer.data,r=this.GetCriticalVelocitySquared(e);for(let a=0;a<this.m_count;a++){const e=i[a],s=t.b2Vec2.Dot(e,e);s>r&&e.Scale(Math.sqrt(r/s))}}SolveGravity(e){const i=S.SolveGravity_s_gravity,r=this.m_velocityBuffer.data,a=t.b2Vec2.Scale(e.dt*this.m_def.gravityScale,this.m_world.GetGravity(),i);for(let t=0;t<this.m_count;t++)r[t].Add(a)}SolveBarrier(r){const a=S.SolveBarrier_s_aabb,s=S.SolveBarrier_s_va,o=S.SolveBarrier_s_vb,n=S.SolveBarrier_s_pba,c=S.SolveBarrier_s_vba,l=S.SolveBarrier_s_vc,f=S.SolveBarrier_s_pca,u=S.SolveBarrier_s_vca,h=S.SolveBarrier_s_qba,d=S.SolveBarrier_s_qca,_=S.SolveBarrier_s_dv,m=S.SolveBarrier_s_f,p=this.m_positionBuffer.data,B=this.m_velocityBuffer.data;for(let t=0;t<this.m_count;t++){0!=(this.m_flagsBuffer.data[t]&S.k_barrierWallFlags)&&B[t].SetZero()}const b=e.b2_barrierCollisionTime*r.dt,g=this.GetParticleMass();for(let e=0;e<this.m_pairBuffer.count;e++){const x=this.m_pairBuffer.data[e];if(x.flags&i.b2ParticleFlag.b2_barrierParticle){const e=x.indexA,i=x.indexB,y=p[e],P=p[i],S=a;t.b2Vec2.Min(y,P,S.lowerBound),t.b2Vec2.Max(y,P,S.upperBound);const C=this.m_groupBuffer[e],v=this.m_groupBuffer[i],F=this.GetLinearVelocity(C,e,y,s),G=this.GetLinearVelocity(v,i,P,o),A=t.b2Vec2.Subtract(P,y,n),w=t.b2Vec2.Subtract(G,F,c),V=this.GetInsideBoundsEnumerator(S);let I;for(;(I=V.GetNext())>=0;){const e=p[I],i=this.m_groupBuffer[I];if(C!==i&&v!==i){const a=this.GetLinearVelocity(i,I,e,l),s=t.b2Vec2.Subtract(e,y,f),o=t.b2Vec2.Subtract(a,F,u),n=t.b2Vec2.Cross(w,o),c=t.b2Vec2.Cross(A,o)-t.b2Vec2.Cross(s,w),p=t.b2Vec2.Cross(A,s);let x,P;const S=h,C=d;if(0===n){if(0===c)continue;if(!((P=-p/c)>=0&&P<b))continue;if(t.b2Vec2.AddScaled(A,P,w,S),t.b2Vec2.AddScaled(s,P,o,C),!((x=t.b2Vec2.Dot(S,C)/t.b2Vec2.Dot(S,S))>=0&&x<=1))continue}else{const e=c*c-4*p*n;if(e<0)continue;const i=Math.sqrt(e);let r=(-c-i)/(2*n),a=(-c+i)/(2*n);if(r>a){const t=r;r=a,a=t}if(P=r,t.b2Vec2.AddScaled(A,P,w,S),t.b2Vec2.AddScaled(s,P,o,C),x=t.b2Vec2.Dot(S,C)/t.b2Vec2.Dot(S,S),!(P>=0&&P<b&&x>=0&&x<=1)){if(!((P=a)>=0&&P<b))continue;if(t.b2Vec2.AddScaled(A,P,w,S),t.b2Vec2.AddScaled(s,P,o,C),!((x=t.b2Vec2.Dot(S,C)/t.b2Vec2.Dot(S,S))>=0&&x<=1))continue}}const v=_;v.x=F.x+x*w.x-a.x,v.y=F.y+x*w.y-a.y;const G=t.b2Vec2.Scale(g,v,m);if(i&&this.IsRigidGroup(i)){const r=i.GetMass(),a=i.GetInertia();r>0&&i.m_linearVelocity.AddScaled(1/r,G),a>0&&(i.m_angularVelocity+=t.b2Vec2.Cross(t.b2Vec2.Subtract(e,i.GetCenter(),t.b2Vec2.s_t0),G)/a)}else B[I].Add(v);this.ParticleApplyForce(I,G.Scale(-r.inv_dt))}}}}}SolveStaticPressure(r){this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);const a=this.GetCriticalPressure(r),s=this.m_def.staticPressureStrength*a,o=e.b2_maxParticlePressure*a,n=this.m_def.staticPressureRelaxation;for(let c=0;c<this.m_def.staticPressureIterations;c++){for(let t=0;t<this.m_count;t++)this.m_accumulationBuffer[t]=0;for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t];if(e.flags&i.b2ParticleFlag.b2_staticPressureParticle){const t=e.indexA,i=e.indexB,r=e.weight;this.m_accumulationBuffer[t]+=r*this.m_staticPressureBuffer[i],this.m_accumulationBuffer[i]+=r*this.m_staticPressureBuffer[t]}}for(let r=0;r<this.m_count;r++){const a=this.m_weightBuffer[r];if(this.m_flagsBuffer.data[r]&i.b2ParticleFlag.b2_staticPressureParticle){const i=(this.m_accumulationBuffer[r]+s*(a-e.b2_minParticleWeight))/(a+n);this.m_staticPressureBuffer[r]=(0,t.b2Clamp)(i,0,o)}else this.m_staticPressureBuffer[r]=0}}}ComputeWeight(){for(let t=0;t<this.m_count;t++)this.m_weightBuffer[t]=0;for(let t=0;t<this.m_bodyContactBuffer.count;t++){const e=this.m_bodyContactBuffer.data[t],i=e.index,r=e.weight;this.m_weightBuffer[i]+=r}for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t],i=e.indexA,r=e.indexB,a=e.weight;this.m_weightBuffer[i]+=a,this.m_weightBuffer[r]+=a}}SolvePressure(r){const a=S.SolvePressure_s_f,s=this.m_positionBuffer.data,o=this.m_velocityBuffer.data,n=this.GetCriticalPressure(r),c=this.m_def.pressureStrength*n,l=e.b2_maxParticlePressure*n;for(let t=0;t<this.m_count;t++){const i=this.m_weightBuffer[t],r=c*Math.max(0,i-e.b2_minParticleWeight);this.m_accumulationBuffer[t]=Math.min(r,l)}if(this.m_allParticleFlags&S.k_noPressureFlags)for(let t=0;t<this.m_count;t++)this.m_flagsBuffer.data[t]&S.k_noPressureFlags&&(this.m_accumulationBuffer[t]=0);if(this.m_allParticleFlags&i.b2ParticleFlag.b2_staticPressureParticle)for(let t=0;t<this.m_count;t++)this.m_flagsBuffer.data[t]&i.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[t]+=this.m_staticPressureBuffer[t]);const f=r.dt/(this.m_def.density*this.m_particleDiameter),u=this.GetParticleInvMass();for(let e=0;e<this.m_bodyContactBuffer.count;e++){const i=this.m_bodyContactBuffer.data[e],r=i.index,n=i.body,l=i.weight,h=i.mass,d=i.normal,_=s[r],m=this.m_accumulationBuffer[r]+c*l,p=t.b2Vec2.Scale(f*l*h*m,d,a);o[r].SubtractScaled(u,p),n.ApplyLinearImpulse(p,_,!0)}for(let e=0;e<this.m_contactBuffer.count;e++){const i=this.m_contactBuffer.data[e],r=i.indexA,s=i.indexB,n=i.weight,c=i.normal,l=this.m_accumulationBuffer[r]+this.m_accumulationBuffer[s],u=t.b2Vec2.Scale(f*n*l,c,a);o[r].Subtract(u),o[s].Add(u)}}SolveDamping(e){const i=S.SolveDamping_s_v,r=S.SolveDamping_s_f,a=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,o=this.m_def.dampingStrength,n=1/this.GetCriticalVelocity(e),c=this.GetParticleInvMass();for(let l=0;l<this.m_bodyContactBuffer.count;l++){const e=this.m_bodyContactBuffer.data[l],f=e.index,u=e.body,h=e.weight,d=e.mass,_=e.normal,m=a[f],p=t.b2Vec2.Subtract(u.GetLinearVelocityFromWorldPoint(m,t.b2Vec2.s_t0),s[f],i),B=t.b2Vec2.Dot(p,_);if(B<0){const e=Math.max(o*h,Math.min(-n*B,.5)),i=t.b2Vec2.Scale(e*d*B,_,r);s[f].AddScaled(c,i),u.ApplyLinearImpulse(i.Negate(),m,!0)}}for(let l=0;l<this.m_contactBuffer.count;l++){const e=this.m_contactBuffer.data[l],a=e.indexA,c=e.indexB,f=e.weight,u=e.normal,h=t.b2Vec2.Subtract(s[c],s[a],i),d=t.b2Vec2.Dot(h,u);if(d<0){const e=Math.max(o*f,Math.min(-n*d,.5)),i=t.b2Vec2.Scale(e*d,u,r);s[a].Add(i),s[c].Subtract(i)}}}SolveRigidDamping(){const e=S.SolveRigidDamping_s_t0,i=S.SolveRigidDamping_s_t1,r=S.SolveRigidDamping_s_p,a=S.SolveRigidDamping_s_v,s=[0],o=[0],n=[0],c=[0],l=[0],f=[0],u=this.m_positionBuffer.data,h=this.m_def.dampingStrength;for(let d=0;d<this.m_bodyContactBuffer.count;d++){const r=this.m_bodyContactBuffer.data[d],_=r.index,m=this.m_groupBuffer[_];if(m&&this.IsRigidGroup(m)){const d=r.body,p=r.normal,B=r.weight,b=u[_],g=t.b2Vec2.Subtract(d.GetLinearVelocityFromWorldPoint(b,e),m.GetLinearVelocityFromWorldPoint(b,i),a),x=t.b2Vec2.Dot(g,p);if(x<0){this.InitDampingParameterWithRigidGroupOrParticle(s,o,n,!0,m,_,b,p),this.InitDampingParameter(c,l,f,d.GetMass(),d.GetInertia()-d.GetMass()*d.GetLocalCenter().LengthSquared(),d.GetWorldCenter(),b,p);const e=h*Math.min(B,1)*this.ComputeDampingImpulse(s[0],o[0],n[0],c[0],l[0],f[0],x);this.ApplyDamping(s[0],o[0],n[0],!0,m,_,e,p),d.ApplyLinearImpulse(t.b2Vec2.Scale(-e,p,t.b2Vec2.s_t0),b,!0)}}}for(let d=0;d<this.m_contactBuffer.count;d++){const _=this.m_contactBuffer.data[d],m=_.indexA,p=_.indexB,B=_.normal,b=_.weight,g=this.m_groupBuffer[m],x=this.m_groupBuffer[p],y=this.IsRigidGroup(g),P=this.IsRigidGroup(x);if(g!==x&&(y||P)){const d=t.b2Vec2.Mid(u[m],u[p],r),_=t.b2Vec2.Subtract(this.GetLinearVelocity(x,p,d,e),this.GetLinearVelocity(g,m,d,i),a),S=t.b2Vec2.Dot(_,B);if(S<0){this.InitDampingParameterWithRigidGroupOrParticle(s,o,n,y,g,m,d,B),this.InitDampingParameterWithRigidGroupOrParticle(c,l,f,P,x,p,d,B);const t=h*b*this.ComputeDampingImpulse(s[0],o[0],n[0],c[0],l[0],f[0],S);this.ApplyDamping(s[0],o[0],n[0],y,g,m,t,B),this.ApplyDamping(c[0],l[0],f[0],P,x,p,-t,B)}}}}SolveExtraDamping(){const e=S.SolveExtraDamping_s_v,i=S.SolveExtraDamping_s_f,r=this.m_velocityBuffer.data,a=this.m_positionBuffer.data,s=this.GetParticleInvMass();for(let o=0;o<this.m_bodyContactBuffer.count;o++){const n=this.m_bodyContactBuffer.data[o],c=n.index;if(this.m_flagsBuffer.data[c]&S.k_extraDampingFlags){const o=n.body,l=n.mass,f=n.normal,u=a[c],h=t.b2Vec2.Subtract(o.GetLinearVelocityFromWorldPoint(u,t.b2Vec2.s_t0),r[c],e),d=t.b2Vec2.Dot(h,f);if(d<0){const e=t.b2Vec2.Scale(.5*l*d,f,i);r[c].AddScaled(s,e),o.ApplyLinearImpulse(e.Negate(),u,!0)}}}}SolveWall(){const t=this.m_velocityBuffer.data;for(let e=0;e<this.m_count;e++)this.m_flagsBuffer.data[e]&i.b2ParticleFlag.b2_wallParticle&&t[e].SetZero()}SolveRigid(e){const i=S.SolveRigid_s_position,a=S.SolveRigid_s_rotation,s=S.SolveRigid_s_transform,o=S.SolveRigid_s_velocityTransform,n=this.m_positionBuffer.data,c=this.m_velocityBuffer.data;for(let l=this.m_groupList;l;l=l.GetNext())if(l.m_groupFlags&r.b2ParticleGroupFlag.b2_rigidParticleGroup){l.UpdateStatistics();const r=a;r.Set(e.dt*l.m_angularVelocity);const f=t.b2Vec2.Add(l.m_center,t.b2Vec2.Subtract(t.b2Vec2.Scale(e.dt,l.m_linearVelocity,t.b2Vec2.s_t0),t.b2Rot.MultiplyVec2(r,l.m_center,t.b2Vec2.s_t1),t.b2Vec2.s_t0),i),u=s;u.SetPositionRotation(f,r),t.b2Transform.Multiply(u,l.m_transform,l.m_transform);const h=o;h.p.x=e.inv_dt*u.p.x,h.p.y=e.inv_dt*u.p.y,h.q.s=e.inv_dt*u.q.s,h.q.c=e.inv_dt*(u.q.c-1);for(let e=l.m_firstIndex;e<l.m_lastIndex;e++)t.b2Transform.MultiplyVec2(h,n[e],c[e])}}SolveElastic(e){const r=S.SolveElastic_s_pa,a=S.SolveElastic_s_pb,s=S.SolveElastic_s_pc,o=S.SolveElastic_s_r,n=S.SolveElastic_s_t0,c=this.m_positionBuffer.data,l=this.m_velocityBuffer.data,f=e.inv_dt*this.m_def.elasticStrength;for(let u=0;u<this.m_triadBuffer.count;u++){const h=this.m_triadBuffer.data[u];if(h.flags&i.b2ParticleFlag.b2_elasticParticle){const i=h.indexA,u=h.indexB,d=h.indexC,_=h.pa,m=h.pb,p=h.pc,B=r.Copy(c[i]),b=a.Copy(c[u]),g=s.Copy(c[d]),x=l[i],y=l[u],P=l[d];B.AddScaled(e.dt,x),b.AddScaled(e.dt,y),g.AddScaled(e.dt,P);const S=(B.x+b.x+g.x)/3,C=(B.y+b.y+g.y)/3;B.x-=S,B.y-=C,b.x-=S,b.y-=C,g.x-=S,g.y-=C;const v=o;v.s=t.b2Vec2.Cross(_,B)+t.b2Vec2.Cross(m,b)+t.b2Vec2.Cross(p,g),v.c=t.b2Vec2.Dot(_,B)+t.b2Vec2.Dot(m,b)+t.b2Vec2.Dot(p,g);const F=v.s*v.s+v.c*v.c;let G=1/Math.sqrt(F);Number.isFinite(G)||(G=198177537e11),v.s*=G,v.c*=G;const A=f*h.strength;t.b2Rot.MultiplyVec2(v,_,n),t.b2Vec2.Subtract(n,B,n),t.b2Vec2.Scale(A,n,n),x.Add(n),t.b2Rot.MultiplyVec2(v,m,n),t.b2Vec2.Subtract(n,b,n),t.b2Vec2.Scale(A,n,n),y.Add(n),t.b2Rot.MultiplyVec2(v,p,n),t.b2Vec2.Subtract(n,g,n),t.b2Vec2.Scale(A,n,n),P.Add(n)}}}SolveSpring(e){const r=S.SolveSpring_s_pa,a=S.SolveSpring_s_pb,s=S.SolveSpring_s_d,o=S.SolveSpring_s_f,n=this.m_positionBuffer.data,c=this.m_velocityBuffer.data,l=e.inv_dt*this.m_def.springStrength;for(let f=0;f<this.m_pairBuffer.count;f++){const u=this.m_pairBuffer.data[f];if(u.flags&i.b2ParticleFlag.b2_springParticle){const i=u.indexA,f=u.indexB,h=r.Copy(n[i]),d=a.Copy(n[f]),_=c[i],m=c[f];h.AddScaled(e.dt,_),d.AddScaled(e.dt,m);const p=t.b2Vec2.Subtract(d,h,s),B=u.distance,b=p.Length(),g=l*u.strength,x=t.b2Vec2.Scale(g*(B-b)/b,p,o);_.Subtract(x),m.Add(x)}}}SolveTensile(r){const a=S.SolveTensile_s_weightedNormal,s=S.SolveTensile_s_s,o=S.SolveTensile_s_f,n=this.m_velocityBuffer.data;for(let e=0;e<this.m_count;e++)this.m_accumulation2Buffer[e]=new t.b2Vec2,this.m_accumulation2Buffer[e].SetZero();for(let e=0;e<this.m_contactBuffer.count;e++){const r=this.m_contactBuffer.data[e];if(r.flags&i.b2ParticleFlag.b2_tensileParticle){const e=r.indexA,i=r.indexB,s=r.weight,o=r.normal,n=t.b2Vec2.Scale((1-s)*s,o,a);this.m_accumulation2Buffer[e].Subtract(n),this.m_accumulation2Buffer[i].Add(n)}}const c=this.GetCriticalVelocity(r),l=this.m_def.surfaceTensionPressureStrength*c,f=this.m_def.surfaceTensionNormalStrength*c,u=e.b2_maxParticleForce*c;for(let e=0;e<this.m_contactBuffer.count;e++){const r=this.m_contactBuffer.data[e];if(r.flags&i.b2ParticleFlag.b2_tensileParticle){const e=r.indexA,i=r.indexB,a=r.weight,c=r.normal,h=this.m_weightBuffer[e]+this.m_weightBuffer[i],d=t.b2Vec2.Subtract(this.m_accumulation2Buffer[i],this.m_accumulation2Buffer[e],s),_=Math.min(l*(h-2)+f*t.b2Vec2.Dot(d,c),u)*a,m=t.b2Vec2.Scale(_,c,o);n[e].Subtract(m),n[i].Add(m)}}}SolveViscous(){const e=S.SolveViscous_s_v,r=S.SolveViscous_s_f,a=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,{viscousStrength:o}=this.m_def,n=this.GetParticleInvMass();for(let c=0;c<this.m_bodyContactBuffer.count;c++){const l=this.m_bodyContactBuffer.data[c],f=l.index;if(this.m_flagsBuffer.data[f]&i.b2ParticleFlag.b2_viscousParticle){const i=l.body,c=l.weight,u=l.mass,h=a[f],d=t.b2Vec2.Subtract(i.GetLinearVelocityFromWorldPoint(h,t.b2Vec2.s_t0),s[f],e),_=t.b2Vec2.Scale(o*u*c,d,r);s[f].AddScaled(n,_),i.ApplyLinearImpulse(_.Negate(),h,!0)}}for(let c=0;c<this.m_contactBuffer.count;c++){const a=this.m_contactBuffer.data[c];if(a.flags&i.b2ParticleFlag.b2_viscousParticle){const i=a.indexA,n=a.indexB,c=a.weight,l=t.b2Vec2.Subtract(s[n],s[i],e),f=t.b2Vec2.Scale(o*c,l,r);s[i].Add(f),s[n].Subtract(f)}}}SolveRepulsive(e){const r=S.SolveRepulsive_s_f,a=this.m_velocityBuffer.data,s=this.m_def.repulsiveStrength*this.GetCriticalVelocity(e);for(let o=0;o<this.m_contactBuffer.count;o++){const e=this.m_contactBuffer.data[o];if(e.flags&i.b2ParticleFlag.b2_repulsiveParticle){const i=e.indexA,o=e.indexB;if(this.m_groupBuffer[i]!==this.m_groupBuffer[o]){const n=e.weight,c=e.normal,l=t.b2Vec2.Scale(s*n,c,r);a[i].Subtract(l),a[o].Add(l)}}}}SolvePowder(r){const a=S.SolvePowder_s_f,s=this.m_positionBuffer.data,o=this.m_velocityBuffer.data,n=this.m_def.powderStrength*this.GetCriticalVelocity(r),c=1-e.b2_particleStride,l=this.GetParticleInvMass();for(let e=0;e<this.m_bodyContactBuffer.count;e++){const r=this.m_bodyContactBuffer.data[e],f=r.index;if(this.m_flagsBuffer.data[f]&i.b2ParticleFlag.b2_powderParticle){const e=r.weight;if(e>c){const i=r.body,u=r.mass,h=s[f],d=r.normal,_=t.b2Vec2.Scale(n*u*(e-c),d,a);o[f].SubtractScaled(l,_),i.ApplyLinearImpulse(_,h,!0)}}}for(let e=0;e<this.m_contactBuffer.count;e++){const r=this.m_contactBuffer.data[e];if(r.flags&i.b2ParticleFlag.b2_powderParticle){const e=r.weight;if(e>c){const i=r.indexA,s=r.indexB,l=r.normal,f=t.b2Vec2.Scale(n*(e-c),l,a);o[i].Subtract(f),o[s].Add(f)}}}}SolveSolid(e){const i=S.SolveSolid_s_f,r=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);const a=e.inv_dt*this.m_def.ejectionStrength;for(let s=0;s<this.m_contactBuffer.count;s++){const e=this.m_contactBuffer.data[s],o=e.indexA,n=e.indexB;if(this.m_groupBuffer[o]!==this.m_groupBuffer[n]){const s=e.weight,c=e.normal,l=this.m_depthBuffer[o]+this.m_depthBuffer[n],f=t.b2Vec2.Scale(a*l*s,c,i);r[o].Subtract(f),r[n].Add(f)}}}SolveForce(t){const e=this.m_velocityBuffer.data,i=t.dt*this.GetParticleInvMass();for(let r=0;r<this.m_count;r++)e[r].AddScaled(i,this.m_forceBuffer[r]);this.m_hasForce=!1}SolveColorMixing(){const e=.5*this.m_def.colorMixingStrength;if(e)for(let r=0;r<this.m_contactBuffer.count;r++){const a=this.m_contactBuffer.data[r],s=a.indexA,o=a.indexB;if(this.m_flagsBuffer.data[s]&this.m_flagsBuffer.data[o]&i.b2ParticleFlag.b2_colorMixingParticle){const i=this.m_colorBuffer.data[s],r=this.m_colorBuffer.data[o];t.b2Color.MixColors(i,r,e)}}}SolveZombie(){let t=0;const a=[];for(let i=0;i<this.m_count;i++)a[i]=e.b2_invalidParticleIndex;let s=0;const o=this.m_world.GetDestructionListener();for(let r=0;r<this.m_count;r++){const n=this.m_flagsBuffer.data[r];if(n&i.b2ParticleFlag.b2_zombieParticle){if(n&i.b2ParticleFlag.b2_destructionListenerParticle&&(null==o||o.SayGoodbyeParticle(this,r)),this.m_handleIndexBuffer.data){const t=this.m_handleIndexBuffer.data[r];t&&(t.SetIndex(e.b2_invalidParticleIndex),this.m_handleIndexBuffer.data[r]=null)}a[r]=e.b2_invalidParticleIndex}else{if(a[r]=t,r!==t){if(this.m_handleIndexBuffer.data){const e=this.m_handleIndexBuffer.data[r];e&&e.SetIndex(t),this.m_handleIndexBuffer.data[t]=e}this.m_flagsBuffer.data[t]=this.m_flagsBuffer.data[r],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[t]=this.m_lastBodyContactStepBuffer.data[r]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[t]=this.m_bodyContactCountBuffer.data[r]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[t]=this.m_consecutiveContactStepsBuffer.data[r]),this.m_positionBuffer.data[t].Copy(this.m_positionBuffer.data[r]),this.m_velocityBuffer.data[t].Copy(this.m_velocityBuffer.data[r]),this.m_groupBuffer[t]=this.m_groupBuffer[r],this.m_hasForce&&this.m_forceBuffer[t].Copy(this.m_forceBuffer[r]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[t]=this.m_staticPressureBuffer[r]),this.m_depthBuffer&&(this.m_depthBuffer[t]=this.m_depthBuffer[r]),this.m_colorBuffer.data&&this.m_colorBuffer.data[t].Copy(this.m_colorBuffer.data[r]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[t]=this.m_userDataBuffer.data[r]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[t]=this.m_expirationTimeBuffer.data[r])}t++,s|=n}}const n=t=>t.index<0,c=t=>t.indexA<0||t.indexB<0,l=t=>t.index<0,f=t=>t.indexA<0||t.indexB<0,u=t=>t.indexA<0||t.indexB<0||t.indexC<0;for(let e=0;e<this.m_proxyBuffer.count;e++){const t=this.m_proxyBuffer.data[e];t.index=a[t.index]}this.m_proxyBuffer.RemoveIf(n);for(let e=0;e<this.m_contactBuffer.count;e++){const t=this.m_contactBuffer.data[e];t.indexA=a[t.indexA],t.indexB=a[t.indexB]}this.m_contactBuffer.RemoveIf(c);for(let e=0;e<this.m_bodyContactBuffer.count;e++){const t=this.m_bodyContactBuffer.data[e];t.index=a[t.index]}this.m_bodyContactBuffer.RemoveIf(l);for(let e=0;e<this.m_pairBuffer.count;e++){const t=this.m_pairBuffer.data[e];t.indexA=a[t.indexA],t.indexB=a[t.indexB]}this.m_pairBuffer.RemoveIf(f);for(let e=0;e<this.m_triadBuffer.count;e++){const t=this.m_triadBuffer.data[e];t.indexA=a[t.indexA],t.indexB=a[t.indexB],t.indexC=a[t.indexC]}if(this.m_triadBuffer.RemoveIf(u),this.m_indexByExpirationTimeBuffer.data){let t=0;for(let i=0;i<this.m_count;i++){const r=a[this.m_indexByExpirationTimeBuffer.data[i]];r!==e.b2_invalidParticleIndex&&(this.m_indexByExpirationTimeBuffer.data[t++]=r)}}for(let e=this.m_groupList;e;e=e.GetNext()){let i=t,s=0,o=!1;for(let t=e.m_firstIndex;t<e.m_lastIndex;t++){const e=a[t];e>=0?(i=Math.min(i,e),s=Math.max(s,e+1)):o=!0}i<s?(e.m_firstIndex=i,e.m_lastIndex=s,o&&e.m_groupFlags&r.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(e,e.m_groupFlags|r.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(e.m_firstIndex=0,e.m_lastIndex=0,e.m_groupFlags&r.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(e,e.m_groupFlags|r.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}this.m_count=t,this.m_allParticleFlags=s,this.m_needsUpdateAllParticleFlags=!1;for(let e=this.m_groupList;e;){const t=e.GetNext();e.m_groupFlags&r.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(e),e=t}}SolveLifetimes(t){this.m_timeElapsed=this.LifetimeToExpirationTime(t.dt);const e=this.GetQuantizedTimeElapsed(),i=this.m_expirationTimeBuffer.data,r=this.m_indexByExpirationTimeBuffer.data,a=this.GetParticleCount();this.m_expirationTimeBufferRequiresSorting&&(l(r,0,a,(t,e)=>{const r=i[t],a=i[e],s=r<=0;return s===a<=0?r>a:s}),this.m_expirationTimeBufferRequiresSorting=!1);for(let s=a-1;s>=0;--s){const t=r[s],a=i[t];if(e<a||a<=0)break;this.DestroyParticle(t)}}RotateBuffer(t,e,i){if(t!==e&&e!==i){if(_(this.m_flagsBuffer.data,t,e,i),this.m_lastBodyContactStepBuffer.data&&_(this.m_lastBodyContactStepBuffer.data,t,e,i),this.m_bodyContactCountBuffer.data&&_(this.m_bodyContactCountBuffer.data,t,e,i),this.m_consecutiveContactStepsBuffer.data&&_(this.m_consecutiveContactStepsBuffer.data,t,e,i),_(this.m_positionBuffer.data,t,e,i),_(this.m_velocityBuffer.data,t,e,i),_(this.m_groupBuffer,t,e,i),this.m_hasForce&&_(this.m_forceBuffer,t,e,i),this.m_staticPressureBuffer&&_(this.m_staticPressureBuffer,t,e,i),this.m_depthBuffer&&_(this.m_depthBuffer,t,e,i),this.m_colorBuffer.data&&_(this.m_colorBuffer.data,t,e,i),this.m_userDataBuffer.data&&_(this.m_userDataBuffer.data,t,e,i),this.m_handleIndexBuffer.data){_(this.m_handleIndexBuffer.data,t,e,i);for(let e=t;e<i;++e){const t=this.m_handleIndexBuffer.data[e];t&&t.SetIndex(r(t.GetIndex()))}}if(this.m_expirationTimeBuffer.data){_(this.m_expirationTimeBuffer.data,t,e,i);const a=this.GetParticleCount(),s=this.m_indexByExpirationTimeBuffer.data;for(let t=0;t<a;++t)s[t]=r(s[t])}for(let t=0;t<this.m_proxyBuffer.count;t++){const e=this.m_proxyBuffer.data[t];e.index=r(e.index)}for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t];e.indexA=r(e.indexA),e.indexB=r(e.indexB)}for(let t=0;t<this.m_bodyContactBuffer.count;t++){const e=this.m_bodyContactBuffer.data[t];e.index=r(e.index)}for(let t=0;t<this.m_pairBuffer.count;t++){const e=this.m_pairBuffer.data[t];e.indexA=r(e.indexA),e.indexB=r(e.indexB)}for(let t=0;t<this.m_triadBuffer.count;t++){const e=this.m_triadBuffer.data[t];e.indexA=r(e.indexA),e.indexB=r(e.indexB),e.indexC=r(e.indexC)}for(let t=this.m_groupList;t;t=t.GetNext())t.m_firstIndex=r(t.m_firstIndex),t.m_lastIndex=r(t.m_lastIndex-1)+1}function r(r){return r<t?r:r<e?r+i-e:r<i?r+t-e:r}}GetCriticalVelocity(t){return this.m_particleDiameter*t.inv_dt}GetCriticalVelocitySquared(t){const e=this.GetCriticalVelocity(t);return e*e}GetCriticalPressure(t){return this.m_def.density*this.GetCriticalVelocitySquared(t)}GetParticleStride(){return e.b2_particleStride*this.m_particleDiameter}GetParticleMass(){const t=this.GetParticleStride();return this.m_def.density*t*t}GetParticleInvMass(){const t=this.m_inverseDiameter*(1/e.b2_particleStride);return this.m_inverseDensity*t*t}GetFixtureContactFilter(){return this.m_allParticleFlags&i.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.GetContactManager().m_contactFilter:null}GetParticleContactFilter(){return this.m_allParticleFlags&i.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.GetContactManager().m_contactFilter:null}GetFixtureContactListener(){return this.m_allParticleFlags&i.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.GetContactManager().m_contactListener:null}GetParticleContactListener(){return this.m_allParticleFlags&i.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.GetContactManager().m_contactListener:null}SetUserOverridableBuffer(t,e){t.data=e,t.userSuppliedCapacity=e.length}SetGroupFlags(t,e){const i=t.m_groupFlags;(i^e)&r.b2ParticleGroupFlag.b2_solidParticleGroup&&(e|=r.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),i&~e&&(this.m_needsUpdateAllGroupFlags=!0),~this.m_allGroupFlags&e&&(e&r.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=e),t.m_groupFlags=e}static BodyContactCompare(t,e){return t.index===e.index?t.weight>e.weight:t.index<e.index}RemoveSpuriousBodyContacts(){l(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,S.BodyContactCompare);const e=S.RemoveSpuriousBodyContacts_s_n,i=S.RemoveSpuriousBodyContacts_s_pos,r=S.RemoveSpuriousBodyContacts_s_normal;let a=-1,o=0;this.m_bodyContactBuffer.count=u(this.m_bodyContactBuffer.data,n=>{if(n.index!==a&&(o=0,a=n.index),o++>3)return!0;const c=e.Copy(n.normal);c.Scale(this.m_particleDiameter*(1-n.weight));const l=t.b2Vec2.Add(this.m_positionBuffer.data[n.index],c,i);if(!n.fixture.TestPoint(l)){const e=n.fixture.GetShape().GetChildCount();for(let i=0;i<e;i++){const e=r;if((0,s.computeDistance)(n.fixture.GetShape(),n.fixture.GetBody().GetTransform(),l,e,i)<t.b2_linearSlop)return!1}return!0}return!1},this.m_bodyContactBuffer.count)}DetectStuckParticle(t){this.m_stuckThreshold<=0||(++this.m_bodyContactCountBuffer.data[t],2===this.m_bodyContactCountBuffer.data[t]&&(++this.m_consecutiveContactStepsBuffer.data[t],this.m_consecutiveContactStepsBuffer.data[t]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=t)),this.m_lastBodyContactStepBuffer.data[t]=this.m_timestamp)}ValidateParticleIndex(t){return t>=0&&t<this.GetParticleCount()&&t!==e.b2_invalidParticleIndex}GetQuantizedTimeElapsed(){return Math.floor(this.m_timeElapsed/4294967296)}LifetimeToExpirationTime(t){return this.m_timeElapsed+Math.floor(t/this.m_def.lifetimeGranularity*4294967296)}ForceCanBeApplied(t){return!(t&i.b2ParticleFlag.b2_wallParticle)}PrepareForceBuffer(){if(!this.m_hasForce){for(let t=0;t<this.m_count;t++)this.m_forceBuffer[t].SetZero();this.m_hasForce=!0}}IsRigidGroup(t){return null!==t&&0!=(t.m_groupFlags&r.b2ParticleGroupFlag.b2_rigidParticleGroup)}GetLinearVelocity(t,e,i,r){return t&&this.IsRigidGroup(t)?t.GetLinearVelocityFromWorldPoint(i,r):r.Copy(this.m_velocityBuffer.data[e])}InitDampingParameter(e,i,r,a,s,o,n,c){e[0]=a>0?1/a:0,i[0]=s>0?1/s:0,r[0]=t.b2Vec2.Cross(t.b2Vec2.Subtract(n,o,t.b2Vec2.s_t0),c)}InitDampingParameterWithRigidGroupOrParticle(t,e,r,a,s,o,n,c){if(s&&a)this.InitDampingParameter(t,e,r,s.GetMass(),s.GetInertia(),s.GetCenter(),n,c);else{const a=this.m_flagsBuffer.data[o];this.InitDampingParameter(t,e,r,a&i.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,n,n,c)}}ComputeDampingImpulse(t,e,i,r,a,s,o){const n=t+e*i*i+r+a*s*s;return n>0?o/n:0}ApplyDamping(t,e,i,r,a,s,o,n){a&&r?(a.m_linearVelocity.AddScaled(o*t,n),a.m_angularVelocity+=o*i*e):this.m_velocityBuffer.data[s].AddScaled(o*t,n)}}exports.b2ParticleSystem=S,S.xTruncBits=12,S.yTruncBits=12,S.tagBits=32,S.yOffset=1<<S.yTruncBits-1,S.yShift=S.tagBits-S.yTruncBits,S.xShift=S.tagBits-S.yTruncBits-S.xTruncBits,S.xScale=1<<S.xShift,S.xOffset=S.xScale*(1<<S.xTruncBits-1),S.yMask=(1<<S.yTruncBits)-1<<S.yShift,S.xMask=~S.yMask,S.DestroyParticlesInShape_s_aabb=new t.b2AABB,S.CreateParticleGroup_s_transform=new t.b2Transform,S.ComputeCollisionEnergy_s_v=new t.b2Vec2,S.QueryShapeAABB_s_aabb=new t.b2AABB,S.QueryPointAABB_s_aabb=new t.b2AABB,S.RayCast_s_aabb=new t.b2AABB,S.RayCast_s_p=new t.b2Vec2,S.RayCast_s_v=new t.b2Vec2,S.RayCast_s_n=new t.b2Vec2,S.RayCast_s_point=new t.b2Vec2,S.k_pairFlags=i.b2ParticleFlag.b2_springParticle,S.k_triadFlags=i.b2ParticleFlag.b2_elasticParticle,S.k_noPressureFlags=i.b2ParticleFlag.b2_powderParticle|i.b2ParticleFlag.b2_tensileParticle,S.k_extraDampingFlags=i.b2ParticleFlag.b2_staticPressureParticle,S.k_barrierWallFlags=i.b2ParticleFlag.b2_barrierParticle|i.b2ParticleFlag.b2_wallParticle,S.CreateParticlesStrokeShapeForGroup_s_edge=new t.b2EdgeShape,S.CreateParticlesStrokeShapeForGroup_s_d=new t.b2Vec2,S.CreateParticlesStrokeShapeForGroup_s_p=new t.b2Vec2,S.CreateParticlesFillShapeForGroup_s_aabb=new t.b2AABB,S.CreateParticlesFillShapeForGroup_s_p=new t.b2Vec2,S.UpdatePairsAndTriads_s_dab=new t.b2Vec2,S.UpdatePairsAndTriads_s_dbc=new t.b2Vec2,S.UpdatePairsAndTriads_s_dca=new t.b2Vec2,S.AddContact_s_d=new t.b2Vec2,S.UpdateBodyContacts_s_aabb=new t.b2AABB,S.Solve_s_subStep=t.b2TimeStep.Create(),S.SolveCollision_s_aabb=new t.b2AABB,S.SolveGravity_s_gravity=new t.b2Vec2,S.SolveBarrier_s_aabb=new t.b2AABB,S.SolveBarrier_s_va=new t.b2Vec2,S.SolveBarrier_s_vb=new t.b2Vec2,S.SolveBarrier_s_pba=new t.b2Vec2,S.SolveBarrier_s_vba=new t.b2Vec2,S.SolveBarrier_s_vc=new t.b2Vec2,S.SolveBarrier_s_pca=new t.b2Vec2,S.SolveBarrier_s_vca=new t.b2Vec2,S.SolveBarrier_s_qba=new t.b2Vec2,S.SolveBarrier_s_qca=new t.b2Vec2,S.SolveBarrier_s_dv=new t.b2Vec2,S.SolveBarrier_s_f=new t.b2Vec2,S.SolvePressure_s_f=new t.b2Vec2,S.SolveDamping_s_v=new t.b2Vec2,S.SolveDamping_s_f=new t.b2Vec2,S.SolveRigidDamping_s_t0=new t.b2Vec2,S.SolveRigidDamping_s_t1=new t.b2Vec2,S.SolveRigidDamping_s_p=new t.b2Vec2,S.SolveRigidDamping_s_v=new t.b2Vec2,S.SolveExtraDamping_s_v=new t.b2Vec2,S.SolveExtraDamping_s_f=new t.b2Vec2,S.SolveRigid_s_position=new t.b2Vec2,S.SolveRigid_s_rotation=new t.b2Rot,S.SolveRigid_s_transform=new t.b2Transform,S.SolveRigid_s_velocityTransform=new t.b2Transform,S.SolveElastic_s_pa=new t.b2Vec2,S.SolveElastic_s_pb=new t.b2Vec2,S.SolveElastic_s_pc=new t.b2Vec2,S.SolveElastic_s_r=new t.b2Rot,S.SolveElastic_s_t0=new t.b2Vec2,S.SolveSpring_s_pa=new t.b2Vec2,S.SolveSpring_s_pb=new t.b2Vec2,S.SolveSpring_s_d=new t.b2Vec2,S.SolveSpring_s_f=new t.b2Vec2,S.SolveTensile_s_weightedNormal=new t.b2Vec2,S.SolveTensile_s_s=new t.b2Vec2,S.SolveTensile_s_f=new t.b2Vec2,S.SolveViscous_s_v=new t.b2Vec2,S.SolveViscous_s_f=new t.b2Vec2,S.SolveRepulsive_s_f=new t.b2Vec2,S.SolvePowder_s_f=new t.b2Vec2,S.SolveSolid_s_f=new t.b2Vec2,S.RemoveSpuriousBodyContacts_s_n=new t.b2Vec2,S.RemoveSpuriousBodyContacts_s_pos=new t.b2Vec2,S.RemoveSpuriousBodyContacts_s_normal=new t.b2Vec2;class C{constructor(){this.index=e.b2_invalidParticleIndex,this.tag=0}static CompareProxyProxy(t,e){return t.tag<e.tag}static CompareTagProxy(t,e){return t<e.tag}static CompareProxyTag(t,e){return t.tag<e}}exports.b2ParticleSystem_Proxy=C;class v{constructor(t,e,i,r,a){this.m_system=t,this.m_xLower=(e&S.xMask)>>>0,this.m_xUpper=(i&S.xMask)>>>0,this.m_yLower=(e&S.yMask)>>>0,this.m_yUpper=(i&S.yMask)>>>0,this.m_first=r,this.m_last=a}GetNext(){for(;this.m_first<this.m_last;){const t=(this.m_system.m_proxyBuffer.data[this.m_first].tag&S.xMask)>>>0;if(t>=this.m_xLower&&t<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return e.b2_invalidParticleIndex}}exports.b2ParticleSystem_InsideBoundsEnumerator=v;class F{constructor(){this.next=null,this.count=0,this.index=0}}exports.b2ParticleSystem_ParticleListNode=F;class G{Allocate(t,e){return e}Clear(){}GetCount(){return 0}Invalidate(t){}GetValidBuffer(){return[]}GetBuffer(){return[]}SetCount(t){}}exports.b2ParticleSystem_FixedSetAllocator=G;class A{constructor(t,i){this.second=e.b2_invalidParticleIndex,this.first=t,this.second=i}}exports.b2ParticleSystem_FixtureParticle=A;class w extends G{Initialize(t,e){}Find(t){return e.b2_invalidParticleIndex}}exports.b2ParticleSystem_FixtureParticleSet=w;class V{constructor(t,i){this.first=e.b2_invalidParticleIndex,this.second=e.b2_invalidParticleIndex,this.first=t,this.second=i}}exports.b2ParticleSystem_ParticlePair=V;class I extends G{Initialize(t,e){}Find(t){return e.b2_invalidParticleIndex}}exports.b2ParticlePairSet=I;class D{IsNecessary(t){return!0}ShouldCreatePair(t,e){return!0}ShouldCreateTriad(t,e,i){return!0}}exports.b2ParticleSystem_ConnectionFilter=D;class T extends D{constructor(t){super(),this.m_threshold=0,this.m_threshold=t}ShouldCreatePair(t,e){return t<this.m_threshold&&this.m_threshold<=e||e<this.m_threshold&&this.m_threshold<=t}ShouldCreateTriad(t,e,i){return(t<this.m_threshold||e<this.m_threshold||i<this.m_threshold)&&(this.m_threshold<=t||this.m_threshold<=e||this.m_threshold<=i)}}exports.b2ParticleSystem_JoinParticleGroupsFilter=T;class R extends t.b2Shape{constructor(e,i=e.length){super(t.b2ShapeType.e_unknown,0),this.m_shapeCount=0,this.m_shapes=e,this.m_shapeCount=i}Clone(){throw new Error}GetChildCount(){return 1}TestPoint(t,e){for(let i=0;i<this.m_shapeCount;i++)if(this.m_shapes[i].TestPoint(t,e))return!0;return!1}RayCast(t,e,i,r){return!1}ComputeAABB(e,i,r){const a=new t.b2AABB;e.lowerBound.x=+t.b2_maxFloat,e.lowerBound.y=+t.b2_maxFloat,e.upperBound.x=-t.b2_maxFloat,e.upperBound.y=-t.b2_maxFloat;for(let t=0;t<this.m_shapeCount;t++){const r=this.m_shapes[t].GetChildCount();for(let s=0;s<r;s++){const r=a;this.m_shapes[t].ComputeAABB(r,i,s),e.Combine1(r)}}}ComputeMass(t,e){}SetupDistanceProxy(t,e){}Draw(){}}exports.b2ParticleSystem_CompositeShape=R;class M extends D{constructor(t){super(),this.m_flagsBuffer=t}IsNecessary(t){return 0!=(this.m_flagsBuffer.data[t]&i.b2ParticleFlag.b2_reactiveParticle)}}exports.b2ParticleSystem_ReactiveFilter=M;
},{"@box2d/core":"FjWk","./b2_settings":"UVin","./b2_particle":"WnZB","./b2_particle_group":"T8II","./b2_voronoi_diagram":"fvR8","./b2_compute_distance":"ql9o","./b2_fixture_particle_query_callbacks":"SHy1"}],"C9l3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../particle/b2_particle"),r=require("../particle/b2_particle_system");function s(e){let r=t.b2_maxFloat;for(let t=e.GetParticleSystemList();null!==t;t=t.m_next)r=Math.min(r,t.GetRadius());return r}(0,t.b2_augment)(t.b2World,{Create(t,e){const r=t(e);return r.m_particleSystemList=null,r}}),Object.assign(t.b2World.prototype,{CreateParticleSystem(e){(0,t.b2Assert)(!this.IsLocked());const s=new r.b2ParticleSystem(e,this);return s.m_prev=null,s.m_next=this.m_particleSystemList,this.m_particleSystemList&&(this.m_particleSystemList.m_prev=s),this.m_particleSystemList=s,s},DestroyParticleSystem(e){(0,t.b2Assert)(!this.IsLocked()),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_particleSystemList&&(this.m_particleSystemList=e.m_next)},GetParticleSystemList(){return this.m_particleSystemList},CalculateReasonableParticleIterations(t){return null===this.m_particleSystemList?1:(0,e.b2CalculateParticleIterations)(this.GetGravity().Length(),s(this),t)}}),(0,t.b2_augment)(t.b2World.prototype,{CreateBody(e,r={}){const s=e(r);return s.m_xf0=new t.b2Transform,s},Solve(t,e){for(let r=this.m_particleSystemList;r;r=r.m_next)r.Solve(e);for(let r=this.GetBodyList();r;r=r.GetNext())r.m_xf0.Copy(r.GetTransform());t(e)}});
},{"@box2d/core":"FjWk","../particle/b2_particle":"WnZB","../particle/b2_particle_system":"SMjx"}],"YuER":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core");(0,e.b2_augment)(e.b2Body.prototype,{SetTransformXY(e,t,o,r){e(t,o,r),this.m_xf0.Copy(this.GetTransform())}});
},{"@box2d/core":"FjWk"}],"XSPm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core");Object.assign(t.b2DestructionListener.prototype,{SayGoodbyeParticleGroup(){},SayGoodbyeParticle(){}}),Object.assign(t.b2ContactFilter.prototype,{SayGoodbyeParticleGroup:()=>!0,SayGoodbyeParticle:()=>!0}),Object.assign(t.b2ContactListener.prototype,{BeginContactFixtureParticle(){},EndContactFixtureParticle(){},BeginContactParticleParticle(){},EndContactParticleParticle(){}});
},{"@box2d/core":"FjWk"}],"Lftl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core");(0,e.b2_augment)(e.b2TimeStep,{Create(e){const t=e();return t.config.particleIterations=0,t}});
},{"@box2d/core":"FjWk"}],"OQOY":[function(require,module,exports) {
"use strict";function e(e,t){const r=t.GetParticleCount();if(r){const s=t.GetRadius(),o=t.GetPositionBuffer();if(t.m_colorBuffer.data){const i=t.GetColorBuffer();e.DrawParticles(o,s,i,r)}else e.DrawParticles(o,s,null,r)}}function t(t,r){for(let s=r.GetParticleSystemList();s;s=s.m_next)e(t,s)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawParticleSystems=void 0,exports.DrawParticleSystems=t;
},{}],"eX67":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t);var c=Object.getOwnPropertyDescriptor(r,t);c&&("get"in c?r.__esModule:!c.writable&&!c.configurable)||(c={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,c)}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),require("./dynamics/b2_world"),require("./dynamics/b2_body"),require("./dynamics/b2_world_callbacks"),require("./dynamics/b2_time_step"),r(require("./particle/b2_particle"),exports),r(require("./particle/b2_particle_group"),exports),r(require("./particle/b2_particle_system"),exports),r(require("./particle/b2_particle_draw_helper"),exports);
},{"./dynamics/b2_world":"C9l3","./dynamics/b2_body":"YuER","./dynamics/b2_world_callbacks":"XSPm","./dynamics/b2_time_step":"Lftl","./particle/b2_particle":"WnZB","./particle/b2_particle_group":"T8II","./particle/b2_particle_system":"SMjx","./particle/b2_particle_draw_helper":"OQOY"}],"y9CM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Settings=void 0;const t=require("@box2d/particles"),i=()=>void 0;class s{constructor(){this.m_testIndex=0,this.m_windowWidth=1600,this.m_windowHeight=900,this.m_hertz=60,this.m_velocityIterations=8,this.m_positionIterations=3,this.m_particleIterations=(0,t.b2CalculateParticleIterations)(10,.04,1/this.m_hertz),this.m_drawShapes=!0,this.m_drawParticles=!0,this.m_drawJoints=!0,this.m_drawAABBs=!1,this.m_drawContactPoints=!1,this.m_drawContactNormals=!1,this.m_drawContactImpulse=!1,this.m_drawFrictionImpulse=!1,this.m_drawCOMs=!1,this.m_drawControllers=!0,this.m_drawStats=!1,this.m_drawInputHelp=!0,this.m_drawFpsMeter=!0,this.m_drawProfile=!1,this.m_enableWarmStarting=!0,this.m_enableContinuous=!0,this.m_enableSubStepping=!1,this.m_enableSleep=!0,this.m_pause=!1,this.m_singleStep=!1,this.m_debugDraw={Prepare:i,Finish:i,PushTransform:i,PopTransform:i,DrawPolygon:i,DrawSolidPolygon:i,DrawCircle:i,DrawSolidCircle:i,DrawSegment:i,DrawTransform:i,DrawPoint:i,DrawParticles:i,DrawAABB:i,DrawStringWorld:i}}}exports.Settings=s;
},{"@box2d/particles":"eX67"}],"MS76":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core");(0,t.b2_augment)(t.b2World,{Create(t,e){const r=t(e);return r.m_controllerList=null,r.m_controllerCount=0,r}}),Object.assign(t.b2World.prototype,{AddController(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t},RemoveController(t){return t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),--this.m_controllerCount,t.m_prev=null,t.m_next=null,t}}),(0,t.b2_augment)(t.b2World.prototype,{CreateBody(t,e={}){const r=t(e);return r.m_controllerList=null,r.m_controllerCount=0,r},DestroyBody(t,e){let r=e.m_controllerList;for(;r;){const t=r;r=r.nextController,t.controller.RemoveBody(e)}t(e)},Solve(t,e){for(let r=this.m_controllerList;r;r=r.m_next)r.Step(e);t(e)}});
},{"@box2d/core":"FjWk"}],"tXpv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"mLhX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Controller=exports.b2ControllerEdge=void 0;const t=require("@box2d/core");class o{constructor(t,o){this.prevBody=null,this.nextBody=null,this.prevController=null,this.nextController=null,this.controller=t,this.body=o}}exports.b2ControllerEdge=o;class r{constructor(){this.m_bodyList=null,this.m_bodyCount=0,this.m_prev=null,this.m_next=null}GetNext(){return this.m_next}GetPrev(){return this.m_prev}GetBodyList(){return this.m_bodyList}AddBody(t){const r=new o(this,t);r.nextBody=this.m_bodyList,r.prevBody=null,this.m_bodyList&&(this.m_bodyList.prevBody=r),this.m_bodyList=r,++this.m_bodyCount,r.nextController=t.m_controllerList,r.prevController=null,t.m_controllerList&&(t.m_controllerList.prevController=r),t.m_controllerList=r,++t.m_controllerCount}RemoveBody(o){(0,t.b2Assert)(this.m_bodyCount>0,"Controller is empty");let r=this.m_bodyList;for(;r&&r.body!==o;)r=r.nextBody;(0,t.b2Assert)(null!==r,"Body is not attached to the controller"),r.prevBody&&(r.prevBody.nextBody=r.nextBody),r.nextBody&&(r.nextBody.prevBody=r.prevBody),this.m_bodyList===r&&(this.m_bodyList=r.nextBody),--this.m_bodyCount,r.nextController&&(r.nextController.prevController=r.prevController),r.prevController&&(r.prevController.nextController=r.nextController),o.m_controllerList===r&&(o.m_controllerList=r.nextController),--o.m_controllerCount}Clear(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0}}exports.b2Controller=r;
},{"@box2d/core":"FjWk"}],"bE4i":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2SubmergedAreaForShape=exports.b2SubmergedAreaByShape=void 0;const e=require("@box2d/core"),r=new e.b2Vec2,t=new e.b2MassData,s=new e.b2Vec2,o=new e.b2Vec2,c=new e.b2Vec2;function n(n,a,u,p,i){const b=n,m=e.b2Rot.TransposeMultiplyVec2(p.q,a,r),y=u-e.b2Vec2.Dot(a,p.p),_=[];let S=0,x=-1,d=-1,h=!1;for(let r=0;r<b.m_count;++r){_[r]=e.b2Vec2.Dot(m,b.m_vertices[r])-y;const t=_[r]<-e.b2_epsilon;r>0&&(t?h||(x=r-1,S++):h&&(d=r-1,S++)),h=t}switch(S){case 0:if(h){const r=t;return b.ComputeMass(r,1),e.b2Transform.MultiplyVec2(p,r.center,i),r.mass}return 0;case 1:-1===x?x=b.m_count-1:d=b.m_count-1}const l=(x+1)%b.m_count,f=(d+1)%b.m_count,v=(0-_[x])/(_[l]-_[x]),V=(0-_[d])/(_[f]-_[d]),g=s.Set(b.m_vertices[x].x*(1-v)+b.m_vertices[l].x*v,b.m_vertices[x].y*(1-v)+b.m_vertices[l].y*v),M=o.Set(b.m_vertices[d].x*(1-V)+b.m_vertices[f].x*V,b.m_vertices[d].y*(1-V)+b.m_vertices[f].y*V);let A=0;const T=c.SetZero();let w,B=b.m_vertices[l],D=l;for(;D!==f;){w=(D=(D+1)%b.m_count)===f?M:b.m_vertices[D];const e=.5*((B.x-g.x)*(w.y-g.y)-(B.y-g.y)*(w.x-g.x));A+=e,T.x+=e*(g.x+B.x+w.x)/3,T.y+=e*(g.y+B.y+w.y)/3,B=w}return T.Scale(1/A),e.b2Transform.MultiplyVec2(p,T,i),A}function a(e,r,t,s,o){return o.SetZero(),0}function u(e,r,t,s,o){return o.SetZero(),0}function p(r,t,s,o,c){const n=r,a=e.b2Transform.MultiplyVec2(o,n.m_p,new e.b2Vec2),u=-(e.b2Vec2.Dot(t,a)-s);if(u<-n.m_radius+e.b2_epsilon)return 0;if(u>n.m_radius)return c.Copy(a),Math.PI*n.m_radius*n.m_radius;const p=n.m_radius*n.m_radius,i=u*u,b=p*(Math.asin(u/n.m_radius)+Math.PI/2)+u*Math.sqrt(p-i),m=-2/3*(p-i)**1.5/b;return c.x=a.x+t.x*m,c.y=a.y+t.y*m,b}function i(e,r,t,s,o){const c=exports.b2SubmergedAreaByShape[e.GetType()];return c?c(e,r,t,s,o):0}exports.b2SubmergedAreaByShape=[],exports.b2SubmergedAreaByShape[e.b2ShapeType.e_circle]=p,exports.b2SubmergedAreaByShape[e.b2ShapeType.e_edge]=a,exports.b2SubmergedAreaByShape[e.b2ShapeType.e_polygon]=n,exports.b2SubmergedAreaByShape[e.b2ShapeType.e_chain]=u,exports.b2SubmergedAreaForShape=i;
},{"@box2d/core":"FjWk"}],"r0L6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2BuoyancyController=void 0;const e=require("@box2d/core"),t=require("./b2_controller"),r=require("./b2_submerged_area"),o={buoyancyForce:new e.b2Vec2};class s extends t.b2Controller{constructor(){super(...arguments),this.normal=new e.b2Vec2(0,1),this.offset=0,this.density=0,this.velocity=new e.b2Vec2,this.linearDrag=0,this.angularDrag=0,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=new e.b2Vec2}Step(t){if(!this.m_bodyList)return;this.useWorldGravity&&this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity());const{buoyancyForce:s}=o;for(let o=this.m_bodyList;o;o=o.nextBody){const{body:t}=o;if(!t.IsAwake())continue;const i=new e.b2Vec2,n=new e.b2Vec2;let y=0,a=0;for(let o=t.GetFixtureList();o;o=o.GetNext()){const s=new e.b2Vec2,c=(0,r.b2SubmergedAreaForShape)(o.GetShape(),this.normal,this.offset,t.GetTransform(),s);y+=c,i.x+=c*s.x,i.y+=c*s.y;let l=0;a+=c*(l=this.useDensity?o.GetDensity():1),n.x+=c*s.x*l,n.y+=c*s.y*l}if(i.x/=y,i.y/=y,n.x/=a,n.y/=a,y<e.b2_epsilon)continue;e.b2Vec2.Negate(this.gravity,s),s.Scale(this.density*y),t.ApplyForce(s,n);const c=t.GetLinearVelocityFromWorldPoint(i,new e.b2Vec2);c.Subtract(this.velocity),c.Scale(-this.linearDrag*y),t.ApplyForce(c,i),t.ApplyTorque(-t.GetInertia()/t.GetMass()*y*t.GetAngularVelocity()*this.angularDrag)}}}exports.b2BuoyancyController=s;
},{"@box2d/core":"FjWk","./b2_controller":"mLhX","./b2_submerged_area":"bE4i"}],"k0iu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ConstantAccelController=void 0;const e=require("@box2d/core"),t=require("./b2_controller"),o=new e.b2Vec2;class r extends t.b2Controller{constructor(){super(...arguments),this.A=new e.b2Vec2}Step(t){e.b2Vec2.Scale(t.dt,this.A,o);for(let r=this.m_bodyList;r;r=r.nextBody){const{body:t}=r;t.IsAwake()&&t.SetLinearVelocity(e.b2Vec2.Add(t.GetLinearVelocity(),o,e.b2Vec2.s_t0))}}}exports.b2ConstantAccelController=r;
},{"@box2d/core":"FjWk","./b2_controller":"mLhX"}],"JSuc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ConstantForceController=void 0;const e=require("@box2d/core"),o=require("./b2_controller");class t extends o.b2Controller{constructor(){super(...arguments),this.F=new e.b2Vec2}Step(e){for(let o=this.m_bodyList;o;o=o.nextBody){const{body:e}=o;e.IsAwake()&&e.ApplyForce(this.F,e.GetWorldCenter())}}}exports.b2ConstantForceController=t;
},{"@box2d/core":"FjWk","./b2_controller":"mLhX"}],"mzbk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2GravityController=void 0;const e=require("@box2d/core"),t=require("./b2_controller"),o=new e.b2Vec2;class s extends t.b2Controller{constructor(){super(...arguments),this.G=1,this.invSqr=!0}Step(t){if(this.invSqr)for(let s=this.m_bodyList;s;s=s.nextBody){const t=s.body,r=t.GetWorldCenter(),l=t.GetMass();for(let i=this.m_bodyList;i&&i!==s;i=i.nextBody){const s=i.body,n=s.GetWorldCenter(),y=s.GetMass(),c=n.x-r.x,d=n.y-r.y,a=c*c+d*d;a<e.b2_epsilon||(o.Set(c,d).Scale(this.G/a/Math.sqrt(a)*l*y),t.IsAwake()&&t.ApplyForce(o,r),s.IsAwake()&&s.ApplyForce(o.Scale(-1),n))}}else for(let s=this.m_bodyList;s;s=s.nextBody){const t=s.body,r=t.GetWorldCenter(),l=t.GetMass();for(let i=this.m_bodyList;i&&i!==s;i=i.nextBody){const s=i.body,n=s.GetWorldCenter(),y=s.GetMass(),c=n.x-r.x,d=n.y-r.y,a=c*c+d*d;a<e.b2_epsilon||(o.Set(c,d).Scale(this.G/a*l*y),t.IsAwake()&&t.ApplyForce(o,r),s.IsAwake()&&s.ApplyForce(o.Scale(-1),n))}}}}exports.b2GravityController=s;
},{"@box2d/core":"FjWk","./b2_controller":"mLhX"}],"GKPc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2TensorDampingController=void 0;const e=require("@box2d/core"),t=require("./b2_controller"),s=new e.b2Vec2;class i extends t.b2Controller{constructor(){super(...arguments),this.T=new e.b2Mat22,this.maxTimestep=0}Step(t){let i=t.dt;if(!(i<=e.b2_epsilon)){i>this.maxTimestep&&this.maxTimestep>0&&(i=this.maxTimestep);for(let t=this.m_bodyList;t;t=t.nextBody){const{body:o}=t;o.IsAwake()&&(o.GetWorldVector(e.b2Mat22.MultiplyVec2(this.T,o.GetLocalVector(o.GetLinearVelocity(),e.b2Vec2.s_t0),e.b2Vec2.s_t1),s),o.SetLinearVelocity(e.b2Vec2.Add(o.GetLinearVelocity(),e.b2Vec2.Scale(i,s,e.b2Vec2.s_t0),e.b2Vec2.s_t1)))}}}SetAxisAligned(e,t){this.T.ex.x=-e,this.T.ex.y=0,this.T.ey.x=0,this.T.ey.y=-t,this.maxTimestep=e>0||t>0?1/Math.max(e,t):0}}exports.b2TensorDampingController=i;
},{"@box2d/core":"FjWk","./b2_controller":"mLhX"}],"sOvg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawControllers=void 0;const o=require("@box2d/core"),r=require("./b2_buoyancy_controller"),e={buoyancyController:new o.b2Color(0,0,.8)},n=new o.b2Vec2,l=new o.b2Vec2,t=100;function a(o,r){n.x=r.normal.x*r.offset+r.normal.y*t,n.y=r.normal.y*r.offset-r.normal.x*t,l.x=r.normal.x*r.offset-r.normal.y*t,l.y=r.normal.y*r.offset+r.normal.x*t,o.DrawSegment(n,l,e.buoyancyController)}function c(o,e){for(let n=e.m_controllerList;n;n=n.m_next)n instanceof r.b2BuoyancyController&&a(o,n)}exports.DrawControllers=c;
},{"@box2d/core":"FjWk","./b2_buoyancy_controller":"r0L6"}],"mFGS":[function(require,module,exports) {
"use strict";var r=this&&this.__createBinding||(Object.create?function(r,e,o,t){void 0===t&&(t=o);var n=Object.getOwnPropertyDescriptor(e,o);n&&("get"in n?e.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,t,n)}:function(r,e,o,t){void 0===t&&(t=o),r[t]=e[o]}),e=this&&this.__exportStar||function(e,o){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(o,t)||r(o,e,t)};Object.defineProperty(exports,"__esModule",{value:!0}),require("./dynamics/b2_world"),require("./dynamics/b2_body"),e(require("./controller/b2_controller"),exports),e(require("./controller/b2_buoyancy_controller"),exports),e(require("./controller/b2_constant_accel_controller"),exports),e(require("./controller/b2_constant_force_controller"),exports),e(require("./controller/b2_gravity_controller"),exports),e(require("./controller/b2_tensor_damping_controller"),exports),e(require("./controller/b2_controller_draw_helper"),exports);
},{"./dynamics/b2_world":"MS76","./dynamics/b2_body":"tXpv","./controller/b2_controller":"mLhX","./controller/b2_buoyancy_controller":"r0L6","./controller/b2_constant_accel_controller":"k0iu","./controller/b2_constant_force_controller":"JSuc","./controller/b2_gravity_controller":"mzbk","./controller/b2_tensor_damping_controller":"GKPc","./controller/b2_controller_draw_helper":"sOvg"}],"XTIe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Test=exports.ContactPoint=exports.DestructionListener=exports.getTestsGrouped=exports.registerTest=void 0;const t=require("@box2d/core"),e=require("@box2d/particles"),o=require("@box2d/controllers"),s=require("./utils/hotkeys"),i=require("./utils/camera"),n={aabb:new t.b2AABB},r={Controllers:[],Examples:[],Joints:[],Collision:[],Benchmark:[],Rope:[],Forces:[],Stacking:[],Geometry:[],Solver:[],Bugs:[],Continuous:[],Lights:[],Particles:[]};function a(t,e,o){r[t].push({group:t,name:e,TestClass:o})}function m(){return Object.keys(r).sort().map(t=>{return{name:t,tests:r[t].sort((t,e)=>t.name<e.name?-1:1)}})}exports.registerTest=a,exports.getTestsGrouped=m;class l extends t.b2DestructionListener{constructor(t){super(),this.test=t}SayGoodbyeJoint(t){this.test.m_mouseJoint===t?this.test.m_mouseJoint=null:this.test.JointDestroyed(t)}SayGoodbyeFixture(t){}SayGoodbyeParticleGroup(t){this.test.ParticleGroupDestroyed(t)}}exports.DestructionListener=l;class h{constructor(){this.normal=new t.b2Vec2,this.position=new t.b2Vec2,this.state=t.b2PointState.b2_nullState,this.normalImpulse=0,this.tangentImpulse=0,this.separation=0}}exports.ContactPoint=h;const _=(t,e,o)=>`${t.toFixed(2)} [${e.toFixed(2)}] (${o.toFixed(2)})`;class d extends t.b2ContactListener{constructor(e={x:0,y:-10}){super(),this.m_bomb=null,this.m_textLines=[],this.m_debugLines=[],this.m_statisticLines=[],this.m_mouseJoint=null,this.m_points=Array.from({length:d.k_maxContactPoints},()=>new h),this.m_pointCount=0,this.m_bombSpawnPoint=new t.b2Vec2,this.m_bombSpawning=!1,this.m_mouseWorld=new t.b2Vec2,this.m_mouseTracing=!1,this.m_mouseTracerPosition=new t.b2Vec2,this.m_mouseTracerVelocity=new t.b2Vec2,this.m_stepCount=0,this.m_maxProfile=new t.b2Profile,this.m_totalProfile=new t.b2Profile,this.m_testControlGroups=[],this.m_world=t.b2World.Create(e),this.m_destructionListener=new l(this),this.m_world.SetDestructionListener(this.m_destructionListener),this.m_world.SetContactListener(this),this.m_groundBody=this.m_world.CreateBody()}setupControls(){}addTestControlGroup(t,e){this.m_testControlGroups.push({legend:t,controls:e})}getBaseHotkeys(){return[(0,s.hotKeyPress)(" ","Launch Bomb",()=>{this.LaunchBomb()})]}getHotkeys(){return[]}JointDestroyed(t){}ParticleGroupDestroyed(t){}BeginContact(t){}EndContact(t){}PreSolve(e,o){const s=e.GetManifold();if(0===s.pointCount)return;const i=e.GetFixtureA(),n=e.GetFixtureB(),r=d.PreSolve_s_state1,a=d.PreSolve_s_state2;(0,t.b2GetPointStates)(r,a,o,s);const m=d.PreSolve_s_worldManifold;e.GetWorldManifold(m);for(let t=0;t<s.pointCount&&this.m_pointCount<d.k_maxContactPoints;++t){const e=this.m_points[this.m_pointCount];e.fixtureA=i,e.fixtureB=n,e.position.Copy(m.points[t]),e.normal.Copy(m.normal),e.state=a[t],e.normalImpulse=s.points[t].normalImpulse,e.tangentImpulse=s.points[t].tangentImpulse,e.separation=m.separations[t],++this.m_pointCount}}PostSolve(t,e){}MouseDown(e){let o;if(this.m_mouseWorld.Copy(e),this.m_mouseTracing=!0,this.m_mouseTracerPosition.Copy(e),this.m_mouseTracerVelocity.SetZero(),null!==this.m_mouseJoint&&(this.m_world.DestroyJoint(this.m_mouseJoint),this.m_mouseJoint=null),this.m_world.QueryPointAABB(e,s=>{if(s.GetBody().GetType()===t.b2BodyType.b2_dynamicBody){if(s.TestPoint(e))return o=s,!1}return!0}),o){const s=5,i=.7,n=o.GetBody(),r=new t.b2MouseJointDef;r.bodyA=this.m_groundBody,r.bodyB=n,r.target.Copy(e),r.maxForce=1e3*n.GetMass(),(0,t.b2LinearStiffness)(r,s,i,r.bodyA,r.bodyB),this.m_mouseJoint=this.m_world.CreateJoint(r),n.SetAwake(!0)}}SpawnBomb(t){this.m_bombSpawnPoint.Copy(t),this.m_bombSpawning=!0}CompleteBombSpawn(e){if(!this.m_bombSpawning)return;const o=t.b2Vec2.Subtract(this.m_bombSpawnPoint,e,new t.b2Vec2);o.Scale(30),this.LaunchBombAt(this.m_bombSpawnPoint,o),this.m_bombSpawning=!1}ShiftMouseDown(t){this.m_mouseWorld.Copy(t),null===this.m_mouseJoint&&this.SpawnBomb(t)}MouseUp(t){this.m_mouseTracing=!1,this.m_mouseJoint&&(this.m_world.DestroyJoint(this.m_mouseJoint),this.m_mouseJoint=null),this.m_bombSpawning&&this.CompleteBombSpawn(t)}MouseMove(t,e){this.m_mouseWorld.Copy(t),e&&this.m_mouseJoint&&this.m_mouseJoint.SetTarget(t)}LaunchBomb(){const e=new t.b2Vec2((0,t.b2RandomFloat)(-15,15),30),o=t.b2Vec2.Scale(-5,e,new t.b2Vec2);this.LaunchBombAt(e,o)}LaunchBombAt(e,o){this.m_bomb&&(this.m_world.DestroyBody(this.m_bomb),this.m_bomb=null),this.m_bomb=this.m_world.CreateBody({type:t.b2BodyType.b2_dynamicBody,position:e,bullet:!0}),this.m_bomb.SetLinearVelocity(o);const s=new t.b2CircleShape;s.m_radius=25/this.GetDefaultViewZoom(),this.m_bomb.CreateFixture({shape:s,density:20,restitution:0})}Resize(t,e){}RunStep(t){let e=t.m_hertz>0?1/t.m_hertz:0;t.m_pause&&(t.m_singleStep?t.m_singleStep=!1:e=0),this.m_debugLines.length=0,this.m_statisticLines.length=0,this.m_textLines.length=0,t.m_pause&&this.addDebug("Paused",!0),this.Step(t,e)}addText(t){this.m_textLines.push(t)}addDebug(t,e){this.m_debugLines.push([t,`${e}`])}addStatistic(t,e){this.m_statisticLines.push([t,`${e}`])}Step(s,r){this.m_world.SetAllowSleeping(s.m_enableSleep),this.m_world.SetWarmStarting(s.m_enableWarmStarting),this.m_world.SetContinuousPhysics(s.m_enableContinuous),this.m_world.SetSubStepping(s.m_enableSubStepping),this.m_pointCount=0,this.m_world.Step(r,{velocityIterations:s.m_velocityIterations,positionIterations:s.m_positionIterations,particleIterations:s.m_particleIterations});const a=s.m_debugDraw,{aabb:m}=n;i.g_camera.unproject({x:0,y:i.g_camera.getHeight()},m.lowerBound),i.g_camera.unproject({x:i.g_camera.getWidth(),y:0},m.upperBound),s.m_drawShapes&&(0,t.DrawShapes)(a,this.m_world,m),s.m_drawParticles&&(0,e.DrawParticleSystems)(a,this.m_world),s.m_drawJoints&&(0,t.DrawJoints)(a,this.m_world),s.m_drawAABBs&&(0,t.DrawAABBs)(a,this.m_world),s.m_drawCOMs&&(0,t.DrawCenterOfMasses)(a,this.m_world),s.m_drawControllers&&(0,o.DrawControllers)(a,this.m_world),r>0&&++this.m_stepCount,s.m_drawStats&&(this.addStatistic("Bodies",this.m_world.GetBodyCount()),this.addStatistic("Contacts",this.m_world.GetContactCount()),this.addStatistic("Joints",this.m_world.GetJointCount()),this.addStatistic("Proxies",this.m_world.GetProxyCount()),this.addStatistic("Height",this.m_world.GetTreeHeight()),this.addStatistic("Balance",this.m_world.GetTreeBalance()),this.addStatistic("Quality",this.m_world.GetTreeQuality().toFixed(2)));{const t=this.m_world.GetProfile();this.m_maxProfile.step=Math.max(this.m_maxProfile.step,t.step),this.m_maxProfile.collide=Math.max(this.m_maxProfile.collide,t.collide),this.m_maxProfile.solve=Math.max(this.m_maxProfile.solve,t.solve),this.m_maxProfile.solveInit=Math.max(this.m_maxProfile.solveInit,t.solveInit),this.m_maxProfile.solveVelocity=Math.max(this.m_maxProfile.solveVelocity,t.solveVelocity),this.m_maxProfile.solvePosition=Math.max(this.m_maxProfile.solvePosition,t.solvePosition),this.m_maxProfile.solveTOI=Math.max(this.m_maxProfile.solveTOI,t.solveTOI),this.m_maxProfile.broadphase=Math.max(this.m_maxProfile.broadphase,t.broadphase),this.m_totalProfile.step+=t.step,this.m_totalProfile.collide+=t.collide,this.m_totalProfile.solve+=t.solve,this.m_totalProfile.solveInit+=t.solveInit,this.m_totalProfile.solveVelocity+=t.solveVelocity,this.m_totalProfile.solvePosition+=t.solvePosition,this.m_totalProfile.solveTOI+=t.solveTOI,this.m_totalProfile.broadphase+=t.broadphase}if(s.m_drawProfile){const e=this.m_world.GetProfile(),o=new t.b2Profile;if(this.m_stepCount>0){const t=1/this.m_stepCount;o.step=t*this.m_totalProfile.step,o.collide=t*this.m_totalProfile.collide,o.solve=t*this.m_totalProfile.solve,o.solveInit=t*this.m_totalProfile.solveInit,o.solveVelocity=t*this.m_totalProfile.solveVelocity,o.solvePosition=t*this.m_totalProfile.solvePosition,o.solveTOI=t*this.m_totalProfile.solveTOI,o.broadphase=t*this.m_totalProfile.broadphase}this.addDebug("Step [ave] (max)",_(e.step,o.step,this.m_maxProfile.step)),this.addDebug("Collide [ave] (max)",_(e.collide,o.collide,this.m_maxProfile.collide)),this.addDebug("Solve [ave] (max)",_(e.solve,o.solve,this.m_maxProfile.solve)),this.addDebug("Solve Init [ave] (max)",_(e.solveInit,o.solveInit,this.m_maxProfile.solveInit)),this.addDebug("Solve Velocity [ave] (max)",_(e.solveVelocity,o.solveVelocity,this.m_maxProfile.solveVelocity)),this.addDebug("Solve Position [ave] (max)",_(e.solvePosition,o.solvePosition,this.m_maxProfile.solvePosition)),this.addDebug("Solve TOI [ave] (max)",_(e.solveTOI,o.solveTOI,this.m_maxProfile.solveTOI)),this.addDebug("Broad-Phase [ave] (max)",_(e.broadphase,o.broadphase,this.m_maxProfile.broadphase))}if(this.m_mouseTracing&&!this.m_mouseJoint){const e=.1,o=new t.b2Vec2;o.x=2/e*(1/e*(this.m_mouseWorld.x-this.m_mouseTracerPosition.x)-this.m_mouseTracerVelocity.x),o.y=2/e*(1/e*(this.m_mouseWorld.y-this.m_mouseTracerPosition.y)-this.m_mouseTracerVelocity.y),this.m_mouseTracerVelocity.AddScaled(r,o),this.m_mouseTracerPosition.AddScaled(r,this.m_mouseTracerVelocity)}if(this.m_bombSpawning){const e=new t.b2Color(0,0,1);a.DrawPoint(this.m_bombSpawnPoint,4,e),e.SetRGB(.8,.8,.8),a.DrawSegment(this.m_mouseWorld,this.m_bombSpawnPoint,e)}if(s.m_drawContactPoints){const e=.1,o=.3;for(let i=0;i<this.m_pointCount;++i){const n=this.m_points[i];if(n.state===t.b2PointState.b2_addState?a.DrawPoint(n.position,10,new t.b2Color(.3,.95,.3)):n.state===t.b2PointState.b2_persistState&&a.DrawPoint(n.position,5,new t.b2Color(.3,.3,.95)),s.m_drawContactNormals){const e=n.position,s=t.b2Vec2.Add(e,t.b2Vec2.Scale(o,n.normal,t.b2Vec2.s_t0),new t.b2Vec2);a.DrawSegment(e,s,new t.b2Color(.9,.9,.9))}else if(s.m_drawContactImpulse){const o=n.position,s=t.b2Vec2.AddScaled(o,e*n.normalImpulse,n.normal,new t.b2Vec2);a.DrawSegment(o,s,new t.b2Color(.9,.9,.3))}if(s.m_drawFrictionImpulse){const o=t.b2Vec2.CrossVec2One(n.normal,new t.b2Vec2),s=n.position,i=t.b2Vec2.AddScaled(s,e*n.tangentImpulse,o,new t.b2Vec2);a.DrawSegment(s,i,new t.b2Color(.9,.9,.3))}}}}GetDefaultViewZoom(){return 25}getCenter(){return t.b2Vec2.ZERO}Destroy(){}}exports.Test=d,d.k_maxContactPoints=2048,d.PreSolve_s_state1=[],d.PreSolve_s_state2=[],d.PreSolve_s_worldManifold=new t.b2WorldManifold;
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","@box2d/controllers":"mFGS","./utils/hotkeys":"EV9t","./utils/camera":"GUc7"}],"IIZf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FpsCalculator=void 0;class e{constructor(e,t,i){this.index=0,this.lastTime=-1,this.nextUpdate=0,this.calculated={avgFps:0,avgTime:0,minTime:0,maxTime:0,minFps:0,maxFps:0},this.waitTime=e,this.frameTimes=Array.from({length:t},()=>i),this.calculate()}getFps(){return this.calculated}getFrames(){return 0===this.index?this.frameTimes:this.frameTimes.slice(this.index).concat(this.frameTimes.slice(0,this.index))}addFrame(){const e=performance.now();if(-1===this.lastTime)return this.lastTime=e,0;const t=e-this.lastTime;return this.lastTime=e,this.frameTimes[this.index]=t,++this.index===this.frameTimes.length&&(this.index=0),this.nextUpdate-=t,this.nextUpdate<=0&&this.calculate(),t}calculate(){this.nextUpdate=this.waitTime;const e=this.frameTimes.reduce((e,t)=>e+t,0),t=Math.max(1,e/this.frameTimes.length),i=Math.min(...this.frameTimes),s=Math.max(...this.frameTimes);this.calculated={avgFps:1e3/t,avgTime:t,minTime:i,maxTime:s,minFps:1e3/s,maxFps:1e3/i}}}exports.FpsCalculator=e;
},{}],"GXLA":[function(require,module,exports) {

},{}],"lYGI":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Select=exports.selectDef=void 0;const t=e(require("react"));function l(e,t,l,a){return{type:"select",name:e,options:t,initialValue:l,update:a}}require("./style.scss"),exports.selectDef=l;const a=({control:e})=>t.default.createElement("label",{className:"select"},t.default.createElement("div",{className:"select--wrapper"},t.default.createElement("select",{defaultValue:e.initialValue,className:"select--input"},e.options.map(l=>t.default.createElement("option",{key:l,value:l,onClick:()=>e.update(l)},l)))),e.name.split("#")[0]);exports.Select=a;
},{"react":"dmLA","./style.scss":"GXLA"}],"OotG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParticleParameter=exports.defaultParticleTypes=exports.baseParticleTypes=void 0;const e=require("@box2d/particles"),t=require("../../ui/controls/Select");exports.baseParticleTypes={water:e.b2ParticleFlag.b2_waterParticle,viscous:e.b2ParticleFlag.b2_viscousParticle,powder:e.b2ParticleFlag.b2_powderParticle,tensile:e.b2ParticleFlag.b2_tensileParticle,"static pressure":e.b2ParticleFlag.b2_staticPressureParticle},exports.defaultParticleTypes={...exports.baseParticleTypes,spring:e.b2ParticleFlag.b2_springParticle,elastic:e.b2ParticleFlag.b2_elasticParticle,"color mixing":e.b2ParticleFlag.b2_colorMixingParticle,wall:e.b2ParticleFlag.b2_wallParticle,barrier:e.b2ParticleFlag.b2_barrierParticle|e.b2ParticleFlag.b2_wallParticle};class r{constructor(e){this.restartOnChange=!0,this.types=exports.defaultParticleTypes,this.selectedKey="",this.defaultKey="water",this.manager=e}SetValues(e,t){this.types=e,this.defaultKey=t}SetRestartOnChange(e=!0){this.restartOnChange=e}Reset(){this.types=exports.defaultParticleTypes,this.selectedKey="",this.defaultKey="water",this.restartOnChange=!0}GetSelectedKey(){return this.selectedKey||this.defaultKey}GetValue(){return this.types[this.GetSelectedKey()]}GetControl(){const e=Object.keys(this.types);return(0,t.selectDef)("Particle Type",e,this.GetSelectedKey(),e=>{this.selectedKey||e!==this.defaultKey?this.selectedKey!==e&&(this.selectedKey=e,this.restartOnChange&&this.manager.scheduleRestart()):this.selectedKey=e})}}exports.ParticleParameter=r;
},{"@box2d/particles":"eX67","../../ui/controls/Select":"lYGI"}],"Gxyl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RadialEmitter=exports.EmittedParticleCallback=void 0;const t=require("@box2d/core"),e=require("@box2d/particles");class i{ParticleCreated(t,e){}}exports.EmittedParticleCallback=i;class r{constructor(){this.m_particleSystem=null,this.m_callback=null,this.m_origin=new t.b2Vec2,this.m_startingVelocity=new t.b2Vec2,this.m_speed=0,this.m_halfSize=new t.b2Vec2,this.m_emitRate=1,this.m_color=new t.b2Color,this.m_emitRemainder=0,this.m_flags=e.b2ParticleFlag.b2_waterParticle,this.m_group=null}Destroy(){this.SetGroup(null)}SetPosition(t){this.m_origin.Copy(t)}GetPosition(t){return t.Copy(this.m_origin)}SetSize(e){t.b2Vec2.Scale(.5,e,this.m_halfSize)}GetSize(e){return t.b2Vec2.Scale(2,this.m_halfSize,e)}SetVelocity(t){this.m_startingVelocity.Copy(t)}GetVelocity(t){return t.Copy(this.m_startingVelocity)}SetSpeed(t){this.m_speed=t}GetSpeed(){return this.m_speed}SetParticleFlags(t){this.m_flags=t}GetParticleFlags(){return this.m_flags}SetColor(t){this.m_color.Copy(t)}GetColor(t){return t.Copy(this.m_color)}SetEmitRate(t){this.m_emitRate=t}GetEmitRate(){return this.m_emitRate}SetParticleSystem(t){this.m_particleSystem=t}GetParticleSystem(){return this.m_particleSystem}SetCallback(t){this.m_callback=t}GetCallback(){return this.m_callback}SetGroup(t){this.m_group&&this.m_group.SetGroupFlags(this.m_group.GetGroupFlags()&~e.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty),this.m_group=t,this.m_group&&this.m_group.SetGroupFlags(this.m_group.GetGroupFlags()|e.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty)}GetGroup(){return this.m_group}Step(i,r,s=(r?r.length:0)){(0,t.b2Assert)(null!==this.m_particleSystem);let a=0;this.m_emitRemainder+=this.m_emitRate*i;const l=new e.b2ParticleDef;for(l.color.Copy(this.m_color),l.flags=this.m_flags,l.group=this.m_group;this.m_emitRemainder>1;){this.m_emitRemainder-=1;const e=2*Math.random()*Math.PI,i=Math.random(),o=new t.b2Vec2(Math.sin(e),Math.cos(e));l.position.Set(this.m_origin.x+o.x*i*this.m_halfSize.x,this.m_origin.y+o.y*i*this.m_halfSize.y),l.velocity.Copy(this.m_startingVelocity),0!==this.m_speed&&l.velocity.AddScaled(this.m_speed,o);const m=this.m_particleSystem.CreateParticle(l);this.m_callback&&this.m_callback.ParticleCreated(this.m_particleSystem,m),r&&a<s&&(r[a]=m),++a}return a}}exports.RadialEmitter=r;
},{"@box2d/core":"FjWk","@box2d/particles":"eX67"}],"preb":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Checkbox=exports.checkboxDef=void 0;const t=e(require("react"));function c(e,t,c){return{type:"checkbox",name:e,initialValue:t,update:c}}require("./style.scss"),exports.checkboxDef=c;const a=({control:e})=>t.default.createElement("label",{className:"checkbox"},t.default.createElement("input",{type:"checkbox",className:"checkbox--input",onClick:t=>e.update(t.currentTarget.checked),defaultChecked:e.initialValue}),t.default.createElement("span",null,e.name.split("#")[0]));exports.Checkbox=a;
},{"react":"dmLA","./style.scss":"GXLA"}],"u1Kv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractParticleTestWithControls=exports.AbstractParticleTest=exports.particleColors=void 0;const t=require("@box2d/core"),e=require("@box2d/particles"),r=require("../../test"),s=require("../../ui/controls/Checkbox");exports.particleColors=[(new t.b2Color).SetByteRGBA(255,0,0,255),(new t.b2Color).SetByteRGBA(0,255,0,255),(new t.b2Color).SetByteRGBA(0,0,255,255),(new t.b2Color).SetByteRGBA(255,140,0,255),(new t.b2Color).SetByteRGBA(0,206,209,255),(new t.b2Color).SetByteRGBA(255,0,255,255),(new t.b2Color).SetByteRGBA(255,215,0,255),(new t.b2Color).SetByteRGBA(0,255,255,255)];class o extends r.Test{constructor(t={x:0,y:-10}){super(t);const r=new e.b2ParticleSystemDef;this.m_particleSystem=this.m_world.CreateParticleSystem(r),this.m_particleSystem.SetGravityScale(.4),this.m_particleSystem.SetDensity(1.2)}setupControls(){this.addTestControlGroup("Particles",[this.createStrictContactsCheckbox()])}createStrictContactsCheckbox(){return(0,s.checkboxDef)("Strict Particle/Body Contacts",o.m_strictContacts,t=>{o.m_strictContacts=t})}Step(e,r){if(super.Step(e,r),this.m_particleSystem.SetStrictContactCheck(o.m_strictContacts),e.m_drawStats&&(this.addStatistic("Particles",this.m_particleSystem.GetParticleCount()),this.addStatistic("Groups",this.m_particleSystem.GetParticleGroupCount()),this.addStatistic("Pairs",this.m_particleSystem.GetPairCount()),this.addStatistic("Triads",this.m_particleSystem.GetTriadCount())),this.m_mouseTracing&&!this.m_mouseJoint){const e=new t.b2CircleShape;e.m_p.Copy(this.m_mouseTracerPosition),e.m_radius=this.getParticleSelectionRadius();const r=new t.b2AABB,s=new t.b2Transform;s.SetIdentity(),e.ComputeAABB(r,s,0),this.m_particleSystem.QueryAABB(r,r=>{const s=this.m_particleSystem.GetPositionBuffer()[r];if(e.TestPoint(t.b2Transform.IDENTITY,s)){this.m_particleSystem.GetVelocityBuffer()[r].Copy(this.m_mouseTracerVelocity)}return!0})}}ColorParticleGroup(t,e){const r=this.m_particleSystem.GetColorBuffer(),s=t.GetParticleCount(),o=t.GetBufferIndex(),i=s+o,c=exports.particleColors.length;e||(e=Math.floor(s/c))||(e=1);for(let a=o;a<i;a++)r[a]=exports.particleColors[Math.floor(a/e)%c].Clone()}getParticleSelectionRadius(){return 40/this.GetDefaultViewZoom()}}exports.AbstractParticleTest=o,o.m_strictContacts=!1;class i extends o{constructor(t,e={x:0,y:-10}){super(e),this.particleParameter=t}setupControls(){this.addTestControlGroup("Particles",[this.createStrictContactsCheckbox(),this.particleParameter.GetControl()])}}exports.AbstractParticleTestWithControls=i;
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../ui/controls/Checkbox":"preb"}],"mT05":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),s=require("../../utils/particles/particle_emitter"),r=require("./abstract_particle_test"),l={water:t.b2ParticleFlag.b2_waterParticle,powder:t.b2ParticleFlag.b2_powderParticle,tensile:t.b2ParticleFlag.b2_tensileParticle,viscous:t.b2ParticleFlag.b2_viscousParticle,"tensile powder":t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_powderParticle,"viscous powder":t.b2ParticleFlag.b2_viscousParticle|t.b2ParticleFlag.b2_powderParticle,"viscous tensile powder":t.b2ParticleFlag.b2_viscousParticle|t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_powderParticle,"tensile viscous water":t.b2ParticleFlag.b2_viscousParticle|t.b2ParticleFlag.b2_tensileParticle};class a{}a.k_maxPumps=5,a.k_maxEmitters=5,a.k_flipTime=6,a.k_tileRadius=2,a.k_tileDiameter=4,a.k_pumpRadius=1.95,a.k_playfieldLeftEdge=-20,a.k_playfieldRightEdge=20,a.k_playfieldBottomEdge=40,a.k_tileWidth=10,a.k_tileHeight=11,a.k_defaultEmitterRate=30,a.k_defaultEmitterSize=3,a.k_particleExitSpeedY=-9.8,a.k_pumpForce=600,a.k_numberOfSpecialParticles=256;class o extends e.b2DestructionListener{constructor(e,t){super(),this.m_particles=[],this.m_colorOscillationTime=0,this.m_colorOscillationPeriod=2,this.m_world=e,this.m_particleSystem=t,this.m_world.SetDestructionListener(this)}Destroy(){this.m_world.SetDestructionListener(null)}Add(e,i){for(let s=0;s<i&&this.m_particles.length<a.k_numberOfSpecialParticles;++s){const i=e[s];this.m_particleSystem.SetParticleFlags(i,this.m_particleSystem.GetFlagsBuffer()[i]|t.b2ParticleFlag.b2_destructionListenerParticle),this.m_particles.push(this.m_particleSystem.GetParticleHandleFromIndex(i))}}Step(t){var i,s;this.m_colorOscillationTime=(i=this.m_colorOscillationTime+t,s=this.m_colorOscillationPeriod,i-Math.floor(i/s)*s);const r=2*Math.abs(this.m_colorOscillationTime/this.m_colorOscillationPeriod-.5),l=(new e.b2Color).SetByteRGBA(128+128*(1-r),128+256*Math.abs(.5-r),128+128*r,255);for(const e of this.m_particles)this.m_particleSystem.GetColorBuffer()[e.GetIndex()].Copy(l)}SayGoodbyeJoint(e){}SayGoodbyeFixture(e){}SayGoodbyeParticleGroup(e){}SayGoodbyeParticle(e,t){e===this.m_particleSystem&&(this.m_particles=this.m_particles.filter(e=>e.GetIndex()!==t))}}class c extends r.AbstractParticleTestWithControls{constructor({particleParameter:t}){super(t,{x:0,y:-20}),this.m_faucetEmitterIndex=0,this.m_pumpIndex=0,this.m_pumpTimer=0,this.m_pumpForce=new e.b2Vec2,this.m_pumps=[],this.m_emitters=[];const i=this.m_world.CreateBody();for(let e=0;e<a.k_maxEmitters;e++)this.m_emitters[e]=null;for(let e=0;e<a.k_maxPumps;e++)this.m_pumps[e]=null;{const t=new e.b2PolygonShape,s=[new e.b2Vec2(-40,-10),new e.b2Vec2(40,-10),new e.b2Vec2(40,0),new e.b2Vec2(-40,0)];t.Set(s,4),i.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,s=[new e.b2Vec2(a.k_playfieldLeftEdge-20,-1),new e.b2Vec2(a.k_playfieldLeftEdge,-1),new e.b2Vec2(a.k_playfieldLeftEdge,50),new e.b2Vec2(a.k_playfieldLeftEdge-20,50)];t.Set(s,4),i.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,s=[new e.b2Vec2(a.k_playfieldRightEdge,-1),new e.b2Vec2(a.k_playfieldRightEdge+20,-1),new e.b2Vec2(a.k_playfieldRightEdge+20,50),new e.b2Vec2(a.k_playfieldRightEdge,50)];t.Set(s,4),i.CreateFixture({shape:t})}this.m_particleSystem.SetRadius(.25),this.m_specialTracker=new o(this.m_world,this.m_particleSystem),this.m_pumpTimer=0,this.SetupMaze(),this.m_killFieldShape=new e.b2PolygonShape,this.m_killFieldShape.SetAsBox(a.k_playfieldRightEdge-a.k_playfieldLeftEdge,1),this.m_killFieldTransform=new e.b2Transform;const s=new e.b2Vec2(-20,1);this.m_killFieldTransform.SetPositionAngle(s,0),t.SetValues(l,"water"),t.SetRestartOnChange(!1)}Destroy(){for(let e=0;e<this.m_faucetEmitterIndex;e++)this.m_emitters[e]=null}SetupMaze(){this.m_faucetEmitterIndex=0,this.m_pumpIndex=0;const t=new e.b2PolygonShape;t.SetAsBox(a.k_tileRadius,a.k_tileRadius);const i=(0,e.b2MakeArray)(3,e.b2Vec2);i[0].Set(-a.k_tileRadius,-a.k_tileRadius),i[1].Set(a.k_tileRadius,a.k_tileRadius),i[2].Set(a.k_tileRadius,-a.k_tileRadius);const s=new e.b2PolygonShape;s.Set(i,3),i[1].Set(-a.k_tileRadius,a.k_tileRadius);const r=new e.b2PolygonShape;r.Set(i,3);const l=new e.b2CircleShape;l.m_radius=.7*a.k_tileRadius;const o=(new e.b2Color).SetByteRGBA(255,128,128,255),c=(new e.b2Color).SetByteRGBA(128,255,128,255),m=(new e.b2Color).SetByteRGBA(128,128,255,255);this.m_pumpForce.Set(a.k_pumpForce,0);for(let p=0;p<a.k_tileWidth;p++)for(let i=0;i<a.k_tileHeight;i++){const d="# r#g #r##  /#  #  # ###     pA  #  /##### # /#  C  /# #   # ### # / # ## p /#   #  ####  A        /#####KK###"[i*a.k_tileWidth+p],n=new e.b2Vec2(a.k_playfieldLeftEdge+2*a.k_tileRadius*p+a.k_tileRadius,a.k_playfieldBottomEdge-2*a.k_tileRadius*i+a.k_tileRadius);switch(d){case"#":this.CreateBody(n,t,e.b2BodyType.b2_staticBody);break;case"A":this.CreateBody(n,r,e.b2BodyType.b2_staticBody);break;case"/":this.CreateBody(n,s,e.b2BodyType.b2_staticBody);break;case"C":this.CreateBody(n,l,e.b2BodyType.b2_dynamicBody);break;case"p":this.AddPump(n);break;case"b":this.AddFaucetEmitter(n,m);break;case"r":this.AddFaucetEmitter(n,o);break;case"g":this.AddFaucetEmitter(n,c)}}}CreateBody(e,t,i){this.m_world.CreateBody({type:i,position:e}).CreateFixture({shape:t,density:10})}AddPump(t){const i=new e.b2PolygonShape;i.SetAsBox(a.k_pumpRadius,a.k_pumpRadius);const s=this.m_world.CreateBody({position:t,type:e.b2BodyType.b2_dynamicBody,angle:0});s.CreateFixture({shape:i,density:5});const r=new e.b2PrismaticJointDef;r.bodyA=this.m_groundBody,r.bodyB=s,r.collideConnected=!1,r.localAxisA.Set(1,0),r.localAnchorA.Copy(t),this.m_world.CreateJoint(r),this.m_pumps[this.m_pumpIndex]=s,this.m_pumpIndex++}AddFaucetEmitter(t,i){const r=new e.b2Vec2(0,a.k_particleExitSpeedY),l=new s.RadialEmitter;l.SetParticleSystem(this.m_particleSystem),l.SetPosition(t),l.SetVelocity(r),l.SetSize(new e.b2Vec2(a.k_defaultEmitterSize,0)),l.SetEmitRate(a.k_defaultEmitterRate),l.SetColor(i),this.m_emitters[this.m_faucetEmitterIndex]=l,this.m_faucetEmitterIndex++}JointDestroyed(e){super.JointDestroyed(e)}ParticleGroupDestroyed(e){super.ParticleGroupDestroyed(e)}BeginContact(e){super.BeginContact(e)}EndContact(e){super.EndContact(e)}PreSolve(e,t){super.PreSolve(e,t)}PostSolve(e,t){super.PostSolve(e,t)}getCenter(){return{x:0,y:20}}Step(e,t){let i=e.m_hertz>0?1/e.m_hertz:0;e.m_pause&&!e.m_singleStep&&(i=0),super.Step(e,t);const s=this.particleParameter.GetValue();for(let r=0;r<this.m_faucetEmitterIndex;r++){const e=[],t=this.m_emitters[r];if(t){t.SetParticleFlags(s);const r=t.Step(i,e,a.k_numberOfSpecialParticles);this.m_specialTracker.Add(e,r)}}this.m_specialTracker.Step(i),this.m_particleSystem.DestroyParticlesInShape(this.m_killFieldShape,this.m_killFieldTransform);for(let r=0;r<this.m_pumpIndex;r++){const e=this.m_pumps[r];e&&e.ApplyForceToCenter(this.m_pumpForce,!0),this.m_pumpTimer+=i,this.m_pumpTimer>a.k_flipTime&&(this.m_pumpTimer-=a.k_flipTime,this.m_pumpForce.x*=-1)}}}(0,i.registerTest)("Particles","Sandbox",c);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/particles/particle_emitter":"Gxyl","./abstract_particle_test":"u1Kv"}],"itjE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),s=require("./abstract_particle_test"),r=require("../../utils/particles/particle_parameter");class n{constructor(i,s,r,n,a,o){this.m_initialLifetime=0,this.m_remainingLifetime=0,this.m_halfLifetime=0,this.m_origColor=new e.b2Color;const m=new e.b2CircleShape;m.m_p.Copy(s),m.m_radius=r;const c=new t.b2ParticleGroupDef;function l(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}c.flags=o,c.shape=m,this.m_origColor.Copy(function(e,t,i,s=1){let r,n,a;if(0===t)r=n=a=i;else{const s=i<.5?i*(1+t):i+t-i*t,o=2*i-s;r=l(o,s,e+1/3),n=l(o,s,e),a=l(o,s,e-1/3)}return{r:r,g:n,b:a,a:s}}(Math.random(),1,.5)),c.color.Copy(this.m_origColor),this.m_particleSystem=i,this.m_pg=this.m_particleSystem.CreateParticleGroup(c),this.m_initialLifetime=this.m_remainingLifetime=a,this.m_halfLifetime=.5*this.m_initialLifetime;const h=this.m_pg.GetBufferIndex(),_=this.m_particleSystem.GetPositionBuffer(),p=this.m_particleSystem.GetVelocityBuffer();for(let t=h;t<h+this.m_pg.GetParticleCount();t++)e.b2Vec2.Subtract(_[t],s,p[t]),p[t].Scale(n)}Drop(){this.m_pg.DestroyParticles(!1)}ColorCoeff(){return this.m_remainingLifetime>=this.m_halfLifetime?1:1-(this.m_halfLifetime-this.m_remainingLifetime)/this.m_halfLifetime}Step(e){if(e>0&&this.m_remainingLifetime>0){this.m_remainingLifetime=Math.max(this.m_remainingLifetime-e,0);const t=this.ColorCoeff(),i=this.m_particleSystem.GetColorBuffer(),s=this.m_pg.GetBufferIndex();for(let e=s;e<s+this.m_pg.GetParticleCount();e++){i[e].a*=t}}}IsDone(){return this.m_remainingLifetime<=0}}class a extends s.AbstractParticleTestWithControls{constructor({particleParameter:t}){super(t),this.m_VFXIndex=0,this.m_VFX=[],this.m_contact=!1,this.m_contactPoint=new e.b2Vec2,this.m_VFXIndex=0;for(let e=0;e<a.c_maxVFX;e++)this.m_VFX[e]=null;this.CreateWalls(),this.m_particleSystem.SetRadius(.5);for(let i=0;i<a.c_maxCircles;i++){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),s=new e.b2CircleShape;s.m_p.Set(3*(0,e.b2RandomFloat)(-1,1),a.SHAPE_HEIGHT_OFFSET+a.SHAPE_OFFSET*i),s.m_radius=2,t.CreateFixture({shape:s,density:.5}).SetUserData({spark:!0})}t.SetValues(r.baseParticleTypes,"powder"),t.SetRestartOnChange(!1)}BeginContact(t){super.BeginContact(t);const i=t.GetFixtureA().GetUserData(),s=t.GetFixtureB().GetUserData();if((null==i?void 0:i.spark)||(null==s?void 0:s.spark)){const i=new e.b2WorldManifold;t.GetWorldManifold(i),this.m_contactPoint.Copy(i.points[0]),this.m_contact=!0}}Step(e,t){const i=this.particleParameter.GetValue();let s=e.m_hertz>0?1/e.m_hertz:0;e.m_pause&&!e.m_singleStep&&(s=0),super.Step(e,t),this.m_contact&&(this.AddVFX(this.m_contactPoint,i),this.m_contact=!1);for(let r=0;r<a.c_maxVFX;r++){const e=this.m_VFX[r];null!==e&&(e.Step(s),e.IsDone()&&(e.Drop(),this.m_VFX[r]=null))}}AddVFX(t,i){const s=this.m_VFX[this.m_VFXIndex];null!==s&&(s.Drop(),this.m_VFX[this.m_VFXIndex]=null),this.m_VFX[this.m_VFXIndex]=new n(this.m_particleSystem,t,(0,e.b2RandomFloat)(1,2),(0,e.b2RandomFloat)(10,20),(0,e.b2RandomFloat)(.5,1),i),++this.m_VFXIndex>=a.c_maxVFX&&(this.m_VFXIndex=0)}getCenter(){return{x:0,y:20}}CreateWalls(){const t=this.m_world.CreateBody();{const i=new e.b2PolygonShape,s=[new e.b2Vec2(-40,-10),new e.b2Vec2(40,-10),new e.b2Vec2(40,0),new e.b2Vec2(-40,0)];i.Set(s,4),t.CreateFixture({shape:i})}{const i=new e.b2PolygonShape,s=[new e.b2Vec2(-40,40),new e.b2Vec2(40,40),new e.b2Vec2(40,50),new e.b2Vec2(-40,50)];i.Set(s,4),t.CreateFixture({shape:i})}{const i=new e.b2PolygonShape,s=[new e.b2Vec2(-40,-10),new e.b2Vec2(-20,-10),new e.b2Vec2(-20,50),new e.b2Vec2(-40,50)];i.Set(s,4),t.CreateFixture({shape:i})}{const i=new e.b2PolygonShape,s=[new e.b2Vec2(20,-10),new e.b2Vec2(40,-10),new e.b2Vec2(40,50),new e.b2Vec2(20,50)];i.Set(s,4),t.CreateFixture({shape:i})}}}a.c_maxCircles=3,a.c_maxVFX=20,a.SHAPE_HEIGHT_OFFSET=7,a.SHAPE_OFFSET=4.5,(0,i.registerTest)("Particles","Sparky",a);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv","../../utils/particles/particle_parameter":"OotG"}],"tcIx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),a=require("./abstract_particle_test");class s extends a.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r);{const t=this.m_world.CreateBody(),r=new e.b2ChainShape,a=[new e.b2Vec2(-2,0),new e.b2Vec2(2,0),new e.b2Vec2(2,4),new e.b2Vec2(-2,4)];r.CreateLoop(a,4),t.CreateFixture({shape:r})}this.m_particleSystem.SetRadius(.05),this.m_particleSystem.SetDamping(.2);{const a=new e.b2PolygonShape;a.SetAsBox(.8,1,new e.b2Vec2(-1.2,1.01),0);const s=new t.b2ParticleGroupDef;s.flags=r.GetValue(),s.shape=a;const i=this.m_particleSystem.CreateParticleGroup(s);s.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(i,0)}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}(0,r.registerTest)("Particles","DamBreak",s);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"Cv1P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),s=require("../../utils/particles/particle_parameter"),i=require("./abstract_particle_test"),a={"tensile + viscous":t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_viscousParticle,...s.baseParticleTypes};class n extends i.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r),r.SetValues(a,"tensile + viscous");{const t=this.m_world.CreateBody(),r=new e.b2ChainShape,s=[new e.b2Vec2(-2,0),new e.b2Vec2(2,0),new e.b2Vec2(2,4),new e.b2Vec2(-2,4)];r.CreateLoop(s,4),t.CreateFixture({shape:r})}this.m_particleSystem.SetRadius(.025);{const s=new e.b2PolygonShape;s.SetAsBox(2,.4,new e.b2Vec2(0,3.6),0);const i=new t.b2ParticleGroupDef;i.flags=r.GetValue(),i.shape=s;const a=this.m_particleSystem.CreateParticleGroup(i);i.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(a,0)}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-2,3.2),new e.b2Vec2(-1.2,3.2)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-1.1,3.2),new e.b2Vec2(2,3.2)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-1.2,3.2),new e.b2Vec2(-1.2,2.8)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-1.1,3.2),new e.b2Vec2(-1.1,2.8)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-1.6,2.4),new e.b2Vec2(.8,2)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(1.6,1.6),new e.b2Vec2(-.8,1.2)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-1.2,.8),new e.b2Vec2(-1.2,0)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-.4,.8),new e.b2Vec2(-.4,0)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(.4,.8),new e.b2Vec2(.4,0)),t.CreateFixture({shape:r,density:.1})}{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(1.2,.8),new e.b2Vec2(1.2,0)),t.CreateFixture({shape:r,density:.1})}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}(0,r.registerTest)("Particles","Liquid Timer",n);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/particles/particle_parameter":"OotG","./abstract_particle_test":"u1Kv"}],"IKNa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),s=require("./abstract_particle_test"),o=require("../../utils/particles/particle_parameter");class i extends s.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r),this.m_time=0,r.SetValues(o.baseParticleTypes,"water");const s=this.m_world.CreateBody();{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,allowSleep:!1,position:{x:0,y:1}}),r=new e.b2PolygonShape;r.SetAsBox(.05,1,new e.b2Vec2(2,0),0),t.CreateFixture({shape:r,density:5}),r.SetAsBox(.05,1,new e.b2Vec2(-2,0),0),t.CreateFixture({shape:r,density:5}),r.SetAsBox(2,.05,new e.b2Vec2(0,1),0),t.CreateFixture({shape:r,density:5}),r.SetAsBox(2,.05,new e.b2Vec2(0,-1),0),t.CreateFixture({shape:r,density:5});const o=new e.b2RevoluteJointDef;o.bodyA=s,o.bodyB=t,o.localAnchorA.Set(0,1),o.localAnchorB.Set(0,0),o.referenceAngle=0,o.motorSpeed=.05*Math.PI,o.maxMotorTorque=1e7,o.enableMotor=!0,this.m_joint=this.m_world.CreateJoint(o)}this.m_particleSystem.SetRadius(.05);const i=r.GetValue();this.m_particleSystem.SetDamping(.2);{const r=new t.b2ParticleGroupDef;r.flags=i;const s=new e.b2PolygonShape;s.SetAsBox(.9,.9,new e.b2Vec2(0,1),0),r.shape=s;const o=this.m_particleSystem.CreateParticleGroup(r);r.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(o,0)}this.m_time=0}Step(e,t){super.Step(e,t),e.m_hertz>0&&(this.m_time+=1/e.m_hertz),this.m_joint.SetMotorSpeed(.05*Math.cos(this.m_time)*Math.PI)}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:1}}}(0,r.registerTest)("Particles","Wave Machine",i);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv","../../utils/particles/particle_parameter":"OotG"}],"jDdO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),s=require("./abstract_particle_test");class a extends s.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r);{const t=this.m_world.CreateBody();{const r=new e.b2PolygonShape,s=[new e.b2Vec2(-4,-1),new e.b2Vec2(4,-1),new e.b2Vec2(4,0),new e.b2Vec2(-4,0)];r.Set(s,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,s=[new e.b2Vec2(-4,-.1),new e.b2Vec2(-2,-.1),new e.b2Vec2(-2,2),new e.b2Vec2(-4,3)];r.Set(s,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,s=[new e.b2Vec2(2,-.1),new e.b2Vec2(4,-.1),new e.b2Vec2(4,3),new e.b2Vec2(2,2)];r.Set(s,4),t.CreateFixture({shape:r})}}this.m_particleSystem.SetRadius(.07);const s=r.GetValue();this.m_particleSystem.SetDamping(.2);{const r=new e.b2CircleShape;r.m_p.Set(0,3),r.m_radius=2;const a=new t.b2ParticleGroupDef;a.flags=s,a.shape=r;const c=this.m_particleSystem.CreateParticleGroup(a);a.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(c,0)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2CircleShape;r.m_p.Set(0,8),r.m_radius=.5,t.CreateFixture({shape:r,density:.5})}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}(0,r.registerTest)("Particles","Particles",a);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"b9sY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),r=require("../../utils/particles/particle_emitter"),a=require("../../utils/hotkeys"),s=require("./abstract_particle_test"),c=require("../../utils/particles/particle_parameter"),n={...c.baseParticleTypes,"color mixing":t.b2ParticleFlag.b2_colorMixingParticle};class m extends r.EmittedParticleCallback{constructor(e,t){super(),this.m_minLifetime=0,this.m_maxLifetime=0,this.m_minLifetime=e,this.m_maxLifetime=t}ParticleCreated(e,t){e.SetParticleLifetime(t,Math.random()*(this.m_maxLifetime-this.m_minLifetime)+this.m_minLifetime)}}class o extends s.AbstractParticleTestWithControls{constructor({particleParameter:t}){super(t),this.m_particleColorOffset=0,this.m_emitter=new r.RadialEmitter,this.m_lifetimeRandomizer=new m(o.k_particleLifetimeMin,o.k_particleLifetimeMax),this.m_particleSystem.SetRadius(.035),this.m_particleSystem.SetMaxParticleCount(o.k_maxParticleCount),this.m_particleSystem.SetDestructionByAge(!0);const i=this.m_world.CreateBody();{const t=new e.b2PolygonShape,r=o.k_containerHeight+o.k_containerThickness;t.SetAsBox(o.k_containerWidth-o.k_containerThickness,o.k_containerThickness,new e.b2Vec2,0),i.CreateFixture({shape:t}),t.SetAsBox(o.k_containerThickness,r,new e.b2Vec2(-o.k_containerWidth,o.k_containerHeight),0),i.CreateFixture({shape:t}),t.SetAsBox(o.k_containerThickness,r,new e.b2Vec2(o.k_containerWidth,o.k_containerHeight),0),i.CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(5*o.k_containerWidth,o.k_containerThickness,new e.b2Vec2(0,-2*o.k_containerThickness),0),i.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,r=2*this.m_particleSystem.GetRadius(),a=o.k_faucetLength*r*o.k_spoutLength,s=o.k_containerWidth*o.k_faucetWidth*o.k_spoutWidth,c=o.k_containerHeight*o.k_faucetHeight+.5*a;t.SetAsBox(r,a,new e.b2Vec2(-s,c),0),i.CreateFixture({shape:t}),t.SetAsBox(r,a,new e.b2Vec2(s,c),0),i.CreateFixture({shape:t}),t.SetAsBox(s-r,r,new e.b2Vec2(0,c+a-r),0),i.CreateFixture({shape:t})}{const i=2*this.m_particleSystem.GetRadius()*o.k_faucetLength;this.m_emitter.SetParticleSystem(this.m_particleSystem),this.m_emitter.SetCallback(this.m_lifetimeRandomizer),this.m_emitter.SetPosition(new e.b2Vec2(o.k_containerWidth*o.k_faucetWidth,o.k_containerHeight*o.k_faucetHeight+.5*i)),this.m_emitter.SetVelocity(new e.b2Vec2),this.m_emitter.SetSize(new e.b2Vec2(0,i)),this.m_emitter.SetColor(new e.b2Color(1,1,1,1)),this.m_emitter.SetEmitRate(120),this.m_emitter.SetParticleFlags(t.GetValue())}t.SetRestartOnChange(!1),t.SetValues(n,"water")}Step(i,r){let a=i.m_hertz>0?1/i.m_hertz:0;i.m_pause&&!i.m_singleStep&&(a=0),super.Step(i,r),this.m_particleColorOffset+=a,this.m_particleColorOffset>=s.particleColors.length&&(this.m_particleColorOffset-=s.particleColors.length),this.m_emitter.SetParticleFlags(this.particleParameter.GetValue()),this.m_emitter.GetParticleFlags()&t.b2ParticleFlag.b2_colorMixingParticle?this.m_emitter.SetColor(s.particleColors[Math.floor(this.m_particleColorOffset)%s.particleColors.length]):this.m_emitter.SetColor(new e.b2Color(1,1,1,1)),this.m_emitter.Step(a)}getHotkeys(){return[(0,a.hotKeyPress)("m","Increase Flow",()=>this.m_emitter.SetEmitRate(Math.max(o.k_emitRateMin,this.m_emitter.GetEmitRate()*o.k_emitRateChangeFactor))),(0,a.hotKeyPress)("n","Decrease Flow",()=>this.m_emitter.SetEmitRate(Math.min(o.k_emitRateMax,this.m_emitter.GetEmitRate()/o.k_emitRateChangeFactor)))]}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}o.k_particleLifetimeMin=30,o.k_particleLifetimeMax=50,o.k_containerHeight=.2,o.k_containerWidth=1,o.k_containerThickness=.05,o.k_faucetWidth=.1,o.k_faucetHeight=15,o.k_faucetLength=2,o.k_spoutLength=2,o.k_spoutWidth=1.1,o.k_maxParticleCount=1e3,o.k_emitRateChangeFactor=1.05,o.k_emitRateMin=1,o.k_emitRateMax=240,(0,i.registerTest)("Particles","Faucet",o);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/particles/particle_emitter":"Gxyl","../../utils/hotkeys":"EV9t","./abstract_particle_test":"u1Kv","../../utils/particles/particle_parameter":"OotG"}],"NeX0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),r=require("@box2d/particles"),t=require("../../test"),l=require("./abstract_particle_test"),a=require("../../utils/particles/particle_parameter"),i={...a.defaultParticleTypes,erase:r.b2ParticleFlag.b2_zombieParticle,rigid:r.b2ParticleFlag.b2_waterParticle,"rigid barrier":r.b2ParticleFlag.b2_barrierParticle,"elastic barrier":r.b2ParticleFlag.b2_barrierParticle|r.b2ParticleFlag.b2_elasticParticle,"spring barrier":r.b2ParticleFlag.b2_barrierParticle|r.b2ParticleFlag.b2_springParticle,"repulsive wall":r.b2ParticleFlag.b2_repulsiveParticle|r.b2ParticleFlag.b2_wallParticle},s={elastic:r.b2ParticleGroupFlag.b2_solidParticleGroup,rigid:r.b2ParticleGroupFlag.b2_rigidParticleGroup|r.b2ParticleGroupFlag.b2_solidParticleGroup,spring:r.b2ParticleGroupFlag.b2_solidParticleGroup,wall:r.b2ParticleGroupFlag.b2_solidParticleGroup,"rigid barrier":r.b2ParticleGroupFlag.b2_rigidParticleGroup,"elastic barrier":r.b2ParticleGroupFlag.b2_solidParticleGroup,"spring barrier":r.b2ParticleGroupFlag.b2_solidParticleGroup,"repulsive wall":r.b2ParticleGroupFlag.b2_solidParticleGroup},c=r.b2ParticleFlag.b2_wallParticle|r.b2ParticleFlag.b2_springParticle|r.b2ParticleFlag.b2_elasticParticle;class o extends l.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r),this.m_colorIndex=0;{const r=this.m_world.CreateBody();{const t=new e.b2PolygonShape,l=[new e.b2Vec2(-4,-2),new e.b2Vec2(4,-2),new e.b2Vec2(4,0),new e.b2Vec2(-4,0)];t.Set(l,4),r.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,l=[new e.b2Vec2(-4,-2),new e.b2Vec2(-2,-2),new e.b2Vec2(-2,6),new e.b2Vec2(-4,6)];t.Set(l,4),r.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,l=[new e.b2Vec2(2,-2),new e.b2Vec2(4,-2),new e.b2Vec2(4,6),new e.b2Vec2(2,6)];t.Set(l,4),r.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,l=[new e.b2Vec2(-4,4),new e.b2Vec2(4,4),new e.b2Vec2(4,6),new e.b2Vec2(-4,6)];t.Set(l,4),r.CreateFixture({shape:t})}}this.m_colorIndex=0,this.m_particleSystem.SetRadius(.1),this.m_lastGroup=null,r.SetValues(i,"water"),r.SetRestartOnChange(!1)}getGroupFlags(){var e;return null!==(e=s[this.particleParameter.GetSelectedKey()])&&void 0!==e?e:0}MouseMove(t,a){if(super.MouseMove(t,a),a){const a=this.particleParameter.GetValue(),i=new e.b2CircleShape;i.m_p.Copy(t),i.m_radius=.2,this.m_particleSystem.DestroyParticlesInShape(i,e.b2Transform.IDENTITY);const s=this.getGroupFlags();this.m_lastGroup&&s===this.m_lastGroup.GetGroupFlags()||(this.m_colorIndex=(this.m_colorIndex+1)%l.particleColors.length);const o=new r.b2ParticleGroupDef;o.shape=i,o.flags=a,a&c&&(o.flags|=r.b2ParticleFlag.b2_reactiveParticle),o.groupFlags=s,o.color.Copy(l.particleColors[this.m_colorIndex]),o.group=this.m_lastGroup,this.m_lastGroup=this.m_particleSystem.CreateParticleGroup(o),this.m_mouseTracing=!1}}MouseUp(e){super.MouseUp(e),this.m_lastGroup=null}ParticleGroupDestroyed(e){super.ParticleGroupDestroyed(e),e===this.m_lastGroup&&(this.m_lastGroup=null)}SplitParticleGroups(){for(let e=this.m_particleSystem.GetParticleGroupList();e;e=e.GetNext())e!==this.m_lastGroup&&e.GetGroupFlags()&r.b2ParticleGroupFlag.b2_rigidParticleGroup&&e.GetAllParticleFlags()&r.b2ParticleFlag.b2_zombieParticle&&this.m_particleSystem.SplitParticleGroup(e)}Step(e,t){this.m_particleSystem.GetAllParticleFlags()&r.b2ParticleFlag.b2_zombieParticle&&this.SplitParticleGroups(),super.Step(e,t)}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}(0,t.registerTest)("Particles","Particle Drawing",o);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv","../../utils/particles/particle_parameter":"OotG"}],"CFW0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Soup=exports.particleTypes=void 0;const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),s=require("../../utils/particles/particle_parameter"),a=require("./abstract_particle_test");exports.particleTypes={...s.baseParticleTypes,"color mixing":t.b2ParticleFlag.b2_colorMixingParticle};class o extends a.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r),r.SetValues(exports.particleTypes,"water"),this.m_ground=this.m_world.CreateBody();{const t=new e.b2PolygonShape,r=[new e.b2Vec2(-4,-1),new e.b2Vec2(4,-1),new e.b2Vec2(4,0),new e.b2Vec2(-4,0)];t.Set(r,4),this.m_ground.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,r=[new e.b2Vec2(-4,-.1),new e.b2Vec2(-2,-.1),new e.b2Vec2(-2,2),new e.b2Vec2(-4,3)];t.Set(r,4),this.m_ground.CreateFixture({shape:t})}{const t=new e.b2PolygonShape,r=[new e.b2Vec2(2,-.1),new e.b2Vec2(4,-.1),new e.b2Vec2(4,3),new e.b2Vec2(2,2)];t.Set(r,4),this.m_ground.CreateFixture({shape:t})}this.m_particleSystem.SetRadius(.07);{const s=new e.b2PolygonShape;s.SetAsBox(2,1,new e.b2Vec2(0,1),0);const a=new t.b2ParticleGroupDef;a.shape=s,a.flags=r.GetValue();const o=this.m_particleSystem.CreateParticleGroup(a);a.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(o,0)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2CircleShape;r.m_p.Set(0,.5),r.m_radius=.1,t.CreateFixture({shape:r,density:.1}),this.m_particleSystem.DestroyParticlesInShape(r,t.GetTransform())}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2PolygonShape;r.SetAsBox(.1,.1,new e.b2Vec2(-1,.5),0),t.CreateFixture({shape:r,density:.1}),this.m_particleSystem.DestroyParticlesInShape(r,t.GetTransform())}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2PolygonShape;r.SetAsBox(.1,.1,new e.b2Vec2(1,.5),.5),t.CreateFixture({shape:r,density:.1}),this.m_particleSystem.DestroyParticlesInShape(r,t.GetTransform())}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(0,2),new e.b2Vec2(.1,2.1)),t.CreateFixture({shape:r,density:1});const s=new e.b2MassData;s.mass=.1,s.center.x=.5*r.m_vertex1.x+r.m_vertex2.x,s.center.y=.5*r.m_vertex1.y+r.m_vertex2.y,s.I=0,t.SetMassData(s)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(.3,2),new e.b2Vec2(.4,2.1)),t.CreateFixture({shape:r,density:1});const s=new e.b2MassData;s.mass=.1,s.center.x=.5*r.m_vertex1.x+r.m_vertex2.x,s.center.y=.5*r.m_vertex1.y+r.m_vertex2.y,s.I=0,t.SetMassData(s)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-.3,2.1),new e.b2Vec2(-.2,2)),t.CreateFixture({shape:r,density:1});const s=new e.b2MassData;s.mass=.1,s.center.x=.5*r.m_vertex1.x+r.m_vertex2.x,s.center.y=.5*r.m_vertex1.y+r.m_vertex2.y,s.I=0,t.SetMassData(s)}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:1}}}exports.Soup=o,(0,r.registerTest)("Particles","Soup",o);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/particles/particle_parameter":"OotG","./abstract_particle_test":"u1Kv"}],"Ym8t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),c=require("./abstract_particle_test");class a extends c.AbstractParticleTest{constructor(){super();{const t=this.m_world.CreateBody();{const r=new e.b2PolygonShape,c=[new e.b2Vec2(-4,-1),new e.b2Vec2(4,-1),new e.b2Vec2(4,0),new e.b2Vec2(-4,0)];r.Set(c,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,c=[new e.b2Vec2(-4,-.1),new e.b2Vec2(-2,-.1),new e.b2Vec2(-2,2),new e.b2Vec2(-4,2)];r.Set(c,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,c=[new e.b2Vec2(2,-.1),new e.b2Vec2(4,-.1),new e.b2Vec2(4,2),new e.b2Vec2(2,2)];r.Set(c,4),t.CreateFixture({shape:r})}}this.m_particleSystem.SetRadius(.07);{const r=new e.b2CircleShape;r.m_p.Set(0,2),r.m_radius=.5;const c=new t.b2ParticleGroupDef;c.flags=t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_colorMixingParticle,c.shape=r,c.color.SetRGBA(1,0,0,1),this.m_particleSystem.CreateParticleGroup(c)}{const r=new e.b2CircleShape;r.m_p.Set(-1,2),r.m_radius=.5;const c=new t.b2ParticleGroupDef;c.flags=t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_colorMixingParticle,c.shape=r,c.color.SetRGBA(0,1,0,1),this.m_particleSystem.CreateParticleGroup(c)}{const r=new e.b2PolygonShape,c=[new e.b2Vec2(0,3),new e.b2Vec2(2,3),new e.b2Vec2(2,3.5),new e.b2Vec2(0,3.5)];r.Set(c,4);const a=new t.b2ParticleGroupDef;a.flags=t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_colorMixingParticle,a.shape=r,a.color.SetRGBA(0,0,1,1),this.m_particleSystem.CreateParticleGroup(a)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2CircleShape;r.m_p.Set(0,8),r.m_radius=.5,t.CreateFixture({shape:r,density:.5})}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:1}}}(0,r.registerTest)("Particles","Surface Tension",a);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"IXug":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),a=require("./abstract_particle_test");class c extends a.AbstractParticleTest{constructor(){super();{const t=this.m_world.CreateBody();{const r=new e.b2PolygonShape,a=[new e.b2Vec2(-4,-1),new e.b2Vec2(4,-1),new e.b2Vec2(4,0),new e.b2Vec2(-4,0)];r.Set(a,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,a=[new e.b2Vec2(-4,-.1),new e.b2Vec2(-2,-.1),new e.b2Vec2(-2,2),new e.b2Vec2(-4,2)];r.Set(a,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,a=[new e.b2Vec2(2,-.1),new e.b2Vec2(4,-.1),new e.b2Vec2(4,2),new e.b2Vec2(2,2)];r.Set(a,4),t.CreateFixture({shape:r})}}this.m_particleSystem.SetRadius(.07);{const r=new e.b2CircleShape;r.m_p.Set(0,3),r.m_radius=.5;const a=new t.b2ParticleGroupDef;a.flags=t.b2ParticleFlag.b2_springParticle,a.groupFlags=t.b2ParticleGroupFlag.b2_solidParticleGroup,a.shape=r,a.color.SetRGBA(1,0,0,1),this.m_particleSystem.CreateParticleGroup(a)}{const r=new e.b2CircleShape;r.m_p.Set(-1,3),r.m_radius=.5;const a=new t.b2ParticleGroupDef;a.flags=t.b2ParticleFlag.b2_elasticParticle,a.groupFlags=t.b2ParticleGroupFlag.b2_solidParticleGroup,a.shape=r,a.color.SetRGBA(0,1,0,1),this.m_particleSystem.CreateParticleGroup(a)}{const r=new e.b2PolygonShape;r.SetAsBox(1,.5);const a=new t.b2ParticleGroupDef;a.flags=t.b2ParticleFlag.b2_elasticParticle,a.groupFlags=t.b2ParticleGroupFlag.b2_solidParticleGroup,a.position.Set(1,4),a.angle=-.5,a.angularVelocity=2,a.shape=r,a.color.SetRGBA(0,0,1,1),this.m_particleSystem.CreateParticleGroup(a)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2CircleShape;r.m_p.Set(0,8),r.m_radius=.5,t.CreateFixture({shape:r,density:.5})}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:1}}getParticleSelectionRadius(){return.4}}(0,r.registerTest)("Particles","Elastic Particles",c);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"Mlca":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),a=require("./abstract_particle_test");class i extends a.AbstractParticleTest{constructor(){super();{const t=this.m_world.CreateBody();{const r=new e.b2PolygonShape,a=[new e.b2Vec2(-4,-1),new e.b2Vec2(4,-1),new e.b2Vec2(4,0),new e.b2Vec2(-4,0)];r.Set(a,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,a=[new e.b2Vec2(-4,-.1),new e.b2Vec2(-2,-.1),new e.b2Vec2(-2,2),new e.b2Vec2(-4,2)];r.Set(a,4),t.CreateFixture({shape:r})}{const r=new e.b2PolygonShape,a=[new e.b2Vec2(2,-.1),new e.b2Vec2(4,-.1),new e.b2Vec2(4,2),new e.b2Vec2(2,2)];r.Set(a,4),t.CreateFixture({shape:r})}}this.m_particleSystem.SetRadius(.07);{const r=new e.b2CircleShape;r.m_p.Set(0,3),r.m_radius=.5;const a=new t.b2ParticleGroupDef;a.groupFlags=t.b2ParticleGroupFlag.b2_rigidParticleGroup|t.b2ParticleGroupFlag.b2_solidParticleGroup,a.shape=r,a.color.SetByteRGBA(255,0,0,255),this.m_particleSystem.CreateParticleGroup(a)}{const r=new e.b2CircleShape;r.m_p.Set(-1,3),r.m_radius=.5;const a=new t.b2ParticleGroupDef;a.groupFlags=t.b2ParticleGroupFlag.b2_rigidParticleGroup|t.b2ParticleGroupFlag.b2_solidParticleGroup,a.shape=r,a.color.SetByteRGBA(0,255,0,255),this.m_particleSystem.CreateParticleGroup(a)}{const r=new e.b2PolygonShape;r.SetAsBox(1,.5);const a=new t.b2ParticleGroupDef;a.groupFlags=t.b2ParticleGroupFlag.b2_rigidParticleGroup|t.b2ParticleGroupFlag.b2_solidParticleGroup,a.position.Set(1,4),a.angle=-.5,a.angularVelocity=2,a.shape=r,a.color.SetByteRGBA(0,0,255,255),this.m_particleSystem.CreateParticleGroup(a)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),r=new e.b2CircleShape;r.m_p.Set(0,8),r.m_radius=.5,t.CreateFixture({shape:r,density:.5})}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:1}}getParticleSelectionRadius(){return.4}}(0,r.registerTest)("Particles","Rigid Particles",i);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"VGnD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),r=require("../../utils/particles/particle_emitter"),s=require("./abstract_particle_test");class o extends s.AbstractParticleTest{constructor(){super(),this.m_emitters=[new r.RadialEmitter,new r.RadialEmitter],this.m_particleSystem.SetRadius(.05),this.m_particleSystem.SetMaxParticleCount(o.k_maxParticleCount),this.m_particleSystem.SetDestructionByAge(!0);const i=new t.b2ParticleSystemDef;i.radius=this.m_particleSystem.GetRadius(),i.destroyByAge=!0,this.m_particleSystem2=this.m_world.CreateParticleSystem(i),this.m_particleSystem2.SetMaxParticleCount(o.k_maxParticleCount);{const t=this.m_world.CreateBody(),i=new e.b2PolygonShape;i.SetAsBox(5,.1),t.CreateFixture({shape:i})}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),i=new e.b2PolygonShape,r=new e.b2Vec2(0,1.2);i.SetAsBox(o.k_dynamicBoxSize.x,o.k_dynamicBoxSize.y,r,0),t.CreateFixture({shape:i});const s=new e.b2MassData;s.mass=o.k_boxMass,s.center.Copy(r),s.I=0,t.SetMassData(s)}for(let t=0;t<this.m_emitters.length;++t){const i=1&t?-1:1,r=this.m_emitters[t];r.SetPosition(new e.b2Vec2(o.k_emitterPosition.x*i,o.k_emitterPosition.y)),r.SetSize(o.k_emitterSize),r.SetVelocity(new e.b2Vec2(o.k_emitterVelocity.x*i,o.k_emitterVelocity.y)),r.SetEmitRate(o.k_emitRate),r.SetColor(1&t?o.k_rightEmitterColor:o.k_leftEmitterColor),r.SetParticleSystem(1&t?this.m_particleSystem2:this.m_particleSystem)}}Step(e,t){let i=e.m_hertz>0?1/e.m_hertz:0;e.m_pause&&!e.m_singleStep&&(i=0),this.m_particleSystem2.SetStrictContactCheck(s.AbstractParticleTest.m_strictContacts),super.Step(e,t);for(const r of this.m_emitters)r.Step(i)}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:1}}}o.k_maxParticleCount=500,o.k_dynamicBoxSize=new e.b2Vec2(.5,.5),o.k_boxMass=1,o.k_emitRate=100,o.k_emitterPosition=new e.b2Vec2(-5,4),o.k_emitterVelocity=new e.b2Vec2(7,-4),o.k_emitterSize=new e.b2Vec2(1,1),o.k_leftEmitterColor=(new e.b2Color).SetByteRGBA(34,51,255,255),o.k_rightEmitterColor=(new e.b2Color).SetByteRGBA(255,34,17,255),(0,i.registerTest)("Particles","Multiple Systems",o);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/particles/particle_emitter":"Gxyl","./abstract_particle_test":"u1Kv"}],"RPrl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),o=require("../../utils/hotkeys"),s=require("../../test"),r=require("./abstract_particle_test");class i extends r.AbstractParticleTestWithControls{constructor({particleParameter:o}){super(o),this.m_useLinearImpulse=!1;{const t=this.m_world.CreateBody(),o=[new e.b2Vec2(i.kBoxLeft,i.kBoxBottom),new e.b2Vec2(i.kBoxRight,i.kBoxBottom),new e.b2Vec2(i.kBoxRight,i.kBoxTop),new e.b2Vec2(i.kBoxLeft,i.kBoxTop)],s=new e.b2ChainShape;s.CreateLoop(o,o.length),t.CreateFixture({shape:s})}this.m_particleSystem.SetRadius(.05),this.m_particleSystem.SetDamping(.2);{const s=new e.b2PolygonShape;s.SetAsBox(.8,1,new e.b2Vec2(0,1.01),0);const r=new t.b2ParticleGroupDef;r.flags=o.GetValue(),r.shape=s;const i=this.m_particleSystem.CreateParticleGroup(r);r.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(i,0)}}MouseUp(t){if(super.MouseUp(t),i.kBoxLeft<=t.x&&t.x<=i.kBoxRight&&i.kBoxBottom<=t.y&&t.y<=i.kBoxTop){const o=new e.b2Vec2(.5*(i.kBoxLeft+i.kBoxRight),.5*(i.kBoxBottom+i.kBoxTop)),s=e.b2Vec2.Subtract(t,o,new e.b2Vec2);s.Normalize(),this.ApplyImpulseOrForce(s)}}getHotkeys(){return[(0,o.hotKeyPress)("l","Use Linear Impulse",()=>{this.m_useLinearImpulse=!0}),(0,o.hotKeyPress)("f","Use Force",()=>{this.m_useLinearImpulse=!1})]}ApplyImpulseOrForce(t){const o=this.m_world.GetParticleSystemList();(0,e.b2Assert)(null!==o);const s=o.GetParticleGroupList();(0,e.b2Assert)(null!==s);const r=s.GetParticleCount();if(this.m_useLinearImpulse){const o=.005,i=e.b2Vec2.Scale(o*r,t,new e.b2Vec2);s.ApplyLinearImpulse(i)}else{const o=1,i=e.b2Vec2.Scale(o*r,t,new e.b2Vec2);s.ApplyForce(i)}}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}i.kBoxLeft=-2,i.kBoxRight=2,i.kBoxBottom=0,i.kBoxTop=4,(0,s.registerTest)("Particles","Impulse",i);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../utils/hotkeys":"EV9t","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"ah6e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("./soup"),i=require("../../utils/hotkeys"),s=require("../../test");class o extends e.Soup{constructor(e){super(e),this.m_joint=null,this.m_oscillationOffset=0,this.m_particleSystem.SetDamping(1);const i=new t.b2CircleShape;i.m_p.Set(0,.7),i.m_radius=.4,this.m_stirrer=this.m_world.CreateBody({type:t.b2BodyType.b2_dynamicBody}),this.m_stirrer.CreateFixture({shape:i,density:1});const s=new t.b2Transform;s.SetIdentity(),this.m_particleSystem.DestroyParticlesInShape(i,s),this.CreateJoint()}CreateJoint(){const e=new t.b2PrismaticJointDef;e.bodyA=this.m_groundBody,e.bodyB=this.m_stirrer,e.collideConnected=!0,e.localAxisA.Set(1,0),e.localAnchorA.Copy(this.m_stirrer.GetPosition()),this.m_joint=this.m_world.CreateJoint(e)}ToggleJoint(){this.m_joint?(this.m_world.DestroyJoint(this.m_joint),this.m_joint=null):this.CreateJoint()}getHotkeys(){return[(0,i.hotKeyPress)("t","Toggle Joint",()=>this.ToggleJoint())]}MouseUp(t){super.MouseUp(t),this.InSoup(t)&&this.ToggleJoint()}InSoup(t){return t.y>-1&&t.y<2&&t.x>-3&&t.x<3}Step(e,i){this.m_oscillationOffset+=1/e.m_hertz,this.m_oscillationOffset>5&&(this.m_oscillationOffset-=5);const s=.2*this.m_oscillationOffset*2*Math.PI,o=new t.b2Vec2(Math.sin(s),Math.cos(s)).Scale(10);this.InSoup(this.m_stirrer.GetPosition())&&this.m_stirrer.GetLinearVelocity().Length()<2&&this.m_stirrer.ApplyForceToCenter(o,!0),super.Step(e,i)}}(0,s.registerTest)("Particles","Soup Stirrer",o);
},{"@box2d/core":"FjWk","./soup":"CFW0","../../utils/hotkeys":"EV9t","../../test":"XTIe"}],"JOUR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),r=require("../../utils/particles/particle_emitter"),l=require("../../utils/hotkeys"),o=require("./abstract_particle_test");var s;!function(e){e[e.EMPTY=0]="EMPTY",e[e.DIRT=1]="DIRT",e[e.ROCK=2]="ROCK",e[e.OIL=3]="OIL",e[e.WATER=4]="WATER",e[e.WELL=5]="WELL",e[e.PUMP=6]="PUMP"}(s||(s={}));class a{constructor(){this.m_emitterLifetime=[]}Destroy(){for(const e of this.m_emitterLifetime)e.emitter.Destroy()}Add(e,t){this.m_emitterLifetime.push({emitter:e,lifetime:t})}Step(e){const t=[];for(const i of this.m_emitterLifetime){const r=i.lifetime-e;r<=0&&t.push(i.emitter),i.lifetime=r,i.emitter.Step(e)}for(const i of t)i.Destroy(),this.m_emitterLifetime=this.m_emitterLifetime.filter(e=>e.emitter!==i)}}class h extends e.b2DestructionListener{constructor(){super(...arguments),this.m_particleGroups=[]}SayGoodbyeParticleGroup(e){this.RemoveParticleGroup(e)}AddParticleGroup(e){this.m_particleGroups.push(e)}RemoveParticleGroup(e){this.m_particleGroups.splice(this.m_particleGroups.indexOf(e),1)}GetParticleGroups(){return this.m_particleGroups}}class n{}n.k_worldWidthTiles=24,n.k_worldHeightTiles=16,n.k_worldTiles=n.k_worldWidthTiles*n.k_worldHeightTiles,n.k_worldCenterX=0,n.k_worldCenterY=2,n.k_tileWidth=.2,n.k_tileHeight=.2,n.k_tileHalfWidth=.5*n.k_tileWidth,n.k_tileHalfHeight=.5*n.k_tileHeight,n.k_worldHalfWidth=n.k_worldWidthTiles*n.k_tileWidth*.5,n.k_worldHalfHeight=n.k_worldHeightTiles*n.k_tileHeight*.5,n.k_playerColor=new e.b2Color(1,1,1),n.k_playerFrackColor=new e.b2Color(1,.5,.5),n.k_wellColor=new e.b2Color(.5,.5,.5),n.k_oilColor=new e.b2Color(1,0,0),n.k_waterColor=new e.b2Color(0,.2,1),n.k_frackingFluidColor=new e.b2Color(.8,.4,0),n.k_density=.1,n.k_particleRadius=.5*(n.k_tileWidth+n.k_tileHeight)*.2,n.k_dirtProbability=80,n.k_emptyProbability=10,n.k_oilProbability=7,n.k_waterProbability=3,n.k_frackingFluidEmitterLifetime=5,n.k_wellSuckSpeedInside=5*n.k_tileHeight,n.k_wellSuckSpeedOutside=1*n.k_tileWidth,n.k_frackingFluidChargeTime=1,n.k_scorePerOilParticle=1,n.k_scorePerWaterParticle=-1,n.k_scorePerFrackingParticle=0,n.k_scorePerFrackingDeployment=-10;class _ extends h{constructor(e){super(),this.m_score=0,this.m_oil=0,this.m_previousListener=null,this.m_world=e,this.m_previousListener=e.GetDestructionListener(),this.m_world.SetDestructionListener(this)}Destroy(){this.m_world&&this.m_world.SetDestructionListener(this.m_previousListener)}AddScore(e){this.m_score+=e}GetScore(){return this.m_score}AddOil(e){this.m_oil+=e}GetOil(){return this.m_oil}SayGoodbyeParticle(e,t){const i=e.GetUserDataBuffer()[t];if(i){switch(i){case s.OIL:this.AddScore(n.k_scorePerOilParticle),this.AddOil(-1);break;case s.WATER:this.AddScore(n.k_scorePerWaterParticle)}}}}class c extends o.AbstractParticleTest{constructor(){super(),this.m_wellX=n.k_worldWidthTiles-n.k_worldWidthTiles/4,this.m_wellTop=n.k_worldHeightTiles-1,this.m_wellBottom=n.k_worldHeightTiles/8,this.m_tracker=new a,this.m_allowInput=!1,this.m_frackingFluidChargeTime=-1,this.m_material=[],this.m_bodies=[],this.m_listener=new _(this.m_world),this.m_particleSystem.SetRadius(n.k_particleRadius),this.InitializeLayout(),this.CreateGround(),this.CreateWell(),this.CreateGeo(),this.CreatePlayer()}Destroy(){this.m_listener.Destroy()}InitializeLayout(){for(let e=0;e<n.k_worldTiles;++e)this.m_material[e]=s.EMPTY,this.m_bodies[e]=null}GetMaterial(e,t){return this.m_material[c.TileToArrayOffset(e,t)]}SetMaterial(e,t,i){this.m_material[c.TileToArrayOffset(e,t)]=i}GetBody(e,t){return this.m_bodies[c.TileToArrayOffset(e,t)]}SetBody(e,t,i){const r=this.m_bodies[c.TileToArrayOffset(e,t)];r&&this.m_world.DestroyBody(r),this.m_bodies[c.TileToArrayOffset(e,t)]=i}CreatePlayer(){this.m_player=this.m_world.CreateBody({type:e.b2BodyType.b2_kinematicBody});const t=new e.b2PolygonShape;t.SetAsBox(n.k_tileHalfWidth,n.k_tileHalfHeight,new e.b2Vec2(n.k_tileHalfWidth,n.k_tileHalfHeight),0),this.m_player.CreateFixture({shape:t,density:n.k_density}),this.m_player.SetTransformVec(c.TileToWorld(n.k_worldWidthTiles/2,n.k_worldHeightTiles/2),0)}CreateGeo(){for(let e=0;e<n.k_worldWidthTiles;e++)for(let t=0;t<n.k_worldHeightTiles;t++){if(this.GetMaterial(e,t)!==s.EMPTY)continue;const i=100*Math.random();i<n.k_dirtProbability||0===t?this.CreateDirtBlock(e,t):i<n.k_dirtProbability+n.k_emptyProbability?this.SetMaterial(e,t,s.EMPTY):i<n.k_dirtProbability+n.k_emptyProbability+n.k_oilProbability?this.CreateReservoirBlock(e,t,s.OIL):this.CreateReservoirBlock(e,t,s.WATER)}}CreateGround(){const t=this.m_world.CreateBody(),i=new e.b2ChainShape,r=new e.b2Vec2,l=new e.b2Vec2;c.GetExtents(r,l);const o=[new e.b2Vec2(r.x,r.y),new e.b2Vec2(l.x,r.y),new e.b2Vec2(l.x,l.y),new e.b2Vec2(r.x,l.y)];i.CreateLoop(o,4),t.CreateFixture({shape:i})}CreateDirtBlock(t,i){const r=c.TileToWorld(t,i),l=this.m_world.CreateBody(),o=new e.b2PolygonShape;o.SetAsBox(n.k_tileHalfWidth,n.k_tileHalfHeight,c.CenteredPosition(r),0),l.CreateFixture({shape:o,density:n.k_density}),this.SetBody(t,i,l),this.SetMaterial(t,i,s.DIRT)}CreateReservoirBlock(i,r,l){const o=c.TileToWorld(i,r),a=new e.b2PolygonShape;this.SetMaterial(i,r,l),a.SetAsBox(n.k_tileHalfWidth,n.k_tileHalfHeight,c.CenteredPosition(o),0);const h=new t.b2ParticleGroupDef;h.flags=t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_viscousParticle|t.b2ParticleFlag.b2_destructionListenerParticle,h.shape=a,h.color.Copy(l===s.OIL?n.k_oilColor:n.k_waterColor);const _=this.m_particleSystem.CreateParticleGroup(h);this.m_listener.AddParticleGroup(_);const d=_.GetParticleCount(),m=this.m_particleSystem.GetUserDataBuffer(),k=_.GetBufferIndex();for(let e=0;e<d;++e)m[k+e]=this.m_material[c.TileToArrayOffset(i,r)];l===s.OIL&&this.m_listener.AddOil(d)}CreateWell(){for(let e=this.m_wellBottom;e<=this.m_wellTop;e++)this.SetMaterial(this.m_wellX,e,s.WELL)}CreateFrackingFluidEmitter(i){const l=new t.b2ParticleGroupDef,o=this.m_particleSystem.CreateParticleGroup(l);this.m_listener.AddParticleGroup(o);const s=new r.RadialEmitter;s.SetGroup(o),s.SetParticleSystem(this.m_particleSystem),s.SetPosition(c.CenteredPosition(i)),s.SetVelocity(new e.b2Vec2(0,-n.k_tileHalfHeight)),s.SetSpeed(.1*n.k_tileHalfWidth),s.SetSize(new e.b2Vec2(n.k_tileHalfWidth,n.k_tileHalfHeight)),s.SetEmitRate(20),s.SetColor(n.k_frackingFluidColor),s.SetParticleFlags(t.b2ParticleFlag.b2_tensileParticle|t.b2ParticleFlag.b2_viscousParticle),this.m_tracker.Add(s,n.k_frackingFluidEmitterLifetime),this.m_listener.AddScore(n.k_scorePerFrackingDeployment)}SetPlayerPosition(t,i){const r=this.m_player.GetTransform().p,l=[0],o=[0];c.WorldToTile(r,l,o),t=(0,e.b2Clamp)(t,0,n.k_worldWidthTiles-1),i=(0,e.b2Clamp)(i,0,n.k_worldHeightTiles-1),this.GetMaterial(t,i)===s.WELL||l[0]===t&&o[0]===i||(this.DeployFrackingFluid(),this.m_player.SetTransformVec(c.TileToWorld(t,i),0))}DeployFrackingFluid(){let e=!1;const t=this.m_player.GetTransform().p;return this.m_frackingFluidChargeTime>n.k_frackingFluidChargeTime&&(this.CreateFrackingFluidEmitter(t),e=!0),this.m_frackingFluidChargeTime=-1,e}DestroyParticlesInTiles(t,i,r,l){const o=new e.b2PolygonShape,s=r-t+1,a=l-i+1,h=t+s/2,_=i+a/2;o.SetAsBox(n.k_tileHalfWidth*s,n.k_tileHalfHeight*a);const d=new e.b2Transform;d.SetPositionAngle(c.CenteredPosition(c.TileToWorld(h,_)),0),this.m_particleSystem.DestroyParticlesInShape(o,d)}JointDestroyed(e){super.JointDestroyed(e)}ParticleGroupDestroyed(e){super.ParticleGroupDestroyed(e)}BeginContact(e){super.BeginContact(e)}EndContact(e){super.EndContact(e)}PreSolve(e,t){super.PreSolve(e,t)}PostSolve(e,t){super.PostSolve(e,t)}getHotkeys(){return[(0,l.hotKeyPress)("a","Left",()=>this.AdjustPlayerPosition(-1,0)),(0,l.hotKeyPress)("d","Right",()=>this.AdjustPlayerPosition(1,0)),(0,l.hotKeyPress)("w","Up",()=>this.AdjustPlayerPosition(0,1)),(0,l.hotKeyPress)("s","Down",()=>this.AdjustPlayerPosition(0,-1)),(0,l.hotKeyPress)("e","Deploy Fracking",()=>{this.m_frackingFluidChargeTime<0?this.m_frackingFluidChargeTime=0:this.DeployFrackingFluid()})]}AdjustPlayerPosition(e,t){if(!this.m_allowInput)return;const i=this.m_player.GetTransform().p,r=[0],l=[0];c.WorldToTile(i,r,l),this.SetPlayerPosition(r[0]+e,l[0]+t),this.m_allowInput=!1}MouseDown(e){super.MouseDown(e),this.m_frackingFluidChargeTime=0}MouseUp(t){if(super.MouseUp(t),this.m_allowInput){if(!this.DeployFrackingFluid()){const i=this.m_player.GetTransform().p,r=[0],l=[0];c.WorldToTile(i,r,l);const o=e.b2Vec2.Subtract(t,c.CenteredPosition(i),new e.b2Vec2),s=Math.abs(o.x),a=Math.abs(o.y);s>a&&s>=n.k_tileHalfWidth?r[0]+=o.x>0?1:-1:a>=n.k_tileHalfWidth&&(l[0]+=o.y>0?1:-1),this.SetPlayerPosition(r[0],l[0])}this.m_allowInput=!1}}Step(t,i){let r=t.m_hertz>0?1/t.m_hertz:0;t.m_pause&&!t.m_singleStep&&(r=0),super.Step(t,i),this.m_tracker.Step(r),this.m_allowInput=!0,this.m_frackingFluidChargeTime>=0&&(this.m_frackingFluidChargeTime+=r);const l=this.m_player.GetTransform().p,o=[0],a=[0];c.WorldToTile(l,o,a),this.GetMaterial(o[0],a[0])===s.DIRT&&(this.SetMaterial(o[0],a[0],s.EMPTY),this.SetBody(o[0],a[0],null)),this.DestroyParticlesInTiles(this.m_wellX,this.m_wellTop,this.m_wellX,this.m_wellTop);const h=this.m_listener.GetParticleGroups();for(const s of h){const t=s.GetBufferIndex(),i=this.m_particleSystem.GetPositionBuffer(),r=this.m_particleSystem.GetVelocityBuffer(),l=s.GetParticleCount();for(let o=0;o<l;++o){const l=c.CenteredPosition(c.TileToWorld(this.m_wellX,this.m_wellBottom-2)),s=i[t+o],a=e.b2Vec2.Subtract(s,l,new e.b2Vec2),h=Math.abs(a.x);if(h<n.k_tileWidth&&a.y>-2*n.k_tileWidth&&a.y<0){const i=e.b2Vec2.Subtract(l,s,new e.b2Vec2);i.Normalize(),r[t+o].Copy(i.Scale(n.k_wellSuckSpeedOutside))}else if(h<=n.k_tileHalfWidth&&a.y>0){const i=Math.random()*n.k_tileHalfWidth-a.x,l=new e.b2Vec2(i,n.k_tileHeight);l.Normalize(),r[t+o].Copy(l.Scale(n.k_wellSuckSpeedInside))}}}const _=t.m_debugDraw;this.DrawPlayer(_),this.DrawWell(_),this.DrawScore()}DrawWell(e){for(let t=this.m_wellBottom;t<=this.m_wellTop;++t)this.DrawQuad(e,c.TileToWorld(this.m_wellX,t),n.k_wellColor)}DrawPlayer(e){this.DrawQuad(e,this.m_player.GetTransform().p,c.LerpColor(n.k_playerColor,n.k_playerFrackColor,Math.max(this.m_frackingFluidChargeTime/n.k_frackingFluidChargeTime,0)),!0)}DrawScore(){this.addDebug("Score",this.m_listener.GetScore()),this.addDebug("Remaining Oil",this.m_listener.GetOil())}DrawQuad(t,i,r,l=!1){const o=(0,e.b2MakeArray)(4,e.b2Vec2),s=i.x+n.k_tileWidth,a=i.y+n.k_tileHeight;o[0].Set(i.x,a),o[1].Set(i.x,i.y),o[2].Set(s,i.y),o[3].Set(s,a),l?t.DrawPolygon(o,4,r):t.DrawSolidPolygon(o,4,r)}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}static GetBottomLeft(e){e.Set(n.k_worldCenterX-n.k_worldHalfWidth,n.k_worldCenterY-n.k_worldHalfHeight)}static GetExtents(e,t){c.GetBottomLeft(e),t.Set(n.k_worldCenterX+n.k_worldHalfWidth,n.k_worldCenterY+n.k_worldHalfHeight)}static WorldToTile(t,i,r){const l=new e.b2Vec2;c.GetBottomLeft(l),i[0]=Math.floor((t.x-l.x)/n.k_tileWidth+n.k_tileHalfWidth),r[0]=Math.floor((t.y-l.y)/n.k_tileHeight+n.k_tileHalfHeight)}static TileToWorld(t,i,r=new e.b2Vec2){const l=new e.b2Vec2;return c.GetBottomLeft(l),r.Set(t*n.k_tileWidth+l.x,i*n.k_tileHeight+l.y)}static TileToArrayOffset(e,t){return e+t*n.k_worldWidthTiles}static CenteredPosition(t,i=new e.b2Vec2){return i.Set(t.x+n.k_tileHalfWidth,t.y+n.k_tileHalfHeight)}static LerpColor(t,i,r){return new e.b2Color(c.Lerp(t.r,i.r,r),c.Lerp(t.g,i.g,r),c.Lerp(t.b,i.b,r))}static Lerp(e,t,i){return e*(1-i)+t*i}}(0,i.registerTest)("Particles","Fracker",c);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/particles/particle_emitter":"Gxyl","../../utils/hotkeys":"EV9t","./abstract_particle_test":"u1Kv"}],"ub8m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),r=require("../../utils/hotkeys"),s=require("./abstract_particle_test");class a extends s.AbstractParticleTest{constructor(){super(e.b2Vec2.ZERO),this.m_density=a.k_densityDefault,this.m_position=a.k_containerHalfHeight,this.m_temperature=a.k_temperatureDefault,this.m_barrierBody=null,this.m_particleGroup=null;{const t=this.m_world.CreateBody(),i=new e.b2ChainShape,r=[new e.b2Vec2(-a.k_containerHalfWidth,0),new e.b2Vec2(a.k_containerHalfWidth,0),new e.b2Vec2(a.k_containerHalfWidth,a.k_containerHeight),new e.b2Vec2(-a.k_containerHalfWidth,a.k_containerHeight)];i.CreateLoop(r,4),t.CreateFixture({shape:i,density:0,restitution:1})}this.EnableBarrier(),this.ResetParticles()}DisableBarrier(){this.m_barrierBody&&(this.m_world.DestroyBody(this.m_barrierBody),this.m_barrierBody=null)}EnableBarrier(){if(!this.m_barrierBody){this.m_barrierBody=this.m_world.CreateBody();const t=new e.b2PolygonShape;t.SetAsBox(a.k_containerHalfWidth,a.k_barrierHeight,new e.b2Vec2(0,this.m_position),0),this.m_barrierBody.CreateFixture({shape:t,density:0,restitution:1})}}ToggleBarrier(){this.m_barrierBody?this.DisableBarrier():this.EnableBarrier()}ResetParticles(){null!==this.m_particleGroup&&(this.m_particleGroup.DestroyParticles(!1),this.m_particleGroup=null),this.m_particleSystem.SetRadius(a.k_containerHalfWidth/20);{const i=new e.b2PolygonShape;i.SetAsBox(this.m_density*a.k_containerHalfWidth,this.m_density*a.k_containerHalfHeight,new e.b2Vec2(0,a.k_containerHalfHeight),0);const r=new t.b2ParticleGroupDef;r.flags=t.b2ParticleFlag.b2_powderParticle,r.shape=i,this.m_particleGroup=this.m_particleSystem.CreateParticleGroup(r);const s=this.m_particleSystem.GetVelocityBuffer(),n=this.m_particleGroup.GetBufferIndex();for(let t=0;t<this.m_particleGroup.GetParticleCount();++t){const i=s[n+t];i.Set((0,e.b2RandomFloat)(-1,1)+1,(0,e.b2RandomFloat)(-1,1)+1),i.Normalize(),i.Scale(this.m_temperature)}}}getHotkeys(){return[(0,r.hotKeyPress)("a","Toggle Barrier",()=>this.ToggleBarrier()),(0,r.hotKeyPress)("m","Increase the Particle Density",()=>{this.m_density=Math.min(this.m_density*a.k_densityStep,a.k_densityMax),this.Reset()}),(0,r.hotKeyPress)("n","Reduce the Particle Density",()=>{this.m_density=Math.max(this.m_density/a.k_densityStep,a.k_densityMin),this.Reset()}),(0,r.hotKeyPress)("w","Move the location of the divider up",()=>this.MoveDivider(this.m_position+a.k_barrierMovementIncrement)),(0,r.hotKeyPress)("s","Move the location of the divider down",()=>this.MoveDivider(this.m_position-a.k_barrierMovementIncrement)),(0,r.hotKeyPress)("h","Reduce the temperature (velocity of particles)",()=>{this.m_temperature=Math.max(this.m_temperature-a.k_temperatureStep,a.k_temperatureMin),this.Reset()}),(0,r.hotKeyPress)("j","Increase the temperature (velocity of particles)",()=>{this.m_temperature=Math.min(this.m_temperature+a.k_temperatureStep,a.k_temperatureMax),this.Reset()})]}InContainer(e){return e.x>=-a.k_containerHalfWidth&&e.x<=a.k_containerHalfWidth&&e.y>=0&&e.y<=2*a.k_containerHalfHeight}MouseDown(e){this.InContainer(e)||super.MouseDown(e)}MouseUp(e){this.InContainer(e)?this.ToggleBarrier():(this.MoveDivider(e.y),super.MouseUp(e))}Step(e,t){super.Step(e,t);let i=0,r=0;if(this.m_particleGroup){const e=this.m_particleGroup.GetBufferIndex(),t=this.m_particleSystem.GetVelocityBuffer(),s=this.m_particleSystem.GetPositionBuffer();for(let a=0;a<this.m_particleGroup.GetParticleCount();a++){const n=t[e+a];n.Normalize(),n.Scale(this.m_temperature),s[e+a].y>this.m_position?i++:r++}}const s=i/(a.k_containerHeight-this.m_position),n=r/this.m_position;this.addDebug("Score",s>0?n/s-1:0)}Reset(){this.DisableBarrier(),this.ResetParticles(),this.EnableBarrier()}MoveDivider(t){this.m_position=(0,e.b2Clamp)(t,a.k_barrierMovementIncrement,a.k_containerHeight-a.k_barrierMovementIncrement),this.Reset()}GetDefaultViewZoom(){return 250}getCenter(){return{x:0,y:2}}}a.k_containerWidth=2,a.k_containerHeight=4,a.k_containerHalfWidth=a.k_containerWidth/2,a.k_containerHalfHeight=a.k_containerHeight/2,a.k_barrierHeight=a.k_containerHalfHeight/100,a.k_barrierMovementIncrement=.1*a.k_containerHalfHeight,a.k_densityStep=1.25,a.k_densityMin=.01,a.k_densityMax=.8,a.k_densityDefault=.25,a.k_temperatureStep=.2,a.k_temperatureMin=.4,a.k_temperatureMax=10,a.k_temperatureDefault=5,(0,i.registerTest)("Particles","Maxwell",a);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/hotkeys":"EV9t","./abstract_particle_test":"u1Kv"}],"QXqz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),a=require("./abstract_particle_test");class s extends a.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r);{const t=this.m_world.CreateBody(),r=5,a=5;for(let s=30;s>0;s-=a){const r=new e.b2PolygonShape,c=[new e.b2Vec2(-25,s),new e.b2Vec2(-25,s-a),new e.b2Vec2(0,15)];r.Set(c,3),t.CreateFixture({shape:r})}for(let s=-25;s<25;s+=r){const a=new e.b2PolygonShape,c=[new e.b2Vec2(s,0),new e.b2Vec2(s+r,0),new e.b2Vec2(0,15)];a.Set(c,3),t.CreateFixture({shape:a})}}this.m_particleSystem.SetRadius(.25);const a=r.GetValue();a===t.b2ParticleFlag.b2_waterParticle&&this.m_particleSystem.SetDamping(.2);{const r=new e.b2CircleShape;r.m_p.Set(-20,33),r.m_radius=3;const s=new t.b2ParticleGroupDef;s.flags=a,s.shape=r;const c=this.m_particleSystem.CreateParticleGroup(s);s.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(c,0)}}getCenter(){return{x:0,y:10}}}(0,r.registerTest)("Particles","Ramp",s);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"Twqu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),i=require("./abstract_particle_test"),l=require("../../utils/particles/particle_parameter");class a extends i.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r),this.m_killfieldShape=new e.b2PolygonShape,this.m_killfieldTransform=new e.b2Transform,r.SetValues(l.baseParticleTypes,"water");{const t=this.m_world.CreateBody(),r=1;for(let i=-10;i<10;i+=r){const l=new e.b2PolygonShape,a=[new e.b2Vec2(i,-10),new e.b2Vec2(i+r,-10),new e.b2Vec2(0,25)];l.Set(a,3),t.CreateFixture({shape:l})}}this.m_particleSystem.SetRadius(.5),r.GetValue()===t.b2ParticleFlag.b2_waterParticle&&this.m_particleSystem.SetDamping(.2),this.m_killfieldShape=new e.b2PolygonShape,this.m_killfieldShape.SetAsBox(50,1),this.m_killfieldTransform=new e.b2Transform;const i=new e.b2Vec2(-25,1);this.m_killfieldTransform.SetPositionAngle(i,0)}Step(e,r){super.Step(e,r);const i=this.particleParameter.GetValue(),l=new t.b2ParticleDef;if(l.position.Set(0,33),l.velocity.Set(0,-1),l.flags=i,i&(t.b2ParticleFlag.b2_springParticle|t.b2ParticleFlag.b2_elasticParticle)){const e=this.m_particleSystem.GetParticleCount();l.velocity.Set(1&e?-1:1,-5),l.flags|=t.b2ParticleFlag.b2_reactiveParticle}this.m_particleSystem.CreateParticle(l),this.m_particleSystem.DestroyParticlesInShape(this.m_killfieldShape,this.m_killfieldTransform)}getCenter(){return{x:0,y:20}}}(0,r.registerTest)("Particles","Pointy",a);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv","../../utils/particles/particle_parameter":"OotG"}],"BHjq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),a=require("./abstract_particle_test"),i=require("../../utils/particles/particle_parameter");class s extends a.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r),this.m_particlesToCreate=300;{const t=this.m_world.CreateBody(),r=1;for(let a=-10;a<10;a+=r){const i=new e.b2PolygonShape,s=[new e.b2Vec2(a,-10),new e.b2Vec2(a+r,-10),new e.b2Vec2(0,15)];i.Set(s,3),t.CreateFixture({shape:i})}for(let a=-10;a<35;a+=r){const i=new e.b2PolygonShape,s=[new e.b2Vec2(-10,a),new e.b2Vec2(-10,a+r),new e.b2Vec2(0,15)];i.Set(s,3),t.CreateFixture({shape:i});const c=[new e.b2Vec2(10,a),new e.b2Vec2(10,a+r),new e.b2Vec2(0,15)];i.Set(c,3),t.CreateFixture({shape:i})}}this.m_particlesToCreate=300,this.m_particleSystem.SetRadius(.5),r.GetValue()===t.b2ParticleFlag.b2_waterParticle&&this.m_particleSystem.SetDamping(.2),r.SetValues(i.baseParticleTypes,"water")}Step(e,r){if(super.Step(e,r),this.m_particlesToCreate<=0)return;--this.m_particlesToCreate;const a=this.particleParameter.GetValue(),i=new t.b2ParticleDef;if(i.position.Set(0,40),i.velocity.Set(0,-1),i.flags=a,a&(t.b2ParticleFlag.b2_springParticle|t.b2ParticleFlag.b2_elasticParticle)){const e=this.m_particleSystem.GetParticleCount();i.velocity.Set(1&e?-1:1,-5),i.flags|=t.b2ParticleFlag.b2_reactiveParticle}this.m_particleSystem.CreateParticle(i)}getCenter(){return{x:0,y:20}}}(0,r.registerTest)("Particles","AntiPointy",s);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv","../../utils/particles/particle_parameter":"OotG"}],"uIQj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),c=require("./abstract_particle_test");class s extends c.AbstractParticleTestWithControls{constructor({particleParameter:r}){super(r);{const t=this.m_world.CreateBody();{const r=new e.b2PolygonShape,c=[new e.b2Vec2(-20,30),new e.b2Vec2(-20,0),new e.b2Vec2(-25,0),new e.b2Vec2(-25,30)];r.Set(c),t.CreateFixture({shape:r})}const r=30,c=r/10,s=20,a=s/2;{const r=new e.b2PolygonShape,c=[new e.b2Vec2(-25,0),new e.b2Vec2(20,15),new e.b2Vec2(25,0)];r.Set(c),t.CreateFixture({shape:r})}for(let n=-s;n<s;n+=a){const r=new e.b2PolygonShape,c=[new e.b2Vec2(-25,0),new e.b2Vec2(n,15),new e.b2Vec2(n+a,15)];r.Set(c),t.CreateFixture({shape:r})}for(let n=0;n<r;n+=c){const r=new e.b2PolygonShape,s=[new e.b2Vec2(25,n),new e.b2Vec2(25,n+c),new e.b2Vec2(20,15)];r.Set(s),t.CreateFixture({shape:r})}}this.m_particleSystem.SetRadius(1);const c=r.GetValue();{const r=new e.b2CircleShape;r.m_p.Set(0,35),r.m_radius=12;const s=new t.b2ParticleGroupDef;s.flags=c,s.shape=r;const a=this.m_particleSystem.CreateParticleGroup(s);s.flags&t.b2ParticleFlag.b2_colorMixingParticle&&this.ColorParticleGroup(a,0)}}getCenter(){return{x:0,y:20}}}(0,r.registerTest)("Particles","Corner Case",s);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"u396":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),i=require("../../test"),l=require("../../utils/hotkeys"),r=require("./abstract_particle_test");class s extends e.b2ContactFilter{constructor(){super(...arguments),this.m_enableFixtureParticleCollisions=!0,this.m_enableParticleParticleCollisions=!0}ShouldCollideFixtureParticle(){return this.m_enableFixtureParticleCollisions}ShouldCollideParticleParticle(){return this.m_enableParticleParticleCollisions}}class o extends r.AbstractParticleTest{constructor(){super(e.b2Vec2.ZERO),this.m_contactDisabler=new s,this.m_world.SetContactFilter(this.m_contactDisabler);{const t=this.m_world.CreateBody(),i=new e.b2ChainShape,l=[new e.b2Vec2(-o.kBoxSize,-o.kBoxSize+o.kOffset),new e.b2Vec2(o.kBoxSize,-o.kBoxSize+o.kOffset),new e.b2Vec2(o.kBoxSize,o.kBoxSize+o.kOffset),new e.b2Vec2(-o.kBoxSize,o.kBoxSize+o.kOffset)];i.CreateLoop(l),t.CreateFixture({shape:i,density:0,restitution:1})}this.m_particleSystem.SetRadius(.5);{const i=new e.b2PolygonShape;i.SetAsBox(1.5,1.5,new e.b2Vec2(o.kBoxSizeHalf,o.kBoxSizeHalf+o.kOffset),0);const l=new t.b2ParticleGroupDef;l.shape=i,l.flags=t.b2ParticleFlag.b2_powderParticle|t.b2ParticleFlag.b2_particleContactFilterParticle|t.b2ParticleFlag.b2_fixtureContactFilterParticle,this.m_particleGroup=this.m_particleSystem.CreateParticleGroup(l);const r=this.m_particleSystem.GetVelocityBuffer(),s=this.m_particleGroup.GetBufferIndex();for(let t=0;t<this.m_particleGroup.GetParticleCount();++t){const i=r[s+t];i.Set((0,e.b2RandomFloat)(-1,1),(0,e.b2RandomFloat)(-1,1)),i.Normalize(),i.Scale(o.kSpeedup)}}}Step(e,t){super.Step(e,t);const i=this.m_particleGroup.GetBufferIndex(),l=this.m_particleSystem.GetVelocityBuffer();for(let r=0;r<this.m_particleGroup.GetParticleCount();++r){const e=l[i+r];e.Normalize(),e.Scale(o.kSpeedup)}}getCenter(){return{x:0,y:20}}getHotkeys(){return[(0,l.hotKeyPress)("a","Toggle Fixture Collisions",()=>this.ToggleFixtureCollisions()),(0,l.hotKeyPress)("s","Toggle Particle Collisions",()=>this.ToggleParticleCollisions())]}ToggleFixtureCollisions(){this.m_contactDisabler.m_enableFixtureParticleCollisions=!this.m_contactDisabler.m_enableFixtureParticleCollisions}ToggleParticleCollisions(){this.m_contactDisabler.m_enableParticleParticleCollisions=!this.m_contactDisabler.m_enableParticleParticleCollisions}}o.kBoxSize=10,o.kBoxSizeHalf=o.kBoxSize/2,o.kOffset=20,o.kParticlesContainerSize=o.kOffset+.5,o.kSpeedup=8,(0,i.registerTest)("Particles","Particle Collisions",o);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","../../utils/hotkeys":"EV9t","./abstract_particle_test":"u1Kv"}],"L9fA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/particles"),r=require("../../test"),s=require("./abstract_particle_test");class o extends s.AbstractParticleTest{constructor(){super(),this.m_particleSystem.SetDamping(.2),this.m_particleSystem.SetRadius(.6),this.m_particleSystem.SetGravityScale(.4),this.m_particleSystem.SetDensity(1.2);const r=this.m_world.CreateBody(),s=this.m_world.CreateBody({type:e.b2BodyType.b2_staticBody,allowSleep:!1}),o=new e.b2PolygonShape;o.SetAsBox(.5,10,new e.b2Vec2(20,0),0),s.CreateFixture({shape:o,density:5}),o.SetAsBox(.5,10,new e.b2Vec2(-20,0),0),s.CreateFixture({shape:o,density:5}),o.SetAsBox(.5,20,new e.b2Vec2(0,10),Math.PI/2),s.CreateFixture({shape:o,density:5}),o.SetAsBox(.5,20,new e.b2Vec2(0,-10),Math.PI/2),s.CreateFixture({shape:o,density:5}),this.m_mover=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody}),o.SetAsBox(1,5,new e.b2Vec2(0,2),0),this.m_mover.CreateFixture({shape:o,density:5});const a=new e.b2RevoluteJointDef;a.bodyA=r,a.bodyB=this.m_mover,a.localAnchorA.Set(0,0),a.localAnchorB.Set(0,5),a.referenceAngle=0,a.motorSpeed=0,a.maxMotorTorque=1e7,a.enableMotor=!0,this.m_joint=this.m_world.CreateJoint(a);const i=new t.b2ParticleGroupDef;i.flags=t.b2ParticleFlag.b2_waterParticle;const c=new e.b2PolygonShape;c.SetAsBox(9,9,new e.b2Vec2,0),i.shape=c,this.m_particleSystem.CreateParticleGroup(i)}Step(e,t){const r=(new Date).getTime();this.m_joint.SetMotorSpeed(.7*Math.cos(r/1e3)),super.Step(e,t)}}(0,r.registerTest)("Particles","Eye Candy",o);
},{"@box2d/core":"FjWk","@box2d/particles":"eX67","../../test":"XTIe","./abstract_particle_test":"u1Kv"}],"kTdU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./sandbox"),require("./sparky"),require("./dam_break"),require("./liquid_timer"),require("./wave_machine"),require("./particles"),require("./faucet"),require("./drawing_particles"),require("./soup"),require("./particles_surface_tension"),require("./elastic_particles"),require("./rigid_particles"),require("./multiple_particle_systems"),require("./impulse"),require("./soup_stirrer"),require("./fracker"),require("./maxwell"),require("./ramp"),require("./pointy"),require("./anti_pointy"),require("./corner_case"),require("./particle_collision_filter"),require("./eye_candy");
},{"./sandbox":"mT05","./sparky":"itjE","./dam_break":"tcIx","./liquid_timer":"Cv1P","./wave_machine":"IKNa","./particles":"jDdO","./faucet":"b9sY","./drawing_particles":"NeX0","./soup":"CFW0","./particles_surface_tension":"Ym8t","./elastic_particles":"IXug","./rigid_particles":"Mlca","./multiple_particle_systems":"VGnD","./impulse":"RPrl","./soup_stirrer":"ah6e","./fracker":"JOUR","./maxwell":"ub8m","./ramp":"QXqz","./pointy":"Twqu","./anti_pointy":"BHjq","./corner_case":"uIQj","./particle_collision_filter":"u396","./eye_candy":"L9fA"}],"yavg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BlendFunc=void 0;class t{constructor(t,s,e){this.gl=t,this.default_sfactor=s,this.default_dfactor=e,this.sfactor=s,this.dfactor=e}set(t,s){this.sfactor=t,this.dfactor=s}reset(){this.sfactor=this.default_sfactor,this.dfactor=this.default_dfactor}apply(){this.gl.blendFunc(this.sfactor,this.dfactor)}}exports.BlendFunc=t;
},{}],"RxZN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LightColor=void 0;class t{constructor(t=0,s=0,h=0,i=1){this.r=t,this.g=s,this.b=h,this.a=i}set(t,s,h,i=1){this.r=t,this.g=s,this.b=h,this.a=i}copy(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}toFloatBits(){return Math.round(255*this.a)<<24|Math.round(255*this.b)<<16|Math.round(255*this.g)<<8|Math.round(255*this.r)}}exports.LightColor=t;
},{}],"mcD4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FrameBuffer=void 0;class t{constructor(t,e,i){this.gl=t,this.width=e,this.height=i,this.texture=this.createTexture(),this.framebufferHandle=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebufferHandle),this.bindTexture(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.texture,0),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null),this.bindTexture();const r=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER);if(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),r!==this.gl.FRAMEBUFFER_COMPLETE){if(this.dispose(),r===this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT)throw new Error("Frame buffer couldn't be constructed: incomplete attachment");if(r===this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS)throw new Error("Frame buffer couldn't be constructed: incomplete dimensions");if(r===this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT)throw new Error("Frame buffer couldn't be constructed: missing attachment");if(r===this.gl.FRAMEBUFFER_UNSUPPORTED)throw new Error("Frame buffer couldn't be constructed: unsupported combination of formats");throw new Error(`Frame buffer couldn't be constructed: unknown error ${r}`)}}bindTexture(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}createTexture(){const t=this.gl.RGBA,e=this.gl.UNSIGNED_BYTE,i=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,t,this.width,this.height,0,t,e,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),i}dispose(){this.gl.deleteTexture(this.texture),this.gl.deleteFramebuffer(this.framebufferHandle)}bind(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebufferHandle)}unbind(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}begin(){this.bind(),this.lastViewport=this.gl.getParameter(this.gl.VIEWPORT),this.gl.viewport(0,0,this.width,this.height)}endSimple(){this.end(this.lastViewport[0],this.lastViewport[1],this.lastViewport[2],this.lastViewport[3])}end(t,e,i,r){this.unbind(),this.gl.viewport(t,e,i,r)}}exports.FrameBuffer=t;
},{}],"TD7C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VertexBufferObject=void 0;class t{constructor(t,e,i){this.gl=t,this.buffer=t.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,e),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}setData(t,e=!0){e&&this.bind(),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,t),e&&this.unbind()}bind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer)}unbind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}dispose(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.deleteBuffer(this.buffer)}}exports.VertexBufferObject=t;
},{}],"JQcC":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&("get"in o?r.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,o)}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./BlendFunc"),exports),r(require("./LightColor"),exports),r(require("./FrameBuffer"),exports),r(require("./VertexBufferObject"),exports);
},{"./BlendFunc":"yavg","./LightColor":"RxZN","./FrameBuffer":"mcD4","./VertexBufferObject":"TD7C"}],"K54L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LightMesh=void 0;const e=require("./utils");class s{constructor(e,s){this.vertexNum=0,this.lightMapDrawingDisabled=!1,this.gl=e,this.setVertexNum(s)}setVertexNum(t){t<s.MIN_VERTS&&(t=s.MIN_VERTS),this.vertexNum<t&&(this.vertexNum=t,this.vertices=new Float32Array(4*this.vertexNum),this.colors=new Int32Array(2*this.vertexNum),this.colorScales=new Float32Array(2*this.vertexNum),this.vertBuffer&&this.vertBuffer.dispose(),this.vertBuffer=new e.VertexBufferObject(this.gl,this.gl.DYNAMIC_DRAW,this.vertices),this.colorBuffer&&this.colorBuffer.dispose(),this.colorBuffer=new e.VertexBufferObject(this.gl,this.gl.DYNAMIC_DRAW,this.colors),this.sBuffer&&this.sBuffer.dispose(),this.sBuffer=new e.VertexBufferObject(this.gl,this.gl.DYNAMIC_DRAW,this.colorScales))}getVertices(){return this.vertices}getColors(){return this.colors}getColorScales(){return this.colorScales}render(e,s,t){this.vertBuffer.bind(),e.a_position.enable(),e.a_position.set(2,this.gl.FLOAT,!1,0,0),this.vertBuffer.unbind(),this.colorBuffer.bind(),e.quad_colors.enable(),e.quad_colors.set(4,this.gl.UNSIGNED_BYTE,!0,0,0),this.colorBuffer.unbind(),this.sBuffer.bind(),e.s.enable(),e.s.set(1,this.gl.FLOAT,!1,0,0),this.sBuffer.unbind(),this.gl.drawArrays(s,0,t),e.a_position.disable(),e.quad_colors.disable(),e.s.disable()}update(){this.vertBuffer.setData(this.vertices),this.colorBuffer.setData(this.colors),this.sBuffer.setData(this.colorScales)}dispose(){this.vertBuffer.dispose(),this.colorBuffer.dispose(),this.sBuffer.dispose()}}exports.LightMesh=s,s.MIN_VERTS=4;
},{"./utils":"JQcC"}],"Y5xH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Matrix3=void 0;class t{constructor(){this.data=[1,0,0,0,1,0,0,0,1]}mulVec2(t){const a=t.x*this.data[0]+t.y*this.data[3]+this.data[6],s=t.x*this.data[1]+t.y*this.data[4]+this.data[7];return t.x=a,t.y=s,t}setToTranslation(t){const a=this.data;return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=t.x,a[7]=t.y,a[8]=1,this}setToRotationRad(t){const a=Math.cos(t),s=Math.sin(t),i=this.data;return i[0]=a,i[1]=s,i[2]=0,i[3]=-s,i[4]=a,i[5]=0,i[6]=0,i[7]=0,i[8]=1,this}det(){const t=this.data;return t[0]*t[4]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]-t[6]*t[4]*t[2]}set(t,a,s,i,r,h,e,n,d){return this.data[0]=t,this.data[1]=a,this.data[2]=s,this.data[3]=i,this.data[4]=r,this.data[5]=h,this.data[6]=e,this.data[7]=n,this.data[8]=d,this}inv(){const t=this.det();if(0===t)throw new Error("Can't invert a singular matrix");const a=1/t,s=this.data;return this.set(a*(s[4]*s[8]-s[5]*s[7]),a*(s[2]*s[7]-s[1]*s[8]),a*(s[1]*s[5]-s[2]*s[4]),a*(s[5]*s[6]-s[3]*s[8]),a*(s[0]*s[8]-s[2]*s[6]),a*(s[2]*s[3]-s[0]*s[5]),a*(s[3]*s[7]-s[4]*s[6]),a*(s[1]*s[6]-s[0]*s[7]),a*(s[0]*s[4]-s[1]*s[3]))}rotateRad(t){if(0===t)return this;const s=Math.cos(t),i=Math.sin(t);return this.mul(a.set(s,i,0,-i,s,0,0,0,1))}mul(t){const a=this.data,s=t.data;return this.set(a[0]*s[0]+a[3]*s[1]+a[6]*s[2],a[1]*s[0]+a[4]*s[1]+a[7]*s[2],a[2]*s[0]+a[5]*s[1]+a[8]*s[2],a[0]*s[3]+a[3]*s[4]+a[6]*s[5],a[1]*s[3]+a[4]*s[4]+a[7]*s[5],a[2]*s[3]+a[5]*s[4]+a[8]*s[5],a[0]*s[6]+a[3]*s[7]+a[6]*s[8],a[1]*s[6]+a[4]*s[7]+a[7]*s[8],a[2]*s[6]+a[5]*s[7]+a[8]*s[8])}}exports.Matrix3=t;const a=new t;
},{}],"OIeL":[function(require,module,exports) {
"use strict";function e(e){return Math.sin(exports.DEG_TO_RAD*e)}function r(e){return Math.cos(exports.DEG_TO_RAD*e)}function t(e,r=0){const t=new Array(e);for(let o=0;o<e;o++)t[o]=r;return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeNumberArray=exports.cosDeg=exports.sinDeg=exports.RAD_TO_DEG=exports.DEG_TO_RAD=void 0,exports.DEG_TO_RAD=Math.PI/180,exports.RAD_TO_DEG=180/Math.PI,exports.sinDeg=e,exports.cosDeg=r,exports.makeNumberArray=t;
},{}],"oxsu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rectangle=void 0;class t{constructor(){this.x=0,this.y=0,this.width=0,this.height=0}set(t,h,i,s){return this.x=t,this.y=h,this.width=i,this.height=s,this}contains(t,h){return this.x<=t&&this.x+this.width>=t&&this.y<=h&&this.y+this.height>=h}overlaps(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}}exports.Rectangle=t;
},{}],"ilXT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Spinor=void 0;const t=require("./utils");class e{constructor(t=0,e=0){this.real=t,this.complex=e}setAngle(t){return t/=2,this.set(Math.cos(t),Math.sin(t))}copy(t){return this.set(t.real,t.complex),this}set(t,e){return this.real=t,this.complex=e,this}scale(t){return this.real*=t,this.complex*=t,this}invert(){return this.complex=-this.complex,this.scale(this.len2()),this}add(t){return this.real+=t.real,this.complex+=t.complex,this}addAngle(t){return t/=2,this.real+=Math.cos(t),this.complex+=Math.sin(t),this}sub(t){return this.real-=t.real,this.complex-=t.complex,this}subAngle(t){return t/=2,this.real-=Math.cos(t),this.complex-=Math.sin(t),this}len(){return Math.sqrt(this.real*this.real+this.complex*this.complex)}len2(){return this.real*this.real+this.complex*this.complex}mul(t){return this.set(this.real*t.real-this.complex*t.complex,this.real*t.complex+this.complex*t.real),this}nor(){const t=this.len();return this.real/=t,this.complex/=t,this}angle(){return 2*Math.atan2(this.complex,this.real)}lerp(t,e,s){return this.scale(1-e),s.copy(t).scale(e),this.add(s),this.nor(),this}slerp(t,s){let r,i,l,h,a,o,c;return(h=this.real*t.real+this.complex*t.complex)<0?(h=-h,i=-t.complex,r=-t.real):(i=t.complex,r=t.real),1-h>e.COSINE_THRESHOLD?(l=Math.acos(h),a=Math.sin(l),o=Math.sin((1-s)*l)/a,c=Math.sin(s*l)/a):(o=1-s,c=s),this.complex=o*this.complex+c*i,this.real=o*this.real+c*r,this}toString(){const e=this.angle();return`radians: ${e}, degrees: ${e*t.RAD_TO_DEG*e}`}}exports.Spinor=e,e.COSINE_THRESHOLD=.001;
},{"./utils":"OIeL"}],"sfhL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Vector2=void 0;class t{constructor(){this.x=0,this.y=0}set(t,s){return this.x=t,this.y=s,this}copy(t){return this.x=t.x,this.y=t.y,this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.length();if(t>0){const s=1/t;this.x*=s,this.y*=s}return this}add(t){return this.x+=t.x,this.y+=t.y,this}addXY(t,s){return this.x+=t,this.y+=s,this}subXY(t,s){return this.x-=t,this.y-=s,this}sub(t){return this.x-=t.x,this.y-=t.y,this}scale(t){return this.x*=t,this.y*=t,this}rotate(t){const s=Math.cos(t),i=Math.sin(t),{x:h}=this;return this.x=s*h-i*this.y,this.y=i*h+s*this.y,this}rotate90(t){const{x:s}=this;return t>=0?(this.x=-this.y,this.y=s):(this.x=this.y,this.y=-s),this}getAngle(){return Math.atan2(this.y,this.x)}static MakeArray(s){const i=new Array(s);for(let h=0;h<s;h++)i[h]=new t;return i}}exports.Vector2=t;
},{}],"qZYd":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&("get"in o?r.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,o)}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./Matrix3"),exports),r(require("./utils"),exports),r(require("./Rectangle"),exports),r(require("./Spinor"),exports),r(require("./Vector2"),exports);
},{"./Matrix3":"Y5xH","./utils":"OIeL","./Rectangle":"oxsu","./Spinor":"ilXT","./Vector2":"sfhL"}],"CXtu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lightSettings=exports.NO_GAMMA_CORRECTION=exports.RECOMMENDED_GAMMA_CORRECTION=void 0,exports.RECOMMENDED_GAMMA_CORRECTION=.625,exports.NO_GAMMA_CORRECTION=1,exports.lightSettings={isDiffuse:!1,gammaCorrection:exports.NO_GAMMA_CORRECTION};
},{}],"bnXh":[function(require,module,exports) {
"use strict";function e(e,r){const o=e.indexOf(r);o>=0&&e.splice(o,1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeFromArray=void 0,exports.removeFromArray=e;
},{}],"xnbj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Light=void 0;const t=require("../LightMesh"),i=require("../utils"),s=require("../math"),e=require("../settings"),h=require("../utils/arrayUtils");class r{constructor(e,h,r,o,a){this.color=new i.LightColor,this.tmpPosition=new s.Vector2,this.active=!0,this.soft=!0,this.xray=!1,this.staticLight=!1,this.culled=!1,this.dirty=!0,this.ignoreBody=!1,this.rayNum=0,this.vertexNum=0,this.distance=0,this.direction=0,this.colorF=0,this.softShadowLength=2.5,this.softShadowMesh=null,this.mx=[],this.my=[],this.f=[],this.m_index=0,this.contactFilter=null,this.rayCast=e.createRayCastCallback(this),e.lightList.push(this),this.rayHandler=e,this.gl=e.gl,this.setRayNum(h,!1),this.setColorC(r),this.setDistance(o),this.setSoftnessLength(Number.isFinite(o)?.1*o:this.softShadowLength),this.setDirection(a),this.lightMesh=new t.LightMesh(this.gl,this.vertexNum),this.setupSoftShadowMesh()}setupSoftShadowMesh(){const i=this.soft&&!this.xray;this.softShadowMesh&&!i?(this.softShadowMesh.dispose(),this.softShadowMesh=null):this.softShadowMesh=new t.LightMesh(this.gl,this.getSoftShadowVertexCount())}getSoftShadowVertexCount(){return this.vertexNum}getPosition(){return this.tmpPosition}setColorC(t){this.color.copy(t),this.colorF=this.color.toFloatBits(),this.staticLight&&(this.dirty=!0)}setColor(t,i,s,e){this.color.set(t,i,s,e),this.colorF=this.color.toFloatBits(),this.staticLight&&(this.dirty=!0)}add(t){this.rayHandler=t,this.active?t.lightList.push(this):t.disabledLights.push(this)}remove(t=!0){this.rayHandler.removeLight(this),t&&this.dispose()}dispose(){var t;this.lightMesh.dispose(),null===(t=this.softShadowMesh)||void 0===t||t.dispose()}isActive(){return this.active}setActive(t){t!==this.active&&(this.active=t,t?(this.rayHandler.lightList.push(this),(0,h.removeFromArray)(this.rayHandler.disabledLights,this)):(this.rayHandler.disabledLights.push(this),(0,h.removeFromArray)(this.rayHandler.lightList,this)))}isXray(){return this.xray}setXray(t){this.xray=t,this.staticLight&&(this.dirty=!0),this.setupSoftShadowMesh()}isStaticLight(){return this.staticLight}setStaticLight(t){this.staticLight=t,t&&(this.dirty=!0)}isSoft(){return this.soft}setSoft(t){this.soft=t,this.staticLight&&(this.dirty=!0),this.setupSoftShadowMesh()}getSoftShadowLength(){return this.softShadowLength}setSoftnessLength(t){this.softShadowLength=t,this.staticLight&&(this.dirty=!0)}getColor(){return this.color}getDistance(){return this.distance/e.lightSettings.gammaCorrection}getDirection(){return this.direction}contains(t,i){return!1}setIgnoreAttachedBody(t){this.ignoreBody=t}getIgnoreAttachedBody(){return this.ignoreBody}setRayNum(t,i=!0){var e;t<r.MIN_RAYS&&(t=r.MIN_RAYS),this.rayNum=t,this.vertexNum=t+1,i&&(this.lightMesh.setVertexNum(this.vertexNum),null===(e=this.softShadowMesh)||void 0===e||e.setVertexNum(this.getSoftShadowVertexCount())),this.mx=(0,s.makeNumberArray)(this.vertexNum),this.my=(0,s.makeNumberArray)(this.vertexNum),this.f=(0,s.makeNumberArray)(this.vertexNum)}getRayNum(){return this.rayNum}setContactFilter(t){this.contactFilter=t}getContactFilter(){return this.contactFilter}setContactFilterBits(t,i,s){this.contactFilter={categoryBits:t,groupIndex:i,maskBits:s}}static setGlobalContactFilter(t){this.globalContactFilter=t}static setGlobalContactFilterBits(t,i,s){this.globalContactFilter={categoryBits:t,groupIndex:i,maskBits:s}}static getGlobalContactFilter(){return this.globalContactFilter}reportFixture(t,i,s,e){const h=r.getGlobalContactFilter();if(h&&!this.runContactFilter(h,t))return-1;const o=this.getContactFilter();return o&&!this.runContactFilter(o,t)?-1:this.ignoreBody&&this.getBody()===i?-1:(this.mx[this.m_index]=s.x,this.my[this.m_index]=s.y,this.f[this.m_index]=e,e)}runContactFilter(t,i){return 0!==t.groupIndex&&t.groupIndex===i.groupIndex?t.groupIndex>0:0!=(t.maskBits&i.categoryBits)&&0!=(t.categoryBits&i.maskBits)}}exports.Light=r,r.DefaultColor=new i.LightColor(.75,.75,.5,.75),r.DebugColor=new i.LightColor(1,1,0),r.MIN_RAYS=3,r.globalContactFilter=null;
},{"../LightMesh":"K54L","../utils":"JQcC","../math":"qZYd","../settings":"CXtu","../utils/arrayUtils":"bnXh"}],"PHzJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChainLight=void 0;const t=require("./Light"),s=require("../math"),i=require("../settings"),e={v1:new s.Vector2,v2:new s.Vector2,vSegmentStart:new s.Vector2,vDirection:new s.Vector2,vRayOffset:new s.Vector2,previousAngle:new s.Spinor,currentAngle:new s.Spinor,nextAngle:new s.Spinor,startAngle:new s.Spinor,endAngle:new s.Spinor,rayAngle:new s.Spinor};class h extends t.Light{constructor(t,i,e,n,r,o){super(t,i,e,n,0),this.chain=[],this.bodyAngle=0,this.bodyAngleOffset=0,this.body=null,this.segmentAngles=[],this.segmentLengths=[],this.startX=[],this.startY=[],this.endX=[],this.endY=[],this.bodyPosition=new s.Vector2,this.tmpEnd=new s.Vector2,this.tmpStart=new s.Vector2,this.tmpPerp=new s.Vector2,this.tmpVec=new s.Vector2,this.zeroPosition=new s.Matrix3,this.rotateAroundZero=new s.Matrix3,this.restorePosition=new s.Matrix3,this.chainLightBounds=new s.Rectangle,this.rayHandlerBounds=new s.Rectangle,this.rayStartOffset=h.defaultRayStartOffset,this.rayDirection=r,this.vertexNum=2*(this.vertexNum-1),this.endX=(0,s.makeNumberArray)(i),this.endY=(0,s.makeNumberArray)(i),this.startX=(0,s.makeNumberArray)(i),this.startY=(0,s.makeNumberArray)(i),this.chain=o?o.slice():[],this.setMesh()}update(){this.dirty?(this.updateChain(),this.applyAttachment()):this.updateBody(),this.cull()||this.staticLight&&!this.dirty||(this.dirty=!1,this.updateMesh())}render(){var t;this.rayHandler.culling&&this.culled||(this.rayHandler.lightRenderedLastFrame++,this.lightMesh.render(this.rayHandler.lightShader,this.gl.TRIANGLE_STRIP,this.vertexNum),null===(t=this.softShadowMesh)||void 0===t||t.render(this.rayHandler.lightShader,this.gl.TRIANGLE_STRIP,this.vertexNum))}debugRender(s){const i=[];for(let t=0;t<this.rayNum;t++)i.push({x:this.mx[t],y:this.my[t]});for(let t=this.rayNum-1;t>-1;t--)i.push({x:this.startX[t],y:this.startY[t]});s(i,i.length,t.Light.DebugColor)}attachToBody(t,i=0){this.body=t,this.bodyPosition.copy(this.rayHandler.getBodyPosition(this.body)),this.bodyAngleOffset=s.DEG_TO_RAD*i,this.bodyAngle=this.rayHandler.getBodyAngle(t),this.applyAttachment(),this.staticLight&&(this.dirty=!0)}getBody(){return this.body}getX(){return this.tmpPosition.x}getY(){return this.tmpPosition.y}setPosition(t,s){this.tmpPosition.set(t,s),this.staticLight&&(this.dirty=!0)}setPositionV(t){this.tmpPosition.copy(t),this.staticLight&&(this.dirty=!0)}contains(t,s){if(!this.chainLightBounds.contains(t,s))return!1;const i=[];for(let h=0;h<this.rayNum;h++)i.push(this.mx[h],this.my[h]);for(let h=this.rayNum-1;h>-1;h--)i.push(this.startX[h],this.startY[h]);let e=0;for(let h=0;h<i.length;h+=2){const n=i[h],r=i[h+1],o=i[(h+2)%i.length],a=i[(h+3)%i.length];(r<=s&&s<a||a<=s&&s<r)&&t<(o-n)/(a-r)*(s-r)+n&&e++}return 1==(1&e)}setDistance(t){t*=i.lightSettings.gammaCorrection,this.distance=t<.01?.01:t,this.dirty=!0}setDirection(t){}updateChain(){const{v1:t,v2:s,vSegmentStart:i,vDirection:h,vRayOffset:n,previousAngle:r,currentAngle:o,nextAngle:a,startAngle:l,endAngle:d,rayAngle:c}=e,g=Math.round(this.chain.length/2)-1;this.segmentAngles.length=0,this.segmentLengths.length=0;let y=0;for(let e=0,p=0;e<this.chain.length-2;e+=2,p++)t.set(this.chain[e+2],this.chain[e+3]).subXY(this.chain[e],this.chain[e+1]),this.segmentLengths.push(t.length()),this.segmentAngles.push(t.rotate90(this.rayDirection).getAngle()),y+=this.segmentLengths[p];let m=0,u=this.rayNum;for(let e=0;e<g;e++){r.setAngle(0===e?this.segmentAngles[e]:this.segmentAngles[e-1]),o.setAngle(this.segmentAngles[e]),a.setAngle(e===this.segmentAngles.length-1?this.segmentAngles[e]:this.segmentAngles[e+1]),l.copy(r).slerp(o,.5),d.copy(o).slerp(a,.5);const p=2*e;i.set(this.chain[p],this.chain[p+1]),h.set(this.chain[p+2],this.chain[p+3]).sub(i).normalize();const A=y/u,f=e===g-1?u:Math.round(this.segmentLengths[e]/y*u);for(let r=0;r<f;r++){const o=r*A;c.copy(l).slerp(d,o/this.segmentLengths[e]);const a=c.angle();n.set(this.rayStartOffset,0).rotate(a),t.copy(h).scale(o).add(i).add(n),this.startX[m]=t.x,this.startY[m]=t.y,s.set(this.distance,0).rotate(a).add(t),this.endX[m]=s.x,this.endY[m]=s.y,m++}u-=f,y-=this.segmentLengths[e]}}applyAttachment(){if(this.body&&!this.staticLight){this.restorePosition.setToTranslation(this.bodyPosition),this.rotateAroundZero.setToRotationRad(this.bodyAngle+this.bodyAngleOffset);for(let t=0;t<this.rayNum;t++)this.restorePosition.mulVec2(this.rotateAroundZero.mulVec2(this.tmpVec.set(this.startX[t],this.startY[t]))),this.startX[t]=this.tmpVec.x,this.startY[t]=this.tmpVec.y,this.restorePosition.mulVec2(this.rotateAroundZero.mulVec2(this.tmpVec.set(this.endX[t],this.endY[t]))),this.endX[t]=this.tmpVec.x,this.endY[t]=this.tmpVec.y}}cull(){return this.rayHandler.culling?(this.updateBoundingRects(),this.culled=this.chainLightBounds.width>0&&this.chainLightBounds.height>0&&!this.chainLightBounds.overlaps(this.rayHandlerBounds)):this.culled=!1,this.culled}updateBody(){if(!this.body||this.staticLight)return;const t=this.rayHandler.getBodyPosition(this.body),s=this.rayHandler.getBodyAngle(this.body);this.tmpVec.set(0,0).sub(this.bodyPosition),this.bodyPosition.copy(t),this.zeroPosition.setToTranslation(this.tmpVec),this.restorePosition.setToTranslation(this.bodyPosition),this.rotateAroundZero.setToRotationRad(this.bodyAngle).inv().rotateRad(s),this.bodyAngle=s;for(let i=0;i<this.rayNum;i++)this.restorePosition.mulVec2(this.rotateAroundZero.mulVec2(this.zeroPosition.mulVec2(this.tmpVec.set(this.startX[i],this.startY[i])))),this.startX[i]=this.tmpVec.x,this.startY[i]=this.tmpVec.y,this.restorePosition.mulVec2(this.rotateAroundZero.mulVec2(this.zeroPosition.mulVec2(this.tmpVec.set(this.endX[i],this.endY[i])))),this.endX[i]=this.tmpVec.x,this.endY[i]=this.tmpVec.y}updateMesh(){for(let t=0;t<this.rayNum;t++)this.m_index=t,this.f[t]=1,this.tmpEnd.x=this.endX[t],this.mx[t]=this.tmpEnd.x,this.tmpEnd.y=this.endY[t],this.my[t]=this.tmpEnd.y,this.tmpStart.x=this.startX[t],this.tmpStart.y=this.startY[t],this.xray||this.rayCast(this.tmpStart,this.tmpEnd);this.setMesh()}setMesh(){const t=this.lightMesh.getVertices();let s=0;const i=this.lightMesh.getColors();let e=0;const h=this.lightMesh.getColorScales();let n=0;for(let r=0;r<this.rayNum;r++)t[s++]=this.startX[r],t[s++]=this.startY[r],i[e++]=this.colorF,h[n++]=1,t[s++]=this.mx[r],t[s++]=this.my[r],i[e++]=this.colorF,h[n++]=1-this.f[r];if(this.lightMesh.update(),this.softShadowMesh){const t=this.softShadowMesh.getVertices();let s=0;const i=this.softShadowMesh.getColors();let e=0;const h=this.softShadowMesh.getColorScales();let n=0;for(let r=0;r<this.rayNum;r++){t[s++]=this.mx[r],t[s++]=this.my[r],i[e++]=this.colorF;const o=1-this.f[r];h[n++]=o,this.tmpPerp.set(this.mx[r],this.my[r]).subXY(this.startX[r],this.startY[r]).normalize().scale(this.softShadowLength*o).addXY(this.mx[r],this.my[r]),t[s++]=this.tmpPerp.x,t[s++]=this.tmpPerp.y,i[e++]=0,h[n++]=0}this.softShadowMesh.update()}}updateBoundingRects(){let t=this.startX[0],s=this.startX[0],i=this.startY[0],e=this.startY[0];for(let h=0;h<this.rayNum;h++)t=(t=t>this.startX[h]?t:this.startX[h])>this.mx[h]?t:this.mx[h],s=(s=s<this.startX[h]?s:this.startX[h])<this.mx[h]?s:this.mx[h],i=(i=i>this.startY[h]?i:this.startY[h])>this.my[h]?i:this.my[h],e=(e=e<this.startY[h]?e:this.startY[h])<this.my[h]?e:this.my[h];this.chainLightBounds.set(s,e,t-s,i-e),this.rayHandlerBounds.set(this.rayHandler.x1,this.rayHandler.y1,this.rayHandler.x2-this.rayHandler.x1,this.rayHandler.y2-this.rayHandler.y1)}}exports.ChainLight=h,h.defaultRayStartOffset=.001;
},{"./Light":"xnbj","../math":"qZYd","../settings":"CXtu"}],"abTr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PositionalLight=void 0;const t=require("./Light"),s=require("../math");class i extends t.Light{constructor(t,i,h,e,r,o,a){super(t,i,h,e,a),this.tmpEnd=new s.Vector2,this.start=new s.Vector2,this.body=null,this.bodyOffsetX=0,this.bodyOffsetY=0,this.bodyAngleOffset=0,this.start.x=r,this.start.y=o,this.setMesh()}getSoftShadowVertexCount(){return 2*this.vertexNum}update(){this.updateBody(),this.cull()||this.staticLight&&!this.dirty||(this.dirty=!1,this.updateMesh())}render(){var t;this.rayHandler.culling&&this.culled||(this.rayHandler.lightRenderedLastFrame++,this.lightMesh.render(this.rayHandler.lightShader,this.gl.TRIANGLE_FAN,this.vertexNum),null===(t=this.softShadowMesh)||void 0===t||t.render(this.rayHandler.lightShader,this.gl.TRIANGLE_STRIP,this.getSoftShadowVertexCount()-2))}debugRender(s){const i=[this.start];for(let t=0;t<this.rayNum;t++)i.push({x:this.mx[t],y:this.my[t]});s(i,i.length,t.Light.DebugColor)}attachToBody(t,s=0,i=0,h=0){this.body=t,this.bodyOffsetX=s,this.bodyOffsetY=i,this.bodyAngleOffset=h,this.staticLight&&(this.dirty=!0)}getPosition(){return this.tmpPosition.copy(this.start)}getBody(){return this.body}getX(){return this.start.x}getY(){return this.start.y}setPosition(t,s){this.start.set(t,s),this.staticLight&&(this.dirty=!0)}setPositionV(t){this.start.copy(t),this.staticLight&&(this.dirty=!0)}contains(t,s){const i=this.start.x-t,h=this.start.y-s,e=i*i+h*h;if(this.distance*this.distance<=e)return!1;let r=!1,o=this.mx[this.rayNum]=this.start.x,a=this.my[this.rayNum]=this.start.y,d=0,n=0;for(let y=0;y<=this.rayNum;o=d,a=n,++y)d=this.mx[y],((n=this.my[y])<s&&a>=s||n>=s&&a<s)&&(s-n)/(a-n)*(o-d)<t-d&&(r=!r);return r}setRayNum(t,i=!0){super.setRayNum(t,i),this.sin=(0,s.makeNumberArray)(t),this.cos=(0,s.makeNumberArray)(t),this.endX=(0,s.makeNumberArray)(t),this.endY=(0,s.makeNumberArray)(t)}cull(){return this.culled=this.rayHandler.culling&&!this.rayHandler.intersect(this.start.x,this.start.y,this.distance+this.softShadowLength),this.culled}updateBody(){if(!this.body||this.staticLight)return;const t=this.rayHandler.getBodyPosition(this.body),i=this.rayHandler.getBodyAngle(this.body),h=Math.cos(i),e=Math.sin(i),r=this.bodyOffsetX*h-this.bodyOffsetY*e,o=this.bodyOffsetX*e+this.bodyOffsetY*h;this.start.x=t.x+r,this.start.y=t.y+o,this.setDirection(this.bodyAngleOffset+s.RAD_TO_DEG*i)}updateMesh(){for(let t=0;t<this.rayNum;t++)this.m_index=t,this.f[t]=1,this.tmpEnd.x=this.endX[t]+this.start.x,this.mx[t]=this.tmpEnd.x,this.tmpEnd.y=this.endY[t]+this.start.y,this.my[t]=this.tmpEnd.y,this.xray||this.rayCast(this.start,this.tmpEnd);this.setMesh()}setMesh(){const t=this.lightMesh.getVertices();let s=0;const i=this.lightMesh.getColors();let h=0;const e=this.lightMesh.getColorScales();let r=0;t[s++]=this.start.x,t[s++]=this.start.y,i[h++]=this.colorF,e[r++]=1;for(let o=0;o<this.rayNum;o++)t[s++]=this.mx[o],t[s++]=this.my[o],i[h++]=this.colorF,e[r++]=1-this.f[o];if(this.lightMesh.update(),this.softShadowMesh){const t=this.softShadowMesh.getVertices();let s=0;const i=this.softShadowMesh.getColors();let h=0;const e=this.softShadowMesh.getColorScales();let r=0;for(let o=0;o<this.rayNum;o++){t[s++]=this.mx[o],t[s++]=this.my[o],i[h++]=this.colorF;const a=1-this.f[o];e[r++]=a,t[s++]=this.mx[o]+a*this.softShadowLength*this.cos[o],t[s++]=this.my[o]+a*this.softShadowLength*this.sin[o],i[h++]=0,e[r++]=0}this.softShadowMesh.update()}}getBodyOffsetX(){return this.bodyOffsetX}getBodyOffsetY(){return this.bodyOffsetY}getBodyAngleOffset(){return this.bodyAngleOffset}setBodyOffsetX(t){this.bodyOffsetX=t}setBodyOffsetY(t){this.bodyOffsetY=t}setBodyAngleOffset(t){this.bodyAngleOffset=t}}exports.PositionalLight=i;
},{"./Light":"xnbj","../math":"qZYd"}],"LvCl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConeLight=void 0;const t=require("./PositionalLight"),e=require("../math"),i=require("../settings");class s extends t.PositionalLight{constructor(t,e,i,s,r,h,n,o){super(t,e,i,s,r,h,n),this.setConeDegree(o)}update(){this.updateBody(),this.dirty&&this.setEndPoints(),this.cull()||this.staticLight&&!this.dirty||(this.dirty=!1,this.updateMesh())}setDirection(t){this.direction=t,this.dirty=!0}getConeDegree(){return this.coneDegree}setConeDegree(t){this.coneDegree=Math.max(0,Math.min(180,t)),this.dirty=!0}setDistance(t){t*=i.lightSettings.gammaCorrection,this.distance=t<.01?.01:t,this.dirty=!0}setEndPoints(){for(let t=0;t<this.rayNum;t++){const i=this.direction+this.coneDegree-2*this.coneDegree*t/(this.rayNum-1),s=this.sin[t]=(0,e.sinDeg)(i),r=this.cos[t]=(0,e.cosDeg)(i);this.endX[t]=this.distance*r,this.endY[t]=this.distance*s}}}exports.ConeLight=s;
},{"./PositionalLight":"abTr","../math":"qZYd","../settings":"CXtu"}],"rpKn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DirectionalLight=void 0;const t=require("./Light"),s=require("../math");class i extends t.Light{constructor(t,i,h,e){super(t,i,h,1/0,e),this.sin=0,this.cos=0,this.body=null,this.vertexNum=2*(this.vertexNum-1),this.start=s.Vector2.MakeArray(this.rayNum),this.end=s.Vector2.MakeArray(this.rayNum),this.setMesh()}setDirection(t){this.direction=t,this.sin=(0,s.sinDeg)(t),this.cos=(0,s.cosDeg)(t),this.staticLight&&(this.dirty=!0)}update(){this.staticLight&&!this.dirty||(this.dirty=!1,this.updateMesh())}updateMesh(){const t=this.rayHandler.x2-this.rayHandler.x1,s=this.rayHandler.y2-this.rayHandler.y1,i=t>s?t:s;let h=i*this.cos,e=i*this.sin;h*h<.1&&e*e<.1&&(h=1,e=1);const r=i*-this.sin,o=i*this.cos;let a=.5*(this.rayHandler.x1+this.rayHandler.x2)-r,n=.5*(this.rayHandler.y1+this.rayHandler.y2)-o;const d=2*r/(this.rayNum-1);a=Math.floor(a/(2*d))*d*2;const l=2*o/(this.rayNum-1);n=Math.ceil(n/(2*l))*l*2;for(let y=0;y<this.rayNum;y++){const t=y*d+a,s=y*l+n;this.m_index=y,this.start[y].x=t-h,this.start[y].y=s-e,this.mx[y]=this.end[y].x=t+h,this.my[y]=this.end[y].y=s+e,this.xray||this.rayCast(this.start[y],this.end[y])}this.setMesh()}setMesh(){const t=this.lightMesh.getVertices();let s=0;const i=this.lightMesh.getColors();let h=0;const e=this.lightMesh.getColorScales();let r=0;for(let o=0;o<this.rayNum;o++)t[s++]=this.start[o].x,t[s++]=this.start[o].y,i[h++]=this.colorF,e[r++]=1,t[s++]=this.mx[o],t[s++]=this.my[o],i[h++]=this.colorF,e[r++]=1;if(this.lightMesh.update(),this.softShadowMesh){const t=this.softShadowMesh.getVertices();let s=0;const i=this.softShadowMesh.getColors();let h=0;const e=this.softShadowMesh.getColorScales();let r=0;for(let o=0;o<this.rayNum;o++)t[s++]=this.mx[o],t[s++]=this.my[o],i[h++]=this.colorF,e[r++]=1,t[s++]=this.mx[o]+this.softShadowLength*this.cos,t[s++]=this.my[o]+this.softShadowLength*this.sin,i[h++]=0,e[r++]=1;this.softShadowMesh.update()}}render(){var t;this.rayHandler.lightRenderedLastFrame++,this.lightMesh.render(this.rayHandler.lightShader,this.gl.TRIANGLE_STRIP,this.vertexNum),null===(t=this.softShadowMesh)||void 0===t||t.render(this.rayHandler.lightShader,this.gl.TRIANGLE_STRIP,this.vertexNum)}debugRender(s){const i=[];for(let t=0;t<this.rayNum;t++)i.push(this.start[t],{x:this.mx[t],y:this.my[t]});s(i,i.length,t.Light.DebugColor)}contains(t,s){let i,h,e=!1,r=this.mx[this.rayNum]=this.start[0].x,o=this.my[this.rayNum]=this.start[0].y;for(let a=0;a<=this.rayNum;r=i,o=h,++a)i=this.mx[a],((h=this.my[a])<s&&o>=s||h>=s&&o<s)&&(s-h)/(o-h)*(r-i)<t-i&&(e=!e);for(let a=0;a<this.rayNum;r=i,o=h,++a)i=this.start[a].x,((h=this.start[a].y)<s&&o>=s||h>=s&&o<s)&&(s-h)/(o-h)*(r-i)<t-i&&(e=!e);return e}attachToBody(t){}setPosition(t,s){}getBody(){return this.body}getX(){return 0}getY(){return 0}setPositionV(t){}setDistance(t){}setIgnoreAttachedBody(t){}getIgnoreAttachedBody(){return!1}setIgnoreBody(t){this.body=t,this.ignoreBody=!!t}}exports.DirectionalLight=i;
},{"./Light":"xnbj","../math":"qZYd"}],"JXQp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PointLight=void 0;const t=require("./PositionalLight"),i=require("./Light"),s=require("../math"),e=require("../settings");class h extends t.PositionalLight{constructor(t,s,e=i.Light.DefaultColor,h=15,o=0,r=0){super(t,s,e,h,o,r,0)}update(){this.updateBody(),this.dirty&&this.setEndPoints(),this.cull()||this.staticLight&&!this.dirty||(this.dirty=!1,this.updateMesh())}setDistance(t){t*=e.lightSettings.gammaCorrection,this.distance=t<.01?.01:t,this.dirty=!0}setEndPoints(){const t=360/(this.rayNum-1);for(let i=0;i<this.rayNum;i++){const e=t*i;this.sin[i]=(0,s.sinDeg)(e),this.cos[i]=(0,s.cosDeg)(e),this.endX[i]=this.distance*this.cos[i],this.endY[i]=this.distance*this.sin[i]}}setDirection(t){}}exports.PointLight=h;
},{"./PositionalLight":"abTr","./Light":"xnbj","../math":"qZYd","../settings":"CXtu"}],"T6Cd":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,o)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./ChainLight"),exports),t(require("./ConeLight"),exports),t(require("./DirectionalLight"),exports),t(require("./Light"),exports),t(require("./PointLight"),exports),t(require("./PositionalLight"),exports);
},{"./ChainLight":"PHzJ","./ConeLight":"LvCl","./DirectionalLight":"rpKn","./Light":"xnbj","./PointLight":"JXQp","./PositionalLight":"abTr"}],"F186":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.factoriesGl2=void 0;const i=require("./webgl1");exports.factoriesGl2=Object.assign(Object.assign({},i.factoriesGl1),{uniform1ui:(i,t)=>({location:t,set:r=>i.uniform1ui(t,r),setV:(r,e,o)=>i.uniform1uiv(t,r,e,o)}),uniform2ui:(i,t)=>({location:t,set:(r,e)=>i.uniform2ui(t,r,e),setV:(r,e,o)=>i.uniform2uiv(t,r,e,o)}),uniform3ui:(i,t)=>({location:t,set:(r,e,o)=>i.uniform3ui(t,r,e,o),setV:(r,e,o)=>i.uniform3uiv(t,r,e,o)}),uniform4ui:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniform4ui(t,r,e,o,n),setV:(r,e,o)=>i.uniform4uiv(t,r,e,o)}),uniformMatrix2x3f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix2x3fv(t,r,e,o,n)}),uniformMatrix2x4f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix2x4fv(t,r,e,o,n)}),uniformMatrix3x2f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix3x2fv(t,r,e,o,n)}),uniformMatrix3x4f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix3x4fv(t,r,e,o,n)}),uniformMatrix4x2f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix4x2fv(t,r,e,o,n)}),uniformMatrix4x3f:(i,t)=>({location:t,set:(r,e,o,n)=>i.uniformMatrix4x3fv(t,r,e,o,n)}),vertexAttribDivisor:(i,t)=>({location:t,set:r=>i.vertexAttribDivisor(t,r)}),vertexAttribI4i:(i,t)=>({location:t,set:(r,e,o,n)=>i.vertexAttribI4i(t,r,e,o,n),setV:r=>i.vertexAttribI4iv(t,r)}),vertexAttribI4ui:(i,t)=>({location:t,set:(r,e,o,n)=>i.vertexAttribI4ui(t,r,e,o,n),setV:r=>i.vertexAttribI4uiv(t,r)}),vertexAttribIPointer:(i,t)=>({location:t,enable:()=>i.enableVertexAttribArray(t),disable:()=>i.disableVertexAttribArray(t),set:(r,e,o,n)=>i.vertexAttribIPointer(t,r,e,o,n)})});
},{"./webgl1":"S7Lm"}],"Dpka":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createShaderProgram=exports.glsl=void 0;const e=require("./webgl2");function r(e,...r){let t="";for(let o=0;o<r.length;o++)t+=e[o],t+=r[o];return t.replace(/^[\r\n]+/,"")+e[e.length-1]}function t(e,r,t,o){const a=e.createShader(t);return e.shaderSource(a,o),e.compileShader(a),e.attachShader(r,a),a}function o(r,o,a,s){const n=r.createProgram(),c={},l=t(r,n,r.VERTEX_SHADER,o),i=t(r,n,r.FRAGMENT_SHADER,a);r.linkProgram(n),r.useProgram(n);for(const t of Object.keys(s)){const o=s[t],a=e.factoriesGl2[o];if(!a)throw new Error(`Can't handle ${o}!`);const l=o.startsWith("uniform")?r.getUniformLocation(n,t):r.getAttribLocation(n,t);c[t]=a(r,l)}return Object.assign(Object.assign({},c),{use(){r.useProgram(n)},dispose(){r.useProgram(null),r.deleteShader(i),r.deleteShader(l),r.deleteProgram(n)}})}exports.glsl=r,exports.createShaderProgram=o;
},{"./webgl2":"F186"}],"uCUJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDiffuseShader=void 0;const e=require("typed-glsl"),r=e.glsl`
attribute vec4 a_position;
attribute vec2 a_texCoord;
varying vec2 v_texCoords;

void main() {
    v_texCoords = a_texCoord;
    gl_Position = a_position;
}
`,t=e.glsl`
#ifdef GL_ES
precision lowp float;
#define MED mediump
#else
#define MED 
#endif

varying MED vec2 v_texCoords;
uniform sampler2D u_texture;
uniform  vec4 ambient;

void main() {
    gl_FragColor.rgb = (ambient.rgb + texture2D(u_texture, v_texCoords).rgb);
    gl_FragColor.a = 1.0;
}
`;function o(o){return(0,e.createShaderProgram)(o,r,t,{a_position:"vertexAttribPointer",a_texCoord:"vertexAttribPointer",u_texture:"uniform1i",ambient:"uniform4f"})}exports.createDiffuseShader=o;
},{"typed-glsl":"Dpka"}],"zmHH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createGaussianShader=void 0;const e=require("typed-glsl"),o=(o,t)=>e.glsl`
attribute vec4 a_position;
uniform vec2  dir;
attribute vec2 a_texCoord;
varying vec2 v_texCoords0;
varying vec2 v_texCoords1;
varying vec2 v_texCoords2;
varying vec2 v_texCoords3;
varying vec2 v_texCoords4;

const vec2 futher = vec2(3.2307692308 / ${o}, 3.2307692308 / ${t} );
const vec2 closer = vec2(1.3846153846 / ${o}, 1.3846153846 / ${t} );

void main() {
    vec2 f = futher * dir;
    vec2 c = closer * dir;
    v_texCoords0 = a_texCoord - f;
    v_texCoords1 = a_texCoord - c;
    v_texCoords2 = a_texCoord;
    v_texCoords3 = a_texCoord + c;
    v_texCoords4 = a_texCoord + f;
    gl_Position = a_position;
}
`,t=o=>e.glsl`
#ifdef GL_ES
precision lowp float;
#define MED mediump
#else
#define MED 
#endif

uniform sampler2D u_texture;
varying MED vec2 v_texCoords0;
varying MED vec2 v_texCoords1;
varying MED vec2 v_texCoords2;
varying MED vec2 v_texCoords3;
varying MED vec2 v_texCoords4;
const float center = 0.2270270270;
const float close  = 0.3162162162;
const float far    = 0.0702702703;

void main() {	 
    gl_FragColor${o} = far    * texture2D(u_texture, v_texCoords0)${o}
	      		+ close  * texture2D(u_texture, v_texCoords1)${o}
				+ center * texture2D(u_texture, v_texCoords2)${o}
				+ close  * texture2D(u_texture, v_texCoords3)${o}
				+ far    * texture2D(u_texture, v_texCoords4)${o};
}
`;function r(r,v,s,i){const d=o(v.toFixed(1),s.toFixed(1)),a=t(i?".rgb":"");return(0,e.createShaderProgram)(r,d,a,{a_position:"vertexAttribPointer",a_texCoord:"vertexAttribPointer",dir:"uniform2f"})}exports.createGaussianShader=r;
},{"typed-glsl":"Dpka"}],"pXtZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLightShader=void 0;const r=require("typed-glsl"),e=r.glsl`
attribute vec4 a_position;
attribute vec4 quad_colors;
attribute float s;
uniform mat4 u_projTrans;
varying vec4 v_color;

void main() {
    v_color = s * quad_colors;
    gl_Position =  u_projTrans * a_position;
}
`,o=e=>r.glsl`
#ifdef GL_ES
precision lowp float;
#define MED mediump
#else
#define MED 
#endif

varying vec4 v_color;

void main() {
    gl_FragColor = ${e}(v_color);
}
`;function t(t,i){const a=o(i?"sqrt":"");return(0,r.createShaderProgram)(t,e,a,{a_position:"vertexAttribPointer",quad_colors:"vertexAttribPointer",s:"vertexAttribPointer",u_projTrans:"uniformMatrix4f"})}exports.createLightShader=t;
},{"typed-glsl":"Dpka"}],"TRiO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createShadowShader=void 0;const e=require("typed-glsl"),r=e.glsl`
attribute vec4 a_position;
attribute vec2 a_texCoord;
varying vec2 v_texCoords;

void main() {
    v_texCoords = a_texCoord;
    gl_Position = a_position;
}
`,t=e.glsl`
#ifdef GL_ES
precision lowp float;
#define MED mediump
#else
#define MED 
#endif

varying MED vec2 v_texCoords;
uniform sampler2D u_texture;
uniform vec4 ambient;

void main() {
    vec4 c = texture2D(u_texture, v_texCoords);
    gl_FragColor.rgb = c.rgb * c.a + ambient.rgb;
    gl_FragColor.a = ambient.a - c.a;
}
`;function o(o){return(0,e.createShaderProgram)(o,r,t,{a_position:"vertexAttribPointer",a_texCoord:"vertexAttribPointer",u_texture:"uniform1i",ambient:"uniform4f"})}exports.createShadowShader=o;
},{"typed-glsl":"Dpka"}],"BwHt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createWithoutShadowShader=void 0;const e=require("typed-glsl"),t=e.glsl`
attribute vec4 a_position;
attribute vec2 a_texCoord;
varying vec2 v_texCoords;

void main() {
    v_texCoords = a_texCoord;
    gl_Position = a_position;
}
`,o=e.glsl`
#ifdef GL_ES
precision lowp float;
#define MED mediump
#else
#define MED 
#endif

varying MED vec2 v_texCoords;
uniform sampler2D u_texture;

void main() {
    gl_FragColor = texture2D(u_texture, v_texCoords);
}
`;function r(r){return(0,e.createShaderProgram)(r,t,o,{a_position:"vertexAttribPointer",a_texCoord:"vertexAttribPointer",u_texture:"uniform1i",ambient:"uniform4f"})}exports.createWithoutShadowShader=r;
},{"typed-glsl":"Dpka"}],"kDsY":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&("get"in o?r.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,o)}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./diffuse"),exports),r(require("./gaussian"),exports),r(require("./light"),exports),r(require("./shadow"),exports),r(require("./withoutShadow"),exports);
},{"./diffuse":"uCUJ","./gaussian":"zmHH","./light":"pXtZ","./shadow":"TRiO","./withoutShadow":"BwHt"}],"IkpV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LightMap=void 0;const e=require("./shaders"),r=require("./utils/VertexBufferObject"),i=require("./utils/FrameBuffer"),t=require("./settings");class s{constructor(s,a,h){this.lightMapDrawingDisabled=!1,this.rayHandler=s,this.gl=s.gl,this.vertBuffer=new r.VertexBufferObject(this.gl,this.gl.STATIC_DRAW,this.createVertices()),this.uvBuffer=new r.VertexBufferObject(this.gl,this.gl.STATIC_DRAW,this.createUvCoords()),a<=0&&(a=1),h<=0&&(h=1),this.frameBuffer=new i.FrameBuffer(this.gl,a,h),this.pingPongBuffer=new i.FrameBuffer(this.gl,a,h),this.shadowShader=(0,e.createShadowShader)(this.gl),this.diffuseShader=(0,e.createDiffuseShader)(this.gl),this.withoutShadowShader=(0,e.createWithoutShadowShader)(this.gl),this.blurShader=(0,e.createGaussianShader)(this.gl,a,h,t.lightSettings.isDiffuse)}render(){const e=this.rayHandler.lightRenderedLastFrame>0;if(!this.lightMapDrawingDisabled){if(this.frameBuffer.bindTexture(),this.rayHandler.shadows){const e=this.rayHandler.ambientLight;let r=this.shadowShader;t.lightSettings.isDiffuse?((r=this.diffuseShader).use(),this.rayHandler.diffuseBlendFunc.apply(),r.ambient.set(e.r,e.g,e.b,e.a)):(r.use(),this.rayHandler.shadowBlendFunc.apply(),r.ambient.set(e.r*e.a,e.g*e.a,e.b*e.a,1-e.a)),this.renderTriangleFan(r)}else e&&(this.rayHandler.simpleBlendFunc.apply(),this.withoutShadowShader.use(),this.renderTriangleFan(this.withoutShadowShader));this.gl.disable(this.gl.BLEND)}}renderTriangleFan(e){this.vertBuffer.bind(),e.a_position.enable(),e.a_position.set(2,this.gl.FLOAT,!1,0,0),this.vertBuffer.unbind(),this.uvBuffer.bind(),e.a_texCoord.enable(),e.a_texCoord.set(2,this.gl.FLOAT,!1,0,0),this.uvBuffer.unbind(),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,4),e.a_position.disable(),e.a_texCoord.disable()}gaussianBlur(){this.gl.disable(this.gl.BLEND);for(let e=0;e<this.rayHandler.blurNum;e++)this.frameBuffer.bindTexture(),this.pingPongBuffer.begin(),this.blurShader.use(),this.blurShader.dir.set(1,0),this.renderTriangleFan(this.blurShader),this.pingPongBuffer.endSimple(),this.pingPongBuffer.bindTexture(),this.frameBuffer.begin(),this.blurShader.use(),this.blurShader.dir.set(0,1),this.renderTriangleFan(this.blurShader),this.rayHandler.customViewport?this.frameBuffer.end(this.rayHandler.viewportX,this.rayHandler.viewportY,this.rayHandler.viewportWidth,this.rayHandler.viewportHeight):this.frameBuffer.endSimple();this.gl.enable(this.gl.BLEND)}dispose(){this.shadowShader.dispose(),this.blurShader.dispose(),this.vertBuffer.dispose(),this.uvBuffer.dispose(),this.frameBuffer.dispose(),this.pingPongBuffer.dispose()}createVertices(){return new Float32Array([-1,-1,1,-1,1,1,-1,1])}createUvCoords(){return new Float32Array([0,0,1,0,1,1,0,1])}}exports.LightMap=s;
},{"./shaders":"kDsY","./utils/VertexBufferObject":"TD7C","./utils/FrameBuffer":"mcD4","./settings":"CXtu"}],"aDce":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RayHandler=void 0;const t=require("./LightMap"),i=require("./shaders"),e=require("./utils"),s=require("./utils/arrayUtils"),h=require("./settings");class r{constructor(t,s,r,a,l){this.combined=new Float32Array(16),this.ambientLight=new e.LightColor,this.lightList=[],this.disabledLights=[],this.customLightShader=null,this.culling=!0,this.shadows=!0,this.blur=!0,this.blurNum=1,this.customViewport=!1,this.viewportX=0,this.viewportY=0,this.lightRenderedLastFrame=0,this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.gl=t,this.diffuseBlendFunc=new e.BlendFunc(t,t.DST_COLOR,t.ZERO),this.shadowBlendFunc=new e.BlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.simpleBlendFunc=new e.BlendFunc(t,t.SRC_ALPHA,t.ONE),this.viewportWidth=a,this.viewportHeight=l,this.resizeFBO(s,r),this.lightShader=(0,i.createLightShader)(t,h.lightSettings.gammaCorrection!==h.NO_GAMMA_CORRECTION)}resizeFBO(i,e){var s;null===(s=this.lightMap)||void 0===s||s.dispose(),this.lightMap=new t.LightMap(this,i,e)}setCombinedMatrix(t,i,e,s,h){this.combined.set(t);const r=.5*s;this.x1=i-r,this.x2=i+r;const a=.5*h;this.y1=e-a,this.y2=e+a}intersect(t,i,e){return this.x1<t+e&&this.x2>t-e&&this.y1<i+e&&this.y2>i-e}updateAndRender(){this.update(),this.render()}update(){for(const t of this.lightList)t.update()}prepareRender(){var t;this.lightRenderedLastFrame=0,this.gl.depthMask(!1),this.gl.enable(this.gl.BLEND),this.simpleBlendFunc.apply();const i=this.shadows||this.blur;i&&(this.lightMap.frameBuffer.begin(),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT));const e=null!==(t=this.customLightShader)&&void 0!==t?t:this.lightShader;e.use(),e.u_projTrans.set(!1,this.combined),this.customLightShader&&this.updateLightShader();for(const s of this.lightList)this.customLightShader&&this.updateLightShaderPerLight(s),s.render();if(i){this.customViewport?this.lightMap.frameBuffer.end(this.viewportX,this.viewportY,this.viewportWidth,this.viewportHeight):this.lightMap.frameBuffer.endSimple(),this.lightRenderedLastFrame>0&&this.blur&&this.lightMap.gaussianBlur()}}render(){this.prepareRender(),this.lightMap.render()}renderOnly(){this.lightMap.render()}updateLightShader(){}updateLightShaderPerLight(t){}pointAtLight(t,i){return this.lightList.some(e=>e.contains(t,i))}pointAtShadow(t,i){return!this.lightList.some(e=>e.contains(t,i))}dispose(){this.removeAll(),this.lightMap&&this.lightMap.dispose(),this.lightShader&&this.lightShader.dispose()}removeAll(){this.lightList.forEach(t=>t.dispose()),this.lightList.length=0,this.disabledLights.forEach(t=>t.dispose()),this.disabledLights.length=0}removeLight(t){const i=t.isActive()?this.lightList:this.disabledLights;(0,s.removeFromArray)(i,t)}setLightShader(t){this.customLightShader=t}setCulling(t){this.culling=t}setBlur(t){this.blur=t}setBlurNum(t){this.blurNum=t}setShadows(t){this.shadows=t}setAmbientLightBrightness(t){this.ambientLight.a=Math.max(0,Math.min(1,t))}setAmbientLight(t,i,e,s){this.ambientLight.set(t,i,e,s)}setAmbientLightC(t){this.ambientLight.copy(t)}useCustomViewport(t,i,e,s){this.customViewport=!0,this.viewportX=t,this.viewportY=i,this.viewportWidth=e,this.viewportHeight=s}useDefaultViewport(){this.customViewport=!1}setLightMapRendering(t){this.lightMap.lightMapDrawingDisabled=!t}getLightMapBuffer(){return this.lightMap.frameBuffer}}exports.RayHandler=r;
},{"./LightMap":"IkpV","./shaders":"kDsY","./utils":"JQcC","./utils/arrayUtils":"bnXh","./settings":"CXtu"}],"hWSt":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&("get"in o?r.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,o)}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./lights"),exports),r(require("./utils"),exports),r(require("./shaders"),exports),r(require("./math"),exports),r(require("./settings"),exports),r(require("./LightMap"),exports),r(require("./LightMesh"),exports),r(require("./RayHandler"),exports);
},{"./lights":"T6Cd","./utils":"JQcC","./shaders":"kDsY","./math":"qZYd","./settings":"CXtu","./LightMap":"IkpV","./LightMesh":"K54L","./RayHandler":"aDce"}],"bi9k":[function(require,module,exports) {
"use strict";function o(o){o.setColor(Math.random(),Math.random(),Math.random(),1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setRandomLightColor=void 0,exports.setRandomLightColor=o;
},{}],"TMg8":[function(require,module,exports) {
module.exports=[{x1:0,x2:1.625,y1:-14.0615415625,y2:-11.9990415625},{x1:2.5,x2:4.75,y1:-11.1240415625,y2:-8.6865415625},{x1:5.75,x2:7.875,y1:-7.9365415625,y2:-6.0615415625},{x1:8.6875,x2:10.5625,y1:-5.3115415625,y2:-3.5615415624999986},{x1:11.1875,x2:12.625,y1:-2.4365415624999986,y2:-.24904156249999865},{x1:13.1875,x2:14,y1:1.2509584375000014,y2:3.6259584375000014},{x1:14.1875,x2:13.875,y1:4.813458437500001,y2:7.3759584375000005},{x1:13.25,x2:11.75,y1:8.6884584375,y2:10.4384584375},{x1:10.625,x2:8.8125,y1:11.3759584375,y2:11.8759584375},{x1:7.508101249999999,x2:5.239583124999999,y1:11.9990415625,y2:11.9527453125},{x1:4.54513875,x2:2.6932868749999983,y1:11.8138565625,y2:10.8879309375},{x1:1.9988424999999985,x2:.9340274999999991,y1:10.5638565625,y2:9.4064490625},{x1:.33217562499999964,x2:.008101249999999283,y1:8.6194121875,y2:6.9990415625},{x1:0,x2:-1.625,y1:-14.0615415625,y2:-11.9990415625},{x1:-2.5,x2:-4.75,y1:-11.1240415625,y2:-8.6865415625},{x1:-5.75,x2:-7.875,y1:-7.9365415625,y2:-6.0615415625},{x1:-8.6875,x2:-10.5625,y1:-5.3115415625,y2:-3.5615415624999986},{x1:-11.1875,x2:-12.625,y1:-2.4365415624999986,y2:-.24904156249999865},{x1:-13.1875,x2:-14,y1:1.2509584375000014,y2:3.6259584375000014},{x1:-14.1875,x2:-13.875,y1:4.813458437500001,y2:7.3759584375000005},{x1:-13.25,x2:-11.75,y1:8.6884584375,y2:10.4384584375},{x1:-10.625,x2:-8.8125,y1:11.3759584375,y2:11.8759584375},{x1:-7.508101249999999,x2:-5.239583124999999,y1:11.9990415625,y2:11.9527453125},{x1:-4.54513875,x2:-2.6932868749999983,y1:11.8138565625,y2:10.8879309375},{x1:-1.9988424999999985,x2:-.9340274999999991,y1:10.5638565625,y2:9.4064490625},{x1:-.33217562499999964,x2:-.008101249999999283,y1:8.6194121875,y2:6.9990415625}];
},{}],"CNVK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RayHandlerImpl=void 0;const e=require("@box2d/lights");class t extends e.RayHandler{constructor(e,t,r,o,s,a){super(t,r,o,s,a),this.world=e}createRayCastCallback(e){return(t,r)=>this.world.RayCast(t,r,(t,r,o,s)=>e.reportFixture(t.GetFilterData(),t.GetBody(),r,s))}getBodyPosition(e){return e.GetPosition()}getBodyAngle(e){return e.GetAngle()}}exports.RayHandlerImpl=t;
},{"@box2d/lights":"hWSt"}],"aZQi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractLightTest=void 0;const e=require("@box2d/lights"),t=require("../../utils/camera"),s=require("../../utils/lights/RayHandlerImpl"),r=require("../../utils/gl/glUtils"),i=require("../../test"),l=require("../../ui/controls/Select"),a=require("../../ui/controls/Checkbox");class n extends i.Test{constructor(r){super({x:0,y:0}),this.gl=r,this.drawDebugLight=!1,this.soft=!0,this.mode="Default",this.blendFunc=new e.BlendFunc(r,r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),e.lightSettings.gammaCorrection=e.RECOMMENDED_GAMMA_CORRECTION,e.lightSettings.isDiffuse=!0;const i=this.getViewportSize();this.rayHandler=new s.RayHandlerImpl(this.m_world,r,t.g_camera.getWidth()/4,t.g_camera.getHeight()/4,i.x,i.y),this.rayHandler.setAmbientLight(0,0,0,.5),this.rayHandler.setBlurNum(3)}setupControls(){this.addTestControlGroup("Light",this.getLightControls())}getLightControls(){return[(0,l.selectDef)("Blend Mode",["Default","Over-Burn","Some Other"],this.mode,e=>{this.setBlending(e)}),(0,a.checkboxDef)("Debug Light Shapes",this.drawDebugLight,e=>{this.drawDebugLight=e}),(0,a.checkboxDef)("Soft Shadows",this.soft,e=>{this.soft=e,this.setSoft(e)})]}Resize(e,t){this.rayHandler.resizeFBO(e/4,t/4)}Destroy(){super.Destroy(),this.rayHandler.dispose(),e.Light.setGlobalContactFilter(null)}setBlending(e){this.mode=e,"Over-Burn"===e?this.rayHandler.diffuseBlendFunc.set(this.gl.DST_COLOR,this.gl.SRC_COLOR):"Some Other"===e?this.rayHandler.diffuseBlendFunc.set(this.gl.SRC_COLOR,this.gl.DST_COLOR):this.rayHandler.diffuseBlendFunc.reset()}Step(e,t){return super.Step(e,t),this.clearGlCanvas(),this.blendFunc.apply(),t}clearGlCanvas(){(0,r.clearGlCanvas)(this.gl,0,0,0,1)}renderLights(e,s){const r=this.getViewportSize();if(this.rayHandler.setCombinedMatrix(t.g_camera.combined,r.x/2,r.y/2,r.x,r.y),s>0&&this.rayHandler.update(),this.rayHandler.render(),this.drawDebugLight){const t=e.m_debugDraw,s=t.DrawPolygon.bind(t);for(const e of this.rayHandler.lightList)e.debugRender(s)}}}exports.AbstractLightTest=n;
},{"@box2d/lights":"hWSt","../../utils/camera":"GUc7","../../utils/lights/RayHandlerImpl":"CNVK","../../utils/gl/glUtils":"FFRI","../../test":"XTIe","../../ui/controls/Select":"lYGI","../../ui/controls/Checkbox":"preb"}],"STSQ":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/lights"),r=require("@box2d/core"),s=require("../../utils/camera"),i=require("../../utils/hotkeys"),o=require("../../test"),u=require("../../utils/lights/lightUtils"),h=t(require("./heart.json")),a=require("./abstract_light_test"),g=require("../../utils/gl/glUtils"),n=512,d=32;class l extends a.AbstractLightTest{constructor({gl:t,shader:e,textures:s}){super(t),this.lights=[],this.currentEdgeFixture=null,this.currentEdgeBody=null,this.dragStart=new r.b2Vec2,this.gl=t,this.shader=e,this.textures=s,this.mouseLight=this.createLight(),this.mouseLight.setColor(1,0,0,1);const i=this.m_world.CreateBody();for(const o of h.default){const t=new r.b2EdgeShape;t.SetTwoSided({x:o.x1,y:o.y1},{x:o.x2,y:o.y2}),i.CreateFixture({shape:t,density:0,restitution:0})}}getViewportSize(){return{x:s.g_camera.getWidth(),y:s.g_camera.getHeight()}}setSoft(t){this.mouseLight.setSoft(t);for(const e of this.lights)e.setSoft(t)}createLight(){const t=new e.PointLight(this.rayHandler,n,e.Light.DefaultColor,d,0,0);return(0,u.setRandomLightColor)(t),t.setPositionV(this.m_mouseWorld),t.setSoft(this.soft),t}GetDefaultViewZoom(){return 30}getHotkeys(){return[(0,i.hotKeyPress)("a","Place current light",()=>{this.lights.push(this.mouseLight),this.mouseLight=this.createLight()})]}MouseDown(t){super.MouseDown(t),this.dragStart.Copy(t)}MouseUp(t){super.MouseUp(t),this.currentEdgeFixture=null,this.currentEdgeBody=null}MouseMove(t,e){if(super.MouseMove(t,e),e){if(!this.currentEdgeBody){const t=1/s.g_camera.getZoom();this.currentEdgeBody=this.m_world.CreateBody({position:{x:-t,y:t}})}this.currentEdgeFixture&&this.currentEdgeBody.DestroyFixture(this.currentEdgeFixture);const e=new r.b2EdgeShape;e.SetTwoSided(this.dragStart,t),this.currentEdgeFixture=this.currentEdgeBody.CreateFixture({shape:e,density:0,restitution:0})}}Step(t,e){super.Step(t,e),this.addText("Left drag to draw lines"),this.mouseLight.setPositionV(this.m_mouseWorld);const r=s.g_camera.getCenter();return this.rayHandler.setCombinedMatrix(s.g_camera.combined,r.x,r.y,s.g_camera.getWidth(),s.g_camera.getHeight()),this.renderLights(t,e),e}clearGlCanvas(){(0,g.clearGlCanvas)(this.gl,1,1,1,1)}}(0,o.registerTest)("Lights","Draw World",l);
},{"@box2d/lights":"hWSt","@box2d/core":"FjWk","../../utils/camera":"GUc7","../../utils/hotkeys":"EV9t","../../test":"XTIe","../../utils/lights/lightUtils":"bi9k","./heart.json":"TMg8","./abstract_light_test":"aZQi","../../utils/gl/glUtils":"FFRI"}],"Ety2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setRotatedRect=exports.setBounds=exports.setRect=void 0;const t=require("@box2d/lights");function e(t,e,s,o,r){const n=e+o,c=s+r;return t.set([e,c,e,s,n,c,n,c,e,s,n,s]),t}function s(t,e,s,o,r){return t.set([r,o,r,e,s,o,s,o,r,e,s,e]),t}function o(e,s,o,r,n,c,u,i,d=1){const p=s+u,x=o+i,R=-u*d,a=-i*d,f=(r-u)*d,_=(n-i)*d,h=c*t.DEG_TO_RAD,l=Math.cos(h),M=Math.sin(h),b=l*R-M*_+p,v=M*R+l*_+x,B=l*R-M*a+p,D=M*R+l*a+x,O=l*f-M*_+p,g=M*f+l*_+x,j=B+(O-b),q=g-(v-D);return e.set([b,v,B,D,O,g,O,g,B,D,j,q]),e}exports.setRect=e,exports.setBounds=s,exports.setRotatedRect=o;
},{"@box2d/lights":"hWSt"}],"YErq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sprite=void 0;const t=require("@box2d/lights"),e=require("./vertex"),s=new Float32Array(12);class r{constructor(r,i,h){this.uvOffsetX=0,this.uvOffsetY=0,this.gl=r,this.shader=i,this.texture=h,this.vertBuffer=new t.VertexBufferObject(r,r.DYNAMIC_DRAW,s),this.uvBuffer=new t.VertexBufferObject(r,r.STATIC_DRAW,(0,e.setBounds)(s,0,1,1,0))}setUvOffset(t,e){this.uvOffsetX=t,this.uvOffsetY=e}destroy(){this.vertBuffer.dispose(),this.uvBuffer.dispose()}isDone(){return!0}setRect(t,r,i,h){this.vertBuffer.setData((0,e.setRect)(s,t,r,i,h))}setRotatedRect(t,r,i,h,f,u,d,a=1){this.vertBuffer.setData((0,e.setRotatedRect)(s,t,r,i,h,f,u,d,a))}render(){this.vertBuffer.bind(),this.shader.position.enable(),this.shader.position.set(2,this.gl.FLOAT,!1,0,0),this.vertBuffer.unbind(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.uvBuffer.bind(),this.shader.uv.enable(),this.shader.uv.set(2,this.gl.FLOAT,!1,0,0),this.uvBuffer.unbind(),this.shader.opacity.set(1),this.shader.uvOffset.set(this.uvOffsetX,this.uvOffsetY),this.shader.textureID.set(0),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}exports.Sprite=r;
},{"@box2d/lights":"hWSt","./vertex":"Ety2"}],"kyzd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),i=require("@box2d/lights"),e=require("../../utils/hotkeys"),s=require("../../utils/gl/Sprite"),o=require("../../test"),r=require("../../utils/lights/lightUtils"),h=require("./abstract_light_test"),n=require("../../ui/controls/Select"),a=t=>1<<t,l={WORLD:a(1),MARBLE:a(2),LIGHT:a(3)},c={WORLD:l.MARBLE,MARBLE:l.MARBLE|l.WORLD|l.LIGHT,LIGHT:l.MARBLE},g=1,d=2*g,L=128,u=16,y=48,b=33;class f{constructor(t,i){this.sprite=t,this.body=i}render(){const i=this.body.GetPosition();this.sprite.setRotatedRect(i.x-g,i.y-g,d,d,(0,t.b2RadToDeg)(this.body.GetAngle()),g,g),this.sprite.render()}}function p(t,i){return t+Math.random()*(i-t)}class m extends h.AbstractLightTest{constructor({gl:e,shader:o,textures:r}){super(e),this.sunDirection=-90,this.lightsType="Point",this.directionalLight=null,this.gl=e,this.shader=o,this.textures=r,this.bg=new s.Sprite(e,o,r.bg.texture),this.createBoundary();const h={restitution:.9,friction:.01,shape:new t.b2CircleShape(g),density:1};this.marbles=Array.from({length:5},()=>{const i=this.m_world.CreateBody({type:t.b2BodyType.b2_dynamicBody,position:{x:4+40*Math.random(),y:4+25*Math.random()}});return i.CreateFixture(h).SetFilterData({categoryBits:l.MARBLE,maskBits:c.MARBLE}),new f(new s.Sprite(e,o,r.marble.texture),i)}),this.bg.setRect(0,0,y,b),i.Light.setGlobalContactFilterBits(l.LIGHT,0,c.LIGHT),this.setLightsType(this.lightsType)}getLightControls(){return[(0,n.selectDef)("Lights Type",["Point","Cone","Chain","Directional"],this.lightsType,t=>{this.setLightsType(t)}),...super.getLightControls()]}getViewportSize(){return{x:y,y:b}}setSoft(t){var i,e;null===(i=this.directionalLight)||void 0===i||i.setSoft(t);for(const s of this.marbles)null===(e=s.light)||void 0===e||e.setSoft(t)}GetDefaultViewZoom(){return 20}getCenter(){return{x:y/2,y:b/2}}Destroy(){this.bg.destroy();for(const t of this.marbles)t.light.dispose(),t.sprite.destroy();super.Destroy()}setLightsType(t){switch(t){case"Point":this.initPointLights();break;case"Cone":this.initConeLights();break;case"Chain":this.initChainLights();break;case"Directional":this.initDirectionalLight()}this.lightsType=t}getHotkeys(){return[(0,e.hotKeyPress)("c","Random Light Colors",()=>{for(const t of this.marbles)(0,r.setRandomLightColor)(t.light)}),(0,e.hotKeyPress)("d","Random Light Distance",()=>{for(const t of this.marbles)t.light.setDistance(p(.5*u,2*u))})]}Step(t,i){super.Step(t,i),this.bg.render();for(const e of this.marbles)e.render();return this.directionalLight&&(this.sunDirection+=.008*i,this.directionalLight.setDirection(this.sunDirection)),this.renderLights(t,i),i}createBoundary(){const i=new t.b2ChainShape;i.CreateLoop([new t.b2Vec2,new t.b2Vec2(0,b),new t.b2Vec2(y,b),new t.b2Vec2(y,0)]),this.groundBody=this.m_world.CreateBody({type:t.b2BodyType.b2_staticBody}),this.groundBody.CreateFixture({shape:i,density:0}).SetFilterData({categoryBits:l.WORLD,maskBits:c.WORLD})}clearLights(){var t;this.directionalLight&&(this.directionalLight.remove(),this.directionalLight=null);for(const i of this.marbles)null===(t=i.light)||void 0===t||t.remove()}initPointLights(){this.clearLights();for(const t of this.marbles){const e=new i.PointLight(this.rayHandler,L,i.Light.DefaultColor,u,0,0);e.attachToBody(t.body,g/2,g/2),(0,r.setRandomLightColor)(e),t.light=e,e.setSoft(this.soft)}}initConeLights(){this.clearLights();for(const t of this.marbles){const e=new i.ConeLight(this.rayHandler,L,i.Light.DefaultColor,u,0,0,0,p(15,40));e.attachToBody(t.body,g/2,g/2,p(0,360)),(0,r.setRandomLightColor)(e),t.light=e,e.setSoft(this.soft)}}initChainLights(){this.clearLights();for(const t of this.marbles){const e=new i.ChainLight(this.rayHandler,L,i.Light.DefaultColor,u,1,[-5,0,0,3,5,0]);e.attachToBody(t.body,p(0,360)),(0,r.setRandomLightColor)(e),t.light=e,e.setSoft(this.soft)}}initDirectionalLight(){this.clearLights(),this.sunDirection=p(0,360),this.directionalLight=new i.DirectionalLight(this.rayHandler,4*L,i.Light.DefaultColor,this.sunDirection),this.directionalLight.setSoftnessLength(5),this.directionalLight.setSoft(this.soft)}}(0,o.registerTest)("Lights","Official Demo",m);
},{"@box2d/core":"FjWk","@box2d/lights":"hWSt","../../utils/hotkeys":"EV9t","../../utils/gl/Sprite":"YErq","../../test":"XTIe","../../utils/lights/lightUtils":"bi9k","./abstract_light_test":"aZQi","../../ui/controls/Select":"lYGI"}],"cXYR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./draw_world"),require("./official_demo");
},{"./draw_world":"STSQ","./official_demo":"kyzd"}],"JZl2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("@box2d/controllers"),o=require("../../test");class a extends o.Test{constructor(){super(),this.m_bodies=[];const o=new t.b2BuoyancyController;this.m_controller=o,o.normal.Set(0,1),o.offset=20,o.density=2,o.linearDrag=5,o.angularDrag=2;const a=this.m_world.CreateBody();{const t=new e.b2EdgeShape;t.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),a.CreateFixture({shape:t}),t.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(-40,25)),a.CreateFixture({shape:t}),t.SetTwoSided(new e.b2Vec2(40,0),new e.b2Vec2(40,25)),a.CreateFixture({shape:t})}for(let t=0;t<5;t++){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:40*Math.random()-20,y:15*Math.random()+5},angle:Math.random()*Math.PI}),o=new e.b2PolygonShape;o.SetAsBox(.5*Math.random()+1,.5*Math.random()+1),t.CreateFixture({density:1,friction:.3,restitution:.1,shape:o}),this.m_bodies.push(t)}for(let t=0;t<5;t++){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:40*Math.random()-20,y:15*Math.random()+5},angle:Math.random()*Math.PI});t.CreateFixture({density:1,friction:.3,restitution:.1,shape:new e.b2CircleShape(.5*Math.random()+1)}),this.m_bodies.push(t)}for(let t=0;t<15;t++){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:40*Math.random()-20,y:15*Math.random()+5},angle:Math.random()*Math.PI}),o=new e.b2PolygonShape;if(Math.random()>.66)o.Set([new e.b2Vec2(-1-1*Math.random(),1+1*Math.random()),new e.b2Vec2(-.5-1*Math.random(),-1-1*Math.random()),new e.b2Vec2(.5+1*Math.random(),-1-1*Math.random()),new e.b2Vec2(1+1*Math.random(),1+1*Math.random())]);else if(Math.random()>.5){const t=[];t[0]=new e.b2Vec2(0,1+1*Math.random()),t[2]=new e.b2Vec2(-.5-1*Math.random(),-1-1*Math.random()),t[3]=new e.b2Vec2(.5+1*Math.random(),-1-1*Math.random()),t[1]=new e.b2Vec2(t[0].x+t[2].x,t[0].y+t[2].y),t[1].Scale(Math.random()/2+.8),t[4]=new e.b2Vec2(t[3].x+t[0].x,t[3].y+t[0].y),t[4].Scale(Math.random()/2+.8),o.Set(t)}else o.Set([new e.b2Vec2(0,1+1*Math.random()),new e.b2Vec2(-.5-1*Math.random(),-1-1*Math.random()),new e.b2Vec2(.5+1*Math.random(),-1-1*Math.random())]);t.CreateFixture({density:1,friction:.3,restitution:.1,shape:o}),this.m_bodies.push(t)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:40},angle:0}),o=new e.b2PolygonShape;o.SetAsBox(4,1),t.CreateFixture({density:3,shape:o}),this.m_bodies.push(t)}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:30}}),o=new e.b2CircleShape(.7),a={density:2,shape:o};o.m_p.Set(3,0),t.CreateFixture(a),o.m_p.Set(-3,0),t.CreateFixture(a),o.m_p.Set(0,3),t.CreateFixture(a),o.m_p.Set(0,-3),t.CreateFixture(a),a.density=2;const r=new e.b2PolygonShape;a.shape=r,r.SetAsBox(3,.2),t.CreateFixture(a),r.SetAsBox(.2,3),t.CreateFixture(a),this.m_bodies.push(t)}for(const e of this.m_bodies)this.m_controller.AddBody(e);this.m_world.AddController(this.m_controller)}getCenter(){return{x:0,y:10}}}(0,o.registerTest)("Controllers","Boyancy Test",a);
},{"@box2d/core":"FjWk","@box2d/controllers":"mFGS","../../test":"XTIe"}],"lA4L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test");class o{constructor(){this.gainP=1,this.gainI=1,this.gainD=1,this.currentError=0,this.previousError=0,this.integral=0,this.output=0}step(t){this.integral=t*(this.integral+this.currentError);const e=1/t*(this.currentError-this.previousError);this.output=this.gainP*this.currentError+this.gainI*this.integral+this.gainD*e,this.previousError=this.currentError}}class i extends e.Test{constructor(){super({x:0,y:-30}),this.targetPosition=10,this.targetPositionInterval=0,this.posAvg=0,this.angleController=new o,this.positionController=new o,this.angleController.gainP=1e3,this.angleController.gainI=0,this.angleController.gainD=250,this.positionController.gainP=.5,this.positionController.gainI=0,this.positionController.gainD=1.5,this.pendulumBody=this.m_world.CreateBody({type:t.b2BodyType.b2_dynamicBody,position:{x:0,y:2+.5*i.PENDULUM_LENGTH}});const e=new t.b2PolygonShape;e.SetAsBox(.5,.5*i.PENDULUM_LENGTH);const r={shape:e,density:1/(1*i.PENDULUM_LENGTH)};this.pendulumBody.CreateFixture(r),this.wheelBody=this.m_world.CreateBody({type:t.b2BodyType.b2_dynamicBody,position:t.b2Vec2.UNITY});const s=new t.b2CircleShape;s.m_radius=.6,r.shape=s,r.density=1/(.6*Math.PI*.6),r.friction=10,this.wheelBody.CreateFixture(r);const n=new t.b2RevoluteJointDef;n.Initialize(this.wheelBody,this.pendulumBody,{x:0,y:0}),n.localAnchorA.Set(0,0),n.localAnchorB.Set(0,-.5*i.PENDULUM_LENGTH),n.collideConnected=!1,n.enableMotor=!0,n.maxMotorTorque=40,this.wheelJoint=this.m_world.CreateJoint(n),this.groundBody=this.m_world.CreateBody({type:t.b2BodyType.b2_staticBody,position:t.b2Vec2.ZERO});const l=new t.b2EdgeShape;l.SetTwoSided({x:-100,y:0},{x:100,y:0}),r.shape=l,r.friction=10,this.groundBody.CreateFixture(r)}getCenter(){return{x:0,y:5}}Step(e,o){let i=e.m_hertz>0?1/e.m_hertz:0;e.m_pause&&!e.m_singleStep&&(i=0),super.Step(e,o),this.targetPositionInterval+=i,this.targetPositionInterval>=8&&(this.targetPositionInterval=0,this.targetPosition=10===this.targetPosition?-10:10);let s=0;{const e=.4;this.posAvg=(1-e)*this.posAvg+e*this.pendulumBody.GetPosition().x,this.positionController.currentError=this.targetPosition-this.posAvg,this.positionController.step(i);let o=this.positionController.output;s=(o=(0,t.b2Clamp)(o,-10,10))/this.m_world.GetGravity().y,s=(0,t.b2Clamp)(s,(0,t.b2DegToRad)(-15),(0,t.b2DegToRad)(15))}let n=this.pendulumBody.GetAngle();n=r(n),this.angleController.currentError=s-n,this.angleController.step(i);let l=this.angleController.output;Math.abs(l)>1e3&&(l=0);const h=l/(2*Math.PI*.6);this.wheelJoint.SetMotorSpeed(h)}}function r(e){for(;e>(0,t.b2DegToRad)(180);)e-=(0,t.b2DegToRad)(360);for(;e<(0,t.b2DegToRad)(-180);)e+=(0,t.b2DegToRad)(360);return e}i.PENDULUM_LENGTH=10,(0,e.registerTest)("Controllers","Segway",i);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"HjDI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./buoyancy_test"),require("./segway");
},{"./buoyancy_test":"JZl2","./segway":"lA4L"}],"SedG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super(e.b2Vec2.ZERO);{const t=new e.b2CircleShape;t.m_p.SetZero(),t.m_radius=.1;const o=-6,r=0,s=4,n=6;for(let i=0;i<400;++i){this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(o,r),y:(0,e.b2RandomFloat)(s,n)}}).CreateFixture({shape:t,density:.01})}}{const t=new e.b2PolygonShape;t.SetAsBox(1.5,1.5);const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-40,y:5},bullet:!0});o.CreateFixture({shape:t,density:1}),o.SetLinearVelocity(new e.b2Vec2(10,0))}}GetDefaultViewZoom(){return 65}getCenter(){return{x:0,y:5}}}(0,t.registerTest)("Benchmark","Add Pair Stress Test",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"FVox":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys");class r extends t.Test{constructor(){super(e.b2Vec2.ZERO),this.positiveForce=!1,this.negativeForce=!1,this.cwTorque=!1,this.ccwTorque=!1;const t=this.m_world.CreateBody({position:{x:0,y:20}});{const o=new e.b2EdgeShape,r={shape:o,density:0,restitution:.4};o.SetTwoSided(new e.b2Vec2(-20,-20),new e.b2Vec2(-20,20)),t.CreateFixture(r),o.SetTwoSided(new e.b2Vec2(20,-20),new e.b2Vec2(20,20)),t.CreateFixture(r),o.SetTwoSided(new e.b2Vec2(-20,20),new e.b2Vec2(20,20)),t.CreateFixture(r),o.SetTwoSided(new e.b2Vec2(-20,-20),new e.b2Vec2(20,-20)),t.CreateFixture(r)}{const o=new e.b2Transform;o.q.Set(.3524*Math.PI),o.q.GetXAxis(o.p);const r=[];r[0]=e.b2Transform.MultiplyVec2(o,new e.b2Vec2(-1,0),new e.b2Vec2),r[1]=e.b2Transform.MultiplyVec2(o,new e.b2Vec2(1,0),new e.b2Vec2),r[2]=e.b2Transform.MultiplyVec2(o,new e.b2Vec2(0,.5),new e.b2Vec2);const n=new e.b2PolygonShape;n.Set(r,3);const c=new e.b2Transform;c.q.Set(-.3524*Math.PI),c.q.GetXAxis(c.p).Negate(),c.p.Copy(e.b2Rot.MultiplyVec2(c.q,new e.b2Vec2(-1,0),new e.b2Vec2)),r[0]=e.b2Transform.MultiplyVec2(c,new e.b2Vec2(-1,0),new e.b2Vec2),r[1]=e.b2Transform.MultiplyVec2(c,new e.b2Vec2(1,0),new e.b2Vec2),r[2]=e.b2Transform.MultiplyVec2(c,new e.b2Vec2(0,.5),new e.b2Vec2);const s=new e.b2PolygonShape;s.Set(r,3),this.m_body=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:3},angle:Math.PI,allowSleep:!1}),this.m_body.CreateFixture({shape:n,density:2}),this.m_body.CreateFixture({shape:s,density:2});const i=10,y=this.m_body.GetInertia(),b=this.m_body.GetMass(),l=Math.sqrt(2*y/b),p=new e.b2FrictionJointDef;p.bodyA=t,p.bodyB=this.m_body,p.localAnchorA.SetZero(),p.localAnchorB.Copy(this.m_body.GetLocalCenter()),p.collideConnected=!0,p.maxForce=.5*b*i,p.maxTorque=.2*b*l*i,this.m_world.CreateJoint(p)}{const o=new e.b2PolygonShape;o.SetAsBox(.5,.5);const r={shape:o,density:1,friction:.3};for(let n=0;n<10;++n){const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:7+1.54*n}});o.CreateFixture(r);const c=10,s=o.GetInertia(),i=o.GetMass(),y=Math.sqrt(2*s/i),b=new e.b2FrictionJointDef;b.localAnchorA.SetZero(),b.localAnchorB.SetZero(),b.bodyA=t,b.bodyB=o,b.collideConnected=!0,b.maxForce=i*c,b.maxTorque=.1*i*y*c,this.m_world.CreateJoint(b)}}}getHotkeys(){return[(0,o.hotKeyStep)("w","Apply Force",()=>this.ApplyForce(-50)),(0,o.hotKeyStep)("s","Apply Backward Force",()=>this.ApplyForce(50)),(0,o.hotKeyStep)("a","Apply Torque Counter-Clockwise",()=>this.m_body.ApplyTorque(10)),(0,o.hotKeyStep)("d","Apply Torque Clockwise",()=>this.m_body.ApplyTorque(-10))]}ApplyForce(t){const o=this.m_body.GetWorldVector(new e.b2Vec2(0,t),new e.b2Vec2),r=this.m_body.GetWorldPoint(new e.b2Vec2(0,3),new e.b2Vec2);this.m_body.ApplyForce(o,r)}getCenter(){return{x:0,y:15}}}(0,t.registerTest)("Forces","Apply Force",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"kIQ6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();const t=this.m_world.CreateBody({position:{x:0,y:17}});{let o=t;{const t=new e.b2PolygonShape;t.SetAsBox(4,1);const n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-8,y:20}});n.CreateFixture({shape:t,density:2});const i=new e.b2RevoluteJointDef;i.Initialize(o,n,new e.b2Vec2(-12,20)),this.m_world.CreateJoint(i),o=n}{const t=new e.b2PolygonShape;t.SetAsBox(8,1);const n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:4,y:20}});n.CreateFixture({shape:t,density:2});const i=new e.b2RevoluteJointDef;i.Initialize(o,n,new e.b2Vec2(-4,20)),this.m_world.CreateJoint(i),o=n}{const n=new e.b2PolygonShape;n.SetAsBox(3,3);const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,position:{x:12,y:20}});i.CreateFixture({shape:n,density:2});const s=new e.b2RevoluteJointDef;s.Initialize(o,i,new e.b2Vec2(12,20)),this.m_world.CreateJoint(s);const r=new e.b2PrismaticJointDef;r.Initialize(t,i,new e.b2Vec2(12,17),new e.b2Vec2(1,0)),this.m_world.CreateJoint(r)}}}getCenter(){return{x:0,y:15}}}(0,t.registerTest)("Examples","Slider Crank 1",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"Tar1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys");class i extends t.Test{constructor(){super(),this.m_speed=0;const t=this.m_world.CreateBody();{const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture({shape:o})}{this.m_attachment=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:3}});const t=new e.b2PolygonShape;t.SetAsBox(.5,2),this.m_attachment.CreateFixture({shape:t,density:2})}{this.m_platform=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-4,y:5}});const o=new e.b2PolygonShape;o.SetAsBox(.5,4,new e.b2Vec2(4,0),.5*Math.PI),this.m_platform.CreateFixture({shape:o,friction:.6,density:2});const i=new e.b2RevoluteJointDef;i.Initialize(this.m_attachment,this.m_platform,new e.b2Vec2(0,5)),i.maxMotorTorque=50,i.enableMotor=!0,this.m_world.CreateJoint(i);const s=new e.b2PrismaticJointDef;s.Initialize(t,this.m_platform,new e.b2Vec2(0,5),new e.b2Vec2(1,0)),s.maxMotorForce=1e3,s.enableMotor=!0,s.lowerTranslation=-10,s.upperTranslation=10,s.enableLimit=!0,this.m_world.CreateJoint(s),this.m_speed=3}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:8}}),o=new e.b2PolygonShape;o.SetAsBox(.75,.75),t.CreateFixture({shape:o,friction:.6,density:2})}}getHotkeys(){return[(0,o.hotKeyPress)("d","Set Dynamic Body",()=>this.m_platform.SetType(e.b2BodyType.b2_dynamicBody)),(0,o.hotKeyPress)("s","Set Static Body",()=>this.m_platform.SetType(e.b2BodyType.b2_staticBody)),(0,o.hotKeyPress)("k","Set Kinematic Body",()=>{this.m_platform.SetType(e.b2BodyType.b2_kinematicBody),this.m_platform.SetLinearVelocity(new e.b2Vec2(-this.m_speed,0)),this.m_platform.SetAngularVelocity(0)})]}Step(t,o){if(this.m_platform.GetType()===e.b2BodyType.b2_kinematicBody){const{p:t}=this.m_platform.GetTransform(),o=this.m_platform.GetLinearVelocity();(t.x<-10&&o.x<0||t.x>10&&o.x>0)&&this.m_platform.SetLinearVelocity(new e.b2Vec2(-o.x,o.y))}super.Step(t,o)}}(0,t.registerTest)("Examples","Body Types",i);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"HhkB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class s extends t.Test{constructor(){super(),this.m_velocity=new e.b2Vec2,this.m_angularVelocity=0,this.m_shape1=new e.b2PolygonShape,this.m_shape2=new e.b2PolygonShape,this.m_broke=!1,this.m_break=!1;{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s})}this.m_body1=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:40},angle:.25*Math.PI}),this.m_shape1=new e.b2PolygonShape,this.m_shape1.SetAsBox(.5,.5,new e.b2Vec2(-.5,0),0),this.m_piece1=this.m_body1.CreateFixture({shape:this.m_shape1,density:1}),this.m_shape2=new e.b2PolygonShape,this.m_shape2.SetAsBox(.5,.5,new e.b2Vec2(.5,0),0),this.m_piece2=this.m_body1.CreateFixture({shape:this.m_shape2,density:1})}PostSolve(e,t){if(this.m_broke)return;const s=e.GetManifold().pointCount;let i=0;for(let o=0;o<s;++o)i=Math.max(i,t.normalImpulses[o]);i>40&&(this.m_break=!0)}Break(){const t=this.m_piece1.GetBody(),s=t.GetWorldCenter();t.DestroyFixture(this.m_piece2);const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:t.GetPosition(),angle:t.GetAngle()});this.m_piece2=i.CreateFixture({shape:this.m_shape2,density:1});const o=t.GetWorldCenter(),r=i.GetWorldCenter(),a=e.b2Vec2.AddCrossScalarVec2(this.m_velocity,this.m_angularVelocity,e.b2Vec2.Subtract(o,s,e.b2Vec2.s_t0),new e.b2Vec2),h=e.b2Vec2.AddCrossScalarVec2(this.m_velocity,this.m_angularVelocity,e.b2Vec2.Subtract(r,s,e.b2Vec2.s_t0),new e.b2Vec2);t.SetAngularVelocity(this.m_angularVelocity),t.SetLinearVelocity(a),i.SetAngularVelocity(this.m_angularVelocity),i.SetLinearVelocity(h)}Step(e,t){this.m_break&&(this.Break(),this.m_broke=!0,this.m_break=!1),this.m_broke||(this.m_velocity.Copy(this.m_body1.GetLinearVelocity()),this.m_angularVelocity=this.m_body1.GetAngularVelocity()),super.Step(e,t)}}s.e_count=7,(0,t.registerTest)("Examples","Breakable",s);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"gwD4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const n=new e.b2PolygonShape;n.SetAsBox(.5,.125);const i={shape:n,density:20,friction:.2},s=new e.b2RevoluteJointDef;let r=t;for(let t=0;t<o.e_count;++t){const n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:1*t-14.5,y:5}});n.CreateFixture(i);const d=new e.b2Vec2(1*t-15,5);s.Initialize(r,n,d),this.m_world.CreateJoint(s),t===o.e_count>>1&&(this.m_middle=n),r=n}const d=new e.b2Vec2(1*o.e_count-15,5);s.Initialize(r,t,d),this.m_world.CreateJoint(s)}for(let o=0;o<2;++o){const t=[];t[0]=new e.b2Vec2(-.5,0),t[1]=new e.b2Vec2(.5,0),t[2]=new e.b2Vec2(0,1.5);const n=new e.b2PolygonShape;n.Set(t),this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:8*o-8,y:12}}).CreateFixture({shape:n,density:1})}for(let o=0;o<3;++o){const t=new e.b2CircleShape;t.m_radius=.5,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:6*o-6,y:10}}).CreateFixture({shape:t,density:1})}}}o.e_count=30,(0,t.registerTest)("Joints","Bridge",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"gYHV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");function s(e,t,s){return`${e.toFixed(0)} [${t.toFixed(1)}] (${s.toFixed(0)})`}class o extends t.Test{constructor(){super(),this.m_x=0;{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-10,0),new e.b2Vec2(10,0)),t.CreateFixture({shape:s});const o=new e.b2PolygonShape;o.SetAsBox(.2,1,new e.b2Vec2(.5,1),0),t.CreateFixture({shape:o})}{const t=new e.b2PolygonShape;t.SetAsBox(2,.1),this.m_body=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:4}}),this.m_body.CreateFixture({shape:t,density:1}),t.SetAsBox(.25,.25),this.m_x=.20352793,this.m_bullet=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,bullet:!0,position:{x:this.m_x,y:10}}),this.m_bullet.CreateFixture({shape:t,density:100}),this.m_bullet.SetLinearVelocity(new e.b2Vec2(0,-50))}}Launch(){this.m_body.SetTransformVec(new e.b2Vec2(0,4),0),this.m_body.SetLinearVelocity(e.b2Vec2.ZERO),this.m_body.SetAngularVelocity(0),this.m_x=(0,e.b2RandomFloat)(-1,1),this.m_bullet.SetTransformVec(new e.b2Vec2(this.m_x,10),0),this.m_bullet.SetLinearVelocity(new e.b2Vec2(0,-50)),this.m_bullet.SetAngularVelocity(0),e.b2Gjk.reset(),e.b2Toi.reset()}GetDefaultViewZoom(){return 50}Step(t,o){super.Step(t,o),this.addDebug("GJK Calls [ave Iters] (max Iters)",e.b2Gjk.calls>0&&s(e.b2Gjk.calls,e.b2Gjk.iters/e.b2Gjk.calls,e.b2Gjk.maxIters)),this.addDebug("Toi Calls [ave Iters] (max Iters)",e.b2Toi.calls>0&&s(e.b2Toi.calls,e.b2Toi.iters/e.b2Toi.calls,e.b2Toi.maxIters)),this.addDebug("Root Toi [ave Iters] (max Iters)",e.b2Toi.calls>0&&`[${(e.b2Toi.rootIters/e.b2Toi.calls).toFixed(1)}] (${e.b2Toi.maxRootIters})`),this.m_stepCount%60==0&&this.Launch()}}(0,t.registerTest)("Continuous","Bullet Test",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"Le3H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const n=new e.b2PolygonShape;n.SetAsBox(.5,.125);const i={shape:n,density:20},s=new e.b2WeldJointDef;let r=t;for(let t=0;t<o.e_count;++t){const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:1*t-14.5,y:5}});o.CreateFixture(i);const n=new e.b2Vec2(1*t-15,5);s.Initialize(r,o,n),this.m_world.CreateJoint(s),r=o}}{const o=new e.b2PolygonShape;o.SetAsBox(1,.125);const n={shape:o,density:20},i=new e.b2WeldJointDef,s=5,r=.7;let y=t;for(let t=0;t<3;++t){const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:2*t-14,y:15}});o.CreateFixture(n);const d=new e.b2Vec2(2*t-15,15);i.Initialize(y,o,d),(0,e.b2AngularStiffness)(i,s,r,i.bodyA,i.bodyB),this.m_world.CreateJoint(i),y=o}}{const n=new e.b2PolygonShape;n.SetAsBox(.5,.125);const i={shape:n,density:20},s=new e.b2WeldJointDef;let r=t;for(let t=0;t<o.e_count;++t){const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:1*t-4.5,y:5}});if(o.CreateFixture(i),t>0){const n=new e.b2Vec2(1*t-5,5);s.Initialize(r,o,n),this.m_world.CreateJoint(s)}r=o}}{const n=new e.b2PolygonShape;n.SetAsBox(.5,.125);const i={shape:n,density:20},s=new e.b2WeldJointDef,r=8,y=.7;let d=t;for(let t=0;t<o.e_count;++t){const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:5.5+1*t,y:10}});if(o.CreateFixture(i),t>0){const n=new e.b2Vec2(5+1*t,10);s.Initialize(d,o,n),(0,e.b2AngularStiffness)(s,r,y,s.bodyA,s.bodyB),this.m_world.CreateJoint(s)}d=o}}for(let o=0;o<2;++o){const t=[];t[0]=new e.b2Vec2(-.5,0),t[1]=new e.b2Vec2(.5,0),t[2]=new e.b2Vec2(0,1.5);const n=new e.b2PolygonShape;n.Set(t),this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:8*o-8,y:12}}).CreateFixture({shape:n,density:1})}for(let o=0;o<2;++o){const t=new e.b2CircleShape;t.m_radius=.5,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:6*o-6,y:10}}).CreateFixture({shape:t,density:1})}}}o.e_count=8,(0,t.registerTest)("Joints","Cantilever",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"ygSt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),i=require("../../utils/camera"),o=require("../../utils/hotkeys");class r extends t.Test{constructor(){let t;super(),this.m_speed=0,this.m_speed=50;{t=this.m_world.CreateBody();const i=new e.b2EdgeShape,o={shape:i,density:0,friction:.6};i.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture(o);const r=[.25,1,4,0,0,-1,-2,-2,-1.25,0];let s=20,n=0;const a=5;for(let d=0;d<10;++d){const h=r[d];i.SetTwoSided(new e.b2Vec2(s,n),new e.b2Vec2(s+a,h)),t.CreateFixture(o),n=h,s+=a}for(let d=0;d<10;++d){const h=r[d];i.SetTwoSided(new e.b2Vec2(s,n),new e.b2Vec2(s+a,h)),t.CreateFixture(o),n=h,s+=a}i.SetTwoSided(new e.b2Vec2(s,0),new e.b2Vec2(s+40,0)),t.CreateFixture(o),s+=80,i.SetTwoSided(new e.b2Vec2(s,0),new e.b2Vec2(s+40,0)),t.CreateFixture(o),s+=40,i.SetTwoSided(new e.b2Vec2(s,0),new e.b2Vec2(s+10,5)),t.CreateFixture(o),s+=20,i.SetTwoSided(new e.b2Vec2(s,0),new e.b2Vec2(s+40,0)),t.CreateFixture(o),s+=40,i.SetTwoSided(new e.b2Vec2(s,0),new e.b2Vec2(s,20)),t.CreateFixture(o)}{const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:140,y:1}}),o=new e.b2PolygonShape;o.SetAsBox(10,.25),i.CreateFixture({shape:o,density:1});const r=new e.b2RevoluteJointDef;r.Initialize(t,i,i.GetPosition()),r.lowerAngle=-8*Math.PI/180,r.upperAngle=8*Math.PI/180,r.enableLimit=!0,this.m_world.CreateJoint(r),i.ApplyAngularImpulse(100)}{const i=20,o=new e.b2PolygonShape;o.SetAsBox(1,.125);const r={shape:o,density:1,friction:.6},s=new e.b2RevoluteJointDef;let n=t;for(let t=0;t<i;++t){const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:161+2*t,y:-.125}});i.CreateFixture(r);const o=new e.b2Vec2(160+2*t,-.125);s.Initialize(n,i,o),this.m_world.CreateJoint(s),n=i}const a=new e.b2Vec2(160+2*i,-.125);s.Initialize(n,t,a),this.m_world.CreateJoint(s)}{const t=new e.b2PolygonShape;let i;t.SetAsBox(.5,.5);const o=new e.b2Vec2,r={type:e.b2BodyType.b2_dynamicBody,position:o};o.Set(230,.5),(i=this.m_world.CreateBody(r)).CreateFixture({shape:t,density:.5}),o.Set(230,1.5),(i=this.m_world.CreateBody(r)).CreateFixture({shape:t,density:.5}),o.Set(230,2.5),(i=this.m_world.CreateBody(r)).CreateFixture({shape:t,density:.5}),o.Set(230,3.5),(i=this.m_world.CreateBody(r)).CreateFixture({shape:t,density:.5}),o.Set(230,4.5),(i=this.m_world.CreateBody(r)).CreateFixture({shape:t,density:.5})}{const t=new e.b2PolygonShape,i=(0,e.b2MakeArray)(8,e.b2Vec2);i[0].Set(-1.5,-.5),i[1].Set(1.5,-.5),i[2].Set(1.5,0),i[3].Set(0,.9),i[4].Set(-1.15,.9),i[5].Set(-1.5,.2),t.Set(i,6);const o=new e.b2CircleShape;o.m_radius=.4;const r=new e.b2Vec2,s={type:e.b2BodyType.b2_dynamicBody,position:r};r.Set(0,1),this.m_car=this.m_world.CreateBody(s),this.m_car.CreateFixture({shape:t,density:1});const n={shape:o,density:1,friction:.9};r.Set(-1,.35),this.m_wheel1=this.m_world.CreateBody(s),this.m_wheel1.CreateFixture(n),r.Set(1,.4),this.m_wheel2=this.m_world.CreateBody(s),this.m_wheel2.CreateFixture(n);const a=new e.b2WheelJointDef,d=new e.b2Vec2(0,1),h=this.m_wheel1.GetMass(),l=this.m_wheel2.GetMass(),c=4,w=.7,m=2*Math.PI*c;a.Initialize(this.m_car,this.m_wheel1,this.m_wheel1.GetPosition(),d),a.motorSpeed=0,a.maxMotorTorque=20,a.enableMotor=!0,a.stiffness=h*m*m,a.damping=2*h*w*m,a.lowerTranslation=-.25,a.upperTranslation=.25,a.enableLimit=!0,this.m_spring1=this.m_world.CreateJoint(a),a.Initialize(this.m_car,this.m_wheel2,this.m_wheel2.GetPosition(),d),a.motorSpeed=0,a.maxMotorTorque=10,a.enableMotor=!1,a.stiffness=l*m*m,a.damping=2*l*w*m,a.lowerTranslation=-.25,a.upperTranslation=.25,a.enableLimit=!0,this.m_spring2=this.m_world.CreateJoint(a)}}getHotkeys(){return[(0,o.hotKey)("a","Decelerate",e=>this.m_spring1.SetMotorSpeed(e?this.m_speed:0)),(0,o.hotKey)("d","Accelerate",e=>this.m_spring1.SetMotorSpeed(e?-this.m_speed:0))]}Step(e,t){const o=i.g_camera.getCenter();i.g_camera.setPosition(this.m_car.GetPosition().x,o.y),super.Step(e,t)}}(0,t.registerTest)("Examples","Car",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/camera":"GUc7","../../utils/hotkeys":"EV9t"}],"IeNr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super(),this.m_angularVelocity=0;{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-10,0),new e.b2Vec2(10,0)),t.CreateFixture({shape:o});const s=new e.b2PolygonShape;s.SetAsBox(.2,1,new e.b2Vec2(.5,1),0),t.CreateFixture({shape:s})}{const t=new e.b2PolygonShape;t.SetAsBox(2,.1),this.m_body=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:20}}),this.m_body.CreateFixture({shape:t,density:1}),this.m_angularVelocity=(0,e.b2RandomFloat)(-50,50),this.m_body.SetLinearVelocity(new e.b2Vec2(0,-100)),this.m_body.SetAngularVelocity(this.m_angularVelocity)}e.b2Gjk.reset(),e.b2Toi.reset()}Launch(){e.b2Gjk.reset(),e.b2Toi.reset(),this.m_body.SetTransformVec(new e.b2Vec2(0,20),0),this.m_angularVelocity=(0,e.b2RandomFloat)(-50,50),this.m_body.SetLinearVelocity(new e.b2Vec2(0,-100)),this.m_body.SetAngularVelocity(this.m_angularVelocity)}Step(t,o){super.Step(t,o),this.addDebug("GJK Calls [ave Iters] (max Iters)",e.b2Gjk.calls>0&&`${e.b2Gjk.calls.toFixed(0)} [${(e.b2Gjk.iters/e.b2Gjk.calls).toFixed(1)}] (${e.b2Gjk.maxIters.toFixed(0)})`),this.addDebug("Toi Calls [ave Iters] (max Iters)",e.b2Toi.calls>0&&`${e.b2Toi.calls} [${(e.b2Toi.iters/e.b2Toi.calls).toFixed(1)}] (${e.b2Toi.maxIters})`),this.addDebug("Toi Root [ave Iters] (max Iters)",e.b2Toi.calls>0&&`${e.b2Toi.calls} [${(e.b2Toi.rootIters/e.b2Toi.calls).toFixed(1)}] (${e.b2Toi.maxRootIters})`),this.addDebug("Toi Time in ms [ave] (max)",e.b2Toi.calls>0&&`[${(1e3*e.b2Toi.time/e.b2Toi.calls).toFixed(1)}] (${(1e3*e.b2Toi.maxTime).toFixed(1)})`),this.m_stepCount%60==0&&this.Launch()}GetDefaultViewZoom(){return 50}}(0,t.registerTest)("Continuous","Continuous Test",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"cVdp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=!1;class n extends t.Test{constructor(){super();let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const n=new e.b2PolygonShape;n.SetAsBox(.6,.125);const s={shape:n,density:20,friction:.2},i=new e.b2RevoluteJointDef;i.collideConnected=!1;const r=25;let c=t;for(let t=0;t<30;++t){const n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:.5+t,y:r}});o&&(s.density=10===t?0:20),n.CreateFixture(s);const d=new e.b2Vec2(t,r);i.Initialize(c,n,d),this.m_world.CreateJoint(i),c=n}}}}(0,t.registerTest)("Joints","Chain",n);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"PnmG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture({shape:o})}{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-8,1),new e.b2Vec2(-6,1)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(-6,1),new e.b2Vec2(-4,1)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(-4,1),new e.b2Vec2(-2,1)),t.CreateFixture({shape:o})}{const t=this.m_world.CreateBody({angle:.25*Math.PI}),o=(0,e.b2MakeArray)(4,e.b2Vec2);o[0].Set(5,7),o[1].Set(8,7),o[2].Set(7,8),o[3].Set(6,8);const a=new e.b2ChainShape;a.CreateLoop(o,4),t.CreateFixture({shape:a})}{const t=this.m_world.CreateBody(),o=new e.b2PolygonShape;o.SetAsBox(1,1,new e.b2Vec2(4,3),0),t.CreateFixture({shape:o}),o.SetAsBox(1,1,new e.b2Vec2(6,3),0),t.CreateFixture({shape:o}),o.SetAsBox(1,1,new e.b2Vec2(8,3),0),t.CreateFixture({shape:o})}{const t=this.m_world.CreateBody(),o=(0,e.b2MakeArray)(4,e.b2Vec2);o[0].Set(-1,3),o[1].Set(1,3),o[2].Set(1,5),o[3].Set(-1,5);const a=new e.b2ChainShape;a.CreateLoop(o,4),t.CreateFixture({shape:a})}{const t=this.m_world.CreateBody({position:{x:-10,y:4}}),o=(0,e.b2MakeArray)(10,e.b2Vec2);o[0].Set(0,0),o[1].Set(6,0),o[2].Set(6,2),o[3].Set(4,1),o[4].Set(2,2),o[5].Set(0,2),o[6].Set(-2,2),o[7].Set(-4,3),o[8].Set(-6,2),o[9].Set(-6,0);const a=new e.b2ChainShape;a.CreateLoop(o,10),t.CreateFixture({shape:a})}{const t=this.m_world.CreateBody({position:{x:-3,y:8},type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,allowSleep:!1}),o=new e.b2PolygonShape;o.SetAsBox(.5,.5),t.CreateFixture({shape:o,density:20})}{const t=this.m_world.CreateBody({position:{x:-5,y:5},type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,allowSleep:!1}),o=new e.b2PolygonShape;o.SetAsBox(.25,.25),t.CreateFixture({shape:o,density:20})}{const t=this.m_world.CreateBody({position:{x:-5,y:8},type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,allowSleep:!1});let o=0;const a=Math.PI/3,r=(0,e.b2MakeArray)(6,e.b2Vec2);for(let e=0;e<6;++e)r[e].Set(.5*Math.cos(o),.5*Math.sin(o)),o+=a;const i=new e.b2PolygonShape;i.Set(r,6),t.CreateFixture({shape:i,density:20})}{const t=this.m_world.CreateBody({position:{x:3,y:5},type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,allowSleep:!1}),o=new e.b2CircleShape;o.m_radius=.5,t.CreateFixture({shape:o,density:20})}{this.m_character=this.m_world.CreateBody({position:{x:-7,y:6},type:e.b2BodyType.b2_dynamicBody,allowSleep:!1});const t=new e.b2CircleShape;t.m_radius=.25,this.m_character.CreateFixture({shape:t,density:20,friction:1})}}GetDefaultViewZoom(){return 30}getCenter(){return{x:-2,y:0}}Step(e,t){const o=this.m_character.GetLinearVelocity();this.m_character.SetLinearVelocity({x:-5,y:o.y}),super.Step(e,t),this.addText("This tests various character collision shapes"),this.addText("Limitation: square and hexagon can snag on aligned boxes."),this.addText("Feature: edge chains have smooth collision inside and out.")}}(0,t.registerTest)("Examples","Character Collision",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"zYjI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=new e.b2EdgeShape;t.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),this.m_world.CreateBody().CreateFixture({shape:t,friction:.3})}const t=[];t[0]=new e.b2Vec2(-1,0),t[1]=new e.b2Vec2(1,0),t[2]=new e.b2Vec2(0,2);const r=new e.b2PolygonShape;r.Set(t,3);const i={groupIndex:o.k_smallGroup,categoryBits:o.k_triangleCategory,maskBits:o.k_triangleMask},a={shape:r,density:1,filter:i};this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-5,y:2}}).CreateFixture(a),t[0].Scale(2),t[1].Scale(2),t[2].Scale(2),r.Set(t,3),i.groupIndex=o.k_largeGroup;const s=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,position:{x:-5,y:6}});s.CreateFixture(a);{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-5,y:10}}),o=new e.b2PolygonShape;o.SetAsBox(.5,1),t.CreateFixture({shape:o,density:1});const r=new e.b2PrismaticJointDef;r.bodyA=s,r.bodyB=t,r.enableLimit=!0,r.localAnchorA.Set(0,4),r.localAnchorB.SetZero(),r.localAxisA.Set(0,1),r.lowerTranslation=-1,r.upperTranslation=1,this.m_world.CreateJoint(r)}r.SetAsBox(1,.5);const n={groupIndex:o.k_smallGroup,categoryBits:o.k_boxCategory,maskBits:o.k_boxMask},y={shape:r,density:1,restitution:.1,filter:n};this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:2}}).CreateFixture(y),r.SetAsBox(2,1),n.groupIndex=o.k_largeGroup,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:6}}).CreateFixture(y);const d=new e.b2CircleShape;d.m_radius=1;const l={groupIndex:o.k_smallGroup,categoryBits:o.k_circleCategory,maskBits:o.k_circleMask},c={shape:d,density:1,filter:l};this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:5,y:2}}).CreateFixture(c),d.m_radius*=2,l.groupIndex=o.k_largeGroup,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:5,y:6}}).CreateFixture(c)}}o.k_smallGroup=1,o.k_largeGroup=-1,o.k_triangleCategory=2,o.k_boxCategory=4,o.k_circleCategory=8,o.k_triangleMask=65535,o.k_boxMask=65535^o.k_triangleCategory,o.k_circleMask=65535,(0,t.registerTest)("Examples","Collision Filtering",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"iFXO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=new e.b2EdgeShape;t.SetTwoSided(new e.b2Vec2(-50,0),new e.b2Vec2(50,0)),this.m_world.CreateBody().CreateFixture({shape:t})}const t=[new e.b2Vec2(-1,0),new e.b2Vec2(1,0),new e.b2Vec2(0,2)],o=new e.b2PolygonShape;o.Set(t,3);const a={shape:o,density:1};this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-5,5),y:(0,e.b2RandomFloat)(2,35)}}).CreateFixture(a),t[0].Scale(2),t[1].Scale(2),t[2].Scale(2),o.Set(t,3),this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-5,5),y:(0,e.b2RandomFloat)(2,35)}}).CreateFixture(a),o.SetAsBox(1,.5);const s={shape:o,density:1};this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-5,5),y:(0,e.b2RandomFloat)(2,35)}}).CreateFixture(s),o.SetAsBox(2,1),this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-5,5),y:(0,e.b2RandomFloat)(2,35)}}).CreateFixture(s);const d=new e.b2CircleShape;d.m_radius=1;const i={shape:d,density:1};this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-5,5),y:(0,e.b2RandomFloat)(2,35)}}).CreateFixture(i),d.m_radius*=2,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-5,5),y:(0,e.b2RandomFloat)(2,35)}}).CreateFixture(i)}Step(e,t){super.Step(e,t);const o=new Array(6);let a=0;for(let s=0;s<this.m_pointCount;++s){const e=this.m_points[s],t=e.fixtureA.GetBody(),d=e.fixtureB.GetBody(),i=t.GetMass(),n=d.GetMass();if(i>0&&n>0&&(o[a++]=n>i?t:d,6===a))break}for(let s=0;s<a;s++){const e=o[s];o.indexOf(e)===s&&e!==this.m_bomb&&this.m_world.DestroyBody(e)}}}(0,t.registerTest)("Examples","Collision Processing",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"PSXK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),s=require("../../utils/hotkeys");class n extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(50,0),new e.b2Vec2(-50,0)),t.CreateFixture({shape:s})}{this.m_table1=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(-15,1)});const t=new e.b2PolygonShape;t.SetAsBox(3,.5,new e.b2Vec2(0,3.5),0);const s=new e.b2PolygonShape;s.SetAsBox(.5,1.5,new e.b2Vec2(-2.5,1.5),0);const n=new e.b2PolygonShape;n.SetAsBox(.5,1.5,new e.b2Vec2(2.5,1.5),0),this.m_table1.CreateFixture({shape:t,density:2}),this.m_table1.CreateFixture({shape:s,density:2}),this.m_table1.CreateFixture({shape:n,density:2})}{this.m_table2=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(-5,1)});const t=new e.b2PolygonShape;t.SetAsBox(3,.5,new e.b2Vec2(0,3.5),0);const s=new e.b2PolygonShape;s.SetAsBox(.5,2,new e.b2Vec2(-2.5,2),0);const n=new e.b2PolygonShape;n.SetAsBox(.5,2,new e.b2Vec2(2.5,2),0),this.m_table2.CreateFixture({shape:t,density:2}),this.m_table2.CreateFixture({shape:s,density:2}),this.m_table2.CreateFixture({shape:n,density:2})}{this.m_ship1=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(5,1)});const t=[],s=new e.b2PolygonShape;t[0]=new e.b2Vec2(-2,0),t[1]=new e.b2Vec2(0,4/3),t[2]=new e.b2Vec2(0,4),s.Set(t,3);const n=new e.b2PolygonShape;t[0]=new e.b2Vec2(2,0),t[1]=new e.b2Vec2(0,4/3),t[2]=new e.b2Vec2(0,4),n.Set(t,3),this.m_ship1.CreateFixture({shape:s,density:2}),this.m_ship1.CreateFixture({shape:n,density:2})}{this.m_ship2=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(15,1)});const t=[],s=new e.b2PolygonShape;t[0]=new e.b2Vec2(-2,0),t[1]=new e.b2Vec2(1,2),t[2]=new e.b2Vec2(0,4),s.Set(t,3);const n=new e.b2PolygonShape;t[0]=new e.b2Vec2(2,0),t[1]=new e.b2Vec2(-1,2),t[2]=new e.b2Vec2(0,4),n.Set(t,3),this.m_ship2.CreateFixture({shape:s,density:2}),this.m_ship2.CreateFixture({shape:n,density:2})}}Spawn(){{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:this.m_table1.GetPosition(),angle:this.m_table1.GetAngle()}),s=new e.b2PolygonShape;s.SetAsBox(4,.1,new e.b2Vec2(0,3),0),t.CreateFixture({shape:s,density:2})}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:this.m_table2.GetPosition(),angle:this.m_table2.GetAngle()}),s=new e.b2PolygonShape;s.SetAsBox(4,.1,new e.b2Vec2(0,3),0),t.CreateFixture({shape:s,density:2})}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:this.m_ship1.GetPosition(),angle:this.m_ship1.GetAngle(),gravityScale:0}),s=new e.b2CircleShape(.5);s.m_p.Set(0,2),t.CreateFixture({shape:s,density:2})}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:this.m_ship2.GetPosition(),angle:this.m_ship2.GetAngle(),gravityScale:0}),s=new e.b2CircleShape(.5);s.m_p.Set(0,2),t.CreateFixture({shape:s,density:2})}}getHotkeys(){return[(0,s.hotKeyPress)("s","Spawn Items",()=>{this.Spawn()})]}getCenter(){return{x:0,y:5}}}(0,t.registerTest)("Examples","Compound Shapes",n);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"Z8wF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),r=require("../../utils/hotkeys");class o extends t.Test{constructor(){super(e.b2Vec2.ZERO);{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-10,0),new e.b2Vec2(10,0)),t.CreateFixture({shape:r}),r.SetTwoSided(new e.b2Vec2(-10,0),new e.b2Vec2(-10,20)),t.CreateFixture({shape:r}),r.SetTwoSided(new e.b2Vec2(10,0),new e.b2Vec2(10,20)),t.CreateFixture({shape:r}),r.SetTwoSided(new e.b2Vec2(-10,20),new e.b2Vec2(10,20)),t.CreateFixture({shape:r})}const t=new e.b2CircleShape;t.m_p.SetZero(),t.m_radius=.5;const r={shape:t,density:1,friction:.1};for(let i=0;i<o.e_columnCount;++i)for(let t=0;t<o.e_rowCount;++t){this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:.5*(2.1*i+1+.01*t)-10,y:.5*(2*t+1)}}).CreateFixture(r)}}GetDefaultViewZoom(){return 40}getCenter(){return{x:0,y:10}}CreateCircle(){const t=new e.b2CircleShape;t.m_p.SetZero(),t.m_radius=2,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2Random)(),y:3+(0,e.b2Random)()}}).CreateFixture({shape:t,density:1,friction:0})}getHotkeys(){return[(0,r.hotKeyPress)("c","Create Circle",()=>this.CreateCircle())]}Step(t,r){for(let o=this.m_world.GetBodyList();o;o=o.GetNext())o.GetType(),e.b2BodyType.b2_dynamicBody;180===this.m_stepCount&&(this.m_stepCount+=0),super.Step(t,r);for(let o=this.m_world.GetBodyList();o;o=o.GetNext())o.GetType(),e.b2BodyType.b2_dynamicBody}}o.e_columnCount=0,o.e_rowCount=0,(0,t.registerTest)("Solver","Confined",o);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"IoNu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test"),o=require("../../utils/hotkeys");class s extends e.Test{constructor(){super(),this.m_test_points=[],this.m_count=0,this.m_auto=!1,this.Generate()}GetDefaultViewZoom(){return 50}Generate(){for(let e=0;e<s.e_count;++e){let o=(0,t.b2RandomFloat)(-10,10),s=(0,t.b2RandomFloat)(-10,10);o=(0,t.b2Clamp)(o,-8,8),s=(0,t.b2Clamp)(s,-8,8),this.m_test_points[e]=new t.b2Vec2(o,s)}this.m_count=s.e_count}getHotkeys(){return[(0,o.hotKeyPress)("a","Toggle Autogeneration",()=>{this.m_auto=!this.m_auto}),(0,o.hotKeyPress)("g","Generate a new random convex hull",()=>this.Generate())]}Step(e,o){super.Step(e,o);const s=new t.b2PolygonShape;s.Set(this.m_test_points,this.m_count);const n=e.m_debugDraw;n.DrawPolygon(s.m_vertices,s.m_count,new t.b2Color(.9,.9,.9));for(let r=0;r<this.m_count;++r)n.DrawPoint(this.m_test_points[r],3,new t.b2Color(.3,.9,.3)),n.DrawStringWorld(this.m_test_points[r].x+.05,this.m_test_points[r].y+.05,`${r}`);s.Validate(),this.m_auto&&this.Generate()}}s.e_count=10,(0,e.registerTest)("Geometry","Convex Hull",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"MSqr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture({shape:o})}{const t=this.m_world.CreateBody({position:{x:-5,y:5}}),o=new e.b2PolygonShape;o.SetAsBox(10,.5),this.m_platform=t.CreateFixture({shape:o,friction:.8})}for(let t=0;t<5;++t){const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:2*t-10,y:7}}),r=new e.b2PolygonShape;r.SetAsBox(.5,.5),o.CreateFixture({shape:r,density:20})}}GetDefaultViewZoom(){return 40}PreSolve(e,t){super.PreSolve(e,t);const o=e.GetFixtureA(),r=e.GetFixtureB();o===this.m_platform&&e.SetTangentSpeed(5),r===this.m_platform&&e.SetTangentSpeed(-5)}}(0,t.registerTest)("Examples","Conveyor Belt",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"Ioxf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),s=require("../../test"),e=require("../../utils/hotkeys");class o extends s.Test{constructor(){super(),this.m_positionB=new t.b2Vec2,this.m_angleB=0,this.m_transformA=new t.b2Transform,this.m_transformB=new t.b2Transform,this.m_polygonA=new t.b2PolygonShape,this.m_polygonB=new t.b2PolygonShape,this.m_transformA.SetIdentity(),this.m_transformA.p.Set(0,-.2),this.m_polygonA.SetAsBox(10,.2),this.m_positionB.Set(12.017401,.13678508),this.m_angleB=-.0109265,this.m_transformB.SetPositionAngle(this.m_positionB,this.m_angleB),this.m_polygonB.SetAsBox(2,.1)}GetDefaultViewZoom(){return 200}getCenter(){return{x:10,y:-.5}}getHotkeys(){return[(0,e.hotKeyPress)("a","Move Left",()=>this.Adjust(-.1,0,0)),(0,e.hotKeyPress)("d","Move Right",()=>this.Adjust(.1,0,0)),(0,e.hotKeyPress)("s","Move Down",()=>this.Adjust(0,-.1,0)),(0,e.hotKeyPress)("w","Move Up",()=>this.Adjust(0,.1,0)),(0,e.hotKeyPress)("q","Turn Left",()=>this.Adjust(0,0,.1*Math.PI)),(0,e.hotKeyPress)("e","Turn Right",()=>this.Adjust(0,0,-.1*Math.PI))]}Adjust(t,s,e){this.m_positionB.x+=t,this.m_positionB.y+=s,this.m_angleB+=e,this.m_transformB.SetPositionAngle(this.m_positionB,this.m_angleB)}Step(s,e){super.Step(s,e);const o=new t.b2DistanceInput;o.proxyA.SetShape(this.m_polygonA,0),o.proxyB.SetShape(this.m_polygonB,0),o.transformA.Copy(this.m_transformA),o.transformB.Copy(this.m_transformB),o.useRadii=!0;const n=new t.b2SimplexCache;n.count=0;const i=new t.b2DistanceOutput;(0,t.b2Distance)(i,n,o),this.addDebug("Distance",i.distance.toFixed(2)),this.addDebug("Iterations",i.iterations);const r=s.m_debugDraw;{const s=new t.b2Color(.9,.9,.9),e=[];for(let o=0;o<this.m_polygonA.m_count;++o)e[o]=t.b2Transform.MultiplyVec2(this.m_transformA,this.m_polygonA.m_vertices[o],new t.b2Vec2);r.DrawPolygon(e,this.m_polygonA.m_count,s);for(let o=0;o<this.m_polygonB.m_count;++o)e[o]=t.b2Transform.MultiplyVec2(this.m_transformB,this.m_polygonB.m_vertices[o],new t.b2Vec2);r.DrawPolygon(e,this.m_polygonB.m_count,s)}const m=i.pointA,h=i.pointB,a=new t.b2Color(1,0,0);r.DrawPoint(m,4,a);const p=new t.b2Color(1,1,0);r.DrawPoint(h,4,p)}}(0,s.registerTest)("Examples","Distance Test",o);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"FIrH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();let t=null;{const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),(t=this.m_world.CreateBody()).CreateFixture({shape:o})}{const t=new e.b2PolygonShape;t.SetAsBox(6,.25),this.m_world.CreateBody({position:{x:-1.5,y:10}}).CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(.1,1);const o={shape:t,density:20,friction:.1};for(let n=0;n<10;++n){this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:1*n-6,y:11.25}}).CreateFixture(o)}}{const t=new e.b2PolygonShape;t.SetAsBox(7,.25,e.b2Vec2.ZERO,.3),this.m_world.CreateBody({position:{x:1,y:6}}).CreateFixture({shape:t})}let o=null;{const t=new e.b2PolygonShape;t.SetAsBox(.25,1.5),(o=this.m_world.CreateBody({position:{x:-7,y:4}})).CreateFixture({shape:t})}let n=null;{const t=new e.b2PolygonShape;t.SetAsBox(6,.125),(n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,angle:-.15,position:{x:-.9,y:1}})).CreateFixture({shape:t,density:10})}const i=new e.b2RevoluteJointDef,r=new e.b2Vec2;r.Set(-2,1),i.Initialize(t,n,r),i.collideConnected=!0,this.m_world.CreateJoint(i);let s=null;{const t=new e.b2PolygonShape;t.SetAsBox(.25,.25),(s=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-10,y:15}})).CreateFixture({shape:t,density:10})}r.Set(-7,15),i.Initialize(o,s,r),this.m_world.CreateJoint(i);let y=null;{y=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:6.5,y:3}});const t=new e.b2PolygonShape,o={shape:t,density:10,friction:.1};t.SetAsBox(1,.1,new e.b2Vec2(0,-.9),0),y.CreateFixture(o),t.SetAsBox(.1,1,new e.b2Vec2(-.9,0),0),y.CreateFixture(o),t.SetAsBox(.1,1,new e.b2Vec2(.9,0),0),y.CreateFixture(o)}r.Set(6,2),i.Initialize(t,y,r),this.m_world.CreateJoint(i);let a=null;{const t=new e.b2PolygonShape;t.SetAsBox(1,.1),(a=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:6.5,y:4.1}})).CreateFixture({shape:t,density:30})}r.Set(7.5,4),i.Initialize(y,a,r),this.m_world.CreateJoint(i);let d=null;{const t=new e.b2PolygonShape;t.SetAsBox(.1,1),(d=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:7.4,y:1}})).CreateFixture({shape:t,density:10})}const l=new e.b2DistanceJointDef;l.bodyA=n,l.bodyB=d,l.localAnchorA.Set(6,0),l.localAnchorB.Set(0,-1);const c=e.b2Vec2.Subtract(l.bodyB.GetWorldPoint(l.localAnchorB,new e.b2Vec2),l.bodyA.GetWorldPoint(l.localAnchorA,new e.b2Vec2),new e.b2Vec2);l.length=c.Length(),(0,e.b2LinearStiffness)(l,1,1,l.bodyA,l.bodyB),this.m_world.CreateJoint(l);{const t=.2,o=new e.b2CircleShape;o.m_radius=t;for(let n=0;n<4;++n){this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:5.9+2*t*n,y:2.4}}).CreateFixture({shape:o,density:10})}}}GetDefaultViewZoom(){return 50}getCenter(){return{x:0,y:5}}}(0,t.registerTest)("Examples","Dominos",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"CS84":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class r extends t.Test{constructor(){super(e.b2Vec2.ZERO);const t=new Array(4),r=new Array(2);t[0]=this.m_world.CreateBody({type:e.b2BodyType.b2_staticBody,angle:0,angularVelocity:0,linearDamping:0,angularDamping:0,allowSleep:!0,awake:!0,fixedRotation:!1,bullet:!1,enabled:!0,gravityScale:1});{const r=new e.b2EdgeShape;r.m_radius=.009999999776483,r.m_vertex0.Set(0,0),r.m_vertex1.Set(0,0),r.m_vertex2.Set(44.5217399597168,0),r.m_vertex3.Set(0,0),t[0].CreateFixture({friction:10,restitution:0,density:0,isSensor:!1,filter:{categoryBits:1,maskBits:65535,groupIndex:0},shape:r})}{const r=new e.b2EdgeShape;r.m_radius=.009999999776483,r.m_vertex0.Set(0,0),r.m_vertex1.Set(0,16.69565200805664),r.m_vertex2.Set(44.5217399597168,16.69565200805664),r.m_vertex3.Set(0,0),t[0].CreateFixture({friction:10,restitution:0,density:0,isSensor:!1,filter:{categoryBits:1,maskBits:65535,groupIndex:0},shape:r})}{const r=new e.b2EdgeShape;r.m_radius=.009999999776483,r.m_vertex0.Set(0,0),r.m_vertex1.Set(0,16.69565200805664),r.m_vertex2.Set(0,0),r.m_vertex3.Set(0,0),t[0].CreateFixture({friction:10,restitution:0,density:0,isSensor:!1,filter:{categoryBits:1,maskBits:65535,groupIndex:0},shape:r})}{const r=new e.b2EdgeShape;r.m_radius=.009999999776483,r.m_vertex0.Set(0,0),r.m_vertex1.Set(44.5217399597168,16.69565200805664),r.m_vertex2.Set(44.5217399597168,0),r.m_vertex3.Set(0,0),t[0].CreateFixture({friction:10,restitution:0,density:0,isSensor:!1,filter:{categoryBits:1,maskBits:65535,groupIndex:0},shape:r})}t[1]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:.847826063632965,y:2.5},angle:0,angularVelocity:0,linearDamping:.5,angularDamping:.5,allowSleep:!0,awake:!0,fixedRotation:!1,bullet:!1,enabled:!0,gravityScale:1});{const r=new e.b2PolygonShape,a=(0,e.b2MakeArray)(8,e.b2Vec2);a[0].Set(6.907599925994873,.327199995517731),a[1].Set(-.322800010442734,.282599985599518),a[2].Set(-.322800010442734,-.295700013637543),a[3].Set(6.885900020599365,-.364100009202957),r.Set(a,4),t[1].CreateFixture({friction:1,restitution:.5,density:10,isSensor:!1,filter:{categoryBits:1,maskBits:65535,groupIndex:0},shape:r})}t[2]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:13.04347801208496,y:2.5},angle:0,angularVelocity:0,linearDamping:.5,angularDamping:.5,allowSleep:!0,awake:!0,fixedRotation:!1,bullet:!1,enabled:!0,gravityScale:1});{const r=new e.b2PolygonShape,a=(0,e.b2MakeArray)(8,e.b2Vec2);a[0].Set(.200000002980232,-.300000011920929),a[1].Set(.200000002980232,.200000002980232),a[2].Set(-6.900000095367432,.200000002980232),a[3].Set(-6.900000095367432,-.300000011920929),r.Set(a,4),t[2].CreateFixture({friction:1,restitution:.5,density:10,isSensor:!1,filter:{categoryBits:1,maskBits:65535,groupIndex:0},shape:r})}t[3]=this.m_world.CreateBody({type:e.b2BodyType.b2_staticBody,angle:0,angularVelocity:0,linearDamping:0,angularDamping:0,allowSleep:!0,awake:!0,fixedRotation:!1,bullet:!1,enabled:!0,gravityScale:1});{const a=new e.b2RevoluteJointDef;a.bodyA=t[1],a.bodyB=t[0],a.collideConnected=!1,a.localAnchorA.Set(0,0),a.localAnchorB.Set(.847826063632965,2.5),a.referenceAngle=0,a.enableLimit=!1,a.lowerAngle=0,a.upperAngle=0,a.enableMotor=!1,a.motorSpeed=0,a.maxMotorTorque=0,r[0]=this.m_world.CreateJoint(a)}{const a=new e.b2PrismaticJointDef;a.bodyA=t[1],a.bodyB=t[2],a.collideConnected=!1,a.localAnchorA.Set(0,0),a.localAnchorB.Set(-12.19565200805664,0),a.localAxisA.Set(-1,0),a.referenceAngle=0,a.enableLimit=!0,a.lowerTranslation=-20,a.upperTranslation=0,a.enableMotor=!0,a.motorSpeed=0,a.maxMotorForce=10,r[1]=this.m_world.CreateJoint(a)}}getCenter(){return{x:15,y:5}}}(0,t.registerTest)("Examples","Dump Shell",r);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"fuN2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test"),o=require("../../utils/hotkeys"),r={aabb0:new t.b2AABB,c0:new t.b2Vec2,c1:new t.b2Vec2};class a{constructor(){this.aabb=new t.b2AABB,this.fraction=0,this.overlap=!1,this.proxyId=null}}class s extends e.Test{constructor(){super(),this.m_worldExtent=0,this.m_proxyExtent=0,this.m_tree=new t.b2DynamicTree,this.m_queryAABB=new t.b2AABB,this.m_rayCastInput=new t.b2RayCastInput,this.m_rayCastOutput=new t.b2RayCastOutput,this.m_rayActor=null,this.m_actors=Array.from({length:s.e_actorCount},()=>new a),this.m_stepCount=0,this.m_automated=!1,this.m_worldExtent=15,this.m_proxyExtent=.5;for(let t=0;t<s.e_actorCount;++t){const e=this.m_actors[t];this.GetRandomAABB(e.aabb),e.proxyId=this.m_tree.CreateProxy(e.aabb,e)}this.m_stepCount=0;const e=this.m_worldExtent;this.m_queryAABB.lowerBound.Set(-3,-4+e),this.m_queryAABB.upperBound.Set(5,6+e),this.m_rayCastInput.p1.Set(-5,5+e),this.m_rayCastInput.p2.Set(7,-4+e),this.m_rayCastInput.maxFraction=1,this.m_automated=!1}getCenter(){return{x:0,y:10}}Step(e,o){if(super.Step(e,o),this.Reset(),this.m_automated){const t=Math.max(1,s.e_actorCount>>2);for(let e=0;e<t;++e)this.Action()}this.Query(),this.RayCast();const r=e.m_debugDraw;for(let c=0;c<s.e_actorCount;++c){const e=this.m_actors[c];if(null===e.proxyId)continue;const o=new t.b2Color(.9,.9,.9);e===this.m_rayActor&&e.overlap?o.SetRGB(.9,.6,.6):e===this.m_rayActor?o.SetRGB(.6,.9,.6):e.overlap&&o.SetRGB(.6,.6,.9),r.DrawAABB(e.aabb,o)}const a=new t.b2Color(.7,.7,.7);r.DrawAABB(this.m_queryAABB,a),r.DrawSegment(this.m_rayCastInput.p1,this.m_rayCastInput.p2,a);const n=new t.b2Color(.2,.9,.2),i=new t.b2Color(.9,.2,.2);if(r.DrawPoint(this.m_rayCastInput.p1,6,n),r.DrawPoint(this.m_rayCastInput.p2,6,i),this.m_rayActor){const e=new t.b2Color(.2,.2,.9),o=t.b2Vec2.Add(this.m_rayCastInput.p1,t.b2Vec2.Scale(this.m_rayActor.fraction,t.b2Vec2.Subtract(this.m_rayCastInput.p2,this.m_rayCastInput.p1,new t.b2Vec2),new t.b2Vec2),new t.b2Vec2);r.DrawPoint(o,6,e)}this.addDebug("Dynamic Tree Height",this.m_tree.GetHeight()),++this.m_stepCount}getHotkeys(){return[(0,o.hotKeyPress)("a","Toggle Automated",()=>{this.m_automated=!this.m_automated}),(0,o.hotKeyPress)("c","Create Proxy",()=>this.CreateProxy()),(0,o.hotKeyPress)("d","Destroy Proxy",()=>this.DestroyProxy()),(0,o.hotKeyPress)("m","Move Proxy",()=>this.MoveProxy())]}GetRandomAABB(e){const o=new t.b2Vec2;o.Set(2*this.m_proxyExtent,2*this.m_proxyExtent),e.lowerBound.x=(0,t.b2RandomFloat)(-this.m_worldExtent,this.m_worldExtent),e.lowerBound.y=(0,t.b2RandomFloat)(0,2*this.m_worldExtent),e.upperBound.Copy(e.lowerBound),e.upperBound.Add(o)}MoveAABB(e){const o=new t.b2Vec2;o.x=(0,t.b2RandomFloat)(-.5,.5),o.y=(0,t.b2RandomFloat)(-.5,.5),e.lowerBound.Add(o),e.upperBound.Add(o);const r=t.b2Vec2.Mid(e.lowerBound,e.upperBound,new t.b2Vec2),a=new t.b2Vec2(-this.m_worldExtent,0),s=new t.b2Vec2(this.m_worldExtent,2*this.m_worldExtent),n=t.b2Vec2.Clamp(r,a,s,new t.b2Vec2);e.lowerBound.Add(t.b2Vec2.Subtract(n,r,new t.b2Vec2)),e.upperBound.Add(t.b2Vec2.Subtract(n,r,new t.b2Vec2))}CreateProxy(){for(let e=0;e<s.e_actorCount;++e){const e=(0,t.b2RandomInt)(0,s.e_actorCount-1),o=this.m_actors[e];if(null===o.proxyId)return this.GetRandomAABB(o.aabb),void(o.proxyId=this.m_tree.CreateProxy(o.aabb,o))}}DestroyProxy(){for(let e=0;e<s.e_actorCount;++e){const e=(0,t.b2RandomInt)(0,s.e_actorCount-1),o=this.m_actors[e];if(null!==o.proxyId)return this.m_tree.DestroyProxy(o.proxyId),void(o.proxyId=null)}}MoveProxy(){const{aabb0:e,c0:o,c1:a}=r;for(let r=0;r<s.e_actorCount;++r){const r=(0,t.b2RandomInt)(0,s.e_actorCount-1),n=this.m_actors[r];if(null===n.proxyId)continue;e.Copy(n.aabb),this.MoveAABB(n.aabb);const i=t.b2Vec2.Subtract(n.aabb.GetCenter(a),e.GetCenter(o),new t.b2Vec2);return void this.m_tree.MoveProxy(n.proxyId,n.aabb,i)}}Reset(){this.m_rayActor=null;for(let t=0;t<s.e_actorCount;++t)this.m_actors[t].fraction=1,this.m_actors[t].overlap=!1}Action(){switch(Math.floor((0,t.b2RandomFloat)(0,19))){case 0:this.CreateProxy();break;case 1:this.DestroyProxy();break;default:this.MoveProxy()}}Query(){this.m_tree.Query(this.m_queryAABB,e=>{const o=(0,t.b2Verify)(e.userData);return o.overlap=this.m_queryAABB.TestOverlap(o.aabb),!0});for(let e=0;e<s.e_actorCount;++e)if(null!==this.m_actors[e].proxyId){const o=this.m_queryAABB.TestOverlap(this.m_actors[e].aabb);(0,t.b2Assert)(o===this.m_actors[e].overlap)}}RayCast(){this.m_rayActor=null;const e=(new t.b2RayCastInput).Copy(this.m_rayCastInput);this.m_tree.RayCast(e,(e,o)=>{const r=(0,t.b2Verify)(o.userData),a=new t.b2RayCastOutput;return r.aabb.RayCast(a,e)?(this.m_rayCastOutput=a,this.m_rayActor=r,this.m_rayActor.fraction=a.fraction,a.fraction):e.maxFraction});let o=null;const r=new t.b2RayCastOutput;for(let a=0;a<s.e_actorCount;++a){if(null===this.m_actors[a].proxyId)continue;const s=new t.b2RayCastOutput;this.m_actors[a].aabb.RayCast(s,e)&&(o=this.m_actors[a],r.Copy(s),e.maxFraction=s.fraction)}}}s.e_actorCount=128,(0,e.registerTest)("Collision","Dynamic Tree",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"eWMO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),s=require("../../utils/hotkeys");class o extends t.Test{constructor(){super(),this.m_bodyIndex=0,this.m_circle=new e.b2CircleShape,this.m_angle=0,this.m_bodies=new Array(o.e_maxBodies),this.m_polygons=new Array(4);for(let t=0;t<4;++t)this.m_polygons[t]=new e.b2PolygonShape;{const t=this.m_world.CreateBody();let s=-20,o=2*Math.cos(s/10*Math.PI);for(let n=0;n<80;++n){const n=s+.5,r=2*Math.cos(n/10*Math.PI),i=new e.b2EdgeShape;i.SetTwoSided(new e.b2Vec2(s,o),new e.b2Vec2(n,r)),t.CreateFixture({shape:i}),s=n,o=r}}{const t=new Array(3);t[0]=new e.b2Vec2(-.5,0),t[1]=new e.b2Vec2(.5,0),t[2]=new e.b2Vec2(0,1.5),this.m_polygons[0].Set(t,3)}{const t=new Array(3);t[0]=new e.b2Vec2(-.1,0),t[1]=new e.b2Vec2(.1,0),t[2]=new e.b2Vec2(0,1.5),this.m_polygons[1].Set(t,3)}{const t=1,s=t/(2+Math.sqrt(2)),o=Math.sqrt(2)*s,n=new Array(8);n[0]=new e.b2Vec2(.5*o,0),n[1]=new e.b2Vec2(.5*t,s),n[2]=new e.b2Vec2(.5*t,s+o),n[3]=new e.b2Vec2(.5*o,t),n[4]=new e.b2Vec2(-.5*o,t),n[5]=new e.b2Vec2(-.5*t,s+o),n[6]=new e.b2Vec2(-.5*t,s),n[7]=new e.b2Vec2(-.5*o,0),this.m_polygons[2].Set(n,8)}this.m_polygons[3].SetAsBox(.5,.5),this.m_circle.m_radius=.5;for(let e=0;e<o.e_maxBodies;++e)this.m_bodies[e]=null}CreateBody(t){const s=this.m_bodies[this.m_bodyIndex];null!==s&&(this.m_world.DestroyBody(s),this.m_bodies[this.m_bodyIndex]=null);const n=this.m_bodies[this.m_bodyIndex]=this.m_world.CreateBody({position:{x:(0,e.b2RandomFloat)(-10,10),y:(0,e.b2RandomFloat)(10,20)},angle:(0,e.b2RandomFloat)(-Math.PI,Math.PI),type:e.b2BodyType.b2_dynamicBody,angularDamping:4===t?.02:0});t<4?n.CreateFixture({shape:this.m_polygons[t],friction:.3,density:20}):n.CreateFixture({shape:this.m_circle,friction:.3,density:20}),this.m_bodyIndex=(this.m_bodyIndex+1)%o.e_maxBodies}DestroyBody(){for(let e=0;e<o.e_maxBodies;++e){const t=this.m_bodies[e];if(null!==t)return this.m_world.DestroyBody(t),void(this.m_bodies[e]=null)}}getHotkeys(){return[(0,s.hotKeyPress)("1","Create Triangle",()=>this.CreateBody(0)),(0,s.hotKeyPress)("2","Create Flat Triangle",()=>this.CreateBody(1)),(0,s.hotKeyPress)("3","Create Octagon",()=>this.CreateBody(2)),(0,s.hotKeyPress)("4","Create Box",()=>this.CreateBody(3)),(0,s.hotKeyPress)("5","Create Circle",()=>this.CreateBody(4)),(0,s.hotKeyPress)("d","Destroy Body",()=>this.DestroyBody())]}Step(t,s){const o=!t.m_pause||t.m_singleStep;super.Step(t,s);const n=new e.b2Vec2(0,10),r=new e.b2Vec2(25*Math.cos(this.m_angle),-25*Math.abs(Math.sin(this.m_angle))),i=e.b2Vec2.Add(n,r,new e.b2Vec2);let a=null;const d=new e.b2Vec2,h=new e.b2Vec2;this.m_world.RayCast(n,i,(e,t,s,o)=>(a=e,d.Copy(t),h.Copy(s),o));const c=t.m_debugDraw;if(a){c.DrawPoint(d,5,new e.b2Color(.4,.9,.4)),c.DrawSegment(n,d,new e.b2Color(.8,.8,.8));const t=e.b2Vec2.Add(d,e.b2Vec2.Scale(.5,h,e.b2Vec2.s_t0),new e.b2Vec2);c.DrawSegment(d,t,new e.b2Color(.9,.9,.4))}else c.DrawSegment(n,i,new e.b2Color(.8,.8,.8));o&&(this.m_angle+=.25*Math.PI/180)}}o.e_maxBodies=256,(0,t.registerTest)("Geometry","Edge Shapes",o);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"nr7a":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Radio=exports.radioDef=void 0;const t=e(require("react"));function a(e,t,a,l){return{type:"radio",name:e,options:t,initialValue:a,update:l}}require("./style.scss"),exports.radioDef=a;const l=({control:e})=>t.default.createElement(t.default.Fragment,null,e.options.map(a=>t.default.createElement("label",{className:"radio",key:a},t.default.createElement("input",{name:e.name,type:"radio",className:"radio--input",value:a,onClick:()=>e.update(a),defaultChecked:e.initialValue===a}),t.default.createElement("span",null,a)))," ");exports.Radio=l;
},{"react":"dmLA","./style.scss":"GXLA"}],"DAjt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys"),s=require("../../ui/controls/Radio");class d extends t.Test{constructor(){super(),this.m_offset1=new e.b2Vec2,this.m_offset2=new e.b2Vec2,this.m_body1=null,this.m_body2=null;const t=[new e.b2Vec2(10,-4),new e.b2Vec2(10,0),new e.b2Vec2(6,0),new e.b2Vec2(4,2),new e.b2Vec2(2,0),new e.b2Vec2(-2,0),new e.b2Vec2(-6,0),new e.b2Vec2(-8,-3),new e.b2Vec2(-10,0),new e.b2Vec2(-10,-4)];this.m_offset1.Set(0,8),this.m_offset2.Set(0,16);{const o=t[0].Clone().Add(this.m_offset1),s=t[1].Clone().Add(this.m_offset1),d=t[2].Clone().Add(this.m_offset1),i=t[3].Clone().Add(this.m_offset1),r=t[4].Clone().Add(this.m_offset1),h=t[5].Clone().Add(this.m_offset1),n=t[6].Clone().Add(this.m_offset1),y=t[7].Clone().Add(this.m_offset1),l=t[8].Clone().Add(this.m_offset1),a=t[9].Clone().Add(this.m_offset1),m=this.m_world.CreateBody(),_=new e.b2EdgeShape;_.SetOneSided(a,o,s,d),m.CreateFixture({shape:_}),_.SetOneSided(o,s,d,i),m.CreateFixture({shape:_}),_.SetOneSided(s,d,i,r),m.CreateFixture({shape:_}),_.SetOneSided(d,i,r,h),m.CreateFixture({shape:_}),_.SetOneSided(i,r,h,n),m.CreateFixture({shape:_}),_.SetOneSided(r,h,n,y),m.CreateFixture({shape:_}),_.SetOneSided(h,n,y,l),m.CreateFixture({shape:_}),_.SetOneSided(n,y,l,a),m.CreateFixture({shape:_}),_.SetOneSided(y,l,a,o),m.CreateFixture({shape:_}),_.SetOneSided(l,a,o,s),m.CreateFixture({shape:_})}{const o=t[0].Clone().Add(this.m_offset2),s=t[1].Clone().Add(this.m_offset2),d=t[2].Clone().Add(this.m_offset2),i=t[3].Clone().Add(this.m_offset2),r=t[4].Clone().Add(this.m_offset2),h=t[5].Clone().Add(this.m_offset2),n=t[6].Clone().Add(this.m_offset2),y=t[7].Clone().Add(this.m_offset2),l=t[8].Clone().Add(this.m_offset2),a=t[9].Clone().Add(this.m_offset2),m=this.m_world.CreateBody(),_=new e.b2EdgeShape;_.SetTwoSided(o,s),m.CreateFixture({shape:_}),_.SetTwoSided(s,d),m.CreateFixture({shape:_}),_.SetTwoSided(d,i),m.CreateFixture({shape:_}),_.SetTwoSided(i,r),m.CreateFixture({shape:_}),_.SetTwoSided(r,h),m.CreateFixture({shape:_}),_.SetTwoSided(h,n),m.CreateFixture({shape:_}),_.SetTwoSided(n,y),m.CreateFixture({shape:_}),_.SetTwoSided(y,l),m.CreateFixture({shape:_}),_.SetTwoSided(l,a),m.CreateFixture({shape:_}),_.SetTwoSided(a,o),m.CreateFixture({shape:_})}this.m_body1=null,this.m_body2=null,this.CreateBoxes()}setupControls(){this.addTestControlGroup("Custom",[(0,s.radioDef)("Type",["Boxes","Circles"],"Boxes",e=>{"Boxes"===e?this.CreateBoxes():this.CreateCircles()})])}CreateBoxes(){this.m_body1&&(this.m_world.DestroyBody(this.m_body1),this.m_body1=null),this.m_body2&&(this.m_world.DestroyBody(this.m_body2),this.m_body2=null);{this.m_body1=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:8+this.m_offset1.x,y:2.6+this.m_offset1.y},allowSleep:!1});const t=new e.b2PolygonShape;t.SetAsBox(.5,1),this.m_body1.CreateFixture({shape:t,density:1})}{this.m_body2=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:8+this.m_offset2.x,y:2.6+this.m_offset2.y},allowSleep:!1});const t=new e.b2PolygonShape;t.SetAsBox(.5,1),this.m_body2.CreateFixture({shape:t,density:1})}}CreateCircles(){this.m_body1&&(this.m_world.DestroyBody(this.m_body1),this.m_body1=null),this.m_body2&&(this.m_world.DestroyBody(this.m_body2),this.m_body2=null);{this.m_body1=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:this.m_offset1.x-.5,y:this.m_offset1.y+.6},allowSleep:!1});const t=new e.b2CircleShape(.5);this.m_body1.CreateFixture({shape:t,density:1})}{this.m_body2=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:this.m_offset2.x-.5,y:this.m_offset2.y+.6},allowSleep:!1});const t=new e.b2CircleShape(.5);this.m_body2.CreateFixture({shape:t,density:1})}}getHotkeys(){return[(0,o.hotKeyStep)("a","Apply Force Left",()=>{var t,o;null===(t=this.m_body1)||void 0===t||t.ApplyForceToCenter(new e.b2Vec2(-10,0),!0),null===(o=this.m_body2)||void 0===o||o.ApplyForceToCenter(new e.b2Vec2(-10,0),!0)}),(0,o.hotKeyStep)("d","Apply Force Right",()=>{var t,o;null===(t=this.m_body1)||void 0===t||t.ApplyForceToCenter(new e.b2Vec2(10,0),!0),null===(o=this.m_body2)||void 0===o||o.ApplyForceToCenter(new e.b2Vec2(10,0),!0)})]}}(0,t.registerTest)("Geometry","Edge Test",d);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t","../../ui/controls/Radio":"nr7a"}],"i4wY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-50,0),new e.b2Vec2(50,0)),t.CreateFixture({shape:o})}{const t=new e.b2CircleShape;t.m_radius=1;const o=new e.b2PolygonShape;o.SetAsBox(.5,5);const i=new e.b2CircleShape;i.m_radius=2;const n={x:10,y:9},s=this.m_world.CreateBody({type:e.b2BodyType.b2_staticBody,position:n});s.CreateFixture({shape:t,density:5});const r=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:10,y:8}});r.CreateFixture({shape:o,density:5});const a={x:10,y:6},d=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:a});d.CreateFixture({shape:i,density:5});const y=new e.b2RevoluteJointDef;y.Initialize(r,s,n);const c=this.m_world.CreateJoint(y),l=new e.b2RevoluteJointDef;l.Initialize(r,d,a);const b=this.m_world.CreateJoint(l),_=new e.b2GearJointDef;_.bodyA=s,_.bodyB=d,_.joint1=c,_.joint2=b,_.ratio=i.m_radius/t.m_radius,this.m_world.CreateJoint(_)}{const o=new e.b2CircleShape;o.m_radius=1;const i=new e.b2CircleShape;i.m_radius=2;const n=new e.b2PolygonShape;n.SetAsBox(.5,5);const s={x:-3,y:12},r=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:s});r.CreateFixture({shape:o,density:5});const a=new e.b2RevoluteJointDef;a.bodyA=t,a.bodyB=r,t.GetLocalPoint(s,a.localAnchorA),r.GetLocalPoint(s,a.localAnchorB),a.referenceAngle=r.GetAngle()-t.GetAngle(),this.m_joint1=this.m_world.CreateJoint(a);const d={x:0,y:12},y=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:d});y.CreateFixture({shape:i,density:5});const c=new e.b2RevoluteJointDef;c.Initialize(t,y,d),this.m_joint2=this.m_world.CreateJoint(c);const l={x:2.5,y:12},b=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:l});b.CreateFixture({shape:n,density:5});const _=new e.b2PrismaticJointDef;_.Initialize(t,b,l,new e.b2Vec2(0,1)),_.lowerTranslation=-5,_.upperTranslation=5,_.enableLimit=!0,this.m_joint3=this.m_world.CreateJoint(_);const h=new e.b2GearJointDef;h.bodyA=r,h.bodyB=y,h.joint1=this.m_joint1,h.joint2=this.m_joint2,h.ratio=i.m_radius/o.m_radius,this.m_joint4=this.m_world.CreateJoint(h);const m=new e.b2GearJointDef;m.bodyA=y,m.bodyB=b,m.joint1=this.m_joint2,m.joint2=this.m_joint3,m.ratio=-1/i.m_radius,this.m_joint5=this.m_world.CreateJoint(m)}}}(0,t.registerTest)("Joints","Gear",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"R2Cf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class r extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),r=new e.b2EdgeShape;r.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:r})}let t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:.5}});const r=new e.b2CircleShape;r.m_radius=.5,t.CreateFixture({shape:r,density:10}),t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:6}}),r.m_radius=5,t.CreateFixture({shape:r,density:10})}}(0,t.registerTest)("Solver","Heavy 1",r);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"ysiq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../utils/hotkeys"),s=require("../../test");class o extends s.Test{constructor(){super(),this.m_heavy=null;{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s})}let t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:2.5}});const s=new e.b2CircleShape;s.m_radius=.5,t.CreateFixture({shape:s,density:10}),(t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:3.5}})).CreateFixture({shape:s,density:10})}ToggleHeavy(){if(null!==this.m_heavy)this.m_world.DestroyBody(this.m_heavy),this.m_heavy=null;else{this.m_heavy=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:9}});const t=new e.b2CircleShape;t.m_radius=5,this.m_heavy.CreateFixture({shape:t,density:10})}}getHotkeys(){return[(0,t.hotKeyPress)("h","Toggle Heavy",()=>this.ToggleHeavy())]}}(0,s.registerTest)("Solver","Heavy 2",o);
},{"@box2d/core":"FjWk","../../utils/hotkeys":"EV9t","../../test":"XTIe"}],"WWBw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),o=require("../../test");class t extends o.Test{constructor(){super();const o=this.m_world.CreateBody({position:{x:0,y:20}}),t=new e.b2Vec2(0,.5),r=this.AddNode(o,e.b2Vec2.ZERO,0,3,.5),n=new e.b2RevoluteJointDef;n.bodyA=o,n.bodyB=r,n.localAnchorA.SetZero(),n.localAnchorB.Copy(t),this.m_world.CreateJoint(n)}GetDefaultViewZoom(){return 60}getCenter(){return{x:0,y:15}}AddNode(o,r,n,d,s){const i=new e.b2Vec2(0,s),c=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:o.GetPosition().Clone().Add(r).Subtract(i)}),l=new e.b2PolygonShape;if(l.SetAsBox(.25*s,s),c.CreateFixture({shape:l,density:20}),n===t.e_depth)return c;const y=new e.b2Vec2(d,-s),a=new e.b2Vec2(-d,-s),b=this.AddNode(c,y,n+1,.5*d,s),h=this.AddNode(c,a,n+1,.5*d,s),u=new e.b2RevoluteJointDef;return u.bodyA=c,u.localAnchorB.Copy(i),u.localAnchorA.Copy(y),u.bodyB=b,this.m_world.CreateJoint(u),u.localAnchorA.Copy(a),u.bodyB=h,this.m_world.CreateJoint(u),c}}t.e_depth=4,(0,o.registerTest)("Solver","Mobile Unbalanced",t);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"potL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),o=require("../../test");class t extends o.Test{constructor(){super();const o=this.m_world.CreateBody({position:{x:0,y:20}}),t=new e.b2Vec2(0,.5),r=this.AddNode(o,e.b2Vec2.ZERO,0,3,.5),n=new e.b2RevoluteJointDef;n.bodyA=o,n.bodyB=r,n.localAnchorA.SetZero(),n.localAnchorB.Copy(t),this.m_world.CreateJoint(n)}GetDefaultViewZoom(){return 60}getCenter(){return{x:0,y:15}}AddNode(o,r,n,d,s){const i=new e.b2Vec2(0,s),c=o.GetPosition().Clone().Add(r).Subtract(i),l=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:c}),a=new e.b2PolygonShape;if(a.SetAsBox(.25*s,s),l.CreateFixture({shape:a,density:20}),n===t.e_depth)return l;a.SetAsBox(d,.25*s,new e.b2Vec2(0,-s),0),l.CreateFixture({shape:a,density:20});const y=new e.b2Vec2(d,-s),b=new e.b2Vec2(-d,-s),h=this.AddNode(l,y,n+1,.5*d,s),u=this.AddNode(l,b,n+1,.5*d,s),A=new e.b2RevoluteJointDef;return A.bodyA=l,A.localAnchorB.Copy(i),A.localAnchorA.Copy(y),A.bodyB=h,this.m_world.CreateJoint(A),A.localAnchorA.Copy(b),A.bodyB=u,this.m_world.CreateJoint(A),l}}t.e_depth=4,(0,o.registerTest)("Solver","Mobile Balanced",t);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"dDqt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),i=require("../../utils/hotkeys");class s extends t.Test{constructor(){super(),this.m_time=0,this.m_go=!1;let t=null;{t=this.m_world.CreateBody();const i=new e.b2EdgeShape;i.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture({shape:i})}{const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:8}}),s=new e.b2PolygonShape;s.SetAsBox(2,.5),i.CreateFixture({shape:s,friction:.6,density:2});const o=new e.b2MotorJointDef;o.Initialize(t,i),o.maxForce=1e3,o.maxTorque=1e3,this.m_joint=this.m_world.CreateJoint(o)}this.m_go=!1,this.m_time=0}getHotkeys(){return[(0,i.hotKeyPress)("s","Start/Stop",()=>{this.m_go=!this.m_go})]}Step(t,i){this.m_go&&t.m_hertz>0&&(this.m_time+=1/t.m_hertz);const s=new e.b2Vec2;s.x=6*Math.sin(2*this.m_time),s.y=8+4*Math.sin(1*this.m_time);const o=4*this.m_time;this.m_joint.SetLinearOffset(s),this.m_joint.SetAngularOffset(o),t.m_debugDraw.DrawPoint(s,4,new e.b2Color(.9,.9,.9)),super.Step(t,i)}}(0,t.registerTest)("Joints","Motor Joint",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"ENhL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");var o;!function(e){e[e.e_unknown=0]="e_unknown",e[e.e_above=1]="e_above",e[e.e_below=2]="e_below"}(o||(o={}));class r extends t.Test{constructor(){super(),this.m_radius=0,this.m_top=0,this.m_bottom=0,this.m_state=o.e_unknown;{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture({shape:o})}{const t=this.m_world.CreateBody({position:{x:0,y:10}}),o=new e.b2PolygonShape;o.SetAsBox(3,.5),this.m_platform=t.CreateFixture({shape:o}),this.m_bottom=9.5,this.m_top=10.5}{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:12}});this.m_radius=.5;const r=new e.b2CircleShape;r.m_radius=this.m_radius,this.m_character=t.CreateFixture({shape:r,density:20}),t.SetLinearVelocity(new e.b2Vec2(0,-50)),this.m_state=o.e_unknown}}GetDefaultViewZoom(){return 40}getCenter(){return{x:0,y:5}}PreSolve(t,o){super.PreSolve(t,o);const r=t.GetFixtureA(),s=t.GetFixtureB();r!==this.m_platform&&r!==this.m_character||s!==this.m_platform&&s!==this.m_character||this.m_character.GetBody().GetPosition().y<this.m_top+this.m_radius-3*e.b2_linearSlop&&t.SetEnabled(!1)}}(0,t.registerTest)("Examples","Platformer",r);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"aJvN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys");class r extends t.Test{constructor(){super();let t=null;{t=this.m_world.CreateBody();const o=(0,e.b2MakeArray)(5,e.b2Vec2);o[0].Set(-8,6),o[1].Set(-8,20),o[2].Set(8,20),o[3].Set(8,6),o[4].Set(0,-2);const r=new e.b2ChainShape;r.CreateLoop(o,5),t.CreateFixture({shape:r,density:0})}{const o=new e.b2Vec2(-2,0),r=new e.b2Vec2(2,0),i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:o}),n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:r}),s=new e.b2PolygonShape;s.SetAsBox(1.75,.1);const l={shape:s,density:1};i.CreateFixture(l),n.CreateFixture(l);const a=new e.b2RevoluteJointDef;a.bodyA=t,a.localAnchorB.SetZero(),a.enableMotor=!0,a.maxMotorTorque=1e3,a.enableLimit=!0,a.motorSpeed=-10,a.localAnchorA.Copy(o),a.bodyB=i,a.lowerAngle=-30*Math.PI/180,a.upperAngle=5*Math.PI/180,this.m_leftJoint=this.m_world.CreateJoint(a),a.motorSpeed=10,a.localAnchorA.Copy(r),a.bodyB=n,a.lowerAngle=-5*Math.PI/180,a.upperAngle=30*Math.PI/180,this.m_rightJoint=this.m_world.CreateJoint(a)}{this.m_ball=this.m_world.CreateBody({position:{x:1,y:15},type:e.b2BodyType.b2_dynamicBody,bullet:!0});const t=new e.b2CircleShape;t.m_radius=.2;const o={shape:t,density:1};this.m_ball.CreateFixture(o)}}GetDefaultViewZoom(){return 40}getCenter(){return{x:0,y:5}}getHotkeys(){return[(0,o.hotKey)("a","Hold Flipper",e=>{e?(this.m_leftJoint.SetMotorSpeed(20),this.m_rightJoint.SetMotorSpeed(-20)):(this.m_leftJoint.SetMotorSpeed(-10),this.m_rightJoint.SetMotorSpeed(10))})]}}(0,t.registerTest)("Examples","Pinball",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"iHGO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),o=require("../../test"),s=require("../../utils/hotkeys");class e extends o.Test{constructor(){super(),this.m_polygonA=new t.b2PolygonShape,this.m_polygonB=new t.b2PolygonShape,this.m_transformA=new t.b2Transform,this.m_transformB=new t.b2Transform,this.m_positionB=new t.b2Vec2,this.m_angleB=0,this.m_polygonA.SetAsBox(.2,.4),this.m_transformA.SetPositionAngle(new t.b2Vec2,0),this.m_polygonB.SetAsBox(.5,.5),this.m_positionB.Set(1,1),this.m_angleB=1.9160721,this.m_transformB.SetPositionAngle(this.m_positionB,this.m_angleB)}GetDefaultViewZoom(){return 100}getHotkeys(){return[(0,s.hotKeyPress)("a","Move Left",()=>this.Adjust(-.1,0,0)),(0,s.hotKeyPress)("d","Move Right",()=>this.Adjust(.1,0,0)),(0,s.hotKeyPress)("s","Move Down",()=>this.Adjust(0,-.1,0)),(0,s.hotKeyPress)("w","Move Up",()=>this.Adjust(0,.1,0)),(0,s.hotKeyPress)("q","Turn Left",()=>this.Adjust(0,0,.1*Math.PI)),(0,s.hotKeyPress)("e","Turn Right",()=>this.Adjust(0,0,-.1*Math.PI))]}Adjust(t,o,s){this.m_positionB.x+=t,this.m_positionB.y+=o,this.m_angleB+=s,this.m_transformB.SetPositionAngle(this.m_positionB,this.m_angleB)}Step(o,s){super.Step(o,s);const e=new t.b2Manifold;(0,t.b2CollidePolygons)(e,this.m_polygonA,this.m_transformA,this.m_polygonB,this.m_transformB);const n=new t.b2WorldManifold;n.Initialize(e,this.m_transformA,this.m_polygonA.m_radius,this.m_transformB,this.m_polygonB.m_radius),this.addDebug("Point Count",e.pointCount);const i=o.m_debugDraw;{const o=new t.b2Color(.9,.9,.9),s=[];for(let e=0;e<this.m_polygonA.m_count;++e)s[e]=t.b2Transform.MultiplyVec2(this.m_transformA,this.m_polygonA.m_vertices[e],new t.b2Vec2);i.DrawPolygon(s,this.m_polygonA.m_count,o);for(let e=0;e<this.m_polygonB.m_count;++e)s[e]=t.b2Transform.MultiplyVec2(this.m_transformB,this.m_polygonB.m_vertices[e],new t.b2Vec2);i.DrawPolygon(s,this.m_polygonB.m_count,o)}for(let r=0;r<e.pointCount;++r)i.DrawPoint(n.points[r],4,new t.b2Color(.9,.3,.3))}}(0,o.registerTest)("Geometry","Polygon Collision",e);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"TsIM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys"),s=4,r={Step:{circle:new e.b2CircleShape,transform:new e.b2Transform}};class n extends t.Test{constructor(){super(),this.m_bodyIndex=0,this.m_bodies=Array.from({length:n.e_maxBodies},()=>null),this.m_polygons=Array.from({length:4},()=>new e.b2PolygonShape),this.m_circle=new e.b2CircleShape;{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const t=new Array(3);t[0]=new e.b2Vec2(-.5,0),t[1]=new e.b2Vec2(.5,0),t[2]=new e.b2Vec2(0,1.5),this.m_polygons[0].Set(t,3)}{const t=new Array(3);t[0]=new e.b2Vec2(-.1,0),t[1]=new e.b2Vec2(.1,0),t[2]=new e.b2Vec2(0,1.5),this.m_polygons[1].Set(t,3)}{const t=1,o=t/(2+Math.sqrt(2)),s=Math.sqrt(2)*o,r=new Array(8);r[0]=new e.b2Vec2(.5*s,0),r[1]=new e.b2Vec2(.5*t,o),r[2]=new e.b2Vec2(.5*t,o+s),r[3]=new e.b2Vec2(.5*s,t),r[4]=new e.b2Vec2(-.5*s,t),r[5]=new e.b2Vec2(-.5*t,o+s),r[6]=new e.b2Vec2(-.5*t,o),r[7]=new e.b2Vec2(-.5*s,0),this.m_polygons[2].Set(r,8)}this.m_polygons[3].SetAsBox(.5,.5),this.m_circle.m_radius=.5;for(let e=0;e<n.e_maxBodies;++e)this.m_bodies[e]=null}CreateBody(t){let o=this.m_bodies[this.m_bodyIndex];o&&(this.m_world.DestroyBody(o),this.m_bodies[this.m_bodyIndex]=null),o=this.m_bodies[this.m_bodyIndex]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:(0,e.b2RandomFloat)(-2,2),y:10},angle:(0,e.b2RandomFloat)(-Math.PI,Math.PI),angularDamping:4===t?.02:0}),t<4?o.CreateFixture({shape:this.m_polygons[t],density:1,friction:.3}):o.CreateFixture({shape:this.m_circle,density:1,friction:.3}),this.m_bodyIndex=(this.m_bodyIndex+1)%n.e_maxBodies}DestroyBody(){for(let e=0;e<n.e_maxBodies;++e){const t=this.m_bodies[e];if(t)return this.m_world.DestroyBody(t),void(this.m_bodies[e]=null)}}getHotkeys(){return[(0,o.hotKeyPress)("1","Create Triangle",()=>this.CreateBody(0)),(0,o.hotKeyPress)("2","Create Flat Triangle",()=>this.CreateBody(1)),(0,o.hotKeyPress)("3","Create Octagon",()=>this.CreateBody(2)),(0,o.hotKeyPress)("4","Create Box",()=>this.CreateBody(3)),(0,o.hotKeyPress)("5","Create Circle",()=>this.CreateBody(4)),(0,o.hotKeyPress)("a","Toggle Enabled of Even Bodies",()=>{for(let e=0;e<n.e_maxBodies;e+=2){const t=this.m_bodies[e];t&&t.SetEnabled(!t.IsEnabled())}}),(0,o.hotKeyPress)("d","Destroy Body",()=>this.DestroyBody())]}Step(t,o){super.Step(t,o);const n=t.m_debugDraw;let i=0;const{circle:d,transform:a}=r.Step;d.m_radius=2,d.m_p.Set(0,1.1),a.SetIdentity();const y=new e.b2AABB;d.ComputeAABB(y,a,0),this.m_world.QueryAABB(y,t=>{if(i===s)return!1;const o=t.GetBody(),r=t.GetShape();if((0,e.b2TestOverlap)(r,0,d,0,o.GetTransform(),a)){const t=new e.b2Color(.95,.95,.6),s=o.GetWorldCenter();n.DrawPoint(s,5,t),++i}return!0});const h=new e.b2Color(.4,.7,.8);n.DrawCircle(d.m_p,d.m_radius,h)}}n.e_maxBodies=256,(0,t.registerTest)("Geometry","Polygon Shapes",n);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"eXYw":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var a in r)"default"!==a&&Object.prototype.hasOwnProperty.call(r,a)&&e(n,r,a);return t(n,r),n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Slider=exports.sliderDef=void 0;const n=r(require("react"));function a(e,t,r,n,a,i){return{type:"slider",name:e,min:t,max:r,step:n,initialValue:a,update:i}}function i({control:e}){const[t,r]=(0,n.useState)(e.initialValue);return n.default.createElement("label",{className:"slider"},n.default.createElement("div",{className:"slider--input"},n.default.createElement("input",{type:"range",min:e.min,max:e.max,step:e.step,defaultValue:t,onChange:t=>{const n=parseFloat(t.currentTarget.value);r(n),e.update(n)}}),n.default.createElement("span",null,t)),e.name.split("#")[0])}require("./style.scss"),exports.sliderDef=a,exports.Slider=i;
},{"react":"dmLA","./style.scss":"GXLA"}],"KOHz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys"),i=require("../../ui/controls/Checkbox"),s=require("../../ui/controls/Slider");class r extends t.Test{constructor(){super(),this.m_motorSpeed=10,this.m_enableMotor=!1,this.m_enableLimit=!0;let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const o=new e.b2PolygonShape;o.SetAsBox(1,1);const i={x:0,y:10},s=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:i,angle:.5*Math.PI,allowSleep:!1});s.CreateFixture({shape:o,density:5});const r=new e.b2PrismaticJointDef;r.Initialize(t,s,i,new e.b2Vec2(1,0)),r.motorSpeed=this.m_motorSpeed,r.maxMotorForce=1e4,r.enableMotor=this.m_enableMotor,r.lowerTranslation=-10,r.upperTranslation=10,r.enableLimit=this.m_enableLimit,this.m_joint=this.m_world.CreateJoint(r)}}setupControls(){this.addTestControlGroup("Joint",[(0,i.checkboxDef)("Limit",this.m_enableLimit,e=>{this.m_enableLimit=this.m_joint.EnableLimit(e)}),(0,i.checkboxDef)("Motor",this.m_enableMotor,e=>{this.m_enableMotor=this.m_joint.EnableMotor(e)}),(0,s.sliderDef)("Speed",-100,100,1,this.m_motorSpeed,e=>{this.m_motorSpeed=this.m_joint.SetMotorSpeed(e)})])}getHotkeys(){return[(0,o.hotKeyPress)("l","Toggle Limit",()=>this.m_joint.EnableLimit(!this.m_joint.IsLimitEnabled())),(0,o.hotKeyPress)("m","Start/Stop",()=>this.m_joint.EnableMotor(!this.m_joint.IsMotorEnabled())),(0,o.hotKeyPress)("s","Reverse Direction",()=>this.m_joint.SetMotorSpeed(-this.m_joint.GetMotorSpeed()))]}Step(e,t){super.Step(e,t);const o=this.m_joint.GetMotorForce(e.m_hertz);this.addDebug("Motor Force",o.toFixed())}}(0,t.registerTest)("Joints","Prismatic",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t","../../ui/controls/Checkbox":"preb","../../ui/controls/Slider":"eXYw"}],"jYYg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class i extends t.Test{constructor(){super();const t=16;let i=null;{i=this.m_world.CreateBody();const t=new e.b2CircleShape;t.m_radius=2,t.m_p.Set(-10,30),i.CreateFixture({shape:t}),t.m_p.Set(10,30),i.CreateFixture({shape:t})}{const i=new e.b2PolygonShape;i.SetAsBox(1,2);const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-10,y:t}});o.CreateFixture({shape:i,density:5});const s=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:10,y:t}});s.CreateFixture({shape:i,density:5});const n=new e.b2PulleyJointDef,r=new e.b2Vec2(-10,18),d=new e.b2Vec2(10,18),a=new e.b2Vec2(-10,30),u=new e.b2Vec2(10,30);n.Initialize(o,s,a,u,r,d,1.5),this.m_joint1=this.m_world.CreateJoint(n)}}getCenter(){return{x:0,y:15}}Step(e,t){super.Step(e,t),this.addDebug("Ratio",this.m_joint1.GetRatio().toFixed(2)),this.addDebug("Length A",this.m_joint1.GetCurrentLengthA().toFixed(2)),this.addDebug("Length B",this.m_joint1.GetCurrentLengthB().toFixed(2))}}(0,t.registerTest)("Joints","Pulley",i);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"ZYXC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const t=.5,r=new e.b2PolygonShape;r.SetAsBox(t,t);const s=new e.b2Vec2(-7,.75),n=new e.b2Vec2,c=new e.b2Vec2(.5625,1.25),d=new e.b2Vec2(1.125,0);for(let i=0;i<o.e_count;++i){n.Copy(s);for(let t=i;t<o.e_count;++t){this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:n}).CreateFixture({shape:r,density:5}),n.Add(d)}s.Add(c)}}}}o.e_count=20,(0,t.registerTest)("Stacking","Pyramid",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"M6wA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),s=require("../../utils/hotkeys"),o=require("../../ui/controls/Radio"),r=require("../../ui/controls/Slider");class a extends t.Test{constructor(){super(),this.m_bodyIndex=0,this.m_bodies=[],this.m_polygons=(0,e.b2MakeArray)(4,e.b2PolygonShape),this.m_circle=new e.b2CircleShape,this.m_edge=new e.b2EdgeShape,this.m_degrees=0,this.m_mode="Closest";{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s})}{const t=(0,e.b2MakeArray)(3,e.b2Vec2);t[0].Set(-.5,0),t[1].Set(.5,0),t[2].Set(0,1.5),this.m_polygons[0].Set(t,3)}{const t=(0,e.b2MakeArray)(3,e.b2Vec2);t[0].Set(-.1,0),t[1].Set(.1,0),t[2].Set(0,1.5),this.m_polygons[1].Set(t,3)}{const t=1,s=t/(2+Math.sqrt(2)),o=Math.sqrt(2)*s,r=(0,e.b2MakeArray)(8,e.b2Vec2);r[0].Set(.5*o,0),r[1].Set(.5*t,s),r[2].Set(.5*t,s+o),r[3].Set(.5*o,t),r[4].Set(-.5*o,t),r[5].Set(-.5*t,s+o),r[6].Set(-.5*t,s),r[7].Set(-.5*o,0),this.m_polygons[2].Set(r,8)}this.m_polygons[3].SetAsBox(.5,.5),this.m_circle.m_radius=.5,this.m_edge.SetTwoSided(new e.b2Vec2(-1,0),new e.b2Vec2(1,0)),this.m_bodyIndex=0;for(let e=0;e<a.e_maxBodies;++e)this.m_bodies[e]=null}setupControls(){this.addTestControlGroup("Ray-cast",[(0,o.radioDef)("Mode",["Any","Closest","Multiple"],this.m_mode,e=>{this.m_mode=e}),(0,r.sliderDef)("Angle",0,360,1,this.m_degrees,e=>{this.m_degrees=e})])}CreateBody(t){const s=this.m_bodies[this.m_bodyIndex];null!==s&&(this.m_world.DestroyBody(s),this.m_bodies[this.m_bodyIndex]=null);const o=this.m_bodies[this.m_bodyIndex]=this.m_world.CreateBody({position:{x:(0,e.b2RandomFloat)(-10,10),y:(0,e.b2RandomFloat)(0,20)},angle:(0,e.b2RandomFloat)(-Math.PI,Math.PI),angularDamping:4===t?.02:0});t<4?o.CreateFixture({shape:this.m_polygons[t],friction:.3,userData:{index:t}}):t<5?o.CreateFixture({shape:this.m_circle,friction:.3,userData:{index:t}}):o.CreateFixture({shape:this.m_edge,friction:.3,userData:{index:t}}),this.m_bodyIndex=(this.m_bodyIndex+1)%a.e_maxBodies}DestroyBody(){for(let e=0;e<a.e_maxBodies;++e){const t=this.m_bodies[e];if(null!==t)return this.m_world.DestroyBody(t),void(this.m_bodies[e]=null)}}getHotkeys(){return[(0,s.hotKeyPress)("1","Create Triangle",()=>this.CreateBody(0)),(0,s.hotKeyPress)("2","Create Flat Triangle",()=>this.CreateBody(1)),(0,s.hotKeyPress)("3","Create Octagon",()=>this.CreateBody(2)),(0,s.hotKeyPress)("4","Create Box",()=>this.CreateBody(3)),(0,s.hotKeyPress)("5","Create Circle",()=>this.CreateBody(4)),(0,s.hotKeyPress)("6","Create Edge",()=>this.CreateBody(5)),(0,s.hotKeyPress)("d","Destroy Body",()=>this.DestroyBody())]}Step(t,s){super.Step(t,s);const o=(0,e.b2DegToRad)(this.m_degrees),r=new e.b2Vec2(0,10),a=new e.b2Vec2(11*Math.cos(o),11*Math.sin(o)),i=e.b2Vec2.Add(r,a,new e.b2Vec2);switch(this.addText("Shape 1 is intentionally ignored by the ray"),this.m_mode){case"Closest":this.addDebug("Ray-Cast Mode","Find closest fixture along the ray"),this.rayCastClosest(r,i,t);break;case"Any":this.addDebug("Ray-Cast Mode","Check for obstruction"),this.rayCastAny(r,i,t);break;case"Multiple":this.addDebug("Ray-Cast Mode","Gather multiple fixtures"),this.rayCastMultiple(r,i,t)}}rayCastClosest(t,s,o){let r=!1;const a=new e.b2Vec2,i=new e.b2Vec2;this.m_world.RayCast(t,s,(e,t,s,o)=>{const n=e.GetUserData();return 0===(null==n?void 0:n.index)?-1:(r=!0,a.Copy(t),i.Copy(s),o)});const n=o.m_debugDraw;if(r){n.DrawPoint(a,5,new e.b2Color(.4,.9,.4)),n.DrawSegment(t,a,new e.b2Color(.8,.8,.8));const s=e.b2Vec2.Add(a,e.b2Vec2.Scale(.5,i,e.b2Vec2.s_t0),new e.b2Vec2);n.DrawSegment(a,s,new e.b2Color(.9,.9,.4))}else n.DrawSegment(t,s,new e.b2Color(.8,.8,.8))}rayCastAny(t,s,o){let r=!1;const a=new e.b2Vec2,i=new e.b2Vec2;this.m_world.RayCast(t,s,(e,t,s,o)=>{const n=e.GetUserData();return 0===(null==n?void 0:n.index)?-1:(r=!0,a.Copy(t),i.Copy(s),0)});const n=o.m_debugDraw;if(r){n.DrawPoint(a,5,new e.b2Color(.4,.9,.4)),n.DrawSegment(t,a,new e.b2Color(.8,.8,.8));const s=e.b2Vec2.Add(a,e.b2Vec2.Scale(.5,i,e.b2Vec2.s_t0),new e.b2Vec2);n.DrawSegment(a,s,new e.b2Color(.9,.9,.4))}else n.DrawSegment(t,s,new e.b2Color(.8,.8,.8))}rayCastMultiple(t,s,o){const r=(0,e.b2MakeArray)(3,e.b2Vec2),a=(0,e.b2MakeArray)(3,e.b2Vec2);let i=0;this.m_world.RayCast(t,s,(e,t,s)=>{const o=e.GetUserData();return 0===(null==o?void 0:o.index)?-1:(r[i].Copy(t),a[i].Copy(s),3===++i?0:1)});const n=o.m_debugDraw;n.DrawSegment(t,s,new e.b2Color(.8,.8,.8));for(let d=0;d<i;++d){const s=r[d],o=a[d];n.DrawPoint(s,5,new e.b2Color(.4,.9,.4)),n.DrawSegment(t,s,new e.b2Color(.8,.8,.8));const i=e.b2Vec2.Add(s,e.b2Vec2.Scale(.5,o,e.b2Vec2.s_t0),new e.b2Vec2);n.DrawSegment(s,i,new e.b2Color(.9,.9,.4))}}}a.e_maxBodies=256,(0,t.registerTest)("Collision","Ray Cast",a);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t","../../ui/controls/Radio":"nr7a","../../ui/controls/Slider":"eXYw"}],"nfXo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../ui/controls/Checkbox"),i=require("../../ui/controls/Slider");class r extends t.Test{constructor(){super(),this.m_motorSpeed=1,this.m_enableMotor=!1,this.m_enableLimit=!0;let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const o=new e.b2PolygonShape;o.SetAsBox(.25,3,new e.b2Vec2(0,3),0);const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(-10,20)});i.CreateFixture({shape:o,density:5});const r=new e.b2RevoluteJointDef;r.Initialize(t,i,new e.b2Vec2(-10,20.5)),r.motorSpeed=this.m_motorSpeed,r.maxMotorTorque=1e4,r.enableMotor=this.m_enableMotor,r.lowerAngle=-.25*Math.PI,r.upperAngle=.5*Math.PI,r.enableLimit=this.m_enableLimit,this.m_joint1=this.m_world.CreateJoint(r)}{const o=new e.b2CircleShape(2);this.m_ball=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(5,30)}),this.m_ball.CreateFixture({density:5,filter:{maskBits:1},shape:o});const i=new e.b2PolygonShape;i.SetAsBox(10,.5,new e.b2Vec2(-10,0),0);const r=this.m_world.CreateBody({position:new e.b2Vec2(20,10),type:e.b2BodyType.b2_dynamicBody,bullet:!0});r.CreateFixture({shape:i,density:2});const n=new e.b2RevoluteJointDef;n.Initialize(t,r,new e.b2Vec2(19,10)),n.lowerAngle=-.25*Math.PI,n.upperAngle=0*Math.PI,n.enableLimit=!0,n.enableMotor=!0,n.motorSpeed=0,n.maxMotorTorque=1e4,this.m_joint2=this.m_world.CreateJoint(n)}this.addTestControlGroup("Joint Controls",[(0,o.checkboxDef)("Limit",this.m_enableLimit,e=>{this.m_enableLimit=this.m_joint1.EnableLimit(e)}),(0,o.checkboxDef)("Motor",this.m_enableMotor,e=>{this.m_enableMotor=this.m_joint1.EnableMotor(e)}),(0,i.sliderDef)("Speed",-20,20,1,this.m_motorSpeed,e=>{this.m_motorSpeed=this.m_joint1.SetMotorSpeed(e)})])}getCenter(){return{x:0,y:5}}Step(e,t){super.Step(e,t);const o=this.m_joint1.GetMotorTorque(e.m_hertz);this.addDebug("Motor Torque 1",o.toFixed(0));const i=this.m_joint2.GetMotorTorque(e.m_hertz);this.addDebug("Motor Torque 2",i.toFixed(0))}}(0,t.registerTest)("Joints","Revolute",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../ui/controls/Checkbox":"preb","../../ui/controls/Slider":"eXYw"}],"t4x2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),s=require("../../ui/controls/Slider");class o extends t.Test{constructor(){super(),this.m_bodies=new Array(o.e_count),this.m_force=100,this.m_touching=(0,e.b2MakeBooleanArray)(o.e_count);const t=this.m_world.CreateBody();{const s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s})}{const s=new e.b2CircleShape;s.m_radius=5,s.m_p.Set(0,10),this.m_sensor=t.CreateFixture({shape:s,isSensor:!0})}{const t=new e.b2CircleShape;t.m_radius=1;for(let s=0;s<o.e_count;++s)this.m_touching[s]=!1,this.m_bodies[s]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:3*s-10,y:20},userData:{index:s}}),this.m_bodies[s].CreateFixture({shape:t,density:1})}}setupControls(){this.addTestControlGroup("Sensor",[(0,s.sliderDef)("Force",0,2e3,1,this.m_force,e=>{this.m_force=e})])}getCenter(){return{x:0,y:5}}BeginContact(e){const t=e.GetFixtureA(),s=e.GetFixtureB();if(t===this.m_sensor){const e=s.GetBody().GetUserData();e&&(this.m_touching[e.index]=!0)}if(s===this.m_sensor){const e=t.GetBody().GetUserData();e&&(this.m_touching[e.index]=!0)}}EndContact(e){const t=e.GetFixtureA(),s=e.GetFixtureB();if(t===this.m_sensor){const e=s.GetBody().GetUserData();e&&(this.m_touching[e.index]=!1)}if(s===this.m_sensor){const e=t.GetBody().GetUserData();e&&(this.m_touching[e.index]=!1)}}Step(t,s){super.Step(t,s);for(let i=0;i<o.e_count;++i){if(!this.m_touching[i])continue;const t=this.m_bodies[i],s=this.m_sensor.GetBody(),o=this.m_sensor.GetShape(),r=s.GetWorldPoint(o.m_p,new e.b2Vec2),n=t.GetPosition(),c=e.b2Vec2.Subtract(r,n,new e.b2Vec2);if(c.LengthSquared()<e.b2_epsilon_sq)continue;c.Normalize();const h=e.b2Vec2.Scale(this.m_force,c,new e.b2Vec2);t.ApplyForce(h,n)}}}o.e_count=7,(0,t.registerTest)("Collision","Sensor Test",o);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../ui/controls/Slider":"eXYw"}],"Dl3u":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),s=require("../../test"),i=new t.b2Color(.9,.9,.9),r=new t.b2Color(.5,.9,.5),e=new t.b2Color(.5,.7,.9),o=new t.b2Color(.9,.3,.3);class n extends s.Test{constructor(){super(),this.m_vAs=(0,t.b2MakeArray)(t.b2_maxPolygonVertices,t.b2Vec2),this.m_countA=0,this.m_radiusA=0,this.m_vBs=(0,t.b2MakeArray)(t.b2_maxPolygonVertices,t.b2Vec2),this.m_countB=0,this.m_radiusB=0,this.m_transformA=new t.b2Transform,this.m_transformB=new t.b2Transform,this.m_translationB=new t.b2Vec2,this.m_vAs[0].Set(-.5,1),this.m_vAs[1].Set(.5,1),this.m_vAs[2].Set(0,0),this.m_countA=3,this.m_radiusA=t.b2_polygonRadius,this.m_vBs[0].Set(-.5,-.5),this.m_vBs[1].Set(.5,-.5),this.m_vBs[2].Set(.5,.5),this.m_vBs[3].Set(-.5,.5),this.m_countB=4,this.m_radiusB=t.b2_polygonRadius,this.m_transformA.p.Set(0,.25),this.m_transformA.q.SetIdentity(),this.m_transformB.p.Set(-4,0),this.m_transformB.q.SetIdentity(),this.m_translationB.Set(8,0)}Step(s,n){super.Step(s,n);const a=new t.b2ShapeCastInput;a.proxyA.SetVerticesRadius(this.m_vAs,this.m_countA,this.m_radiusA),a.proxyB.SetVerticesRadius(this.m_vBs,this.m_countB,this.m_radiusB),a.transformA.Copy(this.m_transformA),a.transformB.Copy(this.m_transformB),a.translationB.Copy(this.m_translationB);const m=new t.b2ShapeCastOutput,_=(0,t.b2ShapeCast)(m,a),h=new t.b2Transform;h.q.Copy(this.m_transformB.q),h.p.Copy(this.m_transformB.p).AddScaled(m.lambda,a.translationB);const c=new t.b2DistanceInput;c.proxyA.SetVerticesRadius(this.m_vAs,this.m_countA,this.m_radiusA),c.proxyB.SetVerticesRadius(this.m_vBs,this.m_countB,this.m_radiusB),c.transformA.Copy(this.m_transformA),c.transformB.Copy(h),c.useRadii=!1;const u=new t.b2SimplexCache;u.count=0;const d=new t.b2DistanceOutput;(0,t.b2Distance)(d,u,c),this.addDebug("Hit",_),this.addDebug("Iters",m.iterations),this.addDebug("Lambda",m.lambda.toFixed(6)),this.addDebug("Distance",d.distance.toFixed(6));const b=(0,t.b2MakeArray)(t.b2_maxPolygonVertices,t.b2Vec2);for(let i=0;i<this.m_countA;++i)t.b2Transform.MultiplyVec2(this.m_transformA,this.m_vAs[i],b[i]);const B=s.m_debugDraw;1===this.m_countA?B.DrawCircle(b[0],this.m_radiusA,i):B.DrawPolygon(b,this.m_countA,i);for(let i=0;i<this.m_countB;++i)t.b2Transform.MultiplyVec2(this.m_transformB,this.m_vBs[i],b[i]);1===this.m_countB?B.DrawCircle(b[0],this.m_radiusB,r):B.DrawPolygon(b,this.m_countB,r);for(let i=0;i<this.m_countB;++i)t.b2Transform.MultiplyVec2(h,this.m_vBs[i],b[i]);if(1===this.m_countB?B.DrawCircle(b[0],this.m_radiusB,e):B.DrawPolygon(b,this.m_countB,e),_){const s=m.point;B.DrawPoint(s,10,o);const i=t.b2Vec2.Add(s,m.normal,t.b2Vec2.s_t0);B.DrawSegment(s,i,o)}}}n.e_vertexCount=8,(0,s.registerTest)("Collision","Shape Cast",n);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"MuO2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),s=require("../../utils/hotkeys");class r extends t.Test{constructor(){super(),this.m_fixture2=null,this.m_sensor=!1;{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s})}this.m_body=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:10}});const t=new e.b2PolygonShape;t.SetAsBox(4,4,new e.b2Vec2,0),this.m_fixture1=this.m_body.CreateFixture({shape:t,density:10})}getHotkeys(){return[(0,s.hotKeyPress)("c","Create a Shape",()=>{if(null===this.m_fixture2){const t=new e.b2CircleShape;t.m_radius=3,t.m_p.Set(.5,-4),this.m_fixture2=this.m_body.CreateFixture({shape:t,density:10}),this.m_body.SetAwake(!0)}}),(0,s.hotKeyPress)("d","Destroy a Shape",()=>{null!==this.m_fixture2&&(this.m_body.DestroyFixture(this.m_fixture2),this.m_fixture2=null,this.m_body.SetAwake(!0))}),(0,s.hotKeyPress)("s","Toggle Sensor",()=>{null!==this.m_fixture2&&(this.m_sensor=!this.m_sensor,this.m_fixture2.SetSensor(this.m_sensor))})]}Step(e,t){super.Step(e,t),this.addDebug("Sensor",this.m_sensor)}}(0,t.registerTest)("Examples","Shape Editing",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"hNdw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),i=require("../../utils/camera"),s=require("../../utils/hotkeys");class r extends t.Test{constructor(){super();const t=this.m_world.CreateBody(),s=30*Math.PI/180,r=s-10*Math.PI/180;this.m_platform_width=8;const o=new e.b2Vec2(-8,0),a=new e.b2Vec2,c=new e.b2Vec2(2*Math.cos(s),-2*Math.sin(s)),n=new e.b2Vec2(c.x+2*Math.cos(r),c.y-2*Math.sin(r)),h=[new e.b2Vec2(n.x,n.y-1),n,c,a,o],m=new e.b2ChainShape;m.CreateLoop(h),t.CreateFixture({shape:m,density:0,friction:.2});{const t=2.5,i=3,s=.3,r=0,o=.15,a=t/2+s,c=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-this.m_platform_width/2,y:a}}),n=new e.b2PolygonShape,h=(0,e.b2MakeArray)(4,e.b2Vec2);h[0].Set(-i/2-s,-t/2),h[1].Set(-i/2,-t/2-s),h[2].Set(i/2,-t/2-s),h[3].Set(i/2+s,-t/2),n.Set(h),c.CreateFixture({density:1,friction:r,restitution:o,shape:n}),c.SetLinearVelocity(new e.b2Vec2(.5,0)),this.m_skier=c}i.g_camera.setPositionAndZoom(this.m_platform_width/2,0,.4),this.m_fixed_camera=!0}GetDefaultViewZoom(){return 50}getHotkeys(){return[(0,s.hotKeyPress)("c","Switch Camera Fixed/Tracking",()=>{this.m_fixed_camera=!this.m_fixed_camera,this.m_fixed_camera&&i.g_camera.setPosition(this.m_platform_width/2,0)})]}Step(e,t){if(!this.m_fixed_camera){const e=this.m_skier.GetPosition();i.g_camera.setPosition(e.x,e.y)}super.Step(e,t)}}(0,t.registerTest)("Bugs","Skier",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/camera":"GUc7","../../utils/hotkeys":"EV9t"}],"yGP5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys");class i extends t.Test{constructor(){super();let t=null;{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{let o=t;{const t=new e.b2PolygonShape;t.SetAsBox(.5,2);const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:7}});i.CreateFixture({shape:t,density:2});const n=new e.b2RevoluteJointDef;n.Initialize(o,i,new e.b2Vec2(0,5)),n.motorSpeed=1*Math.PI,n.maxMotorTorque=1e4,n.enableMotor=!0,this.m_joint1=this.m_world.CreateJoint(n),o=i}{const t=new e.b2PolygonShape;t.SetAsBox(.5,4);const i=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:13}});i.CreateFixture({shape:t,density:2});const n=new e.b2RevoluteJointDef;n.Initialize(o,i,new e.b2Vec2(0,9)),n.enableMotor=!1,this.m_world.CreateJoint(n),o=i}{const i=new e.b2PolygonShape;i.SetAsBox(1.5,1.5);const n=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,position:{x:0,y:17}});n.CreateFixture({shape:i,density:2});const s=new e.b2RevoluteJointDef;s.Initialize(o,n,new e.b2Vec2(0,17)),this.m_world.CreateJoint(s);const r=new e.b2PrismaticJointDef;r.Initialize(t,n,new e.b2Vec2(0,17),new e.b2Vec2(0,1)),r.maxMotorForce=1e3,r.enableMotor=!0,this.m_joint2=this.m_world.CreateJoint(r)}{const t=new e.b2PolygonShape;t.SetAsBox(1.5,1.5),this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:23}}).CreateFixture({shape:t,density:2})}}}getHotkeys(){return[(0,o.hotKeyPress)("f","Toggle Friction",()=>{this.m_joint2.EnableMotor(!this.m_joint2.IsMotorEnabled()),this.m_joint2.GetBodyB().SetAwake(!0)}),(0,o.hotKeyPress)("m","Toggle Motor",()=>{this.m_joint1.EnableMotor(!this.m_joint1.IsMotorEnabled()),this.m_joint1.GetBodyB().SetAwake(!0)})]}Step(e,t){super.Step(e,t);const o=this.m_joint1.GetMotorTorque(e.m_hertz);this.addDebug("Motor Torque",o.toFixed(0))}}(0,t.registerTest)("Examples","Slider Crank 2",i);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"fewI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class s extends t.Test{constructor(){super(),this.m_bodies=[];{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s})}{const t=new e.b2CircleShape;t.m_radius=1;for(let i=0;i<s.e_count;++i)this.m_bodies[i]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:4+3*i}}),this.m_bodies[i].CreateFixture({shape:t,density:1}),this.m_bodies[i].SetLinearVelocity(new e.b2Vec2(0,-50))}}}s.e_count=10,(0,t.registerTest)("Stacking","Circle Stack",s);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"nQFY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys");class s extends t.Test{constructor(){super(),this.m_offset=new e.b2Vec2,this.m_motorOn=!0,this.m_motorSpeed=2,this.m_offset.Set(0,8);const t=new e.b2Vec2(0,.8);{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-50,0),new e.b2Vec2(50,0)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(-50,0),new e.b2Vec2(-50,10)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(50,0),new e.b2Vec2(50,10)),t.CreateFixture({shape:o})}for(let s=0;s<40;++s){const t=new e.b2CircleShape;t.m_radius=.25,this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:2*s-40,y:.5}}).CreateFixture({shape:t,density:1})}{const o=new e.b2PolygonShape;o.SetAsBox(2.5,1),this.m_chassis=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:t.x+this.m_offset.x,y:t.y+this.m_offset.y}}),this.m_chassis.CreateFixture({density:1,shape:o,filter:{groupIndex:-1}})}{const o=new e.b2CircleShape;o.m_radius=1.6,this.m_wheel=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:t.x+this.m_offset.x,y:t.y+this.m_offset.y}}),this.m_wheel.CreateFixture({density:1,shape:o,filter:{groupIndex:-1}})}{const o=new e.b2RevoluteJointDef;o.Initialize(this.m_wheel,this.m_chassis,e.b2Vec2.Add(t,this.m_offset,new e.b2Vec2)),o.collideConnected=!1,o.motorSpeed=this.m_motorSpeed,o.maxMotorTorque=400,o.enableMotor=this.m_motorOn,this.m_motorJoint=this.m_world.CreateJoint(o)}const o=e.b2Vec2.Add(t,new e.b2Vec2(0,-.8),new e.b2Vec2);this.CreateLeg(-1,o),this.CreateLeg(1,o),this.m_wheel.SetTransformVec(this.m_wheel.GetPosition(),120*Math.PI/180),this.CreateLeg(-1,o),this.CreateLeg(1,o),this.m_wheel.SetTransformVec(this.m_wheel.GetPosition(),-120*Math.PI/180),this.CreateLeg(-1,o),this.CreateLeg(1,o)}CreateLeg(t,o){const s=new e.b2Vec2(5.4*t,-6.1),i=new e.b2Vec2(7.2*t,-1.2),n=new e.b2Vec2(4.3*t,-1.9),r=new e.b2Vec2(3.1*t,.8),d=new e.b2Vec2(6*t,1.5),h=new e.b2Vec2(2.5*t,3.7),b=new e.b2PolygonShape,a=new e.b2PolygonShape;if(t>0){const t=[];t[0]=s,t[1]=i,t[2]=n,b.Set(t),t[0]=e.b2Vec2.ZERO,t[1]=e.b2Vec2.Subtract(d,r,new e.b2Vec2),t[2]=e.b2Vec2.Subtract(h,r,new e.b2Vec2),a.Set(t)}else{const t=[];t[0]=s,t[1]=n,t[2]=i,b.Set(t),t[0]=e.b2Vec2.ZERO,t[1]=e.b2Vec2.Subtract(h,r,new e.b2Vec2),t[2]=e.b2Vec2.Subtract(d,r,new e.b2Vec2),a.Set(t)}const c=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:this.m_offset,angularDamping:10}),m=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:e.b2Vec2.Add(r,this.m_offset,new e.b2Vec2),angularDamping:10});c.CreateFixture({filter:{groupIndex:-1},shape:b,density:1}),m.CreateFixture({filter:{groupIndex:-1},density:1,shape:a});{const t=new e.b2DistanceJointDef,s=.5,b=10;t.Initialize(c,m,e.b2Vec2.Add(i,this.m_offset,new e.b2Vec2),e.b2Vec2.Add(d,this.m_offset,new e.b2Vec2)),(0,e.b2LinearStiffness)(t,b,s,t.bodyA,t.bodyB),this.m_world.CreateJoint(t),t.Initialize(c,m,e.b2Vec2.Add(n,this.m_offset,new e.b2Vec2),e.b2Vec2.Add(r,this.m_offset,new e.b2Vec2)),(0,e.b2LinearStiffness)(t,b,s,t.bodyA,t.bodyB),this.m_world.CreateJoint(t),t.Initialize(c,this.m_wheel,e.b2Vec2.Add(n,this.m_offset,new e.b2Vec2),e.b2Vec2.Add(o,this.m_offset,new e.b2Vec2)),(0,e.b2LinearStiffness)(t,b,s,t.bodyA,t.bodyB),this.m_world.CreateJoint(t),t.Initialize(m,this.m_wheel,e.b2Vec2.Add(h,this.m_offset,new e.b2Vec2),e.b2Vec2.Add(o,this.m_offset,new e.b2Vec2)),(0,e.b2LinearStiffness)(t,b,s,t.bodyA,t.bodyB),this.m_world.CreateJoint(t)}{const t=new e.b2RevoluteJointDef;t.Initialize(m,this.m_chassis,e.b2Vec2.Add(r,this.m_offset,new e.b2Vec2)),this.m_world.CreateJoint(t)}}getHotkeys(){return[(0,o.hotKeyPress)("a","Left",()=>this.m_motorJoint.SetMotorSpeed(-this.m_motorSpeed)),(0,o.hotKeyPress)("s","Brake",()=>this.m_motorJoint.SetMotorSpeed(0)),(0,o.hotKeyPress)("d","Right",()=>this.m_motorJoint.SetMotorSpeed(this.m_motorSpeed)),(0,o.hotKeyPress)("m","Toggle Enabled",()=>this.m_motorJoint.EnableMotor(!this.m_motorJoint.IsMotorEnabled()))]}}(0,t.registerTest)("Examples","Theo Jansen's Walker",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"uFmP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super(),this.m_fixtureCount=0,this.m_createTime=0,this.m_fixtureCount=0;const t=new e.b2Timer;{const t=.5,o=this.m_world.CreateBody({position:{x:0,y:-t}});{const s=200,i=10,r=new e.b2Vec2;r.y=0;for(let n=0;n<i;++n){r.x=-s*t;for(let i=0;i<s;++i){const s=new e.b2PolygonShape;s.SetAsBox(t,t,r,0),o.CreateFixture({shape:s}),++this.m_fixtureCount,r.x+=2*t}r.y-=2*t}}}{const t=.5,s=new e.b2PolygonShape;s.SetAsBox(t,t);const i=new e.b2Vec2(-7,.75),r=new e.b2Vec2,n=new e.b2Vec2(.5625,1.25),a=new e.b2Vec2(1.125,0);for(let c=0;c<o.e_count;++c){r.Copy(i);for(let t=c;t<o.e_count;++t){this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:r}).CreateFixture({shape:s,density:5}),++this.m_fixtureCount,r.Add(a)}i.Add(n)}}this.m_createTime=t.GetMilliseconds()}Step(e,t){const o=this.m_world.GetContactManager(),s=o.m_broadPhase.GetTreeHeight(),i=2*o.m_broadPhase.GetProxyCount()-1,r=Math.ceil(Math.log(i)/Math.log(2));this.addDebug("Dynamic Tree Height",s),this.addDebug("Min Height",r),super.Step(e,t),this.addDebug("Create Time",`${this.m_createTime.toFixed(2)} ms`),this.addDebug("Fixture Count",this.m_fixtureCount)}}o.e_count=20,(0,t.registerTest)("Benchmark","Tiles",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"e6FC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super(),this.m_shapeA=new e.b2PolygonShape,this.m_shapeB=new e.b2PolygonShape,this.m_shapeA.SetAsBox(25,5),this.m_shapeB.SetAsBox(2.5,2.5)}Step(t,o){super.Step(t,o);const s=new e.b2Sweep;s.c0.Set(0,20+8*Math.cos(Date.now()/1e3)),s.a0=2.95,s.c.Copy(s.c0),s.a=s.a0,s.localCenter.SetZero();const r=new e.b2Sweep;r.c0.Set(20,40),r.a0=.1,r.c.Set(-20,0),r.a=3.1,r.localCenter.SetZero();const n=new e.b2TOIInput;n.proxyA.SetShape(this.m_shapeA,0),n.proxyB.SetShape(this.m_shapeB,0),n.sweepA.Copy(s),n.sweepB.Copy(r),n.tMax=1;const a=new e.b2TOIOutput;(0,e.b2TimeOfImpact)(a,n),this.addDebug("Toi",a.t.toFixed(3)),this.addDebug("Max Toi Iters",e.b2Toi.maxIters),this.addDebug("Max Root Iters",e.b2Toi.maxRootIters);const i=[],p=new e.b2Transform;s.GetTransform(p,0);for(let c=0;c<this.m_shapeA.m_count;++c)i[c]=e.b2Transform.MultiplyVec2(p,this.m_shapeA.m_vertices[c],new e.b2Vec2);const m=t.m_debugDraw;m.DrawPolygon(i,this.m_shapeA.m_count,new e.b2Color(.9,.9,.9));const h=new e.b2Transform;r.GetTransform(h,0);for(let c=0;c<this.m_shapeB.m_count;++c)i[c]=e.b2Transform.MultiplyVec2(h,this.m_shapeB.m_vertices[c],new e.b2Vec2);m.DrawPolygon(i,this.m_shapeB.m_count,new e.b2Color(.5,.9,.5)),m.DrawStringWorld(h.p.x,h.p.y,`${(0).toFixed(1)}`),r.GetTransform(h,a.t);for(let c=0;c<this.m_shapeB.m_count;++c)i[c]=e.b2Transform.MultiplyVec2(h,this.m_shapeB.m_vertices[c],new e.b2Vec2);m.DrawPolygon(i,this.m_shapeB.m_count,new e.b2Color(.5,.7,.9)),m.DrawStringWorld(h.p.x,h.p.y,`${a.t.toFixed(3)}`),r.GetTransform(h,1);for(let c=0;c<this.m_shapeB.m_count;++c)i[c]=e.b2Transform.MultiplyVec2(h,this.m_shapeB.m_vertices[c],new e.b2Vec2);m.DrawPolygon(i,this.m_shapeB.m_count,new e.b2Color(.9,.5,.5)),m.DrawStringWorld(h.p.x,h.p.y,`${1..toFixed(1)}`);for(let c=0;c<1;c+=.1){r.GetTransform(h,c);for(let t=0;t<this.m_shapeB.m_count;++t)i[t]=e.b2Transform.MultiplyVec2(h,this.m_shapeB.m_vertices[t],new e.b2Vec2);m.DrawPolygon(i,this.m_shapeB.m_count,new e.b2Color(.5,.5,.5)),m.DrawStringWorld(h.p.x,h.p.y,`${c.toFixed(1)}`)}}GetDefaultViewZoom(){return 20}getCenter(){return{x:0,y:10}}}(0,t.registerTest)("Collision","Time of Impact",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"t4Qr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super(),this.m_count=0;const t=this.m_world.CreateBody();{const o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,allowSleep:!1,position:{x:0,y:10}}),r=new e.b2PolygonShape;r.SetAsBox(.5,10,new e.b2Vec2(10,0),0),o.CreateFixture({shape:r,density:5}),r.SetAsBox(.5,10,new e.b2Vec2(-10,0),0),o.CreateFixture({shape:r,density:5}),r.SetAsBox(10,.5,new e.b2Vec2(0,10),0),o.CreateFixture({shape:r,density:5}),r.SetAsBox(10,.5,new e.b2Vec2(0,-10),0),o.CreateFixture({shape:r,density:5});const s=new e.b2RevoluteJointDef;s.bodyA=t,s.bodyB=o,s.localAnchorA.Set(0,10),s.localAnchorB.Set(0,0),s.referenceAngle=0,s.motorSpeed=.05*Math.PI,s.maxMotorTorque=1e8,s.enableMotor=!0,this.m_joint=this.m_world.CreateJoint(s)}this.m_count=0}getCenter(){return{x:0,y:5}}Step(t,r){if(super.Step(t,r),this.m_count<o.e_count){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:10}}),o=new e.b2PolygonShape;o.SetAsBox(.125,.125),t.CreateFixture({shape:o,density:1}),++this.m_count}}}o.e_count=800,(0,t.registerTest)("Benchmark","Tumbler",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"jkPn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o})}{const t=new e.b2PolygonShape;t.SetAsBox(13,.25),this.m_world.CreateBody({position:{x:-4,y:22},angle:-.25}).CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(.25,1),this.m_world.CreateBody({position:{x:10.5,y:19}}).CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(13,.25),this.m_world.CreateBody({position:{x:4,y:14},angle:.25}).CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(.25,1),this.m_world.CreateBody({position:{x:-10.5,y:11}}).CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(13,.25),this.m_world.CreateBody({position:{x:-4,y:6},angle:-.25}).CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(.5,.5);const o={shape:t,density:25},s=[.75,.5,.35,.1,0];for(let r=0;r<5;++r){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:4*r-15,y:28}});o.friction=s[r],t.CreateFixture(o)}}}getCenter(){return{x:0,y:10}}}(0,t.registerTest)("Forces","Friction",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"M20t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class s extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),s=new e.b2EdgeShape;s.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:s,restitutionThreshold:10})}{const t=new e.b2CircleShape;t.m_radius=1;const s={shape:t,density:1,restitutionThreshold:10},r=[0,.1,.3,.5,.75,.9,1];for(let o=0;o<7;++o){const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:3*o-10,y:20}});s.restitution=r[o],t.CreateFixture(s)}}}}(0,t.registerTest)("Forces","Restitution",s);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"UOOG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../utils/hotkeys");class s extends t.Test{constructor(){super(),this.m_bullet=null,this.m_bodies=new Array(s.e_rowCount*s.e_columnCount),this.m_indices=(0,e.b2MakeNumberArray)(s.e_rowCount*s.e_columnCount);{const t=this.m_world.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(20,0),new e.b2Vec2(20,20)),t.CreateFixture({shape:o})}const t=[0,-10,-5,5,10];for(let o=0;o<s.e_columnCount;++o){const i=new e.b2PolygonShape;i.SetAsBox(.5,.5);const r={shape:i,density:1,friction:.3};for(let l=0;l<s.e_rowCount;++l){const i=o*s.e_rowCount+l;this.m_indices[i]=i;const n=0,u=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:t[o]+n,y:.55+1.1*l},userData:this.m_indices[i]});this.m_bodies[i]=u,u.CreateFixture(r)}}}getHotkeys(){return[(0,o.hotKeyPress)("Enter","Launch a bullet",()=>this.LaunchBullet()),(0,o.hotKeyPress)("b","Toggle Block solving",()=>(0,e.b2SetBlockSolve)(!(0,e.b2GetBlockSolve)()))]}Destroy(){(0,e.b2SetBlockSolve)(!0)}LaunchBullet(){this.m_bullet&&(this.m_world.DestroyBody(this.m_bullet),this.m_bullet=null);{const t=new e.b2CircleShape;t.m_radius=.25;const o={shape:t,density:20,restitution:.05};this.m_bullet=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,bullet:!0,position:{x:-31,y:5}}),this.m_bullet.CreateFixture(o),this.m_bullet.SetLinearVelocity(new e.b2Vec2(400,0))}}Step(t,o){super.Step(t,o),this.addDebug("Blocksolve",(0,e.b2GetBlockSolve)())}}s.e_columnCount=1,s.e_rowCount=15,(0,t.registerTest)("Stacking","Box Stack",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"lPql":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),o=require("../../test"),t=require("../../utils/hotkeys");class n extends o.Test{constructor(){super(),this.m_bodies=new Array(4),this.m_joints=new Array(8);let o=null;{o=this.m_world.CreateBody();const t=new e.b2EdgeShape;t.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),o.CreateFixture({shape:t})}{const t=new e.b2PolygonShape;t.SetAsBox(.5,.5);const n=this.m_bodies[0]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-5,y:5}});n.CreateFixture({shape:t,density:5});const r=this.m_bodies[1]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:5,y:5}});r.CreateFixture({shape:t,density:5});const i=this.m_bodies[2]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:5,y:15}});i.CreateFixture({shape:t,density:5});const c=this.m_bodies[3]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:-5,y:15}});c.CreateFixture({shape:t,density:5});const s=new e.b2DistanceJointDef;let l,b,d;const h=2,y=0;s.bodyA=o,s.bodyB=n,s.localAnchorA.Set(-10,0),s.localAnchorB.Set(-.5,-.5),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[0]=this.m_world.CreateJoint(s),s.bodyA=o,s.bodyB=r,s.localAnchorA.Set(10,0),s.localAnchorB.Set(.5,-.5),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[1]=this.m_world.CreateJoint(s),s.bodyA=o,s.bodyB=i,s.localAnchorA.Set(10,20),s.localAnchorB.Set(.5,.5),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[2]=this.m_world.CreateJoint(s),s.bodyA=o,s.bodyB=c,s.localAnchorA.Set(-10,20),s.localAnchorB.Set(-.5,.5),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[3]=this.m_world.CreateJoint(s),s.bodyA=n,s.bodyB=r,s.localAnchorA.Set(.5,0),s.localAnchorB.Set(-.5,0),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[4]=this.m_world.CreateJoint(s),s.bodyA=r,s.bodyB=i,s.localAnchorA.Set(0,.5),s.localAnchorB.Set(0,-.5),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[5]=this.m_world.CreateJoint(s),s.bodyA=i,s.bodyB=c,s.localAnchorA.Set(-.5,0),s.localAnchorB.Set(.5,0),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[6]=this.m_world.CreateJoint(s),s.bodyA=c,s.bodyB=n,s.localAnchorA.Set(0,-.5),s.localAnchorB.Set(0,.5),l=s.bodyA.GetWorldPoint(s.localAnchorA,new e.b2Vec2),b=s.bodyB.GetWorldPoint(s.localAnchorB,new e.b2Vec2),d=e.b2Vec2.Subtract(b,l,new e.b2Vec2),s.length=d.Length(),(0,e.b2LinearStiffness)(s,h,y,s.bodyA,s.bodyB),this.m_joints[7]=this.m_world.CreateJoint(s)}}JointDestroyed(e){for(let o=0;o<8;++o)if(this.m_joints[o]===e){this.m_joints[o]=null;break}}getHotkeys(){return[(0,t.hotKeyPress)("b","Delete a Body",()=>{for(let e=0;e<4;++e){const o=this.m_bodies[e];if(o){this.m_world.DestroyBody(o),this.m_bodies[e]=null;break}}}),(0,t.hotKeyPress)("j","Delete a Joint",()=>{for(let e=0;e<8;++e){const o=this.m_joints[e];if(o){this.m_world.DestroyJoint(o),this.m_joints[e]=null;break}}})]}Step(e,o){super.Step(e,o),this.addText("This demonstrates a soft distance joint.")}}(0,o.registerTest)("Examples","Web",n);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"kBjC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test"),i=require("../../utils/hotkeys"),s=require("../../ui/controls/Slider"),n=require("../../ui/controls/Checkbox"),o=require("../../ui/controls/Select"),r=["Spring","PBD Ang","XPBD Ang","PBD Dist","PBD Height","PBD Triangle"],h=["PBD","XPBD"];class m extends e.Test{constructor(){super(),this.m_tuning1=new t.b2RopeTuning,this.m_tuning2=new t.b2RopeTuning,this.m_iterations=[8,8],this.m_position1=new t.b2Vec2,this.m_position2=new t.b2Vec2,this.m_speed=10,this.m_moveLeft=!1,this.m_moveRight=!1;const e=(0,t.b2MakeArray)(20,t.b2Vec2),i=(0,t.b2MakeNumberArray)(20);for(let t=0;t<20;++t)e[t].Set(0,.5*(20-t)),i[t]=1;i[0]=0,i[1]=0,this.m_tuning1.bendHertz=30,this.m_tuning1.bendDamping=4,this.m_tuning1.bendStiffness=1,this.m_tuning1.bendingModel=t.b2BendingModel.b2_pbdTriangleBendingModel,this.m_tuning1.isometric=!0,this.m_tuning1.stretchHertz=30,this.m_tuning1.stretchDamping=4,this.m_tuning1.stretchStiffness=1,this.m_tuning1.stretchingModel=t.b2StretchingModel.b2_pbdStretchingModel,this.m_tuning2.bendHertz=30,this.m_tuning2.bendDamping=.7,this.m_tuning2.bendStiffness=1,this.m_tuning2.bendingModel=t.b2BendingModel.b2_pbdHeightBendingModel,this.m_tuning2.isometric=!0,this.m_tuning2.stretchHertz=30,this.m_tuning2.stretchDamping=1,this.m_tuning2.stretchStiffness=1,this.m_tuning2.stretchingModel=t.b2StretchingModel.b2_pbdStretchingModel,this.m_position1.Set(-5,15),this.m_position2.Set(5,15);const s={position:this.m_position1,vertices:e,masses:i,gravity:{x:0,y:-10},tuning:this.m_tuning1};this.m_rope1=new t.b2Rope(s),s.position=this.m_position2,s.tuning=this.m_tuning2,this.m_rope2=new t.b2Rope(s)}setupControls(){this.addTestControlGroup("Rope 1",this.ropeControls(0,this.m_tuning1)),this.addTestControlGroup("Rope 2",this.ropeControls(1,this.m_tuning2)),this.addTestControlGroup("Speed",[(0,s.sliderDef)("",10,100,1,this.m_speed,t=>{this.m_speed=t})])}ropeControls(t,e){return[(0,o.selectDef)("Bend Model#",r,r[e.bendingModel],t=>{e.bendingModel=r.indexOf(t)}),(0,s.sliderDef)("Damping#b",0,4,.1,e.bendDamping,t=>{e.bendDamping=t}),(0,s.sliderDef)("Hertz#b",0,60,1,e.bendHertz,t=>{e.bendHertz=t}),(0,s.sliderDef)("Stiffness#b",0,1,.1,e.bendStiffness,t=>{e.bendStiffness=t}),(0,n.checkboxDef)("Isometric",e.isometric,t=>{e.isometric=t}),(0,n.checkboxDef)("Fixed Mass",e.fixedEffectiveMass,t=>{e.fixedEffectiveMass=t}),(0,n.checkboxDef)("Warm Start",e.warmStart,t=>{e.warmStart=t}),(0,o.selectDef)("Stretch Model",h,h[e.stretchingModel],t=>{e.stretchingModel=h.indexOf(t)}),(0,s.sliderDef)("Damping#s",0,4,.1,e.stretchDamping,t=>{e.stretchDamping=t}),(0,s.sliderDef)("Hertz#s",0,60,1,e.stretchHertz,t=>{e.stretchHertz=t}),(0,s.sliderDef)("Stiffness#s",0,1,.1,e.stretchStiffness,t=>{e.stretchStiffness=t}),(0,s.sliderDef)("Iterations",0,100,1,this.m_iterations[t],e=>{this.m_iterations[t]=e})]}GetDefaultViewZoom(){return 45}getCenter(){return{x:0,y:20}}getHotkeys(){return[(0,i.hotKeyState)("a","Move Left",this,"m_moveLeft"),(0,i.hotKeyState)("d","Move Right",this,"m_moveRight"),(0,i.hotKeyPress)("s","Reset Ropes",()=>{this.m_position1.Set(-5,15),this.m_position2.Set(5,15),this.m_rope1.Reset(this.m_position1),this.m_rope2.Reset(this.m_position2)})]}Step(t,e){let i=t.m_hertz>0?1/t.m_hertz:0;!0===t.m_pause&&!1===t.m_singleStep&&(i=0);let s=0;this.m_moveLeft&&(s-=1),this.m_moveRight&&(s+=1),s&&(this.m_position1.x+=s*this.m_speed*i,this.m_position2.x+=s*this.m_speed*i),this.m_rope1.SetTuning(this.m_tuning1),this.m_rope2.SetTuning(this.m_tuning2),this.m_rope1.Step(i,this.m_iterations[0],this.m_position1),this.m_rope2.Step(i,this.m_iterations[1],this.m_position2),super.Step(t,e);const n=t.m_debugDraw;this.m_rope1.Draw(n),this.m_rope2.Draw(n)}}(0,e.registerTest)("Rope","Bending",m);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t","../../ui/controls/Slider":"eXYw","../../ui/controls/Checkbox":"preb","../../ui/controls/Select":"lYGI"}],"P1CY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){let t,o,r;super();{t=this.m_world.CreateBody();const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-20,0),new e.b2Vec2(20,0)),t.CreateFixture({shape:o})}{o=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:0,y:4}});const t=new e.b2CircleShape;t.m_radius=1,o.CreateFixture({shape:t,friction:.6,density:2})}{r=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:4,y:8}});const t=new e.b2CircleShape;t.m_radius=1,r.CreateFixture({shape:t,friction:.6,density:2})}{const t=new e.b2MotorJointDef;t.Initialize(o,r),t.maxForce=1e3,t.maxTorque=1e3,this.m_joint=this.m_world.CreateJoint(t)}}}(0,t.registerTest)("Bugs","Motor Joint (Bug #487)",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"qzTy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();const t=this.m_world.CreateBody();{const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(-40,25)),t.CreateFixture({shape:o}),o.SetTwoSided(new e.b2Vec2(40,0),new e.b2Vec2(40,25)),t.CreateFixture({shape:o})}{const t=new e.b2AreaJointDef,o=0,r=10,s=5,n=5,i=20,d=.5;for(let b=0;b<i;++b){const a=2*b*Math.PI/i,c=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,fixedRotation:!0,position:{x:o+s*Math.cos(a),y:r+n*Math.sin(a)}});c.CreateFixture({shape:new e.b2CircleShape(d),density:1}),t.AddBody(c)}const a=10,c=1;(0,e.b2LinearStiffness)(t,a,c,t.bodyA,t.bodyB),this.m_world.CreateJoint(t)}}GetDefaultViewZoom(){return 15}getCenter(){return{x:0,y:5}}}(0,t.registerTest)("Examples","Blob Test",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"pVzv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),o=new e.b2ChainShape;o.CreateLoop([new e.b2Vec2(-30,0),new e.b2Vec2(-30,40),new e.b2Vec2(30,40),new e.b2Vec2(30,0)]),t.CreateFixture({shape:o})}this.m_world.SetContinuousPhysics(!0);{const t=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,bullet:!0,position:{x:15,y:5}}),o=new e.b2PolygonShape;o.SetAsBox(4.5,.45);const n={density:4,restitution:1.4,shape:o};t.CreateFixture(n);const r=new e.b2PolygonShape;r.SetAsBox(.45,8.1,new e.b2Vec2(-4.35,7.05),.2),n.shape=r,t.CreateFixture(n);const s=new e.b2PolygonShape;s.SetAsBox(.45,8.1,new e.b2Vec2(4.35,7.05),-.2),n.shape=s,t.CreateFixture(n)}for(let t=0;t<5;t++){const t=new e.b2CircleShape(1*Math.random()+.5);this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,bullet:!0,position:{x:30*Math.random()-25,y:32*Math.random()+2}}).CreateFixture({shape:t,friction:.3,density:1,restitution:1.1})}}GetDefaultViewZoom(){return 20}getCenter(){return{x:0,y:15}}}(0,t.registerTest)("Continuous","Continuous Collision",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"KBgU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),o=new e.b2ChainShape;o.CreateLoop([new e.b2Vec2(-30,0),new e.b2Vec2(-30,40),new e.b2Vec2(30,40),new e.b2Vec2(30,0)]),t.CreateFixture({shape:o})}const t=new e.b2Vec2,o={position:t},r=new e.b2RevoluteJointDef;for(let a=0;a<2;++a){const i=2*Math.random()-20+40*a,n=30+5*Math.random();o.type=e.b2BodyType.b2_dynamicBody;const s={shape:new e.b2CircleShape(1.25),density:1,friction:.4,restitution:.3};t.Set(i,n);const l=this.m_world.CreateBody(o);l.CreateFixture(s),l.ApplyLinearImpulse(new e.b2Vec2(1e3*Math.random()-500,1e3*Math.random()-500),l.GetWorldCenter());const d=new e.b2PolygonShape;s.shape=d,d.SetAsBox(1.5,1),s.density=1,s.friction=.4,s.restitution=.1,t.Set(i,n-2.8);const w=this.m_world.CreateBody(o);w.CreateFixture(s),d.SetAsBox(1.5,1),t.Set(i,n-4.3);const c=this.m_world.CreateBody(o);c.CreateFixture(s),d.SetAsBox(1.5,1),t.Set(i,n-5.8);const b=this.m_world.CreateBody(o);b.CreateFixture(s),s.density=1,s.friction=.4,s.restitution=.1,d.SetAsBox(1.8,.65),t.Set(i-3,n-2);const C=this.m_world.CreateBody(o);C.CreateFixture(s),d.SetAsBox(1.8,.65),t.Set(i+3,n-2);const g=this.m_world.CreateBody(o);g.CreateFixture(s),s.density=1,s.friction=.4,s.restitution=.1,d.SetAsBox(1.7,.6),t.Set(i-5.7,n-2);const u=this.m_world.CreateBody(o);u.CreateFixture(s),d.SetAsBox(1.7,.6),t.Set(i+5.7,n-2);const p=this.m_world.CreateBody(o);p.CreateFixture(s),s.density=1,s.friction=.4,s.restitution=.1,d.SetAsBox(.75,2.2),t.Set(i-.8,n-8.5);const h=this.m_world.CreateBody(o);h.CreateFixture(s),d.SetAsBox(.75,2.2),t.Set(i+.8,n-8.5);const y=this.m_world.CreateBody(o);y.CreateFixture(s),s.density=1,s.friction=.4,s.restitution=.1,d.SetAsBox(.6,2),t.Set(i-.8,n-12);const m=this.m_world.CreateBody(o);m.CreateFixture(s),d.SetAsBox(.6,2),t.Set(i+.8,n-12);const x=this.m_world.CreateBody(o);x.CreateFixture(s),r.enableLimit=!0,r.lowerAngle=(0,e.b2DegToRad)(-40),r.upperAngle=(0,e.b2DegToRad)(40),r.Initialize(w,l,new e.b2Vec2(i,n-1.5)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-85),r.upperAngle=(0,e.b2DegToRad)(130),r.Initialize(w,C,new e.b2Vec2(i-1.8,n-2)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-130),r.upperAngle=(0,e.b2DegToRad)(85),r.Initialize(w,g,new e.b2Vec2(i+1.8,n-2)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-130),r.upperAngle=(0,e.b2DegToRad)(10),r.Initialize(C,u,new e.b2Vec2(i-4.5,n-2)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-10),r.upperAngle=(0,e.b2DegToRad)(130),r.Initialize(g,p,new e.b2Vec2(i+4.5,n-2)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-15),r.upperAngle=(0,e.b2DegToRad)(15),r.Initialize(w,c,new e.b2Vec2(i,n-3.5)),this.m_world.CreateJoint(r),r.Initialize(c,b,new e.b2Vec2(i,n-5)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-25),r.upperAngle=(0,e.b2DegToRad)(45),r.Initialize(b,h,new e.b2Vec2(i-.8,n-7.2)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-45),r.upperAngle=(0,e.b2DegToRad)(25),r.Initialize(b,y,new e.b2Vec2(i+.8,n-7.2)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-25),r.upperAngle=(0,e.b2DegToRad)(115),r.Initialize(h,m,new e.b2Vec2(i-.8,n-10.5)),this.m_world.CreateJoint(r),r.lowerAngle=(0,e.b2DegToRad)(-115),r.upperAngle=(0,e.b2DegToRad)(25),r.Initialize(y,x,new e.b2Vec2(i+.8,n-10.5)),this.m_world.CreateJoint(r)}o.type=e.b2BodyType.b2_staticBody;const i=new e.b2PolygonShape,n={shape:i,density:0,friction:.4,restitution:.3};for(let e=1;e<=10;++e)i.SetAsBox(1*e,1),t.Set(1*e-30,21-2*e),this.m_world.CreateBody(o).CreateFixture(n);for(let e=1;e<=10;++e)i.SetAsBox(1*e,1),t.Set(30-1*e,21-2*e),this.m_world.CreateBody(o).CreateFixture(n);i.SetAsBox(3,4),t.Set(0,4),this.m_world.CreateBody(o).CreateFixture(n)}GetDefaultViewZoom(){return 15}getCenter(){return{x:0,y:15}}}(0,t.registerTest)("Examples","Ragdolls",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"oRnO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class r extends t.Test{constructor(){super();{const t=this.m_world.CreateBody(),r=new e.b2ChainShape;r.CreateLoop([new e.b2Vec2(-30,0),new e.b2Vec2(-30,40),new e.b2Vec2(30,40),new e.b2Vec2(30,0)]),t.CreateFixture({shape:r})}const t=new e.b2Vec2,r={type:e.b2BodyType.b2_dynamicBody,position:t},o=new e.b2PolygonShape,n={shape:o,density:1,friction:.5,restitution:.1};o.SetAsBox(1,1);for(let e=0;e<10;++e)t.Set(0+.2*Math.random()-.1,30-2.5*e),this.m_world.CreateBody(r).CreateFixture(n);for(let e=0;e<10;++e)t.Set(10+.2*Math.random()-.1,30-2.5*e),this.m_world.CreateBody(r).CreateFixture(n);for(let e=0;e<10;++e)t.Set(20+.2*Math.random()-.1,30-2.5*e),this.m_world.CreateBody(r).CreateFixture(n);r.type=e.b2BodyType.b2_staticBody,t.Set(0,0);const i=[new e.b2Vec2(-30,0),new e.b2Vec2(-10,0),new e.b2Vec2(-30,10)];o.Set(i,i.length),n.density=0,this.m_world.CreateBody(r).CreateFixture(n),r.type=e.b2BodyType.b2_dynamicBody,t.Set(-25,20),n.shape=new e.b2CircleShape(4),n.density=2,n.restitution=.2,n.friction=.5,this.m_world.CreateBody(r).CreateFixture(n)}GetDefaultViewZoom(){return 15}getCenter(){return{x:0,y:15}}}(0,t.registerTest)("Stacking","Stacked Boxes",r);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"LAYy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class r extends t.Test{constructor(){super();const t=(t,r,n)=>{const o=t.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:r}),c=new e.b2PolygonShape;n?c.SetAsBox(15,2):c.SetAsBox(2,15),o.CreateFixture({shape:c,density:1/120,friction:.6,restitution:0})},r=this.m_world,n=r.CreateBody(),o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-600,-240),new e.b2Vec2(600,-240)),n.CreateFixture({shape:o,friction:1,restitution:1});for(let c=0;c<12;c++)for(let n=0;n<12-c;n++){const o=new e.b2Vec2(1.5*(n-.5*(11-c))*30,38*(c+.5)-4-240);t(r,o,!1),t(r,e.b2Vec2.Add(o,new e.b2Vec2(0,17),new e.b2Vec2),!0),0===n&&t(r,e.b2Vec2.Add(o,new e.b2Vec2(-13,34),new e.b2Vec2),!1),n!==12-c-1?t(r,e.b2Vec2.Add(o,new e.b2Vec2(22.5,21),new e.b2Vec2),!0):t(r,e.b2Vec2.Add(o,new e.b2Vec2(13,34),new e.b2Vec2),!1)}}GetDefaultViewZoom(){return 1.5}getCenter(){return{x:0,y:1}}}(0,t.registerTest)("Stacking","Pyramid Topple",r);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"ZCzq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class o extends t.Test{constructor(){super();const t=.2,o=.1,n=1;let i;const r=this.m_world;function s(s,y,c){const a=new e.b2PolygonShape;a.SetAsBox(.5*t,.5*n),r.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:{x:s,y:y},angle:c?Math.PI/2:0}).CreateFixture({shape:a,density:i,friction:o,restitution:.65})}{const t=new e.b2PolygonShape;t.SetAsBox(50,10),r.CreateBody({position:{x:0,y:-10}}).CreateFixture({shape:t,density:0})}{i=10;const t=new e.b2PolygonShape;t.SetAsBox(.7,.7);const o={density:35,shape:t,friction:0,restitution:.85};let n=r.CreateBody({type:e.b2BodyType.b2_dynamicBody,bullet:!0,position:{x:30,y:5}});n.CreateFixture(o),n.SetLinearVelocity(new e.b2Vec2(-25,-25)),n.SetAngularVelocity(6.7),o.density=25,(n=r.CreateBody({type:e.b2BodyType.b2_dynamicBody,bullet:!0,position:{x:-30,y:25}})).CreateFixture(o),n.SetLinearVelocity(new e.b2Vec2(35,-10)),n.SetAngularVelocity(-8.3)}{let e;for(let o=0;o<25;++o)s(e=1.5*o*n-1.5*n*25/2,n/2,!1),s(e,n+t/2,!0);e=37.5*n-1.5*n*25/2;for(let o=1;o<25;++o){o>3&&(i*=.8);const r=.5*n+.99*(n+2*t)*o;for(let y=0;y<25-o;++y)e=1.5*y*n-1.5*n*(25-o)/2,i*=2.5,0===y&&s(e-1.25*n+.5*t,r-t,!1),y===25-o-1&&s(e+1.25*n-.5*t,r-t,!1),i/=2.5,s(e,r,!1),s(e,r+.5*(t+n),!0),s(e,r-.5*(t+n),!0)}}}}(0,t.registerTest)("Benchmark","Domino Tower",o);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"X4xB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test"),r=require("../../utils/hotkeys"),o=.017453292519943295,s=0,i=1;class a{constructor(t){this.m_type=t}getType(){return this.m_type}}class n extends a{constructor(){super(s)}}class c extends a{constructor(t,e){super(i),this.frictionModifier=t,this.outOfCourse=e}}class h{constructor(e){this.m_groundAreas=[],this.m_currentTraction=1,this.m_maxForwardSpeed=0,this.m_maxBackwardSpeed=0,this.m_maxDriveForce=0,this.m_maxLateralImpulse=0,this.m_body=e.CreateBody({type:t.b2BodyType.b2_dynamicBody});const r=new t.b2PolygonShape;r.SetAsBox(.5,1.25),this.m_body.CreateFixture({shape:r,density:1}).SetUserData(new n),this.m_body.SetUserData(this)}setCharacteristics(t,e,r,o){this.m_maxForwardSpeed=t,this.m_maxBackwardSpeed=e,this.m_maxDriveForce=r,this.m_maxLateralImpulse=o}addGroundArea(t){this.m_groundAreas.push(t),this.updateTraction()}removeGroundArea(t){this.m_groundAreas.splice(this.m_groundAreas.indexOf(t)),this.updateTraction()}updateTraction(){0===this.m_groundAreas.length?this.m_currentTraction=1:(this.m_currentTraction=0,this.m_groundAreas.forEach(t=>{t.frictionModifier>this.m_currentTraction&&(this.m_currentTraction=t.frictionModifier)}))}getLateralVelocity(){const e=this.m_body.GetWorldVector(new t.b2Vec2(1,0),new t.b2Vec2);return e.Scale(t.b2Vec2.Dot(e,this.m_body.GetLinearVelocity()))}getForwardVelocity(){const e=this.m_body.GetWorldVector(new t.b2Vec2(0,1),new t.b2Vec2);return e.Scale(t.b2Vec2.Dot(e,this.m_body.GetLinearVelocity()))}updateFriction(){const t=this.getLateralVelocity().Scale(-1*this.m_body.GetMass());t.Length()>this.m_maxLateralImpulse&&t.Scale(this.m_maxLateralImpulse/t.Length()),this.m_body.ApplyLinearImpulse(t.Scale(this.m_currentTraction),this.m_body.GetWorldCenter()),this.m_body.ApplyAngularImpulse(.1*this.m_currentTraction*this.m_body.GetInertia()*-this.m_body.GetAngularVelocity());const e=this.getForwardVelocity(),r=-2*e.Normalize();this.m_body.ApplyForce(e.Scale(this.m_currentTraction*r),this.m_body.GetWorldCenter())}updateDrive(e){if(e.up===e.down)return;let r=0;e.up?r=this.m_maxForwardSpeed:e.down&&(r=this.m_maxBackwardSpeed);const o=this.m_body.GetWorldVector(new t.b2Vec2(0,1),new t.b2Vec2),s=t.b2Vec2.Dot(this.getForwardVelocity(),o);let i=0;if(r>s)i=this.m_maxDriveForce;else{if(!(r<s))return;i=-this.m_maxDriveForce}this.m_body.ApplyForce(o.Scale(this.m_currentTraction*i),this.m_body.GetWorldCenter())}updateTurn(t){let e=0;t.left&&(e+=15),t.right&&(e-=15),this.m_body.ApplyTorque(e)}}class d{constructor(e){this.m_tires=[],this.m_body=e.CreateBody({type:t.b2BodyType.b2_dynamicBody}),this.m_body.SetAngularDamping(3);const r=[];r[0]=new t.b2Vec2(1.5,0),r[1]=new t.b2Vec2(3,2.5),r[2]=new t.b2Vec2(2.8,5.5),r[3]=new t.b2Vec2(1,10),r[4]=new t.b2Vec2(-1,10),r[5]=new t.b2Vec2(-2.8,5.5),r[6]=new t.b2Vec2(-3,2.5),r[7]=new t.b2Vec2(-1.5,0);const o=new t.b2PolygonShape;o.Set(r,8),this.m_body.CreateFixture({shape:o,density:.1});const s=new t.b2RevoluteJointDef;s.bodyA=this.m_body,s.enableLimit=!0,s.lowerAngle=0,s.upperAngle=0,s.localAnchorB.SetZero();let i=new h(e);i.setCharacteristics(250,-40,300,8.5),s.bodyB=i.m_body,s.localAnchorA.Set(-3,.75),e.CreateJoint(s),this.m_tires.push(i),(i=new h(e)).setCharacteristics(250,-40,300,8.5),s.bodyB=i.m_body,s.localAnchorA.Set(3,.75),e.CreateJoint(s),this.m_tires.push(i),(i=new h(e)).setCharacteristics(250,-40,500,7.5),s.bodyB=i.m_body,s.localAnchorA.Set(-3,8.5),this.flJoint=e.CreateJoint(s),this.m_tires.push(i),(i=new h(e)).setCharacteristics(250,-40,500,7.5),s.bodyB=i.m_body,s.localAnchorA.Set(3,8.5),this.frJoint=e.CreateJoint(s),this.m_tires.push(i)}update(e){this.m_tires.forEach(t=>{t.updateFriction()}),this.m_tires.forEach(t=>{t.updateDrive(e)});const r=35*o,s=160*o/60;let i=0;e.left&&(i+=r),e.right&&(i-=r);const a=this.flJoint.GetJointAngle();let n=i-a;const c=a+(n=(0,t.b2Clamp)(n,-s,s));this.flJoint.SetLimits(c,c),this.frJoint.SetLimits(c,c)}}class m extends e.Test{constructor(){super(t.b2Vec2.ZERO),this.m_controlState={left:!1,right:!1,up:!1,down:!1};{this.m_groundBody=this.m_world.CreateBody();const e=new t.b2PolygonShape,r={shape:e,isSensor:!0};e.SetAsBox(9,7,new t.b2Vec2(-10,15),20*o);let s=this.m_groundBody.CreateFixture(r);s.SetUserData(new c(.5,!1)),e.SetAsBox(9,5,new t.b2Vec2(5,20),-40*o),(s=this.m_groundBody.CreateFixture(r)).SetUserData(new c(.2,!1))}this.m_car=new d(this.m_world)}getHotkeys(){return[(0,r.hotKeyState)("a","Turn Left",this.m_controlState,"left"),(0,r.hotKeyState)("d","Turn Right",this.m_controlState,"right"),(0,r.hotKeyState)("w","Move Forward",this.m_controlState,"up"),(0,r.hotKeyState)("s","Move Backward",this.m_controlState,"down")]}static handleContact(t,e){const r=t.GetFixtureA(),o=t.GetFixtureB(),a=r.GetUserData(),n=o.GetUserData();a&&n&&(a.getType()===s||n.getType()===i?m.tire_vs_groundArea(r,o,e):a.getType()!==i&&n.getType()!==s||m.tire_vs_groundArea(o,r,e))}BeginContact(t){m.handleContact(t,!0)}EndContact(t){m.handleContact(t,!1)}static tire_vs_groundArea(t,e,r){const o=t.GetBody().GetUserData(),s=e.GetUserData();r?o.addGroundArea(s):o.removeGroundArea(s)}Step(t,e){this.m_car.update(this.m_controlState),super.Step(t,e)}}(0,e.registerTest)("Examples","TopDown Car",m);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../utils/hotkeys":"EV9t"}],"eHqc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test"),i=require("../../ui/controls/Slider");class s extends e.Test{constructor(){super();const e=this.m_world.CreateBody(),i=new t.b2EdgeShape;i.SetTwoSided(new t.b2Vec2(-40,0),new t.b2Vec2(40,0)),e.CreateFixture({shape:i});const s={x:0,y:5},n=this.m_world.CreateBody({type:t.b2BodyType.b2_dynamicBody,angularDamping:.1,position:s}),h=new t.b2PolygonShape;h.SetAsBox(.5,.5),n.CreateFixture({shape:h,density:5}),this.m_hertz=1,this.m_dampingRatio=.7;const o=new t.b2DistanceJointDef;o.Initialize(e,n,new t.b2Vec2(0,15),s),o.collideConnected=!0,this.m_length=o.length,this.m_minLength=this.m_length,this.m_maxLength=this.m_length,(0,t.b2LinearStiffness)(o,this.m_hertz,this.m_dampingRatio,o.bodyA,o.bodyB),this.m_joint=this.m_world.CreateJoint(o)}setupControls(){this.addTestControlGroup("Joint",[(0,i.sliderDef)("Length",0,20,1,this.m_length,t=>{this.m_length=this.m_joint.SetLength(t)}),(0,i.sliderDef)("Min Length",0,20,1,this.m_minLength,t=>{this.m_minLength=this.m_joint.SetMinLength(t)}),(0,i.sliderDef)("Max Length",0,20,1,this.m_maxLength,t=>{this.m_maxLength=this.m_joint.SetMaxLength(t)}),(0,i.sliderDef)("Hertz",0,10,.1,this.m_hertz,t=>{this.m_hertz=t,this.UpdateStiffness()}),(0,i.sliderDef)("Damping Ratio",0,2,.1,this.m_dampingRatio,t=>{this.m_dampingRatio=t,this.UpdateStiffness()})])}UpdateStiffness(){const e={stiffness:0,damping:0};(0,t.b2LinearStiffness)(e,this.m_hertz,this.m_dampingRatio,this.m_joint.GetBodyA(),this.m_joint.GetBodyB()),this.m_joint.SetStiffness(e.stiffness),this.m_joint.SetDamping(e.damping)}}(0,e.registerTest)("Joints","Distance Joint",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../ui/controls/Slider":"eXYw"}],"t2eE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test"),o=require("../../ui/controls/Checkbox"),i=require("../../ui/controls/Slider");class r extends t.Test{constructor(){super(),this.m_motorSpeed=10,this.m_enableMotor=!1,this.m_enableLimit=!0;const t=this.m_world.CreateBody();{const o=new e.b2EdgeShape;o.SetTwoSided(new e.b2Vec2(-40,0),new e.b2Vec2(40,0)),t.CreateFixture({shape:o,density:0})}{const o=new e.b2CircleShape(2),i=new e.b2Vec2(0,10),r=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:i,allowSleep:!1});r.CreateFixture({shape:o,density:5});const s=new e.b2WheelJointDef;s.Initialize(t,r,i,new e.b2Vec2(0,1)),s.motorSpeed=this.m_motorSpeed,s.maxMotorTorque=1e4,s.enableMotor=this.m_enableMotor,s.lowerTranslation=-3,s.upperTranslation=3,s.enableLimit=this.m_enableLimit;const n=1,a=.7;(0,e.b2LinearStiffness)(s,n,a,t,r),this.m_joint=this.m_world.CreateJoint(s)}this.addTestControlGroup("Joint",[(0,o.checkboxDef)("Limit",this.m_enableLimit,e=>{this.m_enableLimit=this.m_joint.EnableLimit(e)}),(0,o.checkboxDef)("Motor",this.m_enableMotor,e=>{this.m_enableMotor=this.m_joint.EnableMotor(e)}),(0,i.sliderDef)("Speed",-100,100,1,this.m_motorSpeed,e=>{this.m_motorSpeed=this.m_joint.SetMotorSpeed(e)})])}Step(t,o){super.Step(t,o);const i=this.m_joint.GetMotorTorque(t.m_hertz);this.addDebug("Motor Torque",i);const r=this.m_joint.GetReactionForce(t.m_hertz,new e.b2Vec2);this.addDebug("Reaction Force",`(${r.x.toFixed(1)}, ${r.y.toFixed(1)})`)}}(0,t.registerTest)("Joints","Wheel",r);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../ui/controls/Checkbox":"preb","../../ui/controls/Slider":"eXYw"}],"OAod":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("@box2d/core"),e=require("../../test"),i=require("../../ui/controls/Checkbox");class s extends e.Test{constructor(){super(),this.m_distanceJointDef=new t.b2DistanceJointDef,this.m_stabilize=!1;const e=this.m_world.CreateBody();{const i=new t.b2EdgeShape;i.SetTwoSided(new t.b2Vec2(-40,0),new t.b2Vec2(40,0)),e.CreateFixture({shape:i,density:0})}{const i=new t.b2PolygonShape;i.SetAsBox(.5,.125);const s={shape:i,density:20,friction:.2,filter:{categoryBits:1,maskBits:65533}},n=new t.b2RevoluteJointDef;n.collideConnected=!1;const o=10,c=15;this.m_distanceJointDef.localAnchorA.Set(0,c);let a=e;for(let e=0;e<o;++e){const i=new t.b2Vec2(.5+1*e,c),r={type:t.b2BodyType.b2_dynamicBody,position:i};e===o-1&&(i.Set(1*e,c),r.angularDamping=.4);const d=this.m_world.CreateBody(r);if(e===o-1){const e=new t.b2CircleShape(1.5);d.CreateFixture({shape:e,density:100,filter:{categoryBits:2}})}else d.CreateFixture(s);const l=new t.b2Vec2(e,c);n.Initialize(a,d,l),this.m_world.CreateJoint(n),a=d}this.m_distanceJointDef.localAnchorB.SetZero();const r=.01;this.m_distanceJointDef.minLength=0,this.m_distanceJointDef.maxLength=o-1+r,this.m_distanceJointDef.bodyB=a}this.m_distanceJointDef.bodyA=e,this.m_distanceJoint=this.m_world.CreateJoint(this.m_distanceJointDef),this.m_stabilize=!0}setupControls(){this.addTestControlGroup("Wrecking Ball",[(0,i.checkboxDef)("Stabilize",this.m_stabilize,t=>{this.m_stabilize=t,t&&null===this.m_distanceJoint?this.m_distanceJoint=this.m_world.CreateJoint(this.m_distanceJointDef):t||null===this.m_distanceJoint||(this.m_world.DestroyJoint(this.m_distanceJoint),this.m_distanceJoint=null)})])}Step(t,e){super.Step(t,e),this.addDebug("Distance Joint",this.m_distanceJoint?"ON":"OFF")}}(0,e.registerTest)("Examples","Wrecking Ball",s);
},{"@box2d/core":"FjWk","../../test":"XTIe","../../ui/controls/Checkbox":"preb"}],"AVjD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("@box2d/core"),t=require("../../test");class r extends t.Test{constructor(){super();const t=new e.b2Vec2(0,-10);this.m_world.SetGravity(t);const r=[];r[0]=this.m_world.CreateBody({type:e.b2BodyType.b2_staticBody});{const t=new e.b2Vec2(0,1),o=new e.b2Vec2(0,0),s=new e.b2Vec2(4,0),i=new e.b2EdgeShape;i.SetTwoSided(t,o),r[0].CreateFixture({shape:i}),i.SetTwoSided(o,s),r[0].CreateFixture({shape:i})}r[1]=this.m_world.CreateBody({type:e.b2BodyType.b2_dynamicBody,position:new e.b2Vec2(1,3)});{const t=new e.b2PolygonShape,o=(0,e.b2MakeArray)(8,e.b2Vec2);o[0].Set(.5,-3),o[1].Set(.5,3),o[2].Set(-.5,3),o[3].Set(-.5,-3),t.Set(o,4),r[1].CreateFixture({shape:t,friction:.2,density:10})}}}(0,t.registerTest)("Bugs","Chain Problem",r);
},{"@box2d/core":"FjWk","../../test":"XTIe"}],"qTNo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./add_pair"),require("./apply_force"),require("./slider_crank_1"),require("./body_types"),require("./breakable"),require("./bridge"),require("./bullet_test"),require("./cantilever"),require("./car"),require("./continuous_test"),require("./chain"),require("./character_collision"),require("./collision_filtering"),require("./collision_processing"),require("./compound_shapes"),require("./confined"),require("./convex_hull"),require("./conveyor_belt"),require("./distance_test"),require("./dominos"),require("./dump_shell"),require("./dynamic_tree"),require("./edge_shapes"),require("./edge_test"),require("./gear_joint"),require("./heavy1"),require("./heavy2"),require("./mobile_unbalanced"),require("./mobile_balanced"),require("./motor_joint"),require("./platformer"),require("./pinball"),require("./polygon_collision"),require("./polygon_shapes"),require("./prismatic_joint"),require("./pulley_joint"),require("./pyramid"),require("./ray_cast"),require("./revolute_joint"),require("./sensor"),require("./shape_cast"),require("./shape_editing"),require("./skier"),require("./slider_crank_2"),require("./circle_stack"),require("./theo_jansen"),require("./tiles"),require("./time_of_impact"),require("./tumbler"),require("./friction"),require("./restitution"),require("./box_stack"),require("./web"),require("./rope"),require("./motor_joint2"),require("./blob_test"),require("./continous_collision"),require("./ragdolls"),require("./test_stack"),require("./pyramid_topple"),require("./domino_tower"),require("./top_down_car"),require("./distance_joint"),require("./wheel_joint"),require("./wrecking_ball"),require("./chain_problem");
},{"./add_pair":"SedG","./apply_force":"FVox","./slider_crank_1":"kIQ6","./body_types":"Tar1","./breakable":"HhkB","./bridge":"gwD4","./bullet_test":"gYHV","./cantilever":"Le3H","./car":"ygSt","./continuous_test":"IeNr","./chain":"cVdp","./character_collision":"PnmG","./collision_filtering":"zYjI","./collision_processing":"iFXO","./compound_shapes":"PSXK","./confined":"Z8wF","./convex_hull":"IoNu","./conveyor_belt":"MSqr","./distance_test":"Ioxf","./dominos":"FIrH","./dump_shell":"CS84","./dynamic_tree":"fuN2","./edge_shapes":"eWMO","./edge_test":"DAjt","./gear_joint":"i4wY","./heavy1":"R2Cf","./heavy2":"ysiq","./mobile_unbalanced":"WWBw","./mobile_balanced":"potL","./motor_joint":"dDqt","./platformer":"ENhL","./pinball":"aJvN","./polygon_collision":"iHGO","./polygon_shapes":"TsIM","./prismatic_joint":"KOHz","./pulley_joint":"jYYg","./pyramid":"ZYXC","./ray_cast":"M6wA","./revolute_joint":"nfXo","./sensor":"t4x2","./shape_cast":"Dl3u","./shape_editing":"MuO2","./skier":"hNdw","./slider_crank_2":"yGP5","./circle_stack":"fewI","./theo_jansen":"nQFY","./tiles":"uFmP","./time_of_impact":"e6FC","./tumbler":"t4Qr","./friction":"jkPn","./restitution":"M20t","./box_stack":"UOOG","./web":"lPql","./rope":"kBjC","./motor_joint2":"P1CY","./blob_test":"qzTy","./continous_collision":"pVzv","./ragdolls":"KBgU","./test_stack":"oRnO","./pyramid_topple":"LAYy","./domino_tower":"ZCzq","./top_down_car":"X4xB","./distance_joint":"eHqc","./wheel_joint":"t2eE","./wrecking_ball":"OAod","./chain_problem":"AVjD"}],"fZFK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./particles"),require("./lights"),require("./controllers"),require("./core");
},{"./particles":"kTdU","./lights":"cXYR","./controllers":"HjDI","./core":"qTNo"}],"hmdz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useManager=exports.ManagerContext=exports.TestManager=void 0;const t=require("@box2d/core"),e=require("@box2d/debug-draw"),s=require("react"),i=require("typed-signals"),a=require("./utils/camera"),o=require("./utils/hotkeys"),r=require("./utils/gl/preload"),n=require("./utils/gl/defaultShader"),h=require("./utils/gl/glUtils"),l=require("./settings"),m=require("./test"),u=require("./utils/FpsCalculator"),d=require("./utils/particles/particle_parameter");function c(t){return" "===t.key?"Space":t.key}require("./tests");class g{constructor(){this.m_fpsCalculator=new u.FpsCalculator(200,200,16),this.m_settings=new l.Settings,this.m_test=null,this.m_lMouseDown=!1,this.m_rMouseDown=!1,this.m_max_demo_time=1e4,this.m_ctx=null,this.m_mouse=new t.b2Vec2,this.testBaseHotKeys=[],this.testHotKeys=[],this.allHotKeys=[],this.stepHotKeys=[],this.groupedTests=(0,m.getTestsGrouped)(),this.flatTests=[],this.testConstructor=null,this.testTitle="Unset",this.onPauseChanged=new i.Signal,this.m_hoveringCanvas=!1,this.shouldRestart=!1,this.m_keyMap={},this.gl=null,this.textures=null,this.defaultShader=null,this.activateTest=(()=>{}),this.setLeftTable=(()=>{}),this.setRightTable=(()=>{}),this.setTestControlGroups=(()=>{}),this.particleParameter=new d.ParticleParameter(this);for(const{tests:t}of this.groupedTests)this.flatTests.push(...t);this.ownHotKeys=[(0,o.hotKeyPress)("0","Reset Camera",()=>this.HomeCamera()),(0,o.hotKeyPress)("+","Zoom In",()=>this.ZoomCamera(1.1)),(0,o.hotKeyPress)("-","Zoom Out",()=>this.ZoomCamera(.9)),(0,o.hotKeyPress)("r","Reload Test",()=>this.LoadTest()),(0,o.hotKeyPress)("o","Single Step",()=>this.SingleStep()),(0,o.hotKeyPress)("p","Pause/Continue",()=>this.SetPause(!this.m_settings.m_pause)),(0,o.hotKeyPress)("PageUp","Previous Test",()=>this.DecrementTest()),(0,o.hotKeyPress)("PageDown","Next Test",()=>this.IncrementTest())]}init(t,s,i,o,r,n,l){this.setLeftTable=r,this.setRightTable=n,this.activateTest=o,this.setTestControlGroups=l,s.addEventListener("mousedown",t=>this.HandleMouseDown(t)),s.addEventListener("mouseup",t=>this.HandleMouseUp(t)),s.addEventListener("mousemove",t=>this.HandleMouseMove(t)),s.addEventListener("wheel",t=>this.HandleMouseWheel(t)),s.addEventListener("mouseenter",()=>{this.m_hoveringCanvas=!0}),s.addEventListener("mouseleave",()=>{this.m_hoveringCanvas=!1});const m=()=>{var e;const{clientWidth:o,clientHeight:r}=i;s.width===o&&s.height===r||(s.width=t.width=o,s.height=t.height=r,a.g_camera.resize(o,r),null===(e=this.m_test)||void 0===e||e.Resize(o,r),this.gl&&(0,h.resizeGlCanvas)(t,this.gl,o,i.clientHeight))};if(window.addEventListener("resize",m),window.addEventListener("orientationchange",m),m(),this.m_ctx=s.getContext("2d"),!this.m_ctx)throw new Error("Could not create 2d context for debug-draw");this.m_settings.m_debugDraw=new e.DebugDraw(this.m_ctx),window.addEventListener("contextmenu",t=>{t.target instanceof HTMLElement&&t.target.closest("main")&&t.preventDefault()},!0),window.addEventListener("keydown",t=>this.HandleKey(t,!0)),window.addEventListener("keyup",t=>this.HandleKey(t,!1)),this.LoadTest(),this.prepareGl(t)}async prepareGl(t){this.gl=(0,h.initGlCanvas)(t),this.textures=await(0,r.preloadTextures)(this.gl),this.defaultShader=(0,n.createDefaultShader)(this.gl),this.LoadTest()}setTest(t,e){this.testTitle=t,this.testConstructor=e,this.LoadTest()}HomeCamera(){const e=this.m_test?this.m_test.GetDefaultViewZoom():25,s=this.m_test?this.m_test.getCenter():t.b2Vec2.ZERO;a.g_camera.setPositionAndZoom(s.x,s.y,e)}ZoomCamera(e){a.g_camera.setZoom((0,t.b2Clamp)(a.g_camera.getZoom()*e,.5,500))}HandleMouseMove(e){var s;const i=new t.b2Vec2(e.offsetX,e.offsetY),o=a.g_camera.unproject(i,new t.b2Vec2);if(this.m_mouse.Copy(i),null===(s=this.m_test)||void 0===s||s.MouseMove(o,this.m_lMouseDown),this.m_rMouseDown){const{x:t,y:s}=a.g_camera.getCenter(),i=1/a.g_camera.getZoom();a.g_camera.setPosition(t-e.movementX*i,s+e.movementY*i)}}HandleMouseDown(e){var s,i;const o=new t.b2Vec2(e.offsetX,e.offsetY),r=a.g_camera.unproject(o,new t.b2Vec2);switch(e.button){case 0:this.m_lMouseDown=!0,e.shiftKey?null===(s=this.m_test)||void 0===s||s.ShiftMouseDown(r):null===(i=this.m_test)||void 0===i||i.MouseDown(r);break;case 2:this.m_rMouseDown=!0}}HandleMouseUp(e){var s;const i=new t.b2Vec2(e.offsetX,e.offsetY),o=a.g_camera.unproject(i,new t.b2Vec2);switch(e.button){case 0:this.m_lMouseDown=!1,null===(s=this.m_test)||void 0===s||s.MouseUp(o);break;case 2:this.m_rMouseDown=!1}}HandleMouseWheel(t){this.m_hoveringCanvas&&(t.deltaY<0?this.ZoomCamera(1.1):t.deltaY>0&&this.ZoomCamera(1/1.1),t.preventDefault())}HandleKey(t,e){if(this.m_hoveringCanvas||!e){const{key:s}=t,i=this.allHotKeys.find(t=>t.key===s);if(i){!!this.m_keyMap[s]!==e&&(i.step||i.callback(e),this.m_keyMap[s]=e),this.m_hoveringCanvas&&t.preventDefault()}}}DecrementTest(){const t=this.flatTests.findIndex(t=>t.name===this.testTitle)-1;t<0?this.activateTest(this.flatTests[this.flatTests.length-1]):t>=0&&this.activateTest(this.flatTests[t])}IncrementTest(){const t=this.flatTests.findIndex(t=>t.name===this.testTitle)+1;t>=this.flatTests.length?this.activateTest(this.flatTests[0]):t>0&&this.activateTest(this.flatTests[t])}LoadTest(t=!1){var e;const s=this.testConstructor;if(s&&this.m_ctx&&this.gl&&this.defaultShader&&this.textures&&this.m_settings.m_debugDraw){t||this.particleParameter.Reset(),null===(e=this.m_test)||void 0===e||e.Destroy(),this.m_test=new s({gl:this.gl,shader:this.defaultShader,textures:this.textures,particleParameter:this.particleParameter}),this.m_test.setupControls(),this.testBaseHotKeys=this.m_test.getBaseHotkeys(),this.testHotKeys=this.m_test.getHotkeys(),this.allHotKeys=[...this.ownHotKeys,...this.testBaseHotKeys,...this.testHotKeys],this.stepHotKeys=this.allHotKeys.filter(t=>t.step);for(const t of this.allHotKeys){const e=this.allHotKeys.find(e=>t.key===e.key);e&&t!==e&&console.error(`Conflicting keys "${t.description}" and "${e.description}"`)}t||this.HomeCamera(),this.setTestControlGroups(this.m_test.m_testControlGroups.slice())}}SetPause(t){this.m_settings.m_pause=t,this.onPauseChanged.emit(t)}SingleStep(){this.m_settings.m_pause||(this.m_settings.m_pause=!0,this.onPauseChanged.emit(!0)),this.m_settings.m_singleStep=!0}scheduleRestart(){this.shouldRestart=!0}SimulationLoop(){var t;const e=this.m_settings.m_debugDraw;if(this.m_fpsCalculator.addFrame()<=0||!this.gl||!this.defaultShader||!this.m_ctx||!e)return;(0,h.clearGlCanvas)(this.gl,0,0,0,0),this.gl.enable(this.gl.BLEND),this.defaultShader.use(),this.defaultShader.uMVMatrix.set(!1,a.g_camera.modelView),this.defaultShader.uPMatrix.set(!1,a.g_camera.projection);const s=a.g_camera.getCenter(),i=a.g_camera.getZoom();if(e.Prepare(s.x,s.y,i,!0),null===(t=this.m_test)||void 0===t||t.RunStep(this.m_settings),this.m_hoveringCanvas)for(const a of this.stepHotKeys)this.m_keyMap[a.key]&&a.callback(!0);e.Finish(),this.m_settings.m_drawFpsMeter&&this.DrawFpsMeter(this.m_ctx),this.UpdateText(),this.shouldRestart&&(this.shouldRestart=!1,this.LoadTest(!0))}DrawFpsMeter(s){s.save(),s.translate(0,a.g_camera.getHeight()),s.scale(1,-1),s.fillStyle=e.DebugDraw.MakeStyleString(t.b2Color.GREEN);let i=5;for(const t of this.m_fpsCalculator.getFrames())s.fillRect(i,5,1,t),i++;s.restore()}UpdateText(){const t=[],e=this.m_fpsCalculator.getFps(),s=[["Performance:","!"],["Avg. FPS",e.avgFps.toFixed(1)],["Max. Time in ms",e.maxTime.toFixed(1)],["Min. Time in ms",e.minTime.toFixed(1)],["",""]];this.m_test&&(this.m_test.m_textLines.length&&t.push(["Description:","!"],...this.m_test.m_textLines.map(t=>[t,"-"]),["",""]),this.m_settings.m_drawInputHelp&&(t.push(["Mouse:","!"],["Right Drag","Move Camera"],["Left Drag","Grab Objects"],["Wheel","Zoom"],["",""]),t.push(["Keyboard:","!"],...this.allHotKeys.map(t=>[c(t),t.description]),["",""])),this.m_test.m_debugLines.length&&s.push(["Debug Info:","!"],...this.m_test.m_debugLines,["",""]),this.m_test.m_statisticLines.length&&s.push(["Statistics:","!"],...this.m_test.m_statisticLines,["",""])),this.setLeftTable(t),this.setRightTable(s)}}exports.TestManager=g,exports.ManagerContext=(0,s.createContext)(new g);const _=()=>(0,s.useContext)(exports.ManagerContext);exports.useManager=_;
},{"@box2d/core":"FjWk","@box2d/debug-draw":"ewl9","react":"dmLA","typed-signals":"kwcl","./utils/camera":"GUc7","./utils/hotkeys":"EV9t","./utils/gl/preload":"QiTb","./utils/gl/defaultShader":"isif","./utils/gl/glUtils":"FFRI","./settings":"y9CM","./test":"XTIe","./utils/FpsCalculator":"IIZf","./utils/particles/particle_parameter":"OotG","./tests":"fZFK"}],"wtUw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getTestLink=exports.classPrefix=void 0;const e=(e,s)=>s?`${e} ${s}-${e}`:e;exports.classPrefix=e;const s=/[^a-z0-9-]+/gi,t=({group:e,name:t})=>`/${e.replace(s,"_")}#${t.replace(s,"_")}`;exports.getTestLink=t;
},{}],"E7LK":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var l=Object.getOwnPropertyDescriptor(t,r);l&&("get"in l?t.__esModule:!l.writable&&!l.configurable)||(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,l)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var l in r)"default"!==l&&Object.prototype.hasOwnProperty.call(r,l)&&e(n,r,l);return t(n,r),n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Main=exports.useActiveTestEntry=void 0;const n=r(require("react")),l=require("@react-nano/router"),a=require("../../manager"),u=require("../../utils/reactUtils");function i(e,t){return JSON.stringify(e)!==JSON.stringify(t)?t:e}const o=({label:e,value:t})=>"!"===t?n.default.createElement("tr",null,n.default.createElement("th",{colSpan:2},e)):"-"===t?n.default.createElement("tr",null,n.default.createElement("td",{colSpan:2},e)):n.default.createElement("tr",null,n.default.createElement("td",null,t),n.default.createElement("td",null,e)),s=({id:e,table:t})=>n.default.createElement("div",{id:e},n.default.createElement("table",null,n.default.createElement("tbody",null,t.map(([e,t],r)=>n.default.createElement(o,{key:r,label:e,value:t}))))),c=({entry:{name:e,TestClass:t},setTestControlGroups:r})=>{var o;const[c,f]=(0,n.useReducer)(i,[]),[m,p]=(0,n.useReducer)(i,[]),E=(0,n.useRef)(null),v=(0,n.useRef)(null),b=(0,n.useRef)(null),y=(0,a.useManager)(),g=(0,l.useRouter)(),h=d();return(0,n.useEffect)(()=>{const e=E.current,t=v.current,n=b.current;if(e&&t&&n){const l=()=>{try{y.SimulationLoop(),window.requestAnimationFrame(l)}catch(e){console.error("Error during simulation loop",e)}},a=()=>{y.init(e,t,n,e=>g.history.push((0,u.getTestLink)(e)),f,p,r),window.requestAnimationFrame(l)};window.requestAnimationFrame(a)}},[v.current,E.current,b.current,y]),(0,n.useEffect)(()=>{y.setTest(e,t)},[y,t]),n.default.createElement("main",{ref:b},n.default.createElement("canvas",{ref:E}),n.default.createElement("canvas",{ref:v}),n.default.createElement(s,{id:"left_overlay",table:c}),n.default.createElement("div",{id:"title_overlay"},null!==(o=null==h?void 0:h.name)&&void 0!==o?o:""),n.default.createElement(s,{id:"right_overlay",table:m}))};function d(){const e=(0,l.useRouter)(),t=decodeURIComponent(e.path);return(0,a.useManager)().flatTests.find(e=>(0,u.getTestLink)(e)===t)}exports.useActiveTestEntry=d;const f=({setTestControlGroups:e})=>{const t=d();return t?n.default.createElement(c,{entry:t,setTestControlGroups:e}):n.default.createElement("main",null,"Select a test from the right sidebar")};exports.Main=f;
},{"react":"dmLA","@react-nano/router":"Tbrz","../../manager":"hmdz","../../utils/reactUtils":"wtUw"}],"cP8p":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Separator=exports.separatorDef=void 0;const r=e(require("react"));function t(e){return{type:"separator",name:e}}require("./style.scss"),exports.separatorDef=t;const s=()=>r.default.createElement("div",{className:"separator"});exports.Separator=s;
},{"react":"dmLA","./style.scss":"GXLA"}],"HyP1":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var c=Object.getOwnPropertyDescriptor(t,n);c&&("get"in c?t.__esModule:!c.writable&&!c.configurable)||(c={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,c)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var c in n)"default"!==c&&Object.prototype.hasOwnProperty.call(n,c)&&e(r,n,c);return t(r,n),r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Section=void 0;const r=n(require("react"));require("./style.scss");const c=({className:e,legend:t,legendClassName:n,children:c,defaultOpen:i=!1})=>{const[o,s]=(0,r.useState)(i),a=[];return n&&a.push(n),o&&a.push("open-legend"),r.default.createElement("fieldset",{className:`section ${null!=e?e:""}`},r.default.createElement("legend",{onClick:()=>s(!o),tabIndex:0,className:a.join(" ")},t),r.default.createElement("div",{className:o?"section-content":"section-content section-content-hidden"},c))};exports.Section=c;
},{"react":"dmLA","./style.scss":"GXLA"}],"V6BU":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SettingsSection=void 0;const t=e(require("react")),r=require("../controls/Checkbox"),o=require("../controls/Radio"),l=require("../controls/Select"),n=require("../controls/Separator"),c=require("../controls/Slider"),a=require("../Section");require("./style.scss");const s=({control:e})=>{switch(e.type){case"slider":return t.default.createElement(c.Slider,{control:e});case"checkbox":return t.default.createElement(r.Checkbox,{control:e});case"radio":return t.default.createElement(o.Radio,{control:e});case"select":return t.default.createElement(l.Select,{control:e});case"separator":return t.default.createElement(n.Separator,null)}return null},u=({legend:e,controls:r,defaultOpen:o})=>t.default.createElement(a.Section,{legend:e,defaultOpen:o,className:"settings-section"},r.map(e=>t.default.createElement(s,{key:e.name,control:e})));exports.SettingsSection=u;
},{"react":"dmLA","../controls/Checkbox":"preb","../controls/Radio":"nr7a","../controls/Select":"lYGI","../controls/Separator":"cP8p","../controls/Slider":"eXYw","../Section":"HyP1","./style.scss":"GXLA"}],"gpWw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.settingsSliderDef=exports.settingsCheckboxDef=void 0;const e=require("./ui/controls/Checkbox"),t=require("./ui/controls/Slider");function r(t,r,s){const o=t[r];return(0,e.checkboxDef)(s,o,e=>{t[r]=e})}function s(e,r,s,o,i,n){const c=e[r];return(0,t.sliderDef)(s,o,i,n,c,t=>{e[r]=t})}exports.settingsCheckboxDef=r,exports.settingsSliderDef=s;
},{"./ui/controls/Checkbox":"preb","./ui/controls/Slider":"eXYw"}],"R9Rp":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Button=void 0;const t=e(require("react"));require("./style.scss");const o=({label:e,onClick:o})=>t.default.createElement("button",{className:"button",onClick:o},e);exports.Button=o;
},{"react":"dmLA","./style.scss":"GXLA"}],"b64Y":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TestsFolder=void 0;const t=e(require("react")),r=require("@react-nano/router"),s=require("../../utils/reactUtils"),n=require("../Section"),i=({name:e,link:i,tests:a})=>{const l=a.some(e=>i===(0,s.getTestLink)(e));return t.default.createElement(n.Section,{legend:e,legendClassName:l?"active-legend":""},a.map(e=>t.default.createElement(r.Link,{href:(0,s.getTestLink)(e),key:e.name,className:i===(0,s.getTestLink)(e)?"active-link":""},e.name)))};exports.TestsFolder=i;
},{"react":"dmLA","@react-nano/router":"Tbrz","../../utils/reactUtils":"wtUw","../Section":"HyP1"}],"kR8o":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,r)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var n={};if(null!=s)for(var r in s)"default"!==r&&Object.prototype.hasOwnProperty.call(s,r)&&e(n,s,r);return t(n,s),n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SideBar=void 0;const n=s(require("react")),r=require("@react-nano/router");require("./style.scss");const a=require("../../manager"),o=require("../SettingsSection"),i=require("../../testControls"),l=require("../controls/Button"),c=require("../TestsFolder"),u=require("../../utils/reactUtils"),d=({testControlGroups:e})=>{const[t,s]=(0,n.useState)("controls"),[d,m]=(0,n.useState)(!1),f=(0,a.useManager)(),g=(0,r.useRouter)(),b=decodeURIComponent(g.path),p=(0,n.useMemo)(()=>f.groupedTests.some(e=>e.tests.some(e=>b===(0,u.getTestLink)(e))),[f,b]);(0,n.useEffect)(()=>{const e=f.onPauseChanged.connect(m);return()=>{e.disconnect()}}),(0,n.useEffect)(()=>{p||"tests"===t||s("tests")},[p,t]);const S=f.m_settings,C=[(0,i.settingsSliderDef)(S,"m_velocityIterations","Velocity Iters",0,50,1),(0,i.settingsSliderDef)(S,"m_positionIterations","Position Iters",0,50,1),(0,i.settingsSliderDef)(S,"m_particleIterations","Particle Iters",0,50,1),(0,i.settingsSliderDef)(S,"m_hertz","Hertz",5,120,1)],_=[(0,i.settingsCheckboxDef)(S,"m_enableSleep","Sleep"),(0,i.settingsCheckboxDef)(S,"m_enableWarmStarting","Warm Starting"),(0,i.settingsCheckboxDef)(S,"m_enableContinuous","Time of Impact"),(0,i.settingsCheckboxDef)(S,"m_enableSubStepping","Sub-Stepping")],h=[(0,i.settingsCheckboxDef)(S,"m_drawShapes","Shapes"),(0,i.settingsCheckboxDef)(S,"m_drawParticles","Particles"),(0,i.settingsCheckboxDef)(S,"m_drawJoints","Joints"),(0,i.settingsCheckboxDef)(S,"m_drawAABBs","AABBs"),(0,i.settingsCheckboxDef)(S,"m_drawContactPoints","Contact Points"),(0,i.settingsCheckboxDef)(S,"m_drawContactNormals","Contact Normals"),(0,i.settingsCheckboxDef)(S,"m_drawContactImpulse","Contact Impulses"),(0,i.settingsCheckboxDef)(S,"m_drawFrictionImpulse","Friction Impulses"),(0,i.settingsCheckboxDef)(S,"m_drawCOMs","Center of Masses")],k=[(0,i.settingsCheckboxDef)(S,"m_drawStats","Statistics"),(0,i.settingsCheckboxDef)(S,"m_drawInputHelp","Input Help"),(0,i.settingsCheckboxDef)(S,"m_drawProfile","Profile"),(0,i.settingsCheckboxDef)(S,"m_drawFpsMeter","FPS Meter")];return n.default.createElement("div",{className:"sidebar"},n.default.createElement("div",{className:"sidebar--tabs"},n.default.createElement("div",{onClick:()=>s("controls"),className:"controls"===t?"active-tab":""},"Controls"),n.default.createElement("div",{onClick:()=>s("tests"),className:"tests"===t?"active-tab":""},"Tests")),n.default.createElement("div",{className:"controls"===t?"tab-content":"tab-content tab-content-hidden"},n.default.createElement(o.SettingsSection,{legend:"Iterations",controls:C}),n.default.createElement(o.SettingsSection,{legend:"General",controls:_}),n.default.createElement(o.SettingsSection,{legend:"Draw",controls:h}),n.default.createElement(o.SettingsSection,{legend:"Overlay",controls:k}),e.groups.map((t,s)=>n.default.createElement(o.SettingsSection,{defaultOpen:!0,legend:`[Test] ${t.legend}`,key:`${e.key}-${s}`,controls:t.controls}))),n.default.createElement("div",{className:"tests"===t?"tab-content":"tab-content tab-content-hidden"},f.groupedTests.map(({name:e,tests:t})=>n.default.createElement(c.TestsFolder,{key:e,name:e,tests:t,link:b}))),"controls"===t&&n.default.createElement("div",{className:"sidebar--buttons"},n.default.createElement(l.Button,{label:d?"Continue (P)":"Pause (P)",onClick:()=>f.SetPause(!d)}),n.default.createElement(l.Button,{label:"Single Step (O)",onClick:()=>f.SingleStep()}),n.default.createElement(l.Button,{label:"Restart (R)",onClick:()=>f.LoadTest(!0)})))};exports.SideBar=d;
},{"react":"dmLA","@react-nano/router":"Tbrz","./style.scss":"GXLA","../../manager":"hmdz","../SettingsSection":"V6BU","../../testControls":"gpWw","../controls/Button":"R9Rp","../TestsFolder":"b64Y","../../utils/reactUtils":"wtUw"}],"OjAK":[function(require,module,exports) {
module.exports={name:"@box2d/testbed",version:"0.10.0",private:!0,description:"A Testbed for all @box2d packages",homepage:"https://lusito.github.io/box2d.ts/",bugs:{url:"https://github.com/lusito/box2d.ts/issues"},repository:{type:"git",url:"https://github.com/lusito/box2d.ts.git"},license:"MIT",author:"Santo Pfingsten",main:"./dist/index.js",types:"./dist/index.d.ts",files:["dist"],scripts:{build:"rimraf dist && tsc && yarn run build:docs","build:docs":"rimraf ../../docs/testbed && parcel build src/ui/index.html --public-url . --no-source-maps --out-dir ../../docs/testbed",start:"parcel src/ui/index.html",watch:"parcel watch src/ui/index.html"},browserslist:["> 5%"],dependencies:{"@box2d/controllers":"^0.10.0","@box2d/core":"^0.10.0","@box2d/debug-draw":"^0.10.0","@box2d/lights":"^0.10.0","@box2d/particles":"^0.10.0","@react-nano/router":"^0.12.0","@types/randomcolor":"^0.5.6","@types/react":"^18.0.9","@types/react-dom":"^18.0.5","gl-matrix":"^3.4.3","parcel-bundler":"^1.12.5",react:"^18.1.0","react-dom":"^18.1.0",rimraf:"^3.0.2",sass:"^1.52.1","sort-package-json":"^1.57.0","typed-glsl":"0.11.1","typed-signals":"^2.5.0","typeface-open-sans":"1.1.13",typescript:"^4.7.2"}};
},{}],"zo2T":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var u=Object.getOwnPropertyDescriptor(t,r);u&&("get"in u?t.__esModule:!u.writable&&!u.configurable)||(u={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,u)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var u in r)"default"!==u&&Object.prototype.hasOwnProperty.call(r,u)&&e(n,r,u);return t(n,r),n},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const u=r(require("react")),o=n(require("react-dom"));require("typeface-open-sans");const a=require("@react-nano/router"),i=require("./Main"),c=require("./SideBar"),s=n(require("../../package.json"));require("./style.scss");const l={key:0,groups:[]};function d(e,t){return{key:e.key+1,groups:t}}function f(){const[e,t]=(0,u.useReducer)(d,l);return u.default.createElement("div",{className:"container"},u.default.createElement(i.Main,{setTestControlGroups:t}),u.default.createElement(c.SideBar,{testControlGroups:e}))}document.title=`@Box2D Testbed v${s.default.version}`,o.default.render(u.default.createElement(a.Router,{mode:"hash"},u.default.createElement(f,null)),document.getElementById("root"));
},{"react":"dmLA","react-dom":"kUqu","typeface-open-sans":"pHua","@react-nano/router":"Tbrz","./Main":"E7LK","./SideBar":"kR8o","../../package.json":"OjAK","./style.scss":"GXLA"}]},{},["zo2T"], null)